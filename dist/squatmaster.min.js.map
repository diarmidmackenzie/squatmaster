{"version":3,"file":"squatmaster.min.js","mappings":"CAAA,SAA2CA,EAAMC,GAChD,GAAsB,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,SACb,GAAqB,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,OACP,CACJ,IAAIK,EAAIL,IACR,IAAI,IAAIM,KAAKD,GAAuB,iBAAZJ,QAAuBA,QAAUF,GAAMO,GAAKD,EAAEC,EACvE,CACA,CATD,CASGC,MAAM,I,qBCTTC,OAAOC,kBAAkB,oBAAqB,CAE1CC,OAAQ,CACJC,MAAO,CAAEC,KAAM,QAASC,QAAS,QACjCC,QAAS,CAAEF,KAAM,SAAUC,QAAS,GACpCE,cAAe,CAAEH,KAAM,SAAUC,QAAS,GAC1CG,OAAQ,CAAEJ,KAAM,UAAWC,SAAS,GACpCI,SAAU,CAAEL,KAAM,SAAUC,QAAS,GACrCK,QAAS,CAAEN,KAAM,SAAUC,QAAS,GACpCM,UAAW,CAAEP,KAAM,SAAUC,QAAS,KAG1CO,OAEEC,KAAKC,eAAiBD,KAAKC,eAAeC,KAAKF,MAC/CA,KAAKG,GAAGC,iBAAiB,cAAeJ,KAAKC,gBACzCD,KAAKG,GAAGE,YAAY,SACtBL,KAAKC,gBAET,EAEAA,iBAEE,MAAMK,EAAeN,KAAKG,GAAGE,YAAY,QAAQE,SAC5CD,IAIDN,KAAKQ,OACPR,KAAKQ,MAAMC,UAGbT,KAAKQ,MAAQ,IAAIE,MAAMC,cAAcL,GACrCN,KAAKY,SACP,EAEAA,SAEE,MAAMC,EAAcb,KAAKc,SACnBC,EAAUf,KAAKgB,KACfC,EAAoBjB,KAAKkB,eACzBC,EAAgBnB,KAAKoB,WAErBC,EAAOrB,KAAKqB,KAkBlB,GAhBArB,KAAKc,SAAWd,KAAKsB,mBAAmBD,EAAK/B,MAAO+B,EAAK5B,SAE9B,IAAvB4B,EAAK3B,eACL2B,EAAK3B,gBAAkB2B,EAAK5B,SAE9BO,KAAKkB,eAAiBlB,KAAKsB,mBAAmBD,EAAK/B,MAAO+B,EAAK3B,eAE3D2B,EAAK3B,cAAgB2B,EAAK5B,UAC5B8B,QAAQC,KAAK,iFACbD,QAAQC,KAAK,2CAA4CH,EAAK3B,cAAe,wCAI/EM,KAAKkB,eAAiB,KAGG,IAAvBG,EAAK3B,cAAqB,CAC5B,MAAMoB,EAAWd,KAAKkB,gBAAkBlB,KAAKc,SAC7CA,EAASW,YAAa,EACtBX,EAASY,WAAY,EACrBZ,EAASa,YAAa,CACxB,CAEA3B,KAAKgB,KAAO,IAAIN,MAAMkB,aAAc5B,KAAKQ,MAAOR,KAAKc,UACrDd,KAAKgB,KAAKa,uBACV7B,KAAKG,GAAG2B,SAASC,IAAK/B,KAAKgB,MAEvBhB,KAAKkB,iBACPlB,KAAKoB,WAAa,IAAIV,MAAMkB,aAAc5B,KAAKQ,MAAOR,KAAKkB,gBAC3DlB,KAAKoB,WAAWS,uBAChB7B,KAAKG,GAAG2B,SAASC,IAAK/B,KAAKoB,aAG7BpB,KAAKG,GAAGE,YAAY,QAAQ2B,SAAU,EAWtChC,KAAKiC,sBAAsBlB,EAASF,GACpCb,KAAKiC,sBAAsBd,EAAeF,EAC5C,EAEAgB,sBAAsBjB,EAAMF,GACtBE,GACFA,EAAKkB,mBAEHpB,GACFA,EAASL,SAEb,EAEAa,mBAAmBhC,EAAOG,GAExB,MAAM4B,EAAOrB,KAAKqB,KAClB,IAAIP,EAeJ,OAVIA,EAJCO,EAAK1B,OAIK,IAAIe,MAAMyB,mBAAoB,CAAE7C,MAAOA,EACPM,SAAUyB,EAAKzB,SACfC,QAASwB,EAAKxB,QACduC,MAAOf,EAAKvB,YAN5C,IAAIY,MAAM2B,kBAAmB,CAAE/C,MAAOA,IAQrDwB,EAASrB,QAAUA,EACH,IAAZA,IACFqB,EAASwB,aAAc,GAGlBxB,CACT,EAEAyB,SAEEvC,KAAKG,GAAGqC,oBAAoB,cAAexC,KAAKC,gBAChDD,KAAKG,GAAGE,YAAY,QAAQ2B,SAAU,EAClChC,KAAKQ,OACPR,KAAKQ,MAAMC,UAGbT,KAAKiC,sBAAsBjC,KAAKgB,KAAMhB,KAAKc,SAC7C,G,cCpIJ,IAAI2B,EAAgB,UAChBC,EAAiB,UAEjBC,EAAa,CACfC,OAAQ,SAAUvB,GAEhB,OADe,IAAIwB,EAASxB,GACZuB,QAClB,EACAE,KAAM,SAAUzB,GACd,IAAI0B,EAAS,IAAIC,EAGjB,OAFAD,EAAOD,KAAKzB,GACC0B,EAAOE,WAEtB,GAKF,SAASJ,EAAUxB,GAEjBrB,KAAKkD,MAAQ,EACblD,KAAKmD,WAAa9B,EAClBrB,KAAKoD,SAAW,IAAIC,WAAWrD,KAAKmD,YACpCnD,KAAKsD,OAAStD,KAAKmD,WAAWI,UAChC,CA2OA,SAASP,IACPhD,KAAKwD,cAAgB,IAAIf,CAC3B,CAmPA,SAASgB,EAAcC,GACrB,IAAIC,EAAOD,EAAEE,WAAW,GAExB,OAAID,GAAQ,KAAc,KACtBA,GAAQ,MAAe,MACvBA,GAAQ,QAAiB,OACzBA,GAAQ,SAAkB,QACvB,QACT,CAhfA9E,EAAOD,QAAU+D,EAUjBE,EAASgB,UAAUjB,OAAS,WAC1B,IAOIkB,EAPAvE,EAAOS,KAAK+D,eAChB,GAAIxE,EAAO,IACT,OAAOA,EACF,IAAY,IAAPA,GAAe,GACzB,OAAe,IAAPA,GAAe,GAIzB,IAAKuE,EAAc,IAAPvE,IAAgB,GAC1B,OAAOS,KAAKgE,WAAWF,GAClB,IAAKA,EAAc,IAAPvE,IAAgB,GACjC,OAAOS,KAAKiE,cAAcH,GACrB,IAAKA,EAAc,IAAPvE,IAAgB,GACjC,OAAOS,KAAKkE,aAAaJ,GACpB,IAAKA,EAAc,IAAPvE,IAAgB,GACjC,OAAOS,KAAKmE,WAAWL,GAGzB,OAAQvE,GACN,KAAK,IACH,OAAO,KACT,KAAK,IA0BL,KAAK,IAEL,KAAK,IAEL,KAAK,IAEL,KAAK,IACH,OA/BF,KAAK,IACH,OAAO,EACT,KAAK,IACH,OAAO,EACT,KAAK,IACH,OAAOS,KAAKoE,eACd,KAAK,IACH,OAAOpE,KAAKqE,gBACd,KAAK,IACH,OAAOrE,KAAK+D,eACd,KAAK,IACH,OAAO/D,KAAKsE,gBACd,KAAK,IACH,OAAOtE,KAAKuE,gBACd,KAAK,IACH,OAAOvE,KAAKwE,gBACd,KAAK,IACH,OAAOxE,KAAKyE,cACd,KAAK,IACH,OAAOzE,KAAK0E,eACd,KAAK,IACH,OAAO1E,KAAK2E,eACd,KAAK,IACH,OAAO3E,KAAK4E,eASd,KAAK,IAEH,OADAd,EAAO9D,KAAKsE,gBACLtE,KAAKiE,cAAcH,GAC5B,KAAK,IAEH,OADAA,EAAO9D,KAAKuE,gBACLvE,KAAKiE,cAAcH,GAC5B,KAAK,IAEH,OADAA,EAAO9D,KAAKsE,gBACLtE,KAAKgE,WAAWF,GACzB,KAAK,IAEH,OADAA,EAAO9D,KAAKuE,gBACLvE,KAAKgE,WAAWF,GACzB,KAAK,IAEH,OADAA,EAAO9D,KAAKsE,gBACLtE,KAAKkE,aAAaJ,GAC3B,KAAK,IAEH,OADAA,EAAO9D,KAAKuE,gBACLvE,KAAKkE,aAAaJ,GAC3B,KAAK,IAEH,OADAA,EAAO9D,KAAKsE,gBACLtE,KAAKmE,WAAWL,GACzB,KAAK,IAEH,OADAA,EAAO9D,KAAKuE,gBACLvE,KAAKmE,WAAWL,GAE7B,EAEAjB,EAASgB,UAAUE,aAAe,WAChC,IAAIc,EAAmC,IAA5B7E,KAAKoD,SAASpD,KAAKkD,OAE9B,OADAlD,KAAKkD,QACE2B,CACT,EAEAhC,EAASgB,UAAUS,cAAgB,WACjC,IAAIQ,EAAQ9E,KAAK+E,KAAK,GAClBC,EACmB,KAAR,IAAXF,EAAM,KAAgC,IAAXA,EAAM,IAErC,OADA9E,KAAKkD,OAAS,EACP8B,CACT,EAEAnC,EAASgB,UAAUU,cAAgB,WACjC,IAAIO,EAAQ9E,KAAK+E,KAAK,GAClBE,EAGY,KADA,KADD,IAAXH,EAAM,GACNA,EAAM,IACNA,EAAM,IACRA,EAAM,GAER,OADA9E,KAAKkD,OAAS,EACP+B,CACT,EAEApC,EAASgB,UAAUW,cAAgB,WACjC,IAAIM,EAAQ9E,KAAK+E,KAAK,GAClBG,EAOY,KADA,KADA,KADA,KADA,KADA,KADG,IAAXJ,EAAM,GACVA,EAAM,IACNA,EAAM,IACNA,EAAM,IACNA,EAAM,IACNA,EAAM,IACNA,EAAM,IACRA,EAAM,GAER,OADA9E,KAAKkD,OAAS,EACPgC,CACT,EAEArC,EAASgB,UAAUY,YAAc,WAC/B,IAAIU,EAAQnF,KAAK+D,eACjB,OAAQoB,EAAQ,IAAQA,EAAQA,EAAQ,GAC1C,EAEAtC,EAASgB,UAAUa,aAAe,WAChC,IAAIM,EAAShF,KAAKsE,gBAClB,OAAQU,EAAS,MAAUA,EAASA,EAAS,KAC/C,EAEAnC,EAASgB,UAAUc,aAAe,WAChC,IAAIM,EAASjF,KAAKuE,gBAClB,OAAQU,EAASG,KAAKC,IAAI,EAAG,IAAOJ,EAChCA,EAASG,KAAKC,IAAI,EAAG,GAC3B,EAEAxC,EAASgB,UAAUe,aAAe,WAChC,IAAIM,EAASlF,KAAKwE,gBAClB,OAAQU,EAASE,KAAKC,IAAI,EAAG,IAAOH,EAChCA,EAASE,KAAKC,IAAI,EAAG,GAC3B,EAEAxC,EAASgB,UAAUG,WAAa,SAAUF,GACxC,GAAI9D,KAAKsD,OAAStD,KAAKkD,MAAQY,EAC7B,MAAM,IAAIwB,MAAM,4CACRtF,KAAKkD,MAAQ,IAAMY,EAAO,IAAM9D,KAAKsD,QAE/C,IAAIiC,EAAMvF,KAAKmD,WAAWqC,MAAMxF,KAAKkD,MAAOlD,KAAKkD,MAAQY,GAKzD,OAJA9D,KAAKkD,OAASY,EAIPyB,CACT,EAEA1C,EAASgB,UAAUI,cAAgB,SAAUH,GAO3C,IANA,IAGI2B,EACA9B,EAJAmB,EAAQ9E,KAAK+E,KAAKjB,GAClB7E,EAAI,EACJyG,EAAM,GAIHzG,EAAI6E,IACT2B,EAAIX,EAAM7F,IACF,KACNyG,GAAOC,OAAOC,aAAaH,GAC3BxG,MACc,IAAJwG,GAAY,IACtB9B,GAAa,IAAJ8B,IAAa,EAAqB,GAAfX,EAAM7F,EAAI,GACtCyG,GAAOC,OAAOC,aAAajC,GAC3B1E,GAAK,IAEL0E,GAAa,GAAJ8B,IAAW,IAAuB,GAAfX,EAAM7F,EAAI,KAAY,EAChC,GAAf6F,EAAM7F,EAAI,GACbyG,GAAOC,OAAOC,aAAajC,GAC3B1E,GAAK,GAKT,OADAe,KAAKkD,OAASY,EACP4B,CACT,EAEA7C,EAASgB,UAAUK,aAAe,SAAUJ,GAE1C,IADA,IAAI+B,EAAU,IAAIC,MAAMhC,GACf7E,EAAI,EAAGA,EAAI6E,EAAM7E,IACxB4G,EAAQ5G,GAAKe,KAAK4C,SAEpB,OAAOiD,CACT,EAEAhD,EAASgB,UAAUM,WAAa,SAAUL,GAExC,IADA,IAAIiC,EAAM,CAAC,EACF9G,EAAI,EAAGA,EAAI6E,EAAM7E,IAAK,CAC7B,IAAI+G,EAAMhG,KAAK4C,SACXqD,EAAQjG,KAAK4C,SACjBmD,EAAIC,GAAOC,CACb,CACA,OAAOF,CACT,EAEAlD,EAASgB,UAAUO,aAAe,WAChC,IAAIa,EAASjF,KAAKuE,gBAEd2B,GAAQjB,GAAU,GAAM,KAAQ,IAEpC,OAAiB,GAHNA,GAAU,GAGA,GAAK,IADD,QAATA,EAAqB,SAExBG,KAAKC,IAAI,EAAGa,EAAM,GACjC,EAEArD,EAASgB,UAAUQ,cAAgB,WACjC,IAAI8B,EAAMnG,KAAKuE,gBACX6B,EAAMpG,KAAKuE,gBAEX2B,GAAQC,GAAO,GAAM,MAAS,KAIlC,OAAiB,GALNA,GAAO,GAKG,GAAK,KAHP,QAANA,EAAiB,SACXf,KAAKC,IAAI,EAAGa,EAAM,IACnCE,EAAMhB,KAAKC,IAAI,EAAGa,EAAM,IAE5B,EAEArD,EAASgB,UAAUkB,KAAO,SAAUzB,GAClC,IAAI+C,EAAIrG,KAAKkD,MACb,GAAImD,EAAI/C,GAAUtD,KAAKsD,OACrB,OAAOtD,KAAKoD,SAASkD,SAASD,EAAGA,EAAI/C,GAErC,MAAM,IAAIgC,MAAM,6CAEpB,EAMAtC,EAAOa,UAAUZ,UAAY,WAC3B,OAAOjD,KAAKwD,cAAcP,WAC5B,EAEAD,EAAOa,UAAUf,KAAO,SAAUmD,GAChC,IAAI1G,SAAc,EAClB,GAAa,WAATA,EACFS,KAAKuG,YAAYN,QACZ,GAAa,WAAT1G,EACL6F,KAAKoB,MAAMP,KAAWA,EACxBjG,KAAKyG,aAAaR,GAElBjG,KAAK0G,YAAYT,QAEd,GAAa,YAAT1G,GACK,IAAV0G,EACFjG,KAAKwD,cAAcmD,OAAO,MACP,IAAVV,GACTjG,KAAKwD,cAAcmD,OAAO,UAEvB,GAAa,cAATpH,EACTS,KAAKwD,cAAcmD,OAAO,SACrB,IAAa,WAATpH,EAgCT,MAAM,IAAI+F,MAAM,SAAW/F,EAAO,uBA/BlC,GAAc,OAAV0G,EACFjG,KAAKwD,cAAcmD,OAAO,SACrB,CACL,IAAIC,EAAcX,EAAMW,YACxB,GAAIA,GAAed,MACjB9F,KAAK6G,WAAWZ,QACX,GAAIW,GAAeE,MAAQF,GAAeG,MAAQd,aAAiBa,MAAQb,aAAiBc,KACjG/G,KAAKgH,SAASf,QACT,GAAIW,GAAeK,YACpBvE,EAAewE,mBACjBlH,KAAKgH,SAAS,IAAI3D,WAAW4C,IAE7BjG,KAAKgH,SAASf,QAEX,GAAI,sBAAuBA,EAC5BvD,EAAewE,mBACjBlH,KAAKgH,SAAS,IAAI3D,WAAW4C,EAAMkB,SAEnCnH,KAAKgH,SAASf,EAAMkB,aAEjB,GAAKP,GAAeQ,QAAYR,EAAYS,WAAWC,WAAW,SACvEtH,KAAKuH,YAAYtB,QACZ,GAAIW,GAAeY,KACxBxH,KAAKuG,YAAYN,EAAMoB,gBAClB,IAAkC,mBAAvBpB,EAAMwB,aAGtB,MAAM,IAAInC,MAAM,SAAWsB,EAAYS,WAAa,uBAFpDrH,KAAKwD,cAAcmD,OAAOV,EAAMwB,eAGlC,CACF,CAGF,CACAzH,KAAKwD,cAAckE,OACrB,EAEA1E,EAAOa,UAAUmD,SAAW,SAAUW,GACpC,IAAIrE,EAASqE,EAAKrE,QAAUqE,EAAKpE,YAAcoE,EAAK7D,KACpD,GAAIR,GAAU,GACZtD,KAAK4H,WAAW,IAAOtE,QAClB,GAAIA,GAAU,MACnBtD,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAK6H,YAAYvE,OACZ,MAAIA,GAAU,YAInB,MAAM,IAAIgC,MAAM,kBAHhBtF,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAK8H,YAAYxE,EAGnB,CACAtD,KAAKwD,cAAcmD,OAAOgB,EAC5B,EAEA3E,EAAOa,UAAU0C,YAAc,SAAUb,GACvC,IAAIpC,EA+KN,SAAqBoC,GACnB,OAAIA,EAAIpC,OAAS,IAER,IAAKwD,KAAK,CAACpB,IAAO5B,KAElB4B,EAAIqC,QAAQ,oBAAqBtE,GAAcH,MAE1D,CAtLe0E,CAAWtC,GAExB,GAAIpC,GAAU,GACZtD,KAAK4H,WAAW,IAAOtE,QAClB,GAAIA,GAAU,MACnBtD,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAK6H,YAAYvE,OACZ,MAAIA,GAAU,YAInB,MAAM,IAAIgC,MAAM,kBAHhBtF,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAK8H,YAAYxE,EAGnB,CACAtD,KAAKwD,cAAcmD,OAAOjB,EAC5B,EAEA1C,EAAOa,UAAUgD,WAAa,SAAUoB,GACtC,IAAI3E,EAAS2E,EAAI3E,OACjB,GAAIA,GAAU,GACZtD,KAAK4H,WAAW,IAAOtE,QAClB,GAAIA,GAAU,MACnBtD,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAK6H,YAAYvE,OACZ,MAAIA,GAAU,YAInB,MAAM,IAAIgC,MAAM,kBAHhBtF,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAK8H,YAAYxE,EAGnB,CACA,IAAK,IAAIrE,EAAI,EAAGA,EAAIqE,EAAQrE,IAC1Be,KAAK8C,KAAKmF,EAAIhJ,GAElB,EAEA+D,EAAOa,UAAU4C,aAAe,SAAUyB,GACxC,GAAIA,IAAQ,IAAQA,GAAO,IACzBlI,KAAKwD,cAAcmD,OAAa,IAANuB,QACrB,GAAIA,GAAO,GAAQA,GAAO,IAC/BlI,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAK4H,WAAWM,QACX,GAAIA,IAAQ,KAAQA,GAAO,IAChClI,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAKmI,UAAUD,QACV,GAAIA,GAAO,GAAUA,GAAO,MACjClI,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAK6H,YAAYK,QACZ,GAAIA,IAAQ,OAAUA,GAAO,MAClClI,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAKoI,WAAWF,QACX,GAAIA,GAAO,GAAcA,GAAO,WACrClI,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAK8H,YAAYI,QACZ,GAAIA,IAAQ,YAAcA,GAAO,WACtClI,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAKqI,WAAWH,QACX,GAAIA,IAAQ,oBAAsBA,GAAO,mBAC9ClI,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAKsI,WAAWJ,OACX,MAAIA,GAAO,GAAsBA,GAAO,qBAI7C,MAAM,IAAI5C,MAAM,mBAHhBtF,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAKuI,YAAYL,EAGnB,CACF,EAEAlF,EAAOa,UAAU6C,YAAc,SAAUwB,GACvC,IAAIM,EAAO,EACPN,EAAM,IACRM,EAAO,EACPN,GAAOA,GAET,IAAIhC,EAAMd,KAAKoB,MAAMpB,KAAKqD,IAAIP,GAAO9C,KAAKsD,KACtCC,EAAQT,EAAM9C,KAAKC,IAAI,EAAGa,GAAO,EACjC0C,EAAQxD,KAAKoB,MAAMmC,EAAQvD,KAAKC,IAAI,EAAG,KACvCwD,EAAMzD,KAAKC,IAAI,EAAG,IAClBc,EAAOqC,GAAQ,GAAQtC,EAAM,MAAS,GACvC0C,EAAQC,EAAO,QACdzC,EAAMwC,EAAQC,EAClB7I,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAKqI,WAAWlC,GAChBnG,KAAKqI,WAAWjC,EAClB,EAEApD,EAAOa,UAAU0D,YAAc,SAAUuB,GACvC,IACIxF,EADO8D,OAAO2B,KAAKD,GACLxF,OAClB,GAAIA,GAAU,GACZtD,KAAK4H,WAAW,IAAOtE,QAClB,GAAIA,GAAU,MACnBtD,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAK6H,YAAYvE,OACZ,MAAIA,GAAU,YAInB,MAAM,IAAIgC,MAAM,kBAHhBtF,KAAKwD,cAAcmD,OAAO,KAC1B3G,KAAK8H,YAAYxE,EAGnB,CACA,IAAK,IAAI0F,KAAQF,EACXA,EAAIG,eAAeD,KACrBhJ,KAAK8C,KAAKkG,GACVhJ,KAAK8C,KAAKgG,EAAIE,IAGpB,EAEAhG,EAAOa,UAAU+D,WAAa,SAAUM,GACtClI,KAAKwD,cAAcmD,OAAOuB,EAC5B,EAEAlF,EAAOa,UAAUgE,YAAc,SAAUK,GACvClI,KAAKwD,cAAcmD,OAAOuB,GAAO,GACjClI,KAAKwD,cAAcmD,OAAa,IAANuB,EAC5B,EAEAlF,EAAOa,UAAUiE,YAAc,SAAUI,GACvC,IAAIgB,EAAU,WAANhB,EACRlI,KAAKwD,cAAcmD,QAAY,WAAJuC,KAAoB,IAC/ClJ,KAAKwD,cAAcmD,QAAY,SAAJuC,KAAoB,IAC/ClJ,KAAKwD,cAAcmD,QAAY,MAAJuC,KAAoB,GAC/ClJ,KAAKwD,cAAcmD,OAAY,IAAJuC,EAC7B,EAEAlG,EAAOa,UAAU0E,YAAc,SAAUL,GACvC,IAAIiB,EAAOjB,EAAM9C,KAAKC,IAAI,EAAG,IACzB+D,EAAMlB,EAAM9C,KAAKC,IAAI,EAAG,IAC5BrF,KAAKwD,cAAcmD,QAAe,WAAPwC,KAAuB,IAClDnJ,KAAKwD,cAAcmD,QAAe,SAAPwC,KAAuB,IAClDnJ,KAAKwD,cAAcmD,QAAe,MAAPwC,KAAuB,GAClDnJ,KAAKwD,cAAcmD,OAAe,IAAPwC,GAC3BnJ,KAAKwD,cAAcmD,QAAc,WAANyC,KAAsB,IACjDpJ,KAAKwD,cAAcmD,QAAc,SAANyC,KAAsB,IACjDpJ,KAAKwD,cAAcmD,QAAc,MAANyC,KAAsB,GACjDpJ,KAAKwD,cAAcmD,OAAc,IAANyC,EAC7B,EAEApG,EAAOa,UAAUsE,UAAY,SAAUD,GACrClI,KAAKwD,cAAcmD,OAAa,IAANuB,EAC5B,EAEAlF,EAAOa,UAAUuE,WAAa,SAAUF,GACtClI,KAAKwD,cAAcmD,QAAc,MAANuB,IAAiB,GAC5ClI,KAAKwD,cAAcmD,OAAa,IAANuB,EAC5B,EAEAlF,EAAOa,UAAUwE,WAAa,SAAUH,GACtClI,KAAKwD,cAAcmD,OAAQuB,IAAQ,GAAM,KACzClI,KAAKwD,cAAcmD,QAAc,SAANuB,KAAsB,IACjDlI,KAAKwD,cAAcmD,QAAc,MAANuB,KAAsB,GACjDlI,KAAKwD,cAAcmD,OAAc,IAANuB,EAC7B,EAEAlF,EAAOa,UAAUyE,WAAa,SAAUJ,GACtC,IAAIiB,EAAO/D,KAAKoB,MAAM0B,EAAM9C,KAAKC,IAAI,EAAG,KACpC+D,EAAMlB,EAAM9C,KAAKC,IAAI,EAAG,IAC5BrF,KAAKwD,cAAcmD,QAAe,WAAPwC,KAAuB,IAClDnJ,KAAKwD,cAAcmD,QAAe,SAAPwC,KAAuB,IAClDnJ,KAAKwD,cAAcmD,QAAe,MAAPwC,KAAuB,GAClDnJ,KAAKwD,cAAcmD,OAAe,IAAPwC,GAC3BnJ,KAAKwD,cAAcmD,QAAc,WAANyC,KAAsB,IACjDpJ,KAAKwD,cAAcmD,QAAc,SAANyC,KAAsB,IACjDpJ,KAAKwD,cAAcmD,QAAc,MAANyC,KAAsB,GACjDpJ,KAAKwD,cAAcmD,OAAc,IAANyC,EAC7B,C,UCtfA,IAAI1G,EAAiB,CAAC,EACtBA,EAAe2G,eAAiB,WAC9B,IAEE,OADA,IAAIvC,KAAK,KACF,CACT,CAAE,MAAOwC,GACP,OAAO,CACT,CACD,CAP+B,GAShC5G,EAAewE,oBAAsBxE,EAAe2G,gBAAkB,WACpE,IACE,OAAiD,IAA1C,IAAKvC,KAAK,CAAC,IAAIzD,WAAW,MAAOS,IAC1C,CAAE,MAAOwF,GACP,OAAO,CACT,CACD,CANqE,GAQtEzK,EAAOD,QAAQ,GAAiB8D,EAChC,IAAI6G,EAAc1K,EAAOD,QAAQ,GAMjC,SAAS6D,IACPzC,KAAKwJ,QAAU,GACfxJ,KAAKyJ,OAAS,EAChB,CARsB,oBAAXC,SACTH,EAAc1K,EAAOD,QAAQ,GAAc8K,OAAOC,mBAChDD,OAAOE,gBAAkBF,OAAOG,eAAiBH,OAAOH,aAQ5D9G,EAAcoB,UAAU8C,OAAS,SAAUtF,GACrB,iBAATA,EACTrB,KAAKwJ,QAAQM,KAAKzI,IAElBrB,KAAK0H,QACL1H,KAAKyJ,OAAOK,KAAKzI,GAErB,EAEAoB,EAAcoB,UAAU6D,MAAQ,WAC9B,GAAI1H,KAAKwJ,QAAQlG,OAAS,EAAG,CAC3B,IAAIiC,EAAM,IAAIlC,WAAWrD,KAAKwJ,SACzB9G,EAAewE,qBAClB3B,EAAMA,EAAI4B,QAEZnH,KAAKyJ,OAAOK,KAAKvE,GACjBvF,KAAKwJ,QAAU,EACjB,CACF,EAEA/G,EAAcoB,UAAUZ,UAAY,WAElC,GADAjD,KAAK0H,QACDhF,EAAe2G,eAAgB,CAEjC,IADA,IAAIU,EAAU,IAAIR,EACTtK,EAAI,EAAG+K,EAAKhK,KAAKyJ,OAAOnG,OAAQrE,EAAI+K,EAAI/K,IAC/C8K,EAAQpD,OAAO3G,KAAKyJ,OAAOxK,IAE7B,OAAO8K,EAAQE,SACjB,CACE,OAAO,IAAInD,KAAK9G,KAAKyJ,OAEzB,EAEA5K,EAAOD,QAAQ,GAAgB6D,C,6BCrD/B,IAAIyH,EAAW,EAAQ,KAYvB,SAASC,EAAkBC,EAAaC,EAAM9K,EAAM+K,EAAQC,GAC1D,IAAIC,EAAMN,EAASO,oBAAoBL,EAAYM,KAAML,GAuBzD,GApBAG,GAAON,EAASS,mBACZP,EAAYQ,YAAYC,sBAG5BL,GAAON,EAASY,oBACZV,EAAYW,cAAcF,qBACjB,UAATtL,EAAmB,UAAYgL,GAAY,UAE/CC,GAAO,SAAWJ,EAAYY,IAAM,OAEhCZ,EAAYa,WAAab,EAAYc,YACvCV,GAAO,iBACEJ,EAAYa,UACrBT,GAAO,iBACEJ,EAAYc,YACrBV,GAAO,iBAEPA,GAAO,iBAGLJ,EAAYa,UAAW,CACzB,IAAIE,EAAUf,EAAYa,UAAUG,iBAChChB,EAAYa,UAAUI,MAAMC,GAChClB,EAAYa,UAAUG,gBAAkBD,EAExC,IAAII,EAAO,SAAWjB,EAASA,EAAOgB,GAAK,KAAO,IAC9CH,EAAU,OACdX,GAAO,KAAOe,EAEdf,GAAO,UAAYJ,EAAYoB,uBAAuB,GAAGC,KACrD,IAAMF,EAGNnB,EAAYoB,uBAAuB,GAAGE,MACxClB,GAAO,UAAYJ,EAAYoB,uBAAuB,GAAGE,IAAID,KACzD,IAAMF,EACVf,GAAO,oBACHJ,EAAYoB,uBAAuB,GAAGC,KAAO,IAC7CrB,EAAYoB,uBAAuB,GAAGE,IAAID,KAC1C,OAER,CAQA,OANAjB,GAAO,UAAYJ,EAAYoB,uBAAuB,GAAGC,KACrD,UAAYvB,EAASyB,WAAa,OAClCvB,EAAYa,WAAab,EAAYoB,uBAAuB,GAAGE,MACjElB,GAAO,UAAYJ,EAAYoB,uBAAuB,GAAGE,IAAID,KACzD,UAAYvB,EAASyB,WAAa,QAEjCnB,CACT,CA0CA,SAASoB,EAAsBC,EAAmBC,GAChD,IAAIC,EAAqB,CACvBC,OAAQ,GACRC,iBAAkB,GAClBC,cAAe,IAGbC,EAAyB,SAASC,EAAIJ,GACxCI,EAAKC,SAASD,EAAI,IAClB,IAAK,IAAInN,EAAI,EAAGA,EAAI+M,EAAO1I,OAAQrE,IACjC,GAAI+M,EAAO/M,GAAGqN,cAAgBF,GAC1BJ,EAAO/M,GAAGsN,uBAAyBH,EACrC,OAAOJ,EAAO/M,EAGpB,EAEIuN,EAAuB,SAASC,EAAMC,EAAMC,EAASC,GACvD,IAAIC,EAASV,EAAuBM,EAAKK,WAAWC,IAAKJ,GACrDK,EAASb,EAAuBO,EAAKI,WAAWC,IAAKH,GACzD,OAAOC,GAAUG,GACbH,EAAOI,KAAKC,gBAAkBF,EAAOC,KAAKC,aAChD,EAoDA,OAlDArB,EAAkBG,OAAOmB,SAAQ,SAASN,GACxC,IAAK,IAAI5N,EAAI,EAAGA,EAAI6M,EAAmBE,OAAO1I,OAAQrE,IAAK,CACzD,IAAI+N,EAASlB,EAAmBE,OAAO/M,GACvC,GAAI4N,EAAOI,KAAKC,gBAAkBF,EAAOC,KAAKC,eAC1CL,EAAOO,YAAcJ,EAAOI,UAAW,CACzC,GAAkC,QAA9BP,EAAOI,KAAKC,eACZL,EAAOC,YAAcE,EAAOF,WAAWC,MAGpCP,EAAqBK,EAAQG,EAC9BnB,EAAkBG,OAAQF,EAAmBE,QAC/C,UAGJgB,EAASK,KAAKC,MAAMD,KAAKE,UAAUP,KAE5BQ,YAAcpI,KAAKqI,IAAIZ,EAAOW,YACjCR,EAAOQ,aAEXzB,EAAmBC,OAAOlC,KAAKkD,GAG/BA,EAAOU,aAAeV,EAAOU,aAAaC,QAAO,SAASC,GACxD,IAAK,IAAIvH,EAAI,EAAGA,EAAIwG,EAAOa,aAAapK,OAAQ+C,IAC9C,GAAIwG,EAAOa,aAAarH,GAAG9G,OAASqO,EAAGrO,MACnCsN,EAAOa,aAAarH,GAAGwH,YAAcD,EAAGC,UAC1C,OAAO,EAGX,OAAO,CACT,IAGA,KACF,CACF,CACF,IAEAhC,EAAkBI,iBAAiBkB,SAAQ,SAASW,GAClD,IAAK,IAAI7O,EAAI,EAAGA,EAAI6M,EAAmBG,iBAAiB3I,OACnDrE,IAAK,CACR,IAAI8O,EAAmBjC,EAAmBG,iBAAiBhN,GAC3D,GAAI6O,EAAiBE,MAAQD,EAAiBC,IAAK,CACjDjC,EAAmBE,iBAAiBnC,KAAKiE,GACzC,KACF,CACF,CACF,IAGOhC,CACT,CAGA,SAASkC,EAAgCC,EAAQ3O,EAAM4O,GACrD,OAS6C,IATtC,CACLC,MAAO,CACLC,oBAAqB,CAAC,SAAU,oBAChCC,qBAAsB,CAAC,SAAU,sBAEnCC,OAAQ,CACNF,oBAAqB,CAAC,oBAAqB,uBAC3CC,qBAAsB,CAAC,mBAAoB,0BAE7C/O,GAAM2O,GAAQM,QAAQL,EAC1B,CAEA,SAASM,EAAkBC,EAAcC,GAGvC,IAAIC,EAAeF,EAAaG,sBAC3BC,MAAK,SAASC,GACb,OAAOJ,EAAUK,aAAeD,EAAgBC,YAC5CL,EAAUM,KAAOF,EAAgBE,IACjCN,EAAUO,OAASH,EAAgBG,MACnCP,EAAUQ,WAAaJ,EAAgBI,UACvCR,EAAUS,WAAaL,EAAgBK,UACvCT,EAAUpP,OAASwP,EAAgBxP,IACzC,IAIJ,OAHKqP,GACHF,EAAaW,mBAAmBV,IAE1BC,CACV,CAGA,SAASU,EAAUrC,EAAMsC,GACvB,IAAIjG,EAAI,IAAIhE,MAAMiK,GAUlB,OATAjG,EAAE2D,KAAOA,EAET3D,EAAE3F,KAAO,CACP6L,kBAAmB,EACnBC,kBAAmB,GACnBC,mBAAoB,GACpBC,eAAWC,EACXC,oBAAgBD,GAChB3C,GACK3D,CACT,CAEAzK,EAAOD,QAAU,SAAS8K,EAAQoG,GAIhC,SAASC,EAA6B1E,EAAOf,GAC3CA,EAAO0F,SAAS3E,GAChBf,EAAO2F,cAAc,IAAIvG,EAAOwG,sBAAsB,WAClD,CAAC7E,MAAOA,IACd,CAQA,SAAS8E,EAAaC,EAAI/E,EAAOgF,EAAUC,GACzC,IAAIC,EAAa,IAAIC,MAAM,SAC3BD,EAAWlF,MAAQA,EACnBkF,EAAWF,SAAWA,EACtBE,EAAWnG,YAAc,CAACiG,SAAUA,GACpCE,EAAWD,QAAUA,EACrB5G,EAAO+G,YAAW,WAChBL,EAAGM,eAAe,QAASH,EAC7B,GACF,CAEA,IAAII,EAAoB,SAASC,GAC/B,IAAIR,EAAKpQ,KAEL6Q,EAAeC,SAASC,yBAwB5B,GAvBA,CAAC,mBAAoB,sBAAuB,iBACvC5D,SAAQ,SAAS6D,GAChBZ,EAAGY,GAAUH,EAAaG,GAAQ9Q,KAAK2Q,EACzC,IAEJ7Q,KAAKiR,wBAA0B,KAE/BjR,KAAKkR,iBAAkB,EAEvBlR,KAAKmR,aAAe,GACpBnR,KAAKoR,cAAgB,GAErBpR,KAAKqR,kBAAoB,KACzBrR,KAAKsR,mBAAqB,KAE1BtR,KAAKmO,eAAiB,SACtBnO,KAAKuR,mBAAqB,MAC1BvR,KAAKwR,gBAAkB,MACvBxR,KAAKyR,kBAAoB,MAEzBb,EAASvD,KAAKC,MAAMD,KAAKE,UAAUqD,GAAU,CAAC,IAE9C5Q,KAAK0R,YAAsC,eAAxBd,EAAOe,aACG,cAAzBf,EAAOgB,cACT,MAAMtC,EAAU,oBACZ,8CAKN,OAJYsB,EAAOgB,gBACjBhB,EAAOgB,cAAgB,WAGjBhB,EAAOiB,oBACb,IAAK,MACL,IAAK,QACH,MACF,QACEjB,EAAOiB,mBAAqB,MAIhC,OAAQjB,EAAOe,cACb,IAAK,WACL,IAAK,aACL,IAAK,aACH,MACF,QACEf,EAAOe,aAAe,WAO1B,GAHAf,EAAOkB,WA/OX,SAA0BA,EAAYhC,GACpC,IAAIiC,GAAU,EAEd,OADAD,EAAazE,KAAKC,MAAMD,KAAKE,UAAUuE,KACrBnE,QAAO,SAASqE,GAChC,GAAIA,IAAWA,EAAOC,MAAQD,EAAOE,KAAM,CACzC,IAAID,EAAOD,EAAOC,MAAQD,EAAOE,IAC7BF,EAAOE,MAAQF,EAAOC,MACxB1Q,QAAQC,KAAK,qDAEf,IAAI2Q,EAA2B,iBAATF,EAoBtB,OAnBIE,IACFF,EAAO,CAACA,IAEVA,EAAOA,EAAKtE,QAAO,SAASuE,GAM1B,OALyC,IAAzBA,EAAI1D,QAAQ,WACU,IAAlC0D,EAAI1D,QAAQ,mBACe,IAA3B0D,EAAI1D,QAAQ,WACXuD,EAM2B,IAAzBG,EAAI1D,QAAQ,UAAkBsB,GAAe,QACb,IAAnCoC,EAAI1D,QAAQ,mBAJduD,GAAU,GACH,EAIX,WAEOC,EAAOE,IACdF,EAAOC,KAAOE,EAAWF,EAAK,GAAKA,IAC1BA,EAAK3O,MAChB,CACF,GACF,CA+MwB8O,CAAiBxB,EAAOkB,YAAc,GAAIhC,GAE9D9P,KAAKqS,cAAgB,GACjBzB,EAAO0B,qBACT,IAAK,IAAIrT,EAAI2R,EAAO0B,qBAAsBrT,EAAI,EAAGA,IAC/Ce,KAAKqS,cAAcvI,KAAK,IAAIJ,EAAO6I,eAAe,CAChDT,WAAYlB,EAAOkB,WACnBU,aAAc5B,EAAOiB,2BAIzBjB,EAAO0B,qBAAuB,EAGhCtS,KAAKyS,QAAU7B,EAIf5Q,KAAK0S,aAAe,GAEpB1S,KAAK2S,cAAgBzI,EAAS0I,oBAC9B5S,KAAK6S,mBAAqB,EAE1B7S,KAAK8S,eAAYlD,EAEjB5P,KAAK+S,WAAY,CACnB,EAEA3L,OAAO4L,eAAerC,EAAkB9M,UAAW,mBAAoB,CACrEoP,cAAc,EACdC,IAAK,WACH,OAAOlT,KAAKqR,iBACd,IAEFjK,OAAO4L,eAAerC,EAAkB9M,UAAW,oBAAqB,CACtEoP,cAAc,EACdC,IAAK,WACH,OAAOlT,KAAKsR,kBACd,IAIFX,EAAkB9M,UAAUsP,eAAiB,KAC7CxC,EAAkB9M,UAAUuP,YAAc,KAC1CzC,EAAkB9M,UAAUwP,QAAU,KACtC1C,EAAkB9M,UAAUyP,eAAiB,KAC7C3C,EAAkB9M,UAAU0P,uBAAyB,KACrD5C,EAAkB9M,UAAU2P,2BAA6B,KACzD7C,EAAkB9M,UAAU4P,wBAA0B,KACtD9C,EAAkB9M,UAAU6P,0BAA4B,KACxD/C,EAAkB9M,UAAU8P,oBAAsB,KAClDhD,EAAkB9M,UAAU+P,cAAgB,KAE5CjD,EAAkB9M,UAAU6M,eAAiB,SAASzD,EAAM4G,GACtD7T,KAAK+S,YAGT/S,KAAKiQ,cAAc4D,GACc,mBAAtB7T,KAAK,KAAOiN,IACrBjN,KAAK,KAAOiN,GAAM4G,GAEtB,EAEAlD,EAAkB9M,UAAUiQ,0BAA4B,WACtD,IAAID,EAAQ,IAAIrD,MAAM,2BACtBxQ,KAAK0Q,eAAe,0BAA2BmD,EACjD,EAEAlD,EAAkB9M,UAAUkQ,iBAAmB,WAC7C,OAAO/T,KAAKyS,OACd,EAEA9B,EAAkB9M,UAAUmQ,gBAAkB,WAC5C,OAAOhU,KAAKmR,YACd,EAEAR,EAAkB9M,UAAUoQ,iBAAmB,WAC7C,OAAOjU,KAAKoR,aACd,EAIAT,EAAkB9M,UAAUqQ,mBAAqB,SAASxJ,EAAMyJ,GAC9D,IAAIC,EAAqBpU,KAAK0S,aAAapP,OAAS,EAChD8G,EAAc,CAChBiB,MAAO,KACPT,YAAa,KACb8D,aAAc,KACd3D,cAAe,KACfc,kBAAmB,KACnBC,mBAAoB,KACpBb,UAAW,KACXC,YAAa,KACbR,KAAMA,EACNM,IAAK,KACLQ,uBAAwB,KACxB6I,uBAAwB,KACxB/J,OAAQ,KACRgK,6BAA8B,GAC9BC,aAAa,GAEf,GAAIvU,KAAK0R,aAAe0C,EACtBhK,EAAYsE,aAAe1O,KAAK0S,aAAa,GAAGhE,aAChDtE,EAAYW,cAAgB/K,KAAK0S,aAAa,GAAG3H,kBAC5C,CACL,IAAIyJ,EAAaxU,KAAKyU,8BACtBrK,EAAYsE,aAAe8F,EAAW9F,aACtCtE,EAAYW,cAAgByJ,EAAWzJ,aACzC,CAIA,OAHKoJ,GACHnU,KAAK0S,aAAa5I,KAAKM,GAElBA,CACT,EAEAuG,EAAkB9M,UAAUmM,SAAW,SAAS3E,EAAOf,GACrD,GAAItK,KAAK+S,UACP,MAAMzD,EAAU,oBACZ,0DAGN,IAQIlF,EAJJ,GAJoBpK,KAAK0S,aAAa5D,MAAK,SAAS4F,GAClD,OAAOA,EAAErJ,QAAUA,CACrB,IAGE,MAAMiE,EAAU,qBAAsB,yBAIxC,IAAK,IAAIrQ,EAAI,EAAGA,EAAIe,KAAK0S,aAAapP,OAAQrE,IACvCe,KAAK0S,aAAazT,GAAGoM,OACtBrL,KAAK0S,aAAazT,GAAGyL,OAASW,EAAMX,OACtCN,EAAcpK,KAAK0S,aAAazT,IAiBpC,OAdKmL,IACHA,EAAcpK,KAAKkU,mBAAmB7I,EAAMX,OAG9C1K,KAAK2U,+BAEsC,IAAvC3U,KAAKmR,aAAa3C,QAAQlE,IAC5BtK,KAAKmR,aAAarH,KAAKQ,GAGzBF,EAAYiB,MAAQA,EACpBjB,EAAYE,OAASA,EACrBF,EAAYa,UAAY,IAAIvB,EAAOkL,aAAavJ,EAC5CjB,EAAYW,eACTX,EAAYa,SACrB,EAEA0F,EAAkB9M,UAAUgR,UAAY,SAASvK,GAC/C,IAAI8F,EAAKpQ,KACT,GAAI8P,GAAe,MACjBxF,EAAOwK,YAAY3H,SAAQ,SAAS9B,GAClC+E,EAAGJ,SAAS3E,EAAOf,EACrB,QACK,CAIL,IAAIyK,EAAezK,EAAO0K,QAC1B1K,EAAOwK,YAAY3H,SAAQ,SAAS9B,EAAO4J,GACzC,IAAIC,EAAcH,EAAaD,YAAYG,GAC3C5J,EAAMjL,iBAAiB,WAAW,SAASyT,GACzCqB,EAAYC,QAAUtB,EAAMsB,OAC9B,GACF,IACAJ,EAAaD,YAAY3H,SAAQ,SAAS9B,GACxC+E,EAAGJ,SAAS3E,EAAO0J,EACrB,GACF,CACF,EAEApE,EAAkB9M,UAAUuR,YAAc,SAASC,GACjD,GAAIrV,KAAK+S,UACP,MAAMzD,EAAU,oBACZ,6DAGN,KAAM+F,aAAkB3L,EAAOkL,cAC7B,MAAM,IAAIjF,UAAU,0FAItB,IAAIvF,EAAcpK,KAAK0S,aAAa5D,MAAK,SAASwG,GAChD,OAAOA,EAAErK,YAAcoK,CACzB,IAEA,IAAKjL,EACH,MAAMkF,EAAU,qBACZ,8CAEN,IAAIhF,EAASF,EAAYE,OAEzBF,EAAYa,UAAUsK,OACtBnL,EAAYa,UAAY,KACxBb,EAAYiB,MAAQ,KACpBjB,EAAYE,OAAS,MAMiB,IAHnBtK,KAAK0S,aAAa3M,KAAI,SAASuP,GAChD,OAAOA,EAAEhL,MACX,IACiBkE,QAAQlE,IACrBtK,KAAKmR,aAAa3C,QAAQlE,IAAW,GACvCtK,KAAKmR,aAAaqE,OAAOxV,KAAKmR,aAAa3C,QAAQlE,GAAS,GAG9DtK,KAAK2U,6BACP,EAEAhE,EAAkB9M,UAAU4R,aAAe,SAASnL,GAClD,IAAI8F,EAAKpQ,KACTsK,EAAOwK,YAAY3H,SAAQ,SAAS9B,GAClC,IAAIgK,EAASjF,EAAGsF,aAAa5G,MAAK,SAAS4F,GACzC,OAAOA,EAAErJ,QAAUA,CACrB,IACIgK,GACFjF,EAAGgF,YAAYC,EAEnB,GACF,EAEA1E,EAAkB9M,UAAU6R,WAAa,WACvC,OAAO1V,KAAK0S,aAAa/E,QAAO,SAASvD,GACvC,QAASA,EAAYa,SACvB,IACClF,KAAI,SAASqE,GACZ,OAAOA,EAAYa,SACrB,GACF,EAEA0F,EAAkB9M,UAAU8R,aAAe,WACzC,OAAO3V,KAAK0S,aAAa/E,QAAO,SAASvD,GACvC,QAASA,EAAYc,WACvB,IACCnF,KAAI,SAASqE,GACZ,OAAOA,EAAYc,WACrB,GACF,EAGAyF,EAAkB9M,UAAU+R,mBAAqB,SAASC,EACtDnE,GACF,IAAItB,EAAKpQ,KACT,GAAI0R,GAAemE,EAAgB,EACjC,OAAO7V,KAAK0S,aAAa,GAAG9H,YACvB,GAAI5K,KAAKqS,cAAc/O,OAC5B,OAAOtD,KAAKqS,cAAcyD,QAE5B,IAAIlL,EAAc,IAAIlB,EAAO6I,eAAe,CAC1CT,WAAY9R,KAAKyS,QAAQX,WACzBU,aAAcxS,KAAKyS,QAAQZ,qBAkB7B,OAhBAzK,OAAO4L,eAAepI,EAAa,QAC/B,CAAC3E,MAAO,MAAO8P,UAAU,IAG7B/V,KAAK0S,aAAamD,GAAeG,wBAA0B,GAC3DhW,KAAK0S,aAAamD,GAAeI,iBAAmB,SAASpC,GAC3D,IAAIqC,GAAOrC,EAAMlF,WAAqD,IAAxCvH,OAAO2B,KAAK8K,EAAMlF,WAAWrL,OAG3DsH,EAAYuL,MAAQD,EAAM,YAAc,YACuB,OAA3D9F,EAAGsC,aAAamD,GAAeG,yBACjC5F,EAAGsC,aAAamD,GAAeG,wBAAwBlM,KAAK+J,EAEhE,EACAjJ,EAAYxK,iBAAiB,iBAC3BJ,KAAK0S,aAAamD,GAAeI,kBAC5BrL,CACT,EAGA+F,EAAkB9M,UAAUuS,QAAU,SAASpL,EAAK6K,GAClD,IAAIzF,EAAKpQ,KACL4K,EAAc5K,KAAK0S,aAAamD,GAAejL,YACnD,IAAIA,EAAYyL,iBAAhB,CAGA,IAAIL,EACFhW,KAAK0S,aAAamD,GAAeG,wBACnChW,KAAK0S,aAAamD,GAAeG,wBAA0B,KAC3DpL,EAAYpI,oBAAoB,iBAC9BxC,KAAK0S,aAAamD,GAAeI,kBACnCrL,EAAYyL,iBAAmB,SAASC,GACtC,KAAIlG,EAAGsB,aAAemE,EAAgB,GAAtC,CAMA,IAAIhC,EAAQ,IAAIrD,MAAM,gBACtBqD,EAAMlF,UAAY,CAAC4H,OAAQvL,EAAK6K,cAAeA,GAE/C,IAAIW,EAAOF,EAAI3H,UAEXuH,GAAOM,GAAqC,IAA7BpP,OAAO2B,KAAKyN,GAAMlT,OACrC,GAAI4S,EAGwB,QAAtBtL,EAAYuL,OAAyC,cAAtBvL,EAAYuL,QAC7CvL,EAAYuL,MAAQ,iBAEjB,CACqB,QAAtBvL,EAAYuL,QACdvL,EAAYuL,MAAQ,aAGtBK,EAAKC,UAAY,EAEjBD,EAAKE,MAAQ9L,EAAYC,qBAAqB8L,iBAE9C,IAAIC,EAAsB1M,EAAS2M,eAAeL,GAClD3C,EAAMlF,UAAYvH,OAAO0P,OAAOjD,EAAMlF,UAClCzE,EAAS6M,eAAeH,IAE5B/C,EAAMlF,UAAUA,UAAYiI,EAC5B/C,EAAMlF,UAAUqI,OAAS,WACvB,MAAO,CACLrI,UAAWkF,EAAMlF,UAAUA,UAC3B4H,OAAQ1C,EAAMlF,UAAU4H,OACxBV,cAAehC,EAAMlF,UAAUkH,cAC/Bc,iBAAkB9C,EAAMlF,UAAUgI,iBAEtC,CACF,CAGA,IAAIM,EAAW/M,EAASgN,iBAAiB9G,EAAGiB,kBAAkB7G,KAK5DyM,EAASpD,EAAMlF,UAAUkH,gBAJtBK,EAKC,0BAHA,KAAOrC,EAAMlF,UAAUA,UAAY,OAKzCyB,EAAGiB,kBAAkB7G,IACjBN,EAASiN,eAAe/G,EAAGiB,kBAAkB7G,KAC7CyM,EAASG,KAAK,IAClB,IAAIC,EAAWjH,EAAGsC,aAAa4E,OAAM,SAASlN,GAC5C,OAAOA,EAAYQ,aACmB,cAAlCR,EAAYQ,YAAYuL,KAC9B,IAE6B,cAAzB/F,EAAGqB,oBACLrB,EAAGqB,kBAAoB,YACvBrB,EAAG0D,6BAKAoC,GACH9F,EAAGM,eAAe,eAAgBmD,GAEhCwD,IACFjH,EAAGM,eAAe,eAAgB,IAAIF,MAAM,iBAC5CJ,EAAGqB,kBAAoB,WACvBrB,EAAG0D,4BAnEL,CAqEF,EAGApK,EAAO+G,YAAW,WAChBuF,EAAwB7I,SAAQ,SAAS7D,GACvCsB,EAAYyL,iBAAiB/M,EAC/B,GACF,GAAG,EAxFH,CAyFF,EAGAqH,EAAkB9M,UAAU4Q,4BAA8B,WACxD,IAAIrE,EAAKpQ,KACL0O,EAAe,IAAIhF,EAAO6N,gBAAgB,MAC9C7I,EAAa8I,iBAAmB,WAC9BpH,EAAGqH,4BACHrH,EAAGsH,wBACL,EAEA,IAAI3M,EAAgB,IAAIrB,EAAOiO,iBAAiBjJ,GAWhD,OAVA3D,EAAc6M,kBAAoB,WAChCxH,EAAGsH,wBACL,EACA3M,EAAc8M,QAAU,WAEtBzQ,OAAO4L,eAAejI,EAAe,QACjC,CAAC9E,MAAO,SAAU8P,UAAU,IAChC3F,EAAGsH,wBACL,EAEO,CACLhJ,aAAcA,EACd3D,cAAeA,EAEnB,EAIA4F,EAAkB9M,UAAUiU,6BAA+B,SACvDjC,GACF,IAAIjL,EAAc5K,KAAK0S,aAAamD,GAAejL,YAC/CA,WACKA,EAAYyL,wBACZrW,KAAK0S,aAAamD,GAAejL,aAE1C,IAAI8D,EAAe1O,KAAK0S,aAAamD,GAAenH,aAChDA,WACKA,EAAa8I,wBACbxX,KAAK0S,aAAamD,GAAenH,cAE1C,IAAI3D,EAAgB/K,KAAK0S,aAAamD,GAAe9K,cACjDA,WACKA,EAAc6M,yBACd7M,EAAc8M,eACd7X,KAAK0S,aAAamD,GAAe9K,cAE5C,EAGA4F,EAAkB9M,UAAUkU,YAAc,SAAS3N,EAC/C4N,EAAMC,GACR,IAAIC,EAAStM,EAAsBxB,EAAYyB,kBAC3CzB,EAAY0B,oBACZkM,GAAQ5N,EAAYa,YACtBiN,EAAOC,UAAY/N,EAAYoB,uBAC/B0M,EAAOE,KAAO,CACZC,MAAOnO,EAASyB,WAChB2M,SAAUlO,EAAYmO,eAAeD,UAEnClO,EAAYiK,uBAAuB/Q,SACrC4U,EAAOE,KAAK3M,KAAOrB,EAAYiK,uBAAuB,GAAG5I,MAE3DrB,EAAYa,UAAU+M,KAAKE,IAEzBD,GAAQ7N,EAAYc,aAAegN,EAAOlM,OAAO1I,OAAS,IAEnC,UAArB8G,EAAYM,MACTN,EAAYiK,wBACZvE,EAAc,OACnB1F,EAAYiK,uBAAuBlH,SAAQ,SAASqL,UAC3CA,EAAE9M,GACX,IAEEtB,EAAYiK,uBAAuB/Q,OACrC4U,EAAOC,UAAY/N,EAAYiK,uBAE/B6D,EAAOC,UAAY,CAAC,CAAC,GAEvBD,EAAOE,KAAO,CACZE,SAAUlO,EAAYmO,eAAeD,UAEnClO,EAAYmO,eAAeF,QAC7BH,EAAOE,KAAKC,MAAQjO,EAAYmO,eAAeF,OAE7CjO,EAAYoB,uBAAuBlI,SACrC4U,EAAOE,KAAK3M,KAAOrB,EAAYoB,uBAAuB,GAAGC,MAE3DrB,EAAYc,YAAYuN,QAAQP,GAEpC,EAEAvH,EAAkB9M,UAAUwK,oBAAsB,SAASkB,GACzD,IAeI0H,EACAyB,EAhBAtI,EAAKpQ,KAGT,IAAuD,IAAnD,CAAC,QAAS,UAAUwO,QAAQe,EAAYhQ,MAC1C,OAAOoZ,QAAQC,OAAOtJ,EAAU,YAC5B,qBAAuBC,EAAYhQ,KAAO,MAGhD,IAAK0O,EAAgC,sBACjCsB,EAAYhQ,KAAM6Q,EAAGjC,iBAAmBiC,EAAG2C,UAC7C,OAAO4F,QAAQC,OAAOtJ,EAAU,oBAC5B,qBAAuBC,EAAYhQ,KACnC,aAAe6Q,EAAGjC,iBAKxB,GAAyB,UAArBoB,EAAYhQ,KAGd0X,EAAW/M,EAAS2O,cAActJ,EAAY/E,KAC9CkO,EAAczB,EAASnB,QACvBmB,EAAS9J,SAAQ,SAAS2L,EAAcjD,GACtC,IAAIxL,EAAOH,EAAS6O,mBAAmBD,GACvC1I,EAAGsC,aAAamD,GAAehK,kBAAoBxB,CACrD,IAEA+F,EAAGsC,aAAavF,SAAQ,SAAS/C,EAAayL,GAC5CzF,EAAGgG,QAAQhM,EAAYY,IAAK6K,EAC9B,SACK,GAAyB,WAArBtG,EAAYhQ,KAAmB,CACxC0X,EAAW/M,EAAS2O,cAAczI,EAAGkB,mBAAmB9G,KACxDkO,EAAczB,EAASnB,QACvB,IAAIkD,EAAY9O,EAAS+O,YAAYP,EACjC,cAAcpV,OAAS,EAC3B2T,EAAS9J,SAAQ,SAAS2L,EAAcjD,GACtC,IAAIzL,EAAcgG,EAAGsC,aAAamD,GAC9BjL,EAAcR,EAAYQ,YAC1B8D,EAAetE,EAAYsE,aAC3B3D,EAAgBX,EAAYW,cAC5Bc,EAAoBzB,EAAYyB,kBAChCC,EAAqB1B,EAAY0B,mBAMrC,KAHe5B,EAASgP,WAAWJ,IACgC,IAA/D5O,EAAS+O,YAAYH,EAAc,iBAAiBxV,QAEtC8G,EAAY+O,UAAU,CACtC,IAAIC,EAAsBlP,EAASmP,iBAC/BP,EAAcJ,GACdY,EAAuBpP,EAASqP,kBAChCT,EAAcJ,GACdM,IACFM,EAAqBE,KAAO,UAGzBpJ,EAAGsB,aAAiC,IAAlBmE,IACrBzF,EAAGgG,QAAQhM,EAAYY,IAAK6K,GACD,QAAvBnH,EAAayH,OACfzH,EAAa+K,MAAM7O,EAAawO,EAC5BJ,EAAY,cAAgB,cAEN,QAAxBjO,EAAcoL,OAChBpL,EAAc0O,MAAMH,IAKxB,IAAIpB,EAAStM,EAAsBC,EAC/BC,GAIJsE,EAAG2H,YAAY3N,EACX8N,EAAOlM,OAAO1I,OAAS,GACvB,EACN,CACF,GACF,CAYA,OAVA8M,EAAGiB,kBAAoB,CACrB9R,KAAMgQ,EAAYhQ,KAClBiL,IAAK+E,EAAY/E,KAEM,UAArB+E,EAAYhQ,KACd6Q,EAAGsJ,sBAAsB,oBAEzBtJ,EAAGsJ,sBAAsB,UAGpBf,QAAQgB,SACjB,EAEAhJ,EAAkB9M,UAAUyK,qBAAuB,SAASiB,GAC1D,IAAIa,EAAKpQ,KAGT,IAAuD,IAAnD,CAAC,QAAS,UAAUwO,QAAQe,EAAYhQ,MAC1C,OAAOoZ,QAAQC,OAAOtJ,EAAU,YAC5B,qBAAuBC,EAAYhQ,KAAO,MAGhD,IAAK0O,EAAgC,uBACjCsB,EAAYhQ,KAAM6Q,EAAGjC,iBAAmBiC,EAAG2C,UAC7C,OAAO4F,QAAQC,OAAOtJ,EAAU,oBAC5B,sBAAwBC,EAAYhQ,KACpC,aAAe6Q,EAAGjC,iBAGxB,IAAImC,EAAU,CAAC,EACfF,EAAGgB,cAAcjE,SAAQ,SAAS7C,GAChCgG,EAAQhG,EAAOgB,IAAMhB,CACvB,IACA,IAAIsP,EAAe,GACf3C,EAAW/M,EAAS2O,cAActJ,EAAY/E,KAC9CkO,EAAczB,EAASnB,QACvBkD,EAAY9O,EAAS+O,YAAYP,EACjC,cAAcpV,OAAS,EACvBoO,EAAcxH,EAAS+O,YAAYP,EACnC,mBAAmBpV,OAAS,EAChC8M,EAAGsB,YAAcA,EACjB,IAAImI,EAAa3P,EAAS+O,YAAYP,EAClC,kBAAkB,GA4UtB,OA1UEtI,EAAGa,0BADD4I,GAC2BA,EAAWC,OAAO,IAAIC,MAAM,KACpDvL,QAAQ,YAAc,EAK7ByI,EAAS9J,SAAQ,SAAS2L,EAAcjD,GACtC,IAAImE,EAAQ9P,EAAS+P,WAAWnB,GAC5BpO,EAAOR,EAASgQ,QAAQpB,GAExBK,EAAWjP,EAASgP,WAAWJ,IACgC,IAA/D5O,EAAS+O,YAAYH,EAAc,iBAAiBxV,OACpD8L,EAAW4K,EAAM,GAAGF,OAAO,GAAGC,MAAM,KAAK,GAEzCI,EAAYjQ,EAASkQ,aAAatB,EAAcJ,GAChD2B,EAAanQ,EAASoQ,UAAUxB,GAEhC9N,EAAMd,EAASqQ,OAAOzB,IAAiB5O,EAASsQ,qBAGpD,GAAIrB,GAAsB,gBAATzO,IAAwC,cAAb0E,GAC3B,kBAAbA,GAGFgB,EAAGsC,aAAamD,GAAiB,CAC/B7K,IAAKA,EACLN,KAAMA,EACN0E,SAAUA,EACV+J,UAAU,OARd,CAmBA,IAAI/O,EACAQ,EACA8D,EACA3D,EACAG,EACAM,EACA6I,EACAxI,EAEAR,GAfC8N,GAAY/I,EAAGsC,aAAamD,IAC7BzF,EAAGsC,aAAamD,GAAesD,WAEjC/I,EAAGsC,aAAamD,GAAiBzF,EAAG8D,mBAAmBxJ,GAAM,IAc/D,IACI0O,EACAE,EAFAxN,EAAqB5B,EAAS6O,mBAAmBD,GAGhDK,IACHC,EAAsBlP,EAASmP,iBAAiBP,EAC5CJ,IACJY,EAAuBpP,EAASqP,kBAAkBT,EAC9CJ,IACiBc,KAAO,UAE9BnF,EACInK,EAASuQ,2BAA2B3B,GAExC,IAAIP,EAAiBrO,EAASwQ,oBAAoB5B,GAE9C6B,EAAazQ,EAAS+O,YAAYH,EAClC,sBAAuBJ,GAAapV,OAAS,EAC7CsX,EAAQ1Q,EAAS+O,YAAYH,EAAc,gBAC1C/S,KAAI,SAASyQ,GACZ,OAAOtM,EAAS6M,eAAeP,EACjC,IACC7I,QAAO,SAAS6I,GACf,OAA0B,IAAnBA,EAAKC,SACd,IAsBJ,IAnB0B,UAArBlH,EAAYhQ,MAAyC,WAArBgQ,EAAYhQ,QAC5C4Z,GAAYzH,GAAemE,EAAgB,GAC5CzF,EAAGsC,aAAamD,KAClBzF,EAAG0H,6BAA6BjC,GAChCzF,EAAGsC,aAAamD,GAAejL,YAC3BwF,EAAGsC,aAAa,GAAG9H,YACvBwF,EAAGsC,aAAamD,GAAenH,aAC3B0B,EAAGsC,aAAa,GAAGhE,aACvB0B,EAAGsC,aAAamD,GAAe9K,cAC3BqF,EAAGsC,aAAa,GAAG3H,cACnBqF,EAAGsC,aAAamD,GAAe5K,WACjCmF,EAAGsC,aAAamD,GAAe5K,UAAU4P,aACrCzK,EAAGsC,aAAa,GAAG3H,eAErBqF,EAAGsC,aAAamD,GAAe3K,aACjCkF,EAAGsC,aAAamD,GAAe3K,YAAY2P,aACvCzK,EAAGsC,aAAa,GAAG3H,gBAGF,UAArBwE,EAAYhQ,MAAqB4Z,EAmGL,WAArB5J,EAAYhQ,MAAsB4Z,IAE3CvO,GADAR,EAAcgG,EAAGsC,aAAamD,IACJjL,YAC1B8D,EAAetE,EAAYsE,aAC3B3D,EAAgBX,EAAYW,cAC5BG,EAAcd,EAAYc,YAC1BM,EAAyBpB,EAAYoB,uBACrCK,EAAoBzB,EAAYyB,kBAEhCuE,EAAGsC,aAAamD,GAAexB,uBAC3BA,EACJjE,EAAGsC,aAAamD,GAAe/J,mBAC3BA,EACJsE,EAAGsC,aAAamD,GAAe0C,eAAiBA,EAE5CqC,EAAMtX,QAAiC,QAAvBoL,EAAayH,SAC1B6C,IAAa2B,GACZjJ,GAAiC,IAAlBmE,EAGnB+E,EAAMzN,SAAQ,SAASwB,GACrBF,EAAkBrE,EAAYsE,aAAcC,EAC9C,IAJAD,EAAaoM,oBAAoBF,IAQhClJ,GAAiC,IAAlBmE,IACS,QAAvBnH,EAAayH,OACfzH,EAAa+K,MAAM7O,EAAawO,EAC5B,eAEsB,QAAxBrO,EAAcoL,OAChBpL,EAAc0O,MAAMH,KAMC1N,EACvBxB,EAAYyB,kBACZzB,EAAY0B,oBAEkBE,OAAO2B,QAAO,SAASlI,GACrD,MAAgC,QAAzBA,EAAEwH,KAAKC,aAChB,IAAG5J,QACY8G,EAAYoB,uBAAuB,GAAGE,YAC5CtB,EAAYoB,uBAAuB,GAAGE,IAG/C0E,EAAG2H,YAAY3N,EACG,aAAd+P,GAA0C,aAAdA,EACd,aAAdA,GAA0C,aAAdA,IAG5BjP,GACe,aAAdiP,GAA0C,aAAdA,SAiBxB/P,EAAYc,aAhBnBG,EAAQH,EAAYG,MAChBgP,GACG/J,EAAQ+J,EAAW/P,UACtBgG,EAAQ+J,EAAW/P,QAAU,IAAIZ,EAAOqR,aAE1ChL,EAA6B1E,EAAOiF,EAAQ+J,EAAW/P,SACvDsP,EAAa9P,KAAK,CAACuB,EAAOH,EAAaoF,EAAQ+J,EAAW/P,YAErDgG,EAAQ9Q,UACX8Q,EAAQ9Q,QAAU,IAAIkK,EAAOqR,aAE/BhL,EAA6B1E,EAAOiF,EAAQ9Q,SAC5Coa,EAAa9P,KAAK,CAACuB,EAAOH,EAAaoF,EAAQ9Q,iBAvKN,EAC7C4K,EAAcgG,EAAGsC,aAAamD,IAC1BzF,EAAG8D,mBAAmBxJ,IACdM,IAAMA,EAEbZ,EAAYQ,cACfR,EAAYQ,YAAcwF,EAAGwF,mBAAmBC,EAC5CnE,IAGFkJ,EAAMtX,QAA6C,QAAnC8G,EAAYsE,aAAayH,SACvCwE,GAAgBjJ,GAAiC,IAAlBmE,EAGjC+E,EAAMzN,SAAQ,SAASwB,GACrBF,EAAkBrE,EAAYsE,aAAcC,EAC9C,IAJAvE,EAAYsE,aAAaoM,oBAAoBF,IAQjD/O,EAAoBnC,EAAOsR,eAAeC,gBAAgBvQ,GAItDoF,EAAc,QAChBjE,EAAkBG,OAASH,EAAkBG,OAAO2B,QAChD,SAASuN,GACP,MAAsB,QAAfA,EAAMjO,IACf,KAGNzB,EAAyBpB,EAAYoB,wBAA0B,CAAC,CAC9DC,KAAgC,MAAzB,EAAIoK,EAAgB,KAI7B,IAOQvL,EAPJ6Q,GAAa,EACC,aAAdhB,GAA0C,aAAdA,GAC9BgB,GAAc/Q,EAAYc,YAC1BA,EAAcd,EAAYc,aACtB,IAAIxB,EAAOsR,eAAe5Q,EAAYW,cAAeL,GAErDyQ,IAEF9P,EAAQH,EAAYG,MAEhBgP,GAAoC,MAAtBA,EAAW/P,SAElB+P,GACJ/J,EAAQ+J,EAAW/P,UACtBgG,EAAQ+J,EAAW/P,QAAU,IAAIZ,EAAOqR,YACxC3T,OAAO4L,eAAe1C,EAAQ+J,EAAW/P,QAAS,KAAM,CACtD4I,IAAK,WACH,OAAOmH,EAAW/P,MACpB,KAGJlD,OAAO4L,eAAe3H,EAAO,KAAM,CACjC6H,IAAK,WACH,OAAOmH,EAAWhP,KACpB,IAEFf,EAASgG,EAAQ+J,EAAW/P,UAEvBgG,EAAQ9Q,UACX8Q,EAAQ9Q,QAAU,IAAIkK,EAAOqR,aAE/BzQ,EAASgG,EAAQ9Q,UAEf8K,IACFyF,EAA6B1E,EAAOf,GACpCF,EAAYkK,6BAA6BxK,KAAKQ,IAEhDsP,EAAa9P,KAAK,CAACuB,EAAOH,EAAaZ,MAEhCF,EAAYc,aAAed,EAAYc,YAAYG,QAC5DjB,EAAYkK,6BAA6BnH,SAAQ,SAASuH,GACxD,IAAI0G,EAAc1G,EAAEI,YAAYhG,MAAK,SAASwG,GAC5C,OAAOA,EAAEhK,KAAOlB,EAAYc,YAAYG,MAAMC,EAChD,IACI8P,GAl0Bd,SAA2C/P,EAAOf,GAChDA,EAAO8K,YAAY/J,GACnBf,EAAO2F,cAAc,IAAIvG,EAAOwG,sBAAsB,cAClD,CAAC7E,MAAOA,IACd,CA+zBYgQ,CAAkCD,EAAa1G,EAEnD,IACAtK,EAAYkK,6BAA+B,IAG7ClK,EAAYyB,kBAAoBA,EAChCzB,EAAY0B,mBAAqBA,EACjC1B,EAAYc,YAAcA,EAC1Bd,EAAYmO,eAAiBA,EAC7BnO,EAAYoB,uBAAyBA,EACrCpB,EAAYiK,uBAAyBA,EAIrCjE,EAAG2H,YAAY3H,EAAGsC,aAAamD,IAC3B,EACAsF,EACN,CAnKA,CA8OF,SAEqBvL,IAAjBQ,EAAG0C,YACL1C,EAAG0C,UAAiC,UAArBvD,EAAYhQ,KAAmB,SAAW,WAG3D6Q,EAAGkB,mBAAqB,CACtB/R,KAAMgQ,EAAYhQ,KAClBiL,IAAK+E,EAAY/E,KAEM,UAArB+E,EAAYhQ,KACd6Q,EAAGsJ,sBAAsB,qBAEzBtJ,EAAGsJ,sBAAsB,UAE3BtS,OAAO2B,KAAKuH,GAASnD,SAAQ,SAASmO,GACpC,IAAIhR,EAASgG,EAAQgL,GACrB,GAAIhR,EAAOwK,YAAYxR,OAAQ,CAC7B,IAA0C,IAAtC8M,EAAGgB,cAAc5C,QAAQlE,GAAgB,CAC3C8F,EAAGgB,cAActH,KAAKQ,GACtB,IAAIuJ,EAAQ,IAAIrD,MAAM,aACtBqD,EAAMvJ,OAASA,EACfZ,EAAO+G,YAAW,WAChBL,EAAGM,eAAe,YAAamD,EACjC,GACF,CAEA+F,EAAazM,SAAQ,SAASoO,GAC5B,IAAIlQ,EAAQkQ,EAAK,GACblL,EAAWkL,EAAK,GAChBjR,EAAOgB,KAAOiQ,EAAK,GAAGjQ,IAG1B6E,EAAaC,EAAI/E,EAAOgF,EAAU,CAAC/F,GACrC,GACF,CACF,IACAsP,EAAazM,SAAQ,SAASoO,GACxBA,EAAK,IAGTpL,EAAaC,EAAImL,EAAK,GAAIA,EAAK,GAAI,GACrC,IAIA7R,EAAO+G,YAAW,WACVL,GAAMA,EAAGsC,cAGftC,EAAGsC,aAAavF,SAAQ,SAAS/C,GAC3BA,EAAYsE,cACuB,QAAnCtE,EAAYsE,aAAayH,OACzB/L,EAAYsE,aAAaG,sBAAsBvL,OAAS,IAC1D/B,QAAQC,KAAK,sFAEb4I,EAAYsE,aAAaW,mBAAmB,CAAC,GAEjD,GACF,GAAG,KAEIsJ,QAAQgB,SACjB,EAEAhJ,EAAkB9M,UAAU2X,MAAQ,WAClCxb,KAAK0S,aAAavF,SAAQ,SAAS/C,GAM7BA,EAAYsE,cACdtE,EAAYsE,aAAa6G,OAEvBnL,EAAYW,eACdX,EAAYW,cAAcwK,OAExBnL,EAAYa,WACdb,EAAYa,UAAUsK,OAEpBnL,EAAYc,aACdd,EAAYc,YAAYqK,MAE5B,IAEAvV,KAAK+S,WAAY,EACjB/S,KAAK0Z,sBAAsB,SAC7B,EAGA/I,EAAkB9M,UAAU6V,sBAAwB,SAAS+B,GAC3Dzb,KAAKmO,eAAiBsN,EACtB,IAAI5H,EAAQ,IAAIrD,MAAM,wBACtBxQ,KAAK0Q,eAAe,uBAAwBmD,EAC9C,EAGAlD,EAAkB9M,UAAU8Q,4BAA8B,WACxD,IAAIvE,EAAKpQ,KACmB,WAAxBA,KAAKmO,iBAAwD,IAAzBnO,KAAKkR,kBAG7ClR,KAAKkR,iBAAkB,EACvBxH,EAAO+G,YAAW,WAChB,GAAIL,EAAGc,gBAAiB,CACtBd,EAAGc,iBAAkB,EACrB,IAAI2C,EAAQ,IAAIrD,MAAM,qBACtBJ,EAAGM,eAAe,oBAAqBmD,EACzC,CACF,GAAG,GACL,EAGAlD,EAAkB9M,UAAU4T,0BAA4B,WACtD,IAAIgE,EACAC,EAAS,CACX,IAAO,EACPC,OAAQ,EACRC,SAAU,EACVC,UAAW,EACXC,UAAW,EACXC,aAAc,EACdC,OAAQ,GAuBV,GArBAhc,KAAK0S,aAAavF,SAAQ,SAAS/C,GAC7BA,EAAYsE,eAAiBtE,EAAY+O,UAC3CuC,EAAOtR,EAAYsE,aAAayH,QAEpC,IAEAsF,EAAW,MACPC,EAAOM,OAAS,EAClBP,EAAW,SACFC,EAAOE,SAAW,EAC3BH,EAAW,WACFC,EAAOK,aAAe,EAC/BN,EAAW,eACFC,EAAOO,IAAM,EACtBR,EAAW,MACFC,EAAOG,UAAY,EAC5BJ,EAAW,YACFC,EAAOI,UAAY,IAC5BL,EAAW,aAGTA,IAAazb,KAAKuR,mBAAoB,CACxCvR,KAAKuR,mBAAqBkK,EAC1B,IAAI5H,EAAQ,IAAIrD,MAAM,4BACtBxQ,KAAK0Q,eAAe,2BAA4BmD,EAClD,CACF,EAGAlD,EAAkB9M,UAAU6T,uBAAyB,WACnD,IAAI+D,EACAC,EAAS,CACX,IAAO,EACPC,OAAQ,EACRO,WAAY,EACZL,UAAW,EACXC,UAAW,EACXC,aAAc,EACdC,OAAQ,GAyBV,GAvBAhc,KAAK0S,aAAavF,SAAQ,SAAS/C,GAC7BA,EAAYsE,cAAgBtE,EAAYW,gBACvCX,EAAY+O,WACfuC,EAAOtR,EAAYsE,aAAayH,SAChCuF,EAAOtR,EAAYW,cAAcoL,SAErC,IAEAuF,EAAOG,WAAaH,EAAOI,UAE3BL,EAAW,MACPC,EAAOM,OAAS,EAClBP,EAAW,SACFC,EAAOQ,WAAa,EAC7BT,EAAW,aACFC,EAAOK,aAAe,EAC/BN,EAAW,eACFC,EAAOO,IAAM,EACtBR,EAAW,MACFC,EAAOG,UAAY,IAC5BJ,EAAW,aAGTA,IAAazb,KAAKwR,gBAAiB,CACrCxR,KAAKwR,gBAAkBiK,EACvB,IAAI5H,EAAQ,IAAIrD,MAAM,yBACtBxQ,KAAK0Q,eAAe,wBAAyBmD,EAC/C,CACF,EAEAlD,EAAkB9M,UAAUsY,YAAc,WACxC,IAAI/L,EAAKpQ,KAET,GAAIoQ,EAAG2C,UACL,OAAO4F,QAAQC,OAAOtJ,EAAU,oBAC5B,yCAGN,IAAI8M,EAAiBhM,EAAGsC,aAAa/E,QAAO,SAAS2H,GACnD,MAAkB,UAAXA,EAAE5K,IACX,IAAGpH,OACC+Y,EAAiBjM,EAAGsC,aAAa/E,QAAO,SAAS2H,GACnD,MAAkB,UAAXA,EAAE5K,IACX,IAAGpH,OAGCgZ,EAAeC,UAAU,GAC7B,GAAID,EAAc,CAEhB,GAAIA,EAAaE,WAAaF,EAAaG,SACzC,MAAM,IAAI9M,UACN,6DAEmCC,IAArC0M,EAAaI,sBAEbN,GADuC,IAArCE,EAAaI,oBACE,GAC6B,IAArCJ,EAAaI,oBACL,EAEAJ,EAAaI,0BAGO9M,IAArC0M,EAAaK,sBAEbN,GADuC,IAArCC,EAAaK,oBACE,GAC6B,IAArCL,EAAaK,oBACL,EAEAL,EAAaK,oBAGpC,CAiBA,IAfAvM,EAAGsC,aAAavF,SAAQ,SAAS/C,GACN,UAArBA,EAAYM,OACd0R,EACqB,IACnBhS,EAAYmK,aAAc,GAEE,UAArBnK,EAAYM,QACrB2R,EACqB,IACnBjS,EAAYmK,aAAc,EAGhC,IAGO6H,EAAiB,GAAKC,EAAiB,GACxCD,EAAiB,IACnBhM,EAAG8D,mBAAmB,SACtBkI,KAEEC,EAAiB,IACnBjM,EAAG8D,mBAAmB,SACtBmI,KAIJ,IAAI7R,EAAMN,EAAS0S,wBAAwBxM,EAAGuC,cAC1CvC,EAAGyC,sBACPzC,EAAGsC,aAAavF,SAAQ,SAAS/C,EAAayL,GAG5C,IAAIxK,EAAQjB,EAAYiB,MACpBX,EAAON,EAAYM,KACnBM,EAAMZ,EAAYY,KAAOd,EAASsQ,qBACtCpQ,EAAYY,IAAMA,EAEbZ,EAAYQ,cACfR,EAAYQ,YAAcwF,EAAGwF,mBAAmBC,EAC5CzF,EAAGsB,cAGT,IAAI7F,EAAoBnC,EAAOkL,aAAaqG,gBAAgBvQ,GAGxDoF,EAAc,QAChBjE,EAAkBG,OAASH,EAAkBG,OAAO2B,QAChD,SAASuN,GACP,MAAsB,QAAfA,EAAMjO,IACf,KAENpB,EAAkBG,OAAOmB,SAAQ,SAAS+N,GAGrB,SAAfA,EAAMjO,WAC0C2C,IAAhDsL,EAAMpO,WAAW,6BACnBoO,EAAMpO,WAAW,2BAA6B,KAK5C1C,EAAY0B,oBACZ1B,EAAY0B,mBAAmBE,QACjC5B,EAAY0B,mBAAmBE,OAAOmB,SAAQ,SAAS0P,GACjD3B,EAAMjO,KAAKC,gBAAkB2P,EAAY5P,KAAKC,eAC9CgO,EAAM9N,YAAcyP,EAAYzP,YAClC8N,EAAM3O,qBAAuBsQ,EAAYvQ,YAE7C,GAEJ,IACAT,EAAkBI,iBAAiBkB,SAAQ,SAAS2P,IAC3B1S,EAAY0B,oBAC/B1B,EAAY0B,mBAAmBG,kBAAoB,IACtCkB,SAAQ,SAAS4P,GAC5BD,EAAO9O,MAAQ+O,EAAQ/O,MACzB8O,EAAOxR,GAAKyR,EAAQzR,GAExB,GACF,IAGA,IAAIE,EAAyBpB,EAAYoB,wBAA0B,CAAC,CAClEC,KAAgC,MAAzB,EAAIoK,EAAgB,KAEzBxK,GAEEyE,GAAe,OAAkB,UAATpF,IACvBc,EAAuB,GAAGE,MAC7BF,EAAuB,GAAGE,IAAM,CAC9BD,KAAMD,EAAuB,GAAGC,KAAO,IAKzCrB,EAAYmK,cACdnK,EAAYc,YAAc,IAAIxB,EAAOsR,eACjC5Q,EAAYW,cAAeL,IAGjCN,EAAYyB,kBAAoBA,EAChCzB,EAAYoB,uBAAyBA,CACvC,IAGgC,eAA5B4E,EAAGqC,QAAQd,eACbnH,GAAO,kBAAoB4F,EAAGsC,aAAa3M,KAAI,SAASuP,GACtD,OAAOA,EAAEtK,GACX,IAAGoM,KAAK,KAAO,QAEjB5M,GAAO,4BAEP4F,EAAGsC,aAAavF,SAAQ,SAAS/C,EAAayL,GAC5CrL,GAAOL,EAAkBC,EAAaA,EAAYyB,kBAC9C,QAASzB,EAAYE,OAAQ8F,EAAG0C,WACpCtI,GAAO,oBAEHJ,EAAYQ,aAAwC,QAAzBwF,EAAGqB,mBACX,IAAlBoE,GAAwBzF,EAAGsB,cAC9BtH,EAAYQ,YAAYoS,qBAAqB7P,SAAQ,SAASqJ,GAC5DA,EAAKC,UAAY,EACjBjM,GAAO,KAAON,EAAS2M,eAAeL,GAAQ,MAChD,IAEsC,cAAlCpM,EAAYQ,YAAYuL,QAC1B3L,GAAO,2BAGb,IAEA,IAAIyS,EAAO,IAAIvT,EAAOwT,sBAAsB,CAC1C3d,KAAM,QACNiL,IAAKA,IAEP,OAAOmO,QAAQgB,QAAQsD,EACzB,EAEAtM,EAAkB9M,UAAUsZ,aAAe,WACzC,IAAI/M,EAAKpQ,KAET,GAAIoQ,EAAG2C,UACL,OAAO4F,QAAQC,OAAOtJ,EAAU,oBAC5B,0CAGN,GAA4B,sBAAtBc,EAAGjC,gBACiB,wBAAtBiC,EAAGjC,eACL,OAAOwK,QAAQC,OAAOtJ,EAAU,oBAC5B,+CAAiDc,EAAGjC,iBAG1D,IAAI3D,EAAMN,EAAS0S,wBAAwBxM,EAAGuC,cAC1CvC,EAAGyC,sBACHzC,EAAGsB,cACLlH,GAAO,kBAAoB4F,EAAGsC,aAAa3M,KAAI,SAASuP,GACtD,OAAOA,EAAEtK,GACX,IAAGoM,KAAK,KAAO,QAEjB5M,GAAO,4BAEP,IAAI4S,EAAuBlT,EAASgN,iBAChC9G,EAAGkB,mBAAmB9G,KAAKlH,OAC/B8M,EAAGsC,aAAavF,SAAQ,SAAS/C,EAAayL,GAC5C,KAAIA,EAAgB,EAAIuH,GAAxB,CAGA,GAAIhT,EAAY+O,SAkBd,MAjByB,gBAArB/O,EAAYM,KACe,cAAzBN,EAAYgF,SACd5E,GAAO,qCAEPA,GAAO,mBAAqBJ,EAAYgF,SACpC,0BAEwB,UAArBhF,EAAYM,KACrBF,GAAO,4DAEuB,UAArBJ,EAAYM,OACrBF,GAAO,sEAGTA,GAAO,2CAEQJ,EAAYY,IAAM,QAMjC,IAAIqS,EADFjT,EAAYE,SAEW,UAArBF,EAAYM,KACd2S,EAAajT,EAAYE,OAAOgT,iBAAiB,GACnB,UAArBlT,EAAYM,OACrB2S,EAAajT,EAAYE,OAAOiT,iBAAiB,IAE/CF,GAEEvN,GAAe,OAA8B,UAArB1F,EAAYM,OACnCN,EAAYoB,uBAAuB,GAAGE,MACzCtB,EAAYoB,uBAAuB,GAAGE,IAAM,CAC1CD,KAAMrB,EAAYoB,uBAAuB,GAAGC,KAAO,KAO3D,IAAIM,EAAqBH,EACrBxB,EAAYyB,kBACZzB,EAAY0B,qBAEHC,EAAmBC,OAAO2B,QAAO,SAASlI,GACrD,MAAgC,QAAzBA,EAAEwH,KAAKC,aAChB,IAAG5J,QACY8G,EAAYoB,uBAAuB,GAAGE,YAC5CtB,EAAYoB,uBAAuB,GAAGE,IAG/ClB,GAAOL,EAAkBC,EAAa2B,EAClC,SAAU3B,EAAYE,OAAQ8F,EAAG0C,WACjC1I,EAAYmO,gBACZnO,EAAYmO,eAAeiF,cAC7BhT,GAAO,mBAzDT,CA2DF,IAEA,IAAIyS,EAAO,IAAIvT,EAAOwT,sBAAsB,CAC1C3d,KAAM,SACNiL,IAAKA,IAEP,OAAOmO,QAAQgB,QAAQsD,EACzB,EAEAtM,EAAkB9M,UAAU4Z,gBAAkB,SAAS9O,GACrD,IACIsI,EADA7G,EAAKpQ,KAET,OAAI2O,QAA2CiB,IAA5BjB,EAAUkH,gBACzBlH,EAAU4H,OACLoC,QAAQC,OAAO,IAAIjJ,UAAU,qCAI/B,IAAIgJ,SAAQ,SAASgB,EAASf,GACnC,IAAKxI,EAAGkB,mBACN,OAAOsH,EAAOtJ,EAAU,oBACpB,2DACC,GAAKX,GAAqC,KAAxBA,EAAUA,UAe5B,CACL,IAAIkH,EAAgBlH,EAAUkH,cAC9B,GAAIlH,EAAU4H,OACZ,IAAK,IAAItX,EAAI,EAAGA,EAAImR,EAAGsC,aAAapP,OAAQrE,IAC1C,GAAImR,EAAGsC,aAAazT,GAAG+L,MAAQ2D,EAAU4H,OAAQ,CAC/CV,EAAgB5W,EAChB,KACF,CAGJ,IAAImL,EAAcgG,EAAGsC,aAAamD,GAClC,IAAIzL,EAqCF,OAAOwO,EAAOtJ,EAAU,iBACpB,8BArCJ,GAAIlF,EAAY+O,SACd,OAAOQ,IAET,IAAInD,EAAOpP,OAAO2B,KAAK4F,EAAUA,WAAWrL,OAAS,EACjD4G,EAAS6M,eAAepI,EAAUA,WAAa,CAAC,EAEpD,GAAsB,QAAlB6H,EAAKpH,WAAqC,IAAdoH,EAAKtH,MAA4B,IAAdsH,EAAKtH,MACtD,OAAOyK,IAGT,GAAInD,EAAKC,WAAgC,IAAnBD,EAAKC,UACzB,OAAOkD,IAIT,IAAsB,IAAlB9D,GAAwBA,EAAgB,GACxCzL,EAAYsE,eAAiB0B,EAAGsC,aAAa,GAAGhE,gBAC7CD,EAAkBrE,EAAYsE,aAAc8H,GAC/C,OAAOoC,EAAOtJ,EAAU,iBACpB,8BAKR,IAAIoO,EAAkB/O,EAAUA,UAAUgP,OACJ,IAAlCD,EAAgBlP,QAAQ,QAC1BkP,EAAkBA,EAAgB5D,OAAO,KAE3C7C,EAAW/M,EAASgN,iBAAiB9G,EAAGkB,mBAAmB9G,MAClDqL,IAAkB,MACtBW,EAAKjX,KAAOme,EAAkB,qBAC7B,OACNtN,EAAGkB,mBAAmB9G,IAClBN,EAASiN,eAAe/G,EAAGkB,mBAAmB9G,KAC9CyM,EAASG,KAAK,GAKtB,MAjEE,IAAK,IAAI/Q,EAAI,EAAGA,EAAI+J,EAAGsC,aAAapP,SAC9B8M,EAAGsC,aAAarM,GAAG8S,WAGvB/I,EAAGsC,aAAarM,GAAGqI,aAAaW,mBAAmB,CAAC,IACpD4H,EAAW/M,EAASgN,iBAAiB9G,EAAGkB,mBAAmB9G,MAClDnE,IAAM,0BACf+J,EAAGkB,mBAAmB9G,IAClBN,EAASiN,eAAe/G,EAAGkB,mBAAmB9G,KAC9CyM,EAASG,KAAK,KACdhH,EAAGsB,cAVmCrL,KAkE9CsT,GACF,GACF,EAEAhJ,EAAkB9M,UAAU+Z,SAAW,SAASC,GAC9C,GAAIA,GAAYA,aAAoBnU,EAAOoU,iBAAkB,CAC3D,IAAIC,EAAmB,KAUvB,GATA/d,KAAK0S,aAAavF,SAAQ,SAAS/C,GAC7BA,EAAYa,WACZb,EAAYa,UAAUI,QAAUwS,EAClCE,EAAmB3T,EAAYa,UACtBb,EAAYc,aACnBd,EAAYc,YAAYG,QAAUwS,IACpCE,EAAmB3T,EAAYc,YAEnC,KACK6S,EACH,MAAMzO,EAAU,qBAAsB,qBAExC,OAAOyO,EAAiBH,UAC1B,CAEA,IAAII,EAAW,GASf,OARAhe,KAAK0S,aAAavF,SAAQ,SAAS/C,GACjC,CAAC,YAAa,cAAe,cAAe,eACxC,iBAAiB+C,SAAQ,SAAS6D,GAC5B5G,EAAY4G,IACdgN,EAASlU,KAAKM,EAAY4G,GAAQ4M,WAEtC,GACN,IACOjF,QAAQsF,IAAID,GAAUE,MAAK,SAASC,GACzC,IAAIC,EAAU,IAAIC,IAMlB,OALAF,EAAShR,SAAQ,SAASmR,GACxBA,EAAMnR,SAAQ,SAASoR,GACrBH,EAAQI,IAAID,EAAKjT,GAAIiT,EACvB,GACF,IACOH,CACT,GACF,EAGkB,CAAC,eAAgB,iBAAkB,iBACnD,kBAAmB,oBACTjR,SAAQ,SAASsR,GAC3B,IAAI3V,EAAMY,EAAO+U,GACjB,GAAI3V,GAAOA,EAAIjF,WAAaiF,EAAIjF,UAAU+Z,SAAU,CAClD,IAAIc,EAAiB5V,EAAIjF,UAAU+Z,SACnC9U,EAAIjF,UAAU+Z,SAAW,WACvB,OAAOc,EAAeC,MAAM3e,MAC3Bke,MAAK,SAASU,GACb,IAAIC,EAAW,IAAIR,IAKnB,OAJAjX,OAAO2B,KAAK6V,GAAazR,SAAQ,SAAS7B,GA1uDpD,IAAsBiT,EA2uDVK,EAAYtT,GAAI/L,KA1uDnB,CACLuf,WAAY,cACZC,YAAa,eACbC,cAAe,iBACfC,eAAgB,kBAChBC,gBAAiB,qBANCX,EA2uD0BK,EAAYtT,IApuDnD/L,OAASgf,EAAKhf,KAquDXsf,EAASL,IAAIlT,EAAIsT,EAAYtT,GAC/B,IACOuT,CACT,GACF,CACF,CACF,IAGA,IAAIM,EAAU,CAAC,cAAe,gBA8D9B,OA7DAA,EAAQhS,SAAQ,SAAS6D,GACvB,IAAIoO,EAAezO,EAAkB9M,UAAUmN,GAC/CL,EAAkB9M,UAAUmN,GAAU,WACpC,IAAIqO,EAAO9C,UACX,MAAuB,mBAAZ8C,EAAK,IACO,mBAAZA,EAAK,GACPD,EAAaT,MAAM3e,KAAM,CAACuc,UAAU,KAC1C2B,MAAK,SAAS3O,GACU,mBAAZ8P,EAAK,IACdA,EAAK,GAAGV,MAAM,KAAM,CAACpP,GAEzB,IAAG,SAAS+P,GACa,mBAAZD,EAAK,IACdA,EAAK,GAAGV,MAAM,KAAM,CAACW,GAEzB,IAEKF,EAAaT,MAAM3e,KAAMuc,UAClC,CACF,KAEA4C,EAAU,CAAC,sBAAuB,uBAAwB,oBAClDhS,SAAQ,SAAS6D,GACvB,IAAIoO,EAAezO,EAAkB9M,UAAUmN,GAC/CL,EAAkB9M,UAAUmN,GAAU,WACpC,IAAIqO,EAAO9C,UACX,MAAuB,mBAAZ8C,EAAK,IACO,mBAAZA,EAAK,GACPD,EAAaT,MAAM3e,KAAMuc,WAC/B2B,MAAK,WACmB,mBAAZmB,EAAK,IACdA,EAAK,GAAGV,MAAM,KAElB,IAAG,SAASW,GACa,mBAAZD,EAAK,IACdA,EAAK,GAAGV,MAAM,KAAM,CAACW,GAEzB,IAEKF,EAAaT,MAAM3e,KAAMuc,UAClC,CACF,IAIA,CAAC,YAAYpP,SAAQ,SAAS6D,GAC5B,IAAIoO,EAAezO,EAAkB9M,UAAUmN,GAC/CL,EAAkB9M,UAAUmN,GAAU,WACpC,IAAIqO,EAAO9C,UACX,MAAuB,mBAAZ8C,EAAK,GACPD,EAAaT,MAAM3e,KAAMuc,WAC/B2B,MAAK,WACmB,mBAAZmB,EAAK,IACdA,EAAK,GAAGV,MAAM,KAElB,IAEKS,EAAaT,MAAM3e,KAAMuc,UAClC,CACF,IAEO5L,CACT,C,uBC5zDA,IAAIzG,EAAW,CAIfA,mBAA8B,WAC5B,OAAO9E,KAAKma,SAASlY,SAAS,IAAIyS,OAAO,EAAG,GAC9C,GAGA5P,EAASyB,WAAazB,EAASsQ,qBAG/BtQ,EAAS+P,WAAa,SAAStS,GAC7B,OAAOA,EAAKgW,OAAO5D,MAAM,MAAMhU,KAAI,SAAS/E,GAC1C,OAAOA,EAAK2c,MACd,GACF,EAEAzT,EAAS2O,cAAgB,SAASlR,GAEhC,OADYA,EAAKoS,MAAM,QACVhU,KAAI,SAASyZ,EAAMtc,GAC9B,OAAQA,EAAQ,EAAI,KAAOsc,EAAOA,GAAM7B,OAAS,MACnD,GACF,EAGAzT,EAASiN,eAAiB,SAASxP,GACjC,IAAIsP,EAAW/M,EAAS2O,cAAclR,GACtC,OAAOsP,GAAYA,EAAS,EAC9B,EAGA/M,EAASgN,iBAAmB,SAASvP,GACnC,IAAIsP,EAAW/M,EAAS2O,cAAclR,GAEtC,OADAsP,EAASnB,QACFmB,CACT,EAGA/M,EAAS+O,YAAc,SAAStR,EAAM8X,GACpC,OAAOvV,EAAS+P,WAAWtS,GAAMgG,QAAO,SAAS3M,GAC/C,OAAgC,IAAzBA,EAAKwN,QAAQiR,EACtB,GACF,EAKAvV,EAAS6M,eAAiB,SAAS/V,GAqBjC,IApBA,IAAI0e,EAQA/Q,EAAY,CACdK,YANA0Q,EADmC,IAAjC1e,EAAKwN,QAAQ,gBACPxN,EAAK2e,UAAU,IAAI5F,MAAM,KAEzB/Y,EAAK2e,UAAU,IAAI5F,MAAM,MAIf,GAClBtD,UAAWpK,SAASqT,EAAM,GAAI,IAC9BtQ,SAAUsQ,EAAM,GAAGxS,cACnBiC,SAAU9C,SAASqT,EAAM,GAAI,IAC7BzQ,GAAIyQ,EAAM,GACVE,QAASF,EAAM,GACfxQ,KAAM7C,SAASqT,EAAM,GAAI,IAEzBngB,KAAMmgB,EAAM,IAGLzgB,EAAI,EAAGA,EAAIygB,EAAMpc,OAAQrE,GAAK,EACrC,OAAQygB,EAAMzgB,IACZ,IAAK,QACH0P,EAAUkR,eAAiBH,EAAMzgB,EAAI,GACrC,MACF,IAAK,QACH0P,EAAUmR,YAAczT,SAASqT,EAAMzgB,EAAI,GAAI,IAC/C,MACF,IAAK,UACH0P,EAAUoR,QAAUL,EAAMzgB,EAAI,GAC9B,MACF,IAAK,QACH0P,EAAU+H,MAAQgJ,EAAMzgB,EAAI,GAC5B0P,EAAUgI,iBAAmB+I,EAAMzgB,EAAI,GACvC,MACF,QACE0P,EAAU+Q,EAAMzgB,IAAMygB,EAAMzgB,EAAI,GAItC,OAAO0P,CACT,EAGAzE,EAAS2M,eAAiB,SAASlI,GACjC,IAAInE,EAAM,GACVA,EAAIV,KAAK6E,EAAUK,YACnBxE,EAAIV,KAAK6E,EAAU8H,WACnBjM,EAAIV,KAAK6E,EAAUS,SAAS4Q,eAC5BxV,EAAIV,KAAK6E,EAAUQ,UACnB3E,EAAIV,KAAK6E,EAAUiR,SAAWjR,EAAUM,IACxCzE,EAAIV,KAAK6E,EAAUO,MAEnB,IAAI3P,EAAOoP,EAAUpP,KAkBrB,OAjBAiL,EAAIV,KAAK,OACTU,EAAIV,KAAKvK,GACI,SAATA,GAAmBoP,EAAUkR,gBAC7BlR,EAAUmR,cACZtV,EAAIV,KAAK,SACTU,EAAIV,KAAK6E,EAAUkR,gBACnBrV,EAAIV,KAAK,SACTU,EAAIV,KAAK6E,EAAUmR,cAEjBnR,EAAUoR,SAAgD,QAArCpR,EAAUS,SAASlC,gBAC1C1C,EAAIV,KAAK,WACTU,EAAIV,KAAK6E,EAAUoR,WAEjBpR,EAAUgI,kBAAoBhI,EAAU+H,SAC1ClM,EAAIV,KAAK,SACTU,EAAIV,KAAK6E,EAAUgI,kBAAoBhI,EAAU+H,QAE5C,aAAelM,EAAI4M,KAAK,IACjC,EAIAlN,EAAS+V,gBAAkB,SAASjf,GAClC,OAAOA,EAAK8Y,OAAO,IAAIC,MAAM,IAC/B,EAIA7P,EAASgW,YAAc,SAASlf,GAC9B,IAAI0e,EAAQ1e,EAAK8Y,OAAO,GAAGC,MAAM,KAC7BoG,EAAS,CACX7T,YAAaD,SAASqT,EAAM5J,QAAS,KAUvC,OAPA4J,EAAQA,EAAM,GAAG3F,MAAM,KAEvBoG,EAAOlT,KAAOyS,EAAM,GACpBS,EAAO/S,UAAYf,SAASqT,EAAM,GAAI,IACtCS,EAAOC,SAA4B,IAAjBV,EAAMpc,OAAe+I,SAASqT,EAAM,GAAI,IAAM,EAEhES,EAAO3S,YAAc2S,EAAOC,SACrBD,CACT,EAIAjW,EAASmW,YAAc,SAASnF,GAC9B,IAAI9O,EAAK8O,EAAM5O,iBACoBsD,IAA/BsL,EAAM3O,uBACRH,EAAK8O,EAAM3O,sBAEb,IAAI6T,EAAWlF,EAAMkF,UAAYlF,EAAM1N,aAAe,EACtD,MAAO,YAAcpB,EAAK,IAAM8O,EAAMjO,KAAO,IAAMiO,EAAM9N,WACvC,IAAbgT,EAAiB,IAAMA,EAAW,IAAM,MAC/C,EAKAlW,EAASoW,YAAc,SAAStf,GAC9B,IAAI0e,EAAQ1e,EAAK8Y,OAAO,GAAGC,MAAM,KACjC,MAAO,CACLzO,GAAIe,SAASqT,EAAM,GAAI,IACvBvF,UAAWuF,EAAM,GAAGlR,QAAQ,KAAO,EAAIkR,EAAM,GAAG3F,MAAM,KAAK,GAAK,WAChE/L,IAAK0R,EAAM,GAEf,EAIAxV,EAASqW,YAAc,SAASC,GAC9B,MAAO,aAAeA,EAAgBlV,IAAMkV,EAAgBC,cACvDD,EAAgBrG,WAA2C,aAA9BqG,EAAgBrG,UAC1C,IAAMqG,EAAgBrG,UACtB,IACJ,IAAMqG,EAAgBxS,IAAM,MAClC,EAKA9D,EAASwW,UAAY,SAAS1f,GAI5B,IAHA,IACI2f,EADAR,EAAS,CAAC,EAEVT,EAAQ1e,EAAK8Y,OAAO9Y,EAAKwN,QAAQ,KAAO,GAAGuL,MAAM,KAC5C1T,EAAI,EAAGA,EAAIqZ,EAAMpc,OAAQ+C,IAEhC8Z,GADAQ,EAAKjB,EAAMrZ,GAAGsX,OAAO5D,MAAM,MACjB,GAAG4D,QAAUgD,EAAG,GAE5B,OAAOR,CACT,EAGAjW,EAAS0W,UAAY,SAAS1F,GAC5B,IAAIla,EAAO,GACPoL,EAAK8O,EAAM5O,YAIf,QAHmCsD,IAA/BsL,EAAM3O,uBACRH,EAAK8O,EAAM3O,sBAET2O,EAAMpO,YAAc1F,OAAO2B,KAAKmS,EAAMpO,YAAYxJ,OAAQ,CAC5D,IAAI4U,EAAS,GACb9Q,OAAO2B,KAAKmS,EAAMpO,YAAYK,SAAQ,SAAS0T,GACzC3F,EAAMpO,WAAW+T,GACnB3I,EAAOpO,KAAK+W,EAAQ,IAAM3F,EAAMpO,WAAW+T,IAE3C3I,EAAOpO,KAAK+W,EAEhB,IACA7f,GAAQ,UAAYoL,EAAK,IAAM8L,EAAOd,KAAK,KAAO,MACpD,CACA,OAAOpW,CACT,EAIAkJ,EAAS4W,YAAc,SAAS9f,GAC9B,IAAI0e,EAAQ1e,EAAK8Y,OAAO9Y,EAAKwN,QAAQ,KAAO,GAAGuL,MAAM,KACrD,MAAO,CACLxa,KAAMmgB,EAAM5J,QACZjI,UAAW6R,EAAMtI,KAAK,KAE1B,EAEAlN,EAAS6W,YAAc,SAAS7F,GAC9B,IAAIlB,EAAQ,GACR5N,EAAK8O,EAAM5O,YAYf,YAXmCsD,IAA/BsL,EAAM3O,uBACRH,EAAK8O,EAAM3O,sBAET2O,EAAMxN,cAAgBwN,EAAMxN,aAAapK,QAE3C4X,EAAMxN,aAAaP,SAAQ,SAASS,GAClCoM,GAAS,aAAe5N,EAAK,IAAMwB,EAAGrO,MACrCqO,EAAGC,WAAaD,EAAGC,UAAUvK,OAAS,IAAMsK,EAAGC,UAAY,IACxD,MACN,IAEKmM,CACT,EAIA9P,EAAS8W,eAAiB,SAAShgB,GACjC,IAAIigB,EAAKjgB,EAAKwN,QAAQ,KAClBkR,EAAQ,CACVjU,KAAMY,SAASrL,EAAK8Y,OAAO,EAAGmH,EAAK,GAAI,KAErCC,EAAQlgB,EAAKwN,QAAQ,IAAKyS,GAO9B,OANIC,GAAS,GACXxB,EAAMyB,UAAYngB,EAAK8Y,OAAOmH,EAAK,EAAGC,EAAQD,EAAK,GACnDvB,EAAMzZ,MAAQjF,EAAK8Y,OAAOoH,EAAQ,IAElCxB,EAAMyB,UAAYngB,EAAK8Y,OAAOmH,EAAK,GAE9BvB,CACT,EAEAxV,EAASkX,eAAiB,SAASpgB,GACjC,IAAI0e,EAAQ1e,EAAK8Y,OAAO,IAAIC,MAAM,KAClC,MAAO,CACLsH,UAAW3B,EAAM5J,QACjBwL,MAAO5B,EAAM3Z,KAAI,SAAS0F,GACxB,OAAOY,SAASZ,EAAM,GACxB,IAEJ,EAIAvB,EAASqQ,OAAS,SAASzB,GACzB,IAAI9N,EAAMd,EAAS+O,YAAYH,EAAc,UAAU,GACvD,GAAI9N,EACF,OAAOA,EAAI8O,OAAO,EAEtB,EAEA5P,EAASqX,iBAAmB,SAASvgB,GACnC,IAAI0e,EAAQ1e,EAAK8Y,OAAO,IAAIC,MAAM,KAClC,MAAO,CACLyH,UAAW9B,EAAM,GAAGxS,cACpBjH,MAAOyZ,EAAM,GAEjB,EAKAxV,EAASqP,kBAAoB,SAAST,EAAcJ,GAKlD,MAAO,CACLc,KAAM,OACNiI,aANUvX,EAAS+O,YAAYH,EAAeJ,EAC9C,kBAKoB3S,IAAImE,EAASqX,kBAErC,EAGArX,EAASY,oBAAsB,SAASoN,EAAQwJ,GAC9C,IAAIlX,EAAM,WAAakX,EAAY,OAInC,OAHAxJ,EAAOuJ,aAAatU,SAAQ,SAASwU,GACnCnX,GAAO,iBAAmBmX,EAAGH,UAAY,IAAMG,EAAG1b,MAAQ,MAC5D,IACOuE,CACT,EAIAN,EAAS0X,gBAAkB,SAAS5gB,GAClC,IAAI0e,EAAQ1e,EAAK8Y,OAAO,GAAGC,MAAM,KACjC,MAAO,CACL8H,IAAKxV,SAASqT,EAAM,GAAI,IACxBoC,YAAapC,EAAM,GACnBqC,UAAWrC,EAAM,GACjBsC,cAAetC,EAAMla,MAAM,GAE/B,EAEA0E,EAAS+X,gBAAkB,SAASnV,GAClC,MAAO,YAAcA,EAAW+U,IAAM,IACpC/U,EAAWgV,YAAc,KACQ,iBAAzBhV,EAAWiV,UACf7X,EAASgY,qBAAqBpV,EAAWiV,WACzCjV,EAAWiV,YACdjV,EAAWkV,cAAgB,IAAMlV,EAAWkV,cAAc5K,KAAK,KAAO,IACvE,MACJ,EAIAlN,EAASiY,qBAAuB,SAASJ,GACvC,GAAqC,IAAjCA,EAAUvT,QAAQ,WACpB,OAAO,KAET,IAAIkR,EAAQqC,EAAUjI,OAAO,GAAGC,MAAM,KACtC,MAAO,CACLqI,UAAW,SACXC,QAAS3C,EAAM,GACf4C,SAAU5C,EAAM,GAChB6C,SAAU7C,EAAM,GAAKA,EAAM,GAAG3F,MAAM,KAAK,QAAKnK,EAC9C4S,UAAW9C,EAAM,GAAKA,EAAM,GAAG3F,MAAM,KAAK,QAAKnK,EAEnD,EAEA1F,EAASgY,qBAAuB,SAASH,GACvC,OAAOA,EAAUK,UAAY,IACzBL,EAAUM,SACXN,EAAUO,SAAW,IAAMP,EAAUO,SAAW,KAChDP,EAAUQ,UAAYR,EAAUS,UAC7B,IAAMT,EAAUQ,SAAW,IAAMR,EAAUS,UAC3C,GACR,EAGAtY,EAASuY,oBAAsB,SAAS3J,EAAcJ,GAGpD,OAFYxO,EAAS+O,YAAYH,EAAeJ,EAC9C,aACW3S,IAAImE,EAAS0X,gBAC5B,EAKA1X,EAASmP,iBAAmB,SAASP,EAAcJ,GACjD,IAAIhC,EAAQxM,EAAS+O,YAAYH,EAAeJ,EAC9C,gBAAgB,GACdgK,EAAMxY,EAAS+O,YAAYH,EAAeJ,EAC5C,cAAc,GAChB,OAAMhC,GAASgM,EAGR,CACL/L,iBAAkBD,EAAMoD,OAAO,IAC/B6I,SAAUD,EAAI5I,OAAO,KAJd,IAMX,EAGA5P,EAASS,mBAAqB,SAASuN,GACrC,MAAO,eAAiBA,EAAOvB,iBAAxB,iBACYuB,EAAOyK,SAAW,MACvC,EAGAzY,EAAS6O,mBAAqB,SAASD,GASrC,IARA,IAAIvJ,EAAc,CAChBvD,OAAQ,GACRC,iBAAkB,GAClBC,cAAe,GACfkM,KAAM,IAGJwK,EADQ1Y,EAAS+P,WAAWnB,GACd,GAAGiB,MAAM,KAClB9a,EAAI,EAAGA,EAAI2jB,EAAMtf,OAAQrE,IAAK,CACrC,IAAImN,EAAKwW,EAAM3jB,GACX4jB,EAAa3Y,EAAS+O,YACxBH,EAAc,YAAc1M,EAAK,KAAK,GACxC,GAAIyW,EAAY,CACd,IAAI3H,EAAQhR,EAASgW,YAAY2C,GAC7BC,EAAQ5Y,EAAS+O,YACnBH,EAAc,UAAY1M,EAAK,KAQjC,OANA8O,EAAMpO,WAAagW,EAAMxf,OAAS4G,EAASwW,UAAUoC,EAAM,IAAM,CAAC,EAClE5H,EAAMxN,aAAexD,EAAS+O,YAC5BH,EAAc,aAAe1M,EAAK,KACjCrG,IAAImE,EAAS4W,aAChBvR,EAAYvD,OAAOlC,KAAKoR,GAEhBA,EAAMjO,KAAK+S,eACjB,IAAK,MACL,IAAK,SACHzQ,EAAYrD,cAAcpC,KAAKoR,EAAMjO,KAAK+S,eAKhD,CACF,CAKA,OAJA9V,EAAS+O,YAAYH,EAAc,aAAa3L,SAAQ,SAASnM,GAC/DuO,EAAYtD,iBAAiBnC,KAAKI,EAASoW,YAAYtf,GACzD,IAEOuO,CACT,EAIArF,EAASO,oBAAsB,SAASC,EAAML,GAC5C,IAAIG,EAAM,GAGVA,GAAO,KAAOE,EAAO,IACrBF,GAAOH,EAAK2B,OAAO1I,OAAS,EAAI,IAAM,IACtCkH,GAAO,sBACPA,GAAOH,EAAK2B,OAAOjG,KAAI,SAASmV,GAC9B,YAAmCtL,IAA/BsL,EAAM3O,qBACD2O,EAAM3O,qBAER2O,EAAM5O,WACf,IAAG8K,KAAK,KAAO,OAEf5M,GAAO,uBACPA,GAAO,8BAGPH,EAAK2B,OAAOmB,SAAQ,SAAS+N,GAC3B1Q,GAAON,EAASmW,YAAYnF,GAC5B1Q,GAAON,EAAS0W,UAAU1F,GAC1B1Q,GAAON,EAAS6W,YAAY7F,EAC9B,IACA,IAAI6H,EAAW,EAiBf,OAhBA1Y,EAAK2B,OAAOmB,SAAQ,SAAS+N,GACvBA,EAAM6H,SAAWA,IACnBA,EAAW7H,EAAM6H,SAErB,IACIA,EAAW,IACbvY,GAAO,cAAgBuY,EAAW,QAEpCvY,GAAO,iBAEHH,EAAK4B,kBACP5B,EAAK4B,iBAAiBkB,SAAQ,SAAS6V,GACrCxY,GAAON,EAASqW,YAAYyC,EAC9B,IAGKxY,CACT,EAIAN,EAASuQ,2BAA6B,SAAS3B,GAC7C,IAcImK,EAdAC,EAAqB,GACrB3T,EAAcrF,EAAS6O,mBAAmBD,GAC1CqK,GAAuD,IAA9C5T,EAAYrD,cAAcsC,QAAQ,OAC3C4U,GAA6D,IAAjD7T,EAAYrD,cAAcsC,QAAQ,UAG9C8S,EAAQpX,EAAS+O,YAAYH,EAAc,WAC5C/S,KAAI,SAAS/E,GACZ,OAAOkJ,EAAS8W,eAAehgB,EACjC,IACC2M,QAAO,SAAS+R,GACf,MAA2B,UAApBA,EAAMyB,SACf,IACEkC,EAAc/B,EAAMhe,OAAS,GAAKge,EAAM,GAAG7V,KAG3C6X,EAAQpZ,EAAS+O,YAAYH,EAAc,oBAC5C/S,KAAI,SAAS/E,GAEZ,OADYA,EAAK8Y,OAAO,IAAIC,MAAM,KACrBhU,KAAI,SAASyZ,GACxB,OAAOnT,SAASmT,EAAM,GACxB,GACF,IACE8D,EAAMhgB,OAAS,GAAKggB,EAAM,GAAGhgB,OAAS,GAAKggB,EAAM,GAAG,KAAOD,IAC7DJ,EAAgBK,EAAM,GAAG,IAG3B/T,EAAYvD,OAAOmB,SAAQ,SAAS+N,GAClC,GAAiC,QAA7BA,EAAMjO,KAAK+S,eAA2B9E,EAAMpO,WAAWC,IAAK,CAC9D,IAAIwW,EAAW,CACb9X,KAAM4X,EACNG,iBAAkBnX,SAAS6O,EAAMpO,WAAWC,IAAK,KAE/CsW,GAAeJ,IACjBM,EAAS7X,IAAM,CAACD,KAAMwX,IAExBC,EAAmBpZ,KAAKyZ,GACpBJ,KACFI,EAAWlW,KAAKC,MAAMD,KAAKE,UAAUgW,KAC5BE,IAAM,CACbhY,KAAM4X,EACNK,UAAWN,EAAY,aAAe,OAExCF,EAAmBpZ,KAAKyZ,GAE5B,CACF,IACkC,IAA9BL,EAAmB5f,QAAgB+f,GACrCH,EAAmBpZ,KAAK,CACtB2B,KAAM4X,IAKV,IAAIM,EAAYzZ,EAAS+O,YAAYH,EAAc,MAenD,OAdI6K,EAAUrgB,SAEVqgB,EADsC,IAApCA,EAAU,GAAGnV,QAAQ,WACXnC,SAASsX,EAAU,GAAG7J,OAAO,GAAI,IACF,IAAlC6J,EAAU,GAAGnV,QAAQ,SAEqB,IAAvCnC,SAASsX,EAAU,GAAG7J,OAAO,GAAI,IAAa,IACpD,UAEMlK,EAEdsT,EAAmB/V,SAAQ,SAAS+K,GAClCA,EAAO0L,WAAaD,CACtB,KAEKT,CACT,EAGAhZ,EAASwQ,oBAAsB,SAAS5B,GACtC,IAAIP,EAAiB,CAAC,EAIlBsL,EAAa3Z,EAAS+O,YAAYH,EAAc,WACjD/S,KAAI,SAAS/E,GACZ,OAAOkJ,EAAS8W,eAAehgB,EACjC,IACC2M,QAAO,SAAS7E,GACf,MAAyB,UAAlBA,EAAIqY,SACb,IAAG,GACD0C,IACFtL,EAAeF,MAAQwL,EAAW5d,MAClCsS,EAAe9M,KAAOoY,EAAWpY,MAKnC,IAAIqY,EAAQ5Z,EAAS+O,YAAYH,EAAc,gBAC/CP,EAAeiF,YAAcsG,EAAMxgB,OAAS,EAC5CiV,EAAeD,SAA4B,IAAjBwL,EAAMxgB,OAIhC,IAAIygB,EAAM7Z,EAAS+O,YAAYH,EAAc,cAG7C,OAFAP,EAAewL,IAAMA,EAAIzgB,OAAS,EAE3BiV,CACT,EAIArO,EAASoQ,UAAY,SAASxB,GAC5B,IAAI4G,EACAsE,EAAO9Z,EAAS+O,YAAYH,EAAc,WAC9C,GAAoB,IAAhBkL,EAAK1gB,OAEP,MAAO,CAACgH,QADRoV,EAAQsE,EAAK,GAAGlK,OAAO,GAAGC,MAAM,MACV,GAAI1O,MAAOqU,EAAM,IAEzC,IAAIuE,EAAQ/Z,EAAS+O,YAAYH,EAAc,WAC5C/S,KAAI,SAAS/E,GACZ,OAAOkJ,EAAS8W,eAAehgB,EACjC,IACC2M,QAAO,SAASuW,GACf,MAA+B,SAAxBA,EAAU/C,SACnB,IACF,OAAI8C,EAAM3gB,OAAS,EAEV,CAACgH,QADRoV,EAAQuE,EAAM,GAAGhe,MAAM8T,MAAM,MACP,GAAI1O,MAAOqU,EAAM,SAFzC,CAIF,EAKAxV,EAASia,qBAAuB,SAASrL,GACvC,IAEIsL,EAFAxB,EAAQ1Y,EAASma,WAAWvL,GAC5BwL,EAAcpa,EAAS+O,YAAYH,EAAc,uBAEjDwL,EAAYhhB,OAAS,IACvB8gB,EAAiB/X,SAASiY,EAAY,GAAGxK,OAAO,IAAK,KAEnDyK,MAAMH,KACRA,EAAiB,OAEnB,IAAII,EAAWta,EAAS+O,YAAYH,EAAc,gBAClD,GAAI0L,EAASlhB,OAAS,EACpB,MAAO,CACL4L,KAAM7C,SAASmY,EAAS,GAAG1K,OAAO,IAAK,IACvC1K,SAAUwT,EAAM6B,IAChBL,eAAgBA,GAIpB,GADmBla,EAAS+O,YAAYH,EAAc,cACrCxV,OAAS,EAAG,CAC3B,IAAIoc,EAAQxV,EAAS+O,YAAYH,EAAc,cAAc,GAC1DgB,OAAO,IACPC,MAAM,KACT,MAAO,CACL7K,KAAM7C,SAASqT,EAAM,GAAI,IACzBtQ,SAAUsQ,EAAM,GAChB0E,eAAgBA,EAEpB,CACF,EAOAla,EAASwa,qBAAuB,SAASC,EAAOC,GAC9C,IAAIC,EAAS,GAiBb,OAfEA,EADqB,cAAnBF,EAAMvV,SACC,CACP,KAAOuV,EAAMja,KAAO,MAAQia,EAAMvV,SAAW,IAAMwV,EAAKxV,SAAW,OACnE,uBACA,eAAiBwV,EAAK1V,KAAO,QAGtB,CACP,KAAOyV,EAAMja,KAAO,MAAQia,EAAMvV,SAAW,IAAMwV,EAAK1V,KAAO,OAC/D,uBACA,aAAe0V,EAAK1V,KAAO,IAAM0V,EAAKxV,SAAW,mBAGzBQ,IAAxBgV,EAAKR,gBACPS,EAAO/a,KAAK,sBAAwB8a,EAAKR,eAAiB,QAErDS,EAAOzN,KAAK,GACrB,EAMAlN,EAAS0I,kBAAoB,WAC3B,OAAOxN,KAAKma,SAASlY,WAAWyS,OAAO,EAAG,GAC5C,EAOA5P,EAAS0S,wBAA0B,SAASkI,EAAQC,EAASC,GAC3D,IACIC,OAAsBrV,IAAZmV,EAAwBA,EAAU,EAQhD,MAAO,aAFIC,GAAY,qBAGL,KARdF,GAGU5a,EAAS0I,qBAKa,IAAMqS,EADnC,uCAKT,EAEA/a,EAASC,kBAAoB,SAASC,EAAaC,EAAM9K,EAAM+K,GAC7D,IAAIE,EAAMN,EAASO,oBAAoBL,EAAYM,KAAML,GAyBzD,GAtBAG,GAAON,EAASS,mBACdP,EAAYQ,YAAYC,sBAG1BL,GAAON,EAASY,oBACdV,EAAYW,cAAcF,qBACjB,UAATtL,EAAmB,UAAY,UAEjCiL,GAAO,SAAWJ,EAAYY,IAAM,OAEhCZ,EAAY+P,UACd3P,GAAO,KAAOJ,EAAY+P,UAAY,OAC7B/P,EAAYa,WAAab,EAAYc,YAC9CV,GAAO,iBACEJ,EAAYa,UACrBT,GAAO,iBACEJ,EAAYc,YACrBV,GAAO,iBAEPA,GAAO,iBAGLJ,EAAYa,UAAW,CAEzB,IAAIM,EAAO,QAAUjB,EAAOgB,GAAK,IAC7BlB,EAAYa,UAAUI,MAAMC,GAAK,OACrCd,GAAO,KAAOe,EAGdf,GAAO,UAAYJ,EAAYoB,uBAAuB,GAAGC,KACrD,IAAMF,EACNnB,EAAYoB,uBAAuB,GAAGE,MACxClB,GAAO,UAAYJ,EAAYoB,uBAAuB,GAAGE,IAAID,KACzD,IAAMF,EACVf,GAAO,oBACHJ,EAAYoB,uBAAuB,GAAGC,KAAO,IAC7CrB,EAAYoB,uBAAuB,GAAGE,IAAID,KAC1C,OAER,CAQA,OANAjB,GAAO,UAAYJ,EAAYoB,uBAAuB,GAAGC,KACrD,UAAYvB,EAASyB,WAAa,OAClCvB,EAAYa,WAAab,EAAYoB,uBAAuB,GAAGE,MACjElB,GAAO,UAAYJ,EAAYoB,uBAAuB,GAAGE,IAAID,KACzD,UAAYvB,EAASyB,WAAa,QAEjCnB,CACT,EAGAN,EAASkQ,aAAe,SAAStB,EAAcJ,GAG7C,IADA,IAAIsB,EAAQ9P,EAAS+P,WAAWnB,GACvB7Z,EAAI,EAAGA,EAAI+a,EAAM1W,OAAQrE,IAChC,OAAQ+a,EAAM/a,IACZ,IAAK,aACL,IAAK,aACL,IAAK,aACL,IAAK,aACH,OAAO+a,EAAM/a,GAAG6a,OAAO,GAK7B,OAAIpB,EACKxO,EAASkQ,aAAa1B,GAExB,UACT,EAEAxO,EAASgQ,QAAU,SAASpB,GAG1B,OAFY5O,EAAS+P,WAAWnB,GACd,GAAGiB,MAAM,KACd,GAAGD,OAAO,EACzB,EAEA5P,EAASgP,WAAa,SAASJ,GAC7B,MAAyC,MAAlCA,EAAaiB,MAAM,IAAK,GAAG,EACpC,EAEA7P,EAASma,WAAa,SAASvL,GAC7B,IACI4G,EADQxV,EAAS+P,WAAWnB,GACd,GAAGgB,OAAO,GAAGC,MAAM,KACrC,MAAO,CACLrP,KAAMgV,EAAM,GACZxQ,KAAM7C,SAASqT,EAAM,GAAI,IACzBtQ,SAAUsQ,EAAM,GAChB+E,IAAK/E,EAAMla,MAAM,GAAG4R,KAAK,KAE7B,EAEAlN,EAASgb,WAAa,SAASpM,GAC7B,IACI4G,EADOxV,EAAS+O,YAAYH,EAAc,MAAM,GACnCgB,OAAO,GAAGC,MAAM,KACjC,MAAO,CACLoL,SAAUzF,EAAM,GAChB0F,UAAW1F,EAAM,GACjB2F,eAAgBhZ,SAASqT,EAAM,GAAI,IACnC4F,QAAS5F,EAAM,GACf6F,YAAa7F,EAAM,GACnBE,QAASF,EAAM,GAEnB,EAGAxV,EAASsb,WAAa,SAAS7d,GAC7B,GAAoB,iBAATA,GAAqC,IAAhBA,EAAKrE,OACnC,OAAO,EAGT,IADA,IAAI0W,EAAQ9P,EAAS+P,WAAWtS,GACvB1I,EAAI,EAAGA,EAAI+a,EAAM1W,OAAQrE,IAChC,GAAI+a,EAAM/a,GAAGqE,OAAS,GAA4B,MAAvB0W,EAAM/a,GAAGwmB,OAAO,GACzC,OAAO,EAIX,OAAO,CACT,EAIE5mB,EAAOD,QAAUsL,C,WCpzBnB/K,OAAOC,kBAAkB,cAAe,CAEtCsmB,aAAc,CAAC,gBAEfrmB,OAAQ,CAGNsmB,aAAe,CAACpmB,KAAM,OAAQC,QAAS,CAAComB,EAAG,EAAGC,EAAG,IAAKC,GAAI,KAG1DC,UAAY,CAACvmB,QAAS,GAGtBwmB,YAAa,CAACxmB,QAAS,GAGvBymB,gBAAiB,CAACzmB,QAAS,GAG3B0mB,UAAW,CAAC1mB,QAAS,GAGrB2mB,UAAW,CAAC3mB,QAAS,GAGrB4mB,WAAY,CAAC5mB,SAAS,GAGtBC,QAAS,CAACD,QAAS,KAIrBO,OAEEC,KAAKmW,MAAQ,CACXkQ,YAAa,EACbC,eAAgB,EAChBC,gBAAiB,EACjBC,OAAQ,EACRC,YAAa,EACbC,iBAAkB,EAErB,EAED9lB,SACEZ,KAAK2mB,eAED3mB,KAAKqB,KAAK+kB,YACZpmB,KAAK4mB,cAET,EAEAA,eAGE5mB,KAAK6mB,gBAAkB7mB,KAAK8mB,YAAY9mB,KAAKqB,KAAK0kB,UAAY,IAAM,SACpE/lB,KAAK+mB,kBAAoB/mB,KAAK8mB,YAAY9mB,KAAKqB,KAAK2kB,YAAa,SACjEhmB,KAAKgnB,eAAiBhnB,KAAK8mB,YAAY9mB,KAAKqB,KAAK4kB,gBAAiB,UAClEjmB,KAAKinB,kBAAoBjnB,KAAK8mB,YAAY9mB,KAAKqB,KAAK4kB,gBAAkB,IAAM,MAC9E,EAEAU,eAEEO,YAAeC,IACTA,GACFA,EAAMC,WAAWC,YAAYF,EAC/B,EAGFD,YAAYlnB,KAAKsnB,eACjBJ,YAAYlnB,KAAK6mB,iBACjBK,YAAYlnB,KAAK+mB,mBACjBG,YAAYlnB,KAAKgnB,gBACjBE,YAAYlnB,KAAKinB,mBAEjBjnB,KAAKsnB,cAAgB,KACrBtnB,KAAKsnB,cAAgB,KACrBtnB,KAAK6mB,gBAAkB,KACvB7mB,KAAK+mB,kBAAoB,KACzB/mB,KAAKgnB,eAAiB,KACtBhnB,KAAKinB,kBAAoB,IAC3B,EAEAH,YAAYS,EAAQjoB,GAClB,MAAM6nB,EAAQrW,SAAS0W,cAAc,YAMrC,OALAL,EAAMM,aAAa,sBAAuB,CAACF,OAAQA,EAAQjoB,MAAOA,IAEnDwR,SAAS4W,cAAc,SAC/BC,YAAYR,GAEZA,CACT,EAEAS,aAAaC,GAEX,IAAIC,EAAUC,EAEV3iB,KAAK4iB,IAAIH,EAAYjC,EAAI5lB,KAAKqB,KAAKskB,aAAaC,GAAK5lB,KAAKqB,KAAK6kB,UAAY,IAC7E4B,GAAW,GAKb,MAAMG,EAAUJ,EAAY/B,EAAI9lB,KAAKqB,KAAKskB,aAAaG,EAMvD,OALI,EAAY9lB,KAAKqB,KAAK8kB,WACtB,GAAa,KACf4B,GAAW,GAGLD,GAAYC,CAEtB,EAEAG,kBAAkBL,GAiBhB,OAhBI7nB,KAAK4nB,aAAaC,IAEf7nB,KAAKmW,MAAMkQ,YACdrmB,KAAKG,GAAGgoB,KAAK,gBAGfnoB,KAAKmW,MAAMkQ,YAAa,IAGpBrmB,KAAKmW,MAAMkQ,YACbrmB,KAAKG,GAAGgoB,KAAK,eAGfnoB,KAAKmW,MAAMkQ,YAAa,GAGnBrmB,KAAKmW,MAAMkQ,UACpB,EAEA+B,UAAUP,GAER,IAAIQ,EAAWC,EAmBf,OAhBIljB,KAAK4iB,IAAIH,EAAYjC,EAAI5lB,KAAKqB,KAAKskB,aAAaC,GAAK5lB,KAAKqB,KAAK6kB,UAAY,IAC7EmC,GAAY,GAWVjjB,KAAK4iB,IAAIhoB,KAAKqB,KAAKskB,aAAaG,EAAI+B,EAAY/B,GAAK,MACvDwC,GAAY,GAGPD,GAAaC,CACtB,EAEAC,eAAeV,GAuCb,OArCI7nB,KAAKooB,UAAUP,IACZ7nB,KAAKmW,MAAMmQ,eACdtmB,KAAKG,GAAGgoB,KAAK,iBAEfnoB,KAAKmW,MAAMmQ,eAAgB,IAGvBtmB,KAAKmW,MAAMmQ,gBAITuB,EAAYhC,EAAI7lB,KAAKqB,KAAKskB,aAAaE,GAGpC7lB,KAAKmW,MAAMoQ,gBAEdvmB,KAAKG,GAAGgoB,KAAK,kBAGfnoB,KAAKmW,MAAMoQ,gBAAiB,IAKxBvmB,KAAKmW,MAAMoQ,gBAEbvmB,KAAKG,GAAGgoB,KAAK,gBAGfnoB,KAAKmW,MAAMoQ,gBAAiB,GAG9BvmB,KAAKG,GAAGgoB,KAAK,eAEfnoB,KAAKmW,MAAMmQ,eAAgB,GAGtBtmB,KAAKmW,MAAMmQ,aACpB,EAEAkC,QAAQX,GAGN,OAAI7nB,KAAKqB,KAAK0kB,UAAY8B,EAAYhC,EAAI,GAM5C,EAEA4C,aAAaZ,GAiBX,OAhBI7nB,KAAKwoB,QAAQX,IAEV7nB,KAAKmW,MAAMqQ,OACdxmB,KAAKG,GAAGgoB,KAAK,WAGfnoB,KAAKmW,MAAMqQ,OAAQ,IAGfxmB,KAAKmW,MAAMqQ,OACbxmB,KAAKG,GAAGgoB,KAAK,oBAGfnoB,KAAKmW,MAAMqQ,OAAQ,GAGdxmB,KAAKmW,MAAMqQ,KACpB,EAEAkC,aAAab,GAGX,OAAIA,EAAYhC,EAAI7lB,KAAKqB,KAAK2kB,WAMhC,EAEA2C,kBAAkBd,GAiBhB,OAhBI7nB,KAAK0oB,aAAab,IAEf7nB,KAAKmW,MAAMsQ,YACdzmB,KAAKG,GAAGgoB,KAAK,oBAGfnoB,KAAKmW,MAAMsQ,YAAa,IAGpBzmB,KAAKmW,MAAMsQ,YACbzmB,KAAKG,GAAGgoB,KAAK,6BAGfnoB,KAAKmW,MAAMsQ,YAAa,GAGnBzmB,KAAKmW,MAAMsQ,UACpB,EAEAmC,kBAAkBf,GAIhB,OAAIA,EAAYhC,EAAK7lB,KAAKqB,KAAK4kB,gBAAkB,GAMnD,EAEA4C,uBAAuBhB,GAoBrB,OAnBI7nB,KAAK4oB,kBAAkBf,IAEpB7nB,KAAKmW,MAAMuQ,iBACd1mB,KAAKG,GAAGgoB,KAAK,qBAGfnoB,KAAKmW,MAAMuQ,iBAAkB,IAGzB1mB,KAAKmW,MAAMuQ,kBACb1mB,KAAKG,GAAGgoB,KAAK,cAGbnoB,KAAKmW,MAAMoQ,gBAAiB,GAG9BvmB,KAAKmW,MAAMuQ,iBAAkB,GAGxB1mB,KAAKmW,MAAMuQ,eACpB,EAEAoC,OACEjB,YAAc7nB,KAAKG,GAAG4oB,QAAQC,WAAW,gBAAgBnB,YAGtC7nB,KAAKkoB,kBAAkBL,eAO1C7nB,KAAKuoB,eAAeV,aAGpB7nB,KAAKyoB,aAAaZ,aAGlB7nB,KAAK2oB,kBAAkBd,aAGvB7nB,KAAK6oB,uBAAuBhB,aAE9B,IAGF1oB,OAAOC,kBAAkB,sBAAuB,CAE9CC,OAAQ,CACNkoB,OAAQ,CAAC/nB,QAAS,GAClBF,MAAO,CAACE,QAAS,QAGnBO,OAEE,MAAM,OAACwnB,EAAM,MAAEjoB,GAASU,KAAKqB,KAE7BrB,KAAKipB,WAAW1B,EAAQjoB,EAAO,GAAK,IACpCU,KAAKipB,WAAW1B,EAAQjoB,EAAO,EAAK,KACpCU,KAAKipB,WAAW1B,EAAQjoB,EAAO,IAAK,EAEtC,EAEA2pB,WAAW1B,EAAQjoB,EAAO4pB,EAAQzpB,GAEhC,MAAM0pB,EAAOrY,SAAS0W,cAAc,WAWpC,OAVA2B,EAAKrnB,SAASsnB,SAASxD,EAAIxgB,KAAKikB,GAAK,EACrCF,EAAKrnB,SAASwnB,SAASzD,EAAI0B,EAC3B4B,EAAK1B,aAAa,SAAUyB,GAC5BC,EAAK1B,aAAa,iBAAkB,MACpC0B,EAAK1B,aAAa,mBAAoB,KACtC0B,EAAK1B,aAAa,WAAY,CAACnoB,MAAOA,EACPG,QAASA,EACT6C,YAAc7C,EAAU,IACvDO,KAAKG,GAAGwnB,YAAYwB,GAEbA,CACT,G,WCrVFhqB,OAAOC,kBAAkB,eAAgB,CAEvCW,OAIEC,KAAKupB,eAAiB,IAAI7oB,MAAM8oB,QAChCxpB,KAAKypB,iBAAmB,IAAI/oB,MAAMgpB,WAGlC1pB,KAAK2pB,eAAiB,IAAIjpB,MAAMgpB,WAGhC1pB,KAAK4pB,OAAS9Y,SAAS4W,cAAc,SACrCmC,KAAO7pB,KAAK4pB,OAAO9nB,SACnB9B,KAAK8pB,qBAAuB,IAAIppB,MAAMqpB,QACtCF,KAAKG,oBACLhqB,KAAK8pB,qBAAqBG,KAAKJ,KAAKK,aACpClqB,KAAK8pB,qBAAqBK,SAK1BnqB,KAAK6nB,YAAc,IAAInnB,MAAM8oB,QAE7BxpB,KAAKoqB,UAAY,IAAI1pB,MAAM8oB,QAI3BxpB,KAAKqqB,yBAEP,EAEAA,0BAEE,MAAMf,EAAWtpB,KAAKupB,eAChBe,EAAatqB,KAAKypB,iBAExBzpB,KAAKG,GAAG4oB,QAAQwB,OAAOC,iBAAiBlB,GACxCtpB,KAAKG,GAAG4oB,QAAQwB,OAAOE,mBAAmBH,GAE1C,MAAMR,EAAuB9pB,KAAK8pB,qBAClCR,EAASoB,aAAaZ,GACtB9pB,KAAK2pB,eAAegB,sBAAsBb,GAC1CQ,EAAWM,SAAS5qB,KAAK2pB,gBAEzB3pB,KAAK6nB,YAAYgD,WAAW7qB,KAAKupB,eAAgBvpB,KAAKoqB,UAIxD,EAEAxpB,SAGA,EAEAkoB,OAEE9oB,KAAKqqB,yBACP,G,WC1EF,MAAMS,EAAsB,CAC1BrR,MAAO,gBACPsR,IAAK,gBACLC,MAAO,gBACPC,IAAK,gBACLC,MAAO,gBACPC,OAAQ,gBACRC,OAAQ,gBACRC,KAAM,iBAGFC,EAAsB,CAC1B7R,MAAO,UACPsR,IAAK,UACLC,MAAO,UACPC,IAAK,UACLC,MAAO,UACPC,OAAQ,UACRC,OAAQ,WACRC,KAAM,YAGFE,EAA8B,CAClC9R,MAAO,UACPuR,MAAO,UACPC,IAAK,UACLC,MAAO,UACPC,OAAQ,UACRE,KAAM,YAGFG,EAA+B,CACnC/R,MAAO,WAGTta,OAAOC,kBAAkB,mBAAoB,CAE3CsmB,aAAc,CAAC,gBAEfrmB,OAAQ,CACNosB,KAAM,CAACjsB,SAAS,IAGlBO,OAEEC,KAAK0rB,aAAe1rB,KAAK0rB,aAAaxrB,KAAKF,MAC3CA,KAAK2rB,aAAe3rB,KAAK2rB,aAAazrB,KAAKF,MAC3CA,KAAK4rB,UAAY5rB,KAAK4rB,UAAU1rB,KAAKF,MAErCA,KAAKG,GAAGC,iBAAiB,gBAAiBJ,KAAK2rB,cAC/C3rB,KAAKG,GAAGC,iBAAiB,aAAcJ,KAAK4rB,WAC5C5rB,KAAKG,GAAGC,iBAAiB,gBAAiBJ,KAAK0rB,cAG/C1rB,KAAK6rB,MAAQ,QAEb7rB,KAAK8rB,cAAgBhb,SAASib,eAAe,kBAE7C/rB,KAAKgsB,oBAAsB,IAAItrB,MAAM8oB,QACrCxpB,KAAKisB,sBAAwB,IAAIvrB,MAAMgpB,WACvC1pB,KAAKksB,cAAgB,IAAIxrB,MAAM8oB,QAAQ,EAAG,GAAI,GAC9CxpB,KAAKmsB,gBAAkB,IAAIzrB,MAAM8oB,QAEjCxpB,KAAKG,GAAGC,iBAAiB,YAAY,KACnCJ,KAAKosB,QAAQ,gBACb3b,YAAW,IAAMzQ,KAAKqsB,WAAWrsB,KAAK6rB,QAAQ,KAE9C,MAAMS,EAAQxb,SAAS4W,cAAc,WACjC4E,GACFA,EAAMC,MACR,IAGEvsB,KAAKqB,KAAKoqB,OAEZzrB,KAAKG,GAAGsnB,aAAa,cACC,uHAItBznB,KAAKwsB,wBAET,EAEA5rB,SACEZ,KAAKysB,UACP,EAEAlqB,SACEvC,KAAKG,GAAGqC,oBAAoB,gBAAiBxC,KAAK2rB,cAClD3rB,KAAKG,GAAGqC,oBAAoB,aAAcxC,KAAK4rB,UACjD,EAEAc,0BAEE1sB,KAAK6rB,MAAQ,QACb7rB,KAAK8rB,cAAchqB,SAASE,SAAU,EACtChC,KAAKysB,UAEP,EAEAD,wBACExsB,KAAK8rB,cAAchqB,SAASE,SAAU,EACtChC,KAAKG,GAAGgoB,KAAK,uBACf,EAEAwE,iBAGE,OADkB3sB,KAAKG,GAAG6oB,WAAW,gBACpBnB,WACnB,EAEA+E,YAAYf,GAEV7rB,KAAKqsB,WAAWR,GAChB7rB,KAAK6rB,MAAQA,EACb7rB,KAAKysB,UACP,EAGAI,gBAAgBhB,GAEd7rB,KAAKqsB,WAAWR,GAChB7rB,KAAK6rB,MAAQA,EACb7rB,KAAKysB,UACP,EAEAJ,WAAWR,GACT,MAAMiB,EAAShc,SAASib,eAAe,gBAEvCe,EAAOrF,aAAa,QAAS,CAACsF,IAAKzB,EAAoBO,GAAQmB,UAAU,IAGrEzB,EAA4BM,IAC9Bpb,YAAW,KACTqc,EAAOrF,aAAa,QAAS,CAACsF,IAAKxB,EAA4BM,GAAQmB,UAAU,IACjFF,EAAO9D,WAAWiE,MAAMC,WAAW,GAClC,KAGD1B,EAA6BK,IAC/Bpb,YAAW,KACTqc,EAAOrF,aAAa,QAAS,CAACsF,IAAKvB,EAA6BK,GAAQmB,UAAU,IAClFF,EAAO9D,WAAWiE,MAAMC,WAAW,GAClC,IAEP,EAEAd,QAAQW,GACN,MAAMD,EAAShc,SAASib,eAAe,cAEvCe,EAAOrF,aAAa,QAAS,CAACsF,IAAK,GAAIC,UAAU,IACjDF,EAAOrF,aAAa,QAAS,CAACsF,IAAKA,EAAKC,UAAU,GACpD,EAEAtB,eAKqB,WAAf1rB,KAAK6rB,QACP7rB,KAAKosB,QAAQ,oBACbpsB,KAAK4sB,YAAY,QAErB,EAEAjB,eAIE,OAAQ3rB,KAAK6rB,OAEX,IAAK,QAEH,MAAMhC,EAAO/Y,SAAS4W,cAAc,SAC9B4B,EAAWtpB,KAAKgsB,oBAChB1B,EAAatqB,KAAKisB,sBAExBjsB,KAAKG,GAAG4oB,QAAQwB,OAAOC,iBAAiBlB,GACxCtpB,KAAKG,GAAG4oB,QAAQwB,OAAOE,mBAAmBH,GAC1CT,EAAK/nB,SAASwnB,SAAS1D,EAAI0D,EAAS1D,EACpCiE,EAAK/nB,SAASwnB,SAASzD,EAAI,EAC3BgE,EAAK/nB,SAASwnB,SAASxD,EAAIwD,EAASxD,EAKpC,MAAMqH,EAAUntB,KAAKksB,cACf/R,EAAYna,KAAKmsB,gBACvBhS,EAAU8P,KAAKkD,GACfhT,EAAUiT,gBAAgB9C,GAC1BnQ,EAAU0L,EAAI,EACd1L,EAAUkT,YAEVxD,EAAK/nB,SAASwoB,WAAWgD,mBAAmBH,EAAShT,GAErDna,KAAK4sB,YAAY,OACjB5sB,KAAKosB,QAAQ,oBACb,MAEF,IAAK,MAEHpsB,KAAK4sB,YAAY,SACjB5sB,KAAKosB,QAAQ,oBACb,MAEF,IAAK,QAEH,MAAMmB,EAAM,IAAI7sB,MAAM8oB,QACtB+D,EAAItD,KAAKjqB,KAAK2sB,kBACd3sB,KAAKG,GAAGsnB,aAAa,cAAe,CAAC9B,aAAc4H,IACnDvtB,KAAK4sB,YAAY,OAEjB5sB,KAAKosB,QAAQ,mBACb,MAEF,IAAK,MACHoB,KAAOxtB,KAAK2sB,iBAAiB9G,EAC7B7lB,KAAKG,GAAGsnB,aAAa,cAAe,CAAC1B,UAAWyH,OAChDxtB,KAAK4sB,YAAY,SACjB5sB,KAAKosB,QAAQ,mBACb,MAEF,IAAK,QACHoB,KAAOxtB,KAAK2sB,iBAAiB9G,EAC7B7lB,KAAKG,GAAGsnB,aAAa,cAAe,CAACzB,YAAawH,OAClDxtB,KAAK4sB,YAAY,UACjB5sB,KAAKosB,QAAQ,mBACb,MAEF,IAAK,SACHoB,KAAOxtB,KAAK2sB,iBAAiB9G,EAC7B7lB,KAAKG,GAAGsnB,aAAa,cAAe,CAACxB,gBAAiBuH,OACtDxtB,KAAK4sB,YAAY,UACjB5sB,KAAKosB,QAAQ,mBACb,MAEF,IAAK,SAIHpsB,KAAK4sB,YAAY,QACjB5sB,KAAKosB,QAAQ,oBACb,MAEF,IAAK,OACHpsB,KAAKwsB,wBACLxsB,KAAKosB,QAAQ,oBACb,MAEF,QACE7qB,QAAQ+d,MAAM,oCAAqCtf,KAAK6rB,OAG9D,EAEAD,YAEE,OAAQ5rB,KAAK6rB,OAEX,IAAK,QAEH,MAEF,IAAK,MACH7rB,KAAK6sB,gBAAgB,SACrB7sB,KAAKosB,QAAQ,oBACb,MAEF,IAAK,QACHpsB,KAAK6sB,gBAAgB,OACrB7sB,KAAKosB,QAAQ,oBACb,MAEF,IAAK,MACHpsB,KAAK6sB,gBAAgB,SACrB7sB,KAAKosB,QAAQ,oBACb,MAEF,IAAK,QACHpsB,KAAK6sB,gBAAgB,OACrB7sB,KAAKosB,QAAQ,oBACb,MAEF,IAAK,SACHpsB,KAAK6sB,gBAAgB,SACrB7sB,KAAKosB,QAAQ,oBACb,MAEF,IAAK,SACHpsB,KAAK6sB,gBAAgB,UACrB7sB,KAAKosB,QAAQ,oBACb,MAEF,IAAK,OACHpsB,KAAK6sB,gBAAgB,UACrB7sB,KAAKosB,QAAQ,oBACb,MAEF,QACE7qB,QAAQ+d,MAAM,iCAAkCtf,KAAK6rB,OAG3D,EAEAY,WAEE,MACMgB,EAAuB,UAAfztB,KAAK6rB,MAEnB7rB,KAAK8rB,cAAcrE,aAAa,iBACC,CAACiG,OAAQ1tB,KAAK0tB,OACbC,SAAU3tB,KAAK2tB,SACfC,eANlB,EAOkBC,WAAYJ,EACZK,cAAehD,EAAoB9qB,KAAK6rB,QAC5E,IAGF1sB,OAAOC,kBAAkB,iBAAkB,CAEzCC,OAAQ,CACNyuB,cAAe,CAACvuB,KAAM,UACtBwuB,aAAc,CAACvuB,SAAS,GACxBquB,WAAY,CAACruB,SAAS,IAGxBO,OACEC,KAAKguB,OAASld,SAAS0W,cAAc,YACrCxnB,KAAKguB,OAAOvG,aAAa,WAAY,+CACrCznB,KAAKguB,OAAOvG,aAAa,WAAY,iDACrCznB,KAAKG,GAAGwnB,YAAY3nB,KAAKguB,OAC3B,EAEAptB,SAEEZ,KAAKiuB,cACDjuB,KAAKqB,KAAKysB,eAEZ9tB,KAAKkuB,YAAYluB,KAAKguB,OAAQhuB,KAAKqB,KAAKysB,cAAe,GAGzD9tB,KAAKmuB,gBACLnuB,KAAKouB,eACP,EAEAA,gBAEMpuB,KAAKqB,KAAKusB,gBAAkB5tB,KAAKqB,KAAKwsB,aACxC7tB,KAAK4tB,cAAgB5tB,KAAKquB,aAAa,GAAI,EAAG,SAAU,mBAGrDruB,KAAKqB,KAAKusB,eAAiB5tB,KAAKqB,KAAKwsB,aACxC7tB,KAAK6tB,WAAa7tB,KAAKquB,aAAa,GAAI,EAAG,SAAU,eAGnDruB,KAAKqB,KAAKusB,eAAiB5tB,KAAKqB,KAAKwsB,aACvC7tB,KAAK4tB,cAAgB5tB,KAAKquB,aAAa,IAAM,EAAG,SAAU,iBAC1DruB,KAAK6tB,WAAa7tB,KAAKquB,cAAc,IAAM,EAAG,SAAU,cAE5D,EAEAA,aAAazI,EAAGC,EAAGyI,EAAUC,GAS3B,OAPAC,OAAS1d,SAAS0W,cAAc,YAChCgH,OAAO1sB,SAASwnB,SAAS1D,EAAIA,EAC7B4I,OAAO1sB,SAASwnB,SAASzD,EAAIA,EAC7B2I,OAAO1sB,SAASwnB,SAASxD,EAAI,KAC7B0I,OAAO/G,aAAa,kBAAmB,CAAC6G,SAAUA,EAAUC,UAAWA,IACvEvuB,KAAKguB,OAAOrG,YAAY6G,QAEjBA,MACT,EAEAL,gBAEEM,aAAgBtuB,IACVA,GAAMA,EAAGinB,YACXjnB,EAAGinB,WAAWC,YAAYlnB,EAC5B,EAEFsuB,aAAazuB,KAAK4tB,eAClBa,aAAazuB,KAAK6tB,YAClB7tB,KAAK4tB,cAAgB,KACrB5tB,KAAK6tB,WAAa,IACpB,EAEAK,YAAYQ,EAAQ3B,EAAK4B,GAEvB3uB,KAAK4uB,MAAQ9d,SAAS0W,cAAc,WACpCxnB,KAAK4uB,MAAMnH,aAAa,aAAc,IACtCznB,KAAK4uB,MAAMnH,aAAa,QAASkH,GACjC3uB,KAAK4uB,MAAMnH,aAAa,SAAUkH,GAClC3uB,KAAK4uB,MAAMnH,aAAa,eAAe,GACvCznB,KAAK4uB,MAAM9sB,SAASwnB,SAASxD,EAAI,KACjC9lB,KAAK4uB,MAAMnH,aAAa,MAAOsF,GAC/B2B,EAAO/G,YAAY3nB,KAAK4uB,MAE1B,EAEAX,cAEMjuB,KAAK4uB,QACP5uB,KAAK4uB,MAAMxH,WAAWC,YAAYrnB,KAAK4uB,OACvC5uB,KAAK4uB,MAAQ,KAEjB,IAGFzvB,OAAOC,kBAAkB,kBAAmB,CAE1CC,OAAQ,CACNivB,SAAW,CAAC/uB,KAAM,UAClBgvB,UAAW,CAAChvB,KAAM,WAGpBQ,OAEE,MAAMyuB,EAAS1d,SAAS0W,cAAc,YACtCgH,EAAO/G,aAAa,WAAY,kDAChC+G,EAAO/G,aAAa,WAAY,8BAChC+G,EAAOK,UAAU9sB,IAAI,aACrB/B,KAAKG,GAAGwnB,YAAY6G,GAEpB,MAAMrF,EAAOrY,SAAS0W,cAAc,UACpC2B,EAAK1B,aAAa,eAAgB,KAClC0B,EAAK1B,aAAa,eAAgB,KAClC0B,EAAK1B,aAAa,iBAAkB,KACpC0B,EAAK1B,aAAa,eAAgB,GAClC0B,EAAK1B,aAAa,WAAY,6BAC9B0B,EAAKrnB,SAASwnB,SAASxD,EAAI,KAC3B0I,EAAO7G,YAAYwB,GAEnBnpB,KAAKkuB,YAAYM,EAAQxuB,KAAKqB,KAAKitB,SAAU,IAE7C,MAAMQ,EAAehe,SAAS0W,cAAc,UAC5CsH,EAAarH,aAAa,eAAgB,KAC1CqH,EAAarH,aAAa,eAAgB,KAC1CqH,EAAarH,aAAa,iBAAkB,KAC5CqH,EAAarH,aAAa,eAAgB,GAC1CqH,EAAarH,aAAa,cAAe,IACzCqH,EAAarH,aAAa,eAAgB,GAC1CqH,EAAarH,aAAa,QAAS,UACnCqH,EAAarH,aAAa,WAAY,6BAEtCqH,EAAahtB,SAASwnB,SAASxD,EAAI,KACnCqD,EAAKxB,YAAYmH,GAEjBN,EAAOpuB,iBAAiB,UAAU,KAChC0uB,EAAarH,aAAa,YAAa,CAACsH,SAAU,uBACVC,KAAM,EACNC,GAAI,IACJC,IAAK,KACLC,OAAQ,cAAa,IAG/DX,EAAOpuB,iBAAiB,cAAc,KACpC0uB,EAAaM,gBAAgB,aAC7BN,EAAarH,aAAa,WAAY,iBAAgB,IAGxD+G,EAAOpuB,iBAAiB,SAAS,KAC/BJ,KAAKG,GAAG4oB,QAAQZ,KAAKnoB,KAAKqB,KAAKktB,UAAS,GAE5C,EAEAL,YAAYQ,EAAQ3B,EAAK4B,GAEvB3uB,KAAK4uB,MAAQ9d,SAAS0W,cAAc,WACpCxnB,KAAK4uB,MAAMnH,aAAa,aAAc,IACtCznB,KAAK4uB,MAAMnH,aAAa,QAASkH,GACjC3uB,KAAK4uB,MAAMnH,aAAa,SAAUkH,GAClC3uB,KAAK4uB,MAAMnH,aAAa,eAAe,GACvCznB,KAAK4uB,MAAM9sB,SAASwnB,SAASxD,EAAI,KACjC9lB,KAAK4uB,MAAMnH,aAAa,MAAOsF,GAC/B2B,EAAO/G,YAAY3nB,KAAK4uB,MAE1B,G,WC7dFzvB,OAAOC,kBAAkB,iBAAkB,CAEzCC,OAAQ,CACNgwB,UAAW,CAAC7vB,QAAS,GACrB8vB,SAAU,CAAC9vB,QAAS,GACpB+vB,MAAO,CAAC/vB,QAAS,GACjBgwB,QAAS,CAAChwB,QAAS,KAGrBO,OAEEC,KAAKyvB,KAAO,GAEZ,IAAK,IAAIzlB,EAAK,EAAGA,EAAKhK,KAAKqB,KAAKguB,UAAWrlB,IAAM,CAC/C,MAAM0lB,EAAM5e,SAAS0W,cAAc,YACnCkI,EAAIjI,aAAa,aAAc,CAACkI,UAAW3lB,IAC3C,MAAMylB,EAAOzvB,KAAKqB,KAAKguB,UACvBK,EAAI5tB,SAASwnB,SAAS1D,GAAK5b,GAAMylB,EAAO,GAAK,IAAMzvB,KAAKqB,KAAKkuB,MAAQvvB,KAAKqB,KAAKguB,WAC/ErvB,KAAKG,GAAGwnB,YAAY+H,GACpB1vB,KAAKyvB,KAAK3lB,KAAK4lB,EACjB,CAEA1vB,KAAK4vB,UAAY5vB,KAAK4vB,UAAU1vB,KAAKF,MAErCA,KAAKG,GAAG4oB,QAAQ3oB,iBAAiB,aAAcJ,KAAK4vB,UAEtD,EAEAA,UAAUtmB,GAER,MAAMjI,EAAOiI,EAAEumB,QACT,UAACF,EAAS,UAAE7T,EAAS,OAAEE,GAAU3a,EAEvCE,QAAQkH,IAAI,aAAcpH,GAE1B,MAAMquB,EAAM1vB,KAAKyvB,KAAKE,GAEtB,IAAKD,EAAK,OAEV,IAAII,EAGFA,EADEhU,EACOE,EAAS,SAAW,OAGpB,QAEX0T,EAAIjI,aAAa,aAAc,CAACkI,UAAWA,EACXG,OAAQA,EACRC,UAAW1uB,EAAK0uB,UAAY,IAC5BC,SAAU3uB,EAAK2uB,SAAW,IAC1B9E,MAAqB,KAAb7pB,EAAK6pB,MACb+E,OAAQ5uB,EAAK4uB,OAAS,IACtBC,UAAW7uB,EAAK6uB,UAChBC,YAAa9uB,EAAK+uB,YAClBC,YAAahvB,EAAKgvB,aACpD,IAGF,MAAMC,EAAc,CAClB,CAACtqB,IAAK,YAAauqB,MAAO,OAAQC,MAAO,KACzC,CAACxqB,IAAK,WAAYuqB,MAAO,OAAQC,MAAO,KACxC,CAACxqB,IAAK,QAASuqB,MAAO,OAAQC,MAAO,MACrC,CAACxqB,IAAK,SAAUuqB,MAAO,OAAQC,MAAO,MAGxCrxB,OAAOC,kBAAkB,aAAc,CACrCC,OAAQ,CACNswB,UAAW,CAAEpwB,KAAM,UACnBuwB,OAAQ,CAAEvwB,KAAM,SAAUC,QAAS,QACnCuwB,UAAW,CAACxwB,KAAM,UAClBywB,SAAU,CAACzwB,KAAM,UACjB2rB,MAAO,CAAC3rB,KAAM,UACd0wB,OAAQ,CAAC1wB,KAAM,UACf2wB,UAAW,CAAC3wB,KAAM,UAClB6wB,YAAa,CAAC7wB,KAAM,UACpB8wB,YAAa,CAAC9wB,KAAM,WAGtBQ,OAEEC,KAAKguB,OAASld,SAAS0W,cAAc,YACrCxnB,KAAKguB,OAAOvG,aAAa,SAAU,IACnCznB,KAAKguB,OAAOvG,aAAa,WAAY,CAAChoB,QAAS,GAAK6C,aAAa,IACjEtC,KAAKguB,OAAOlsB,SAASwnB,SAASzD,EAAI,GAClC7lB,KAAKG,GAAGwnB,YAAY3nB,KAAKguB,QAEzBhuB,KAAKywB,OAAS3f,SAAS0W,cAAc,YACrCxnB,KAAKywB,OAAOhJ,aAAa,OAAQ,CAACnoB,MAAO,QACPoxB,UAAW,EACXzqB,MAAOjG,KAAKqB,KAAKsuB,UAAY,EAC7BgB,MAAO,WACzC3wB,KAAKguB,OAAOrG,YAAY3nB,KAAKywB,QAE7BzwB,KAAK4wB,WAAa,EACpB,EAEAhwB,SAIE,IAAIiwB,EAFJ7wB,KAAKiuB,cAGL,MAAM6B,EAAS9vB,KAAKqB,KAAKyuB,OACV,SAAXA,IACFe,EAAS,UAEI,WAAXf,IACFe,EAAS,UAEPA,GACF7wB,KAAKkuB,YAAYluB,KAAKguB,OAAQ6C,EAAQ,IAItC7wB,KAAKywB,OAAO3uB,SAASE,QADR,SAAX8tB,GAAgC,UAAXA,EAOzB9vB,KAAK8wB,oBAELR,EAAYnjB,SAAQ,CAACoR,EAAMrb,KACzB,MAAM,IAAC8C,EAAG,MAAEwqB,GAASjS,EAErB,GAAIve,KAAKqB,KAAK2E,GAAM,CAClB,MAAM+qB,EAAQjgB,SAAS0W,cAAc,YACrCuJ,EAAMtJ,aAAa,kBAAmB,CACpCxhB,MAAOjG,KAAKqB,KAAK2E,GACjBwnB,MAAO,GAAe,GAARtqB,EACdstB,MAAOA,IAETxwB,KAAKG,GAAGwnB,YAAYoJ,GACpB/wB,KAAK4wB,WAAW9mB,KAAKinB,EACvB,IAEJ,EAEAD,oBACE9wB,KAAK4wB,WAAWzjB,SAAShN,IACvBA,EAAGinB,WAAWC,YAAYlnB,EAAE,IAE9BH,KAAK4wB,WAAa,EACpB,EAEA1C,YAAYQ,EAAQ3B,EAAK4B,GAEvB3uB,KAAK4uB,MAAQ9d,SAAS0W,cAAc,WACpCxnB,KAAK4uB,MAAMnH,aAAa,aAAc,IACtCznB,KAAK4uB,MAAMnH,aAAa,QAASkH,GACjC3uB,KAAK4uB,MAAMnH,aAAa,SAAUkH,GAClC3uB,KAAK4uB,MAAMnH,aAAa,eAAe,GACvCznB,KAAK4uB,MAAM9sB,SAASwnB,SAASxD,EAAI,KACjC9lB,KAAK4uB,MAAMnH,aAAa,MAAOsF,GAC/B2B,EAAO/G,YAAY3nB,KAAK4uB,MAE1B,EAEAX,cAEMjuB,KAAK4uB,QACP5uB,KAAK4uB,MAAMxH,WAAWC,YAAYrnB,KAAK4uB,OACvC5uB,KAAK4uB,MAAQ,KAEjB,IAIFzvB,OAAOC,kBAAkB,kBAAmB,CAC1CC,OAAQ,CACN4G,MAAO,CAAE1G,KAAM,UACfiuB,KAAM,CAACjuB,KAAM,UACbixB,MAAO,CAACjxB,KAAM,WAGhBQ,OAEEC,KAAKguB,OAASld,SAAS0W,cAAc,YACrCxnB,KAAKguB,OAAOvG,aAAa,SAAU,IACnCznB,KAAKguB,OAAOvG,aAAa,WAAY,CAAChoB,QAAS,GAAK6C,aAAa,EAAMhD,MAAO,UAC9EU,KAAKguB,OAAOlsB,SAASwnB,SAASzD,EAAI7lB,KAAKqB,KAAKmsB,KAC5CxtB,KAAKG,GAAGwnB,YAAY3nB,KAAKguB,QAEzBhuB,KAAKywB,OAAS3f,SAAS0W,cAAc,YAErCxnB,KAAKguB,OAAOrG,YAAY3nB,KAAKywB,OAC/B,EAEA7vB,SACE,MAAMowB,EAAahxB,KAAKqB,KAAK4E,MAAMgrB,QAAQ,GAAKjxB,KAAKqB,KAAKmvB,MAC1DxwB,KAAKywB,OAAOrB,gBAAgB,QAC5BpvB,KAAKywB,OAAOhJ,aAAa,OAAQ,CAACnoB,MAAO,QACPoxB,UAAW,GACXzqB,MAAO+qB,EACPL,MAAO,WAErC3wB,KAAKqB,KAAK4E,MAAQ,EACpBjG,KAAKguB,OAAOvG,aAAa,WAAY,CAACnoB,MAAO,WAG7CU,KAAKguB,OAAOvG,aAAa,WAAY,CAACnoB,MAAO,SAEjD,G,iDCvMF,GAAIoK,OAAOwnB,SAASC,KAAKC,SAAS,cAAe,CAC/C,MAAMC,EAAO,IAAI,KAEXC,EAAOD,EAAKE,QAAQ,sBAC1BD,EAAKE,GAAG,QAAQ,KACdF,EAAKtZ,KAAK,OACVzW,QAAQkH,IAAI,cAAa,IAG3BgpB,UAAUC,aAAaC,aAAa,CAACrF,OAAO,EAAMsF,OAAO,IACxD1T,MAAM5T,IACM+mB,EAAKQ,KAAK,qBAAsBvnB,GACtCknB,GAAG,SAAUM,YAAY,IAE/BC,OAAOC,IACNzwB,QAAQkH,IAAI,6BAA8BupB,EAAI,GAGlD,C,WCrBA7yB,OAAO8yB,iBAAiB,YAAa,CAEnC5yB,OAAQ,CACNA,OAAQ,CACNkwB,MAAO,CAAC/vB,QAAS,GACjB0rB,MAAO,CAAC1rB,QAAS,GACjB0yB,YAAa,CAAC1yB,QAAS,KACvB2yB,WAAY,CAAC3yB,QAAS,KACtB4yB,WAAY,CAAC5yB,QAAS,KACtB6yB,gBAAiB,CAAC7yB,QAAS,KAC3B8yB,gBAAiB,CAAC9yB,QAAS,KAC3B+yB,UAAW,CAAC/yB,QAAS,KACrBgzB,WAAY,CAAChzB,QAAS,KACtBizB,aAAc,CAACjzB,QAAS,KACxBkzB,aAAc,CAAClzB,QAAS,OAI5BO,KAAKsB,GACH,MAAMsxB,EAAa,GACnB,IAAIpyB,EAKJA,EAAW,IAAIG,MAAMkyB,YAAYvxB,EAAK+wB,WAAY/wB,EAAK8wB,WAAY9wB,EAAK+wB,YACxE7xB,EAASsyB,WAAWxxB,EAAKkuB,MAAQ,EAAGluB,EAAK8wB,WAAa,EAAG9wB,EAAK6pB,MAAQ,GACtEyH,EAAW7oB,KAAKvJ,GAGhBA,EAAW,IAAIG,MAAMkyB,YAAYvxB,EAAK+wB,WAAY/wB,EAAK8wB,WAAY9wB,EAAK+wB,YACxE7xB,EAASsyB,UAAUxxB,EAAKkuB,MAAQ,EAAGluB,EAAK8wB,WAAa,EAAG9wB,EAAK6pB,MAAQ,GACrEyH,EAAW7oB,KAAKvJ,GAGhBA,EAAW,IAAIG,MAAMkyB,YAAYvxB,EAAK+wB,WAAY/wB,EAAK6wB,YAAa7wB,EAAK+wB,YACzE7xB,EAASsyB,WAAWxxB,EAAKkuB,MAAQ,EAAGluB,EAAK6wB,YAAc,GAAI7wB,EAAK6pB,MAAQ,GACxEyH,EAAW7oB,KAAKvJ,GAGhBA,EAAW,IAAIG,MAAMkyB,YAAYvxB,EAAK+wB,WAAY/wB,EAAK6wB,YAAa7wB,EAAK+wB,YACzE7xB,EAASsyB,UAAUxxB,EAAKkuB,MAAQ,EAAGluB,EAAK6wB,YAAc,GAAI7wB,EAAK6pB,MAAQ,GACvEyH,EAAW7oB,KAAKvJ,GAIhBA,EAAW,IAAIG,MAAMoyB,iBAAiBzxB,EAAKgxB,gBACLhxB,EAAKgxB,gBACLhxB,EAAKkxB,WAC3ChyB,EAASwyB,QAAQ3tB,KAAKikB,GAAG,GACzB9oB,EAASsyB,WAAWxxB,EAAKkuB,MAAQ,EAAGluB,EAAKmxB,YAAanxB,EAAK6pB,MAAQ,EAAI7pB,EAAKkxB,UAAY,GACxFI,EAAW7oB,KAAKvJ,GAEhBA,EAAW,IAAIG,MAAMoyB,iBAAiBzxB,EAAKixB,gBACLjxB,EAAKixB,gBACL,KACA/xB,EAASwyB,QAAQ3tB,KAAKikB,GAAG,GAC/D9oB,EAASsyB,WAAWxxB,EAAKkuB,MAAQ,EAAGluB,EAAKmxB,YAAanxB,EAAK6pB,MAAQ,EAAI7pB,EAAKkxB,WAC5EI,EAAW7oB,KAAKvJ,GAGhBA,EAAW,IAAIG,MAAMoyB,iBAAiBzxB,EAAKgxB,gBACLhxB,EAAKgxB,gBACLhxB,EAAKkxB,WAC3ChyB,EAASwyB,QAAQ3tB,KAAKikB,GAAG,GACzB9oB,EAASsyB,UAAUxxB,EAAKkuB,MAAQ,EAAGluB,EAAKmxB,YAAanxB,EAAK6pB,MAAQ,EAAI7pB,EAAKkxB,UAAY,GACvFI,EAAW7oB,KAAKvJ,GAEhBA,EAAW,IAAIG,MAAMoyB,iBAAiBzxB,EAAKixB,gBACLjxB,EAAKixB,gBACL,KACA/xB,EAASwyB,QAAQ3tB,KAAKikB,GAAG,GAC/D9oB,EAASsyB,UAAUxxB,EAAKkuB,MAAQ,EAAGluB,EAAKmxB,YAAanxB,EAAK6pB,MAAQ,EAAI7pB,EAAKkxB,WAC3EI,EAAW7oB,KAAKvJ,GAGhBA,EAAW,IAAIG,MAAMoyB,iBAAiBzxB,EAAKqxB,aACLrxB,EAAKqxB,aACLrxB,EAAK6pB,OAC3C3qB,EAASwyB,QAAQ3tB,KAAKikB,GAAG,GACzB9oB,EAASsyB,WAAWxxB,EAAKkuB,MAAQ,EAAGluB,EAAKoxB,aAAc,GACvDE,EAAW7oB,KAAKvJ,GAGhBA,EAAW,IAAIG,MAAMoyB,iBAAiBzxB,EAAKqxB,aACLrxB,EAAKqxB,aACLrxB,EAAK6pB,OAC3C3qB,EAASwyB,QAAQ3tB,KAAKikB,GAAG,GACzB9oB,EAASsyB,UAAUxxB,EAAKkuB,MAAQ,EAAGluB,EAAKoxB,aAAc,GACtDE,EAAW7oB,KAAKvJ,GAEhBP,KAAKO,SAAWG,MAAMsyB,oBAAoBC,sBAAsBN,EAClE,IAIFxzB,OAAOC,kBAAkB,aAAc,CAErCC,OAAQ,CACNkwB,MAAO,CAAC/vB,QAAS,GACjB0rB,MAAO,CAAC1rB,QAAS,GACjB0yB,YAAa,CAAC1yB,QAAS,KACvB2yB,WAAY,CAAC3yB,QAAS,KACtB4yB,WAAY,CAAC5yB,QAAS,KACtB6yB,gBAAiB,CAAC7yB,QAAS,KAC3B8yB,gBAAiB,CAAC9yB,QAAS,KAC3B+yB,UAAW,CAAC/yB,QAAS,KACrBgzB,WAAY,CAAChzB,QAAS,KACtBizB,aAAc,CAACjzB,QAAS,KACxBkzB,aAAc,CAAClzB,QAAS,MAG1BO,OAEEC,KAAKG,GAAGsnB,aAAa,WAAY,CAACyL,UAAW,YACX3D,MAAOvvB,KAAKqB,KAAKkuB,MACjBrE,MAAOlrB,KAAKqB,KAAK6pB,MACjBgH,YAAalyB,KAAKqB,KAAK6wB,YACvBC,WAAYnyB,KAAKqB,KAAK8wB,WACtBC,WAAYpyB,KAAKqB,KAAK+wB,WACtBC,gBAAiBryB,KAAKqB,KAAKgxB,gBAC3BC,gBAAiBtyB,KAAKqB,KAAKixB,gBAC3BC,UAAWvyB,KAAKqB,KAAKkxB,UACrBC,WAAYxyB,KAAKqB,KAAKmxB,WACtBC,aAAczyB,KAAKqB,KAAKoxB,aACxBC,aAAc1yB,KAAKqB,KAAKqxB,eAE1D1yB,KAAKG,GAAGsnB,aAAa,WAAY,CAACnoB,MAAO,QAC3C,G,UC/HFH,OAAOC,kBAAkB,aAAc,CAErCW,OACEC,KAAKmW,MAAQ,CACXgd,YAAY,EACZC,QAAQ,GAGVpzB,KAAKqzB,oBAAsBrzB,KAAKqzB,oBAAoBnzB,KAAKF,MACzDA,KAAKszB,YAActzB,KAAKszB,YAAYpzB,KAAKF,MACzCA,KAAKuzB,WAAavzB,KAAKuzB,WAAWrzB,KAAKF,MACvCA,KAAKG,GAAGC,iBAAiB,uBAAwBJ,KAAKqzB,qBACtDrzB,KAAKG,GAAGC,iBAAiB,eAAgBJ,KAAKszB,aAC9CtzB,KAAKG,GAAGC,iBAAiB,cAAeJ,KAAKuzB,YAG7CvzB,KAAK8rB,cAAgBhb,SAASib,eAAe,kBAC7C/rB,KAAKwzB,aAAe1iB,SAASib,eAAe,kBAC5C/rB,KAAKyzB,cAAgB3iB,SAASib,eAAe,mBAC7C/rB,KAAK0zB,OAAS5iB,SAASib,eAAe,UACtC/rB,KAAK2zB,WAAa7iB,SAASib,eAAe,eAE1C/rB,KAAK4zB,WACP,EAEAP,sBACErzB,KAAKmW,MAAMgd,YAAa,EACxBnzB,KAAK4zB,WACP,EAEAN,cACEtzB,KAAKmW,MAAMid,QAAS,EACpBpzB,KAAK4zB,WACP,EAEAL,aACEvzB,KAAKmW,MAAMid,QAAS,EACpBpzB,KAAK4zB,WACP,EAEAA,YAEEC,iBAAmB,CAAC1zB,EAAI6B,KAClB7B,GAAMA,EAAG2B,WACX3B,EAAG2B,SAASE,QAAUA,EACxB,EAGEhC,KAAKmW,MAAMgd,YAETnzB,KAAKmW,MAAMid,QACbS,iBAAiB7zB,KAAK8rB,eAAe,GACrC+H,iBAAiB7zB,KAAKwzB,cAAc,GACpCK,iBAAiB7zB,KAAKyzB,eAAe,KAGrCI,iBAAiB7zB,KAAK8rB,eAAe,GACrC+H,iBAAiB7zB,KAAKwzB,cAAc,GACpCK,iBAAiB7zB,KAAKyzB,eAAe,IAGvCI,iBAAiB7zB,KAAK0zB,QAAQ,KAG9BG,iBAAiB7zB,KAAK8rB,eAAe,GACrC+H,iBAAiB7zB,KAAKwzB,cAAc,GACpCK,iBAAiB7zB,KAAKyzB,eAAe,GACrCI,iBAAiB7zB,KAAK0zB,QAAQ,IAG5B1zB,KAAKmW,MAAMid,OACbS,iBAAiB7zB,KAAK2zB,YAAY,GAGlCE,iBAAiB7zB,KAAK2zB,YAAY,EAEtC,G,WCzEFx0B,OAAOC,kBAAkB,aAAc,CAErCsmB,aAAc,CAAC,eAAgB,eAE/B3lB,OAEEC,KAAK0rB,aAAe1rB,KAAK0rB,aAAaxrB,KAAKF,MAC3CA,KAAK8zB,UAAY9zB,KAAK8zB,UAAU5zB,KAAKF,MACrCA,KAAK+zB,cAAgB/zB,KAAK+zB,cAAc7zB,KAAKF,MAC7CA,KAAKg0B,YAAch0B,KAAKg0B,YAAY9zB,KAAKF,MACzCA,KAAKi0B,OAASj0B,KAAKi0B,OAAO/zB,KAAKF,MAC/BA,KAAKk0B,eAAiBl0B,KAAKk0B,eAAeh0B,KAAKF,MAC/CA,KAAKm0B,eAAiBn0B,KAAKm0B,eAAej0B,KAAKF,MAC/CA,KAAKo0B,uBAAyBp0B,KAAKo0B,uBAAuBl0B,KAAKF,MAC/DA,KAAK0mB,gBAAkB1mB,KAAK0mB,gBAAgBxmB,KAAKF,MACjDA,KAAKq0B,UAAYr0B,KAAKq0B,UAAUn0B,KAAKF,MAErCA,KAAKG,GAAGC,iBAAiB,gBAAiBJ,KAAK0rB,cAC/C1rB,KAAKG,GAAGC,iBAAiB,aAAcJ,KAAK8zB,WAC5C9zB,KAAKG,GAAGC,iBAAiB,iBAAkBJ,KAAK+zB,eAChD/zB,KAAKG,GAAGC,iBAAiB,eAAgBJ,KAAKg0B,aAC9Ch0B,KAAKG,GAAGC,iBAAiB,UAAWJ,KAAKi0B,QACzCj0B,KAAKG,GAAGC,iBAAiB,mBAAoBJ,KAAKk0B,gBAClDl0B,KAAKG,GAAGC,iBAAiB,mBAAoBJ,KAAKm0B,gBAClDn0B,KAAKG,GAAGC,iBAAiB,4BAA6BJ,KAAKo0B,wBAC3Dp0B,KAAKG,GAAGC,iBAAiB,oBAAqBJ,KAAK0mB,iBACnD1mB,KAAKG,GAAGC,iBAAiB,aAAcJ,KAAKq0B,WAE5Cr0B,KAAKmW,MAAQ,CACXme,SAAU,OACV3E,UAAW,EACXL,SAAU,EACViF,QAAQ,EACRC,iBAAkB,KAGpBx0B,KAAKy0B,WAAa,CAChBC,kBAAc9kB,EACd+kB,cAAU/kB,EACVglB,cAAUhlB,EACVilB,eAAWjlB,EACXklB,iBAAallB,GAGf5P,KAAKwzB,aAAe1iB,SAAS4W,cAAc,mBAC3C1nB,KAAKyzB,cAAgB3iB,SAAS4W,cAAc,oBAE5C1nB,KAAK+0B,QAAU,CACbpF,UAAW,EACX7T,WAAW,EACXE,QAAQ,EACR+T,eAAWngB,EACXogB,cAAUpgB,EACVsb,WAAOtb,EACPqgB,YAAQrgB,EACRsgB,eAAWtgB,EACXwgB,iBAAaxgB,EACbygB,iBAAazgB,EAEjB,EAEArN,SACEvC,KAAKG,GAAGqC,oBAAoB,gBAAiBxC,KAAK0rB,cAClD1rB,KAAKG,GAAGqC,oBAAoB,aAAcxC,KAAK8zB,WAC/C9zB,KAAKG,GAAGqC,oBAAoB,iBAAkBxC,KAAK+zB,eACnD/zB,KAAKG,GAAGqC,oBAAoB,eAAgBxC,KAAKg0B,aACjDh0B,KAAKG,GAAGqC,oBAAoB,UAAWxC,KAAKi0B,QAC5Cj0B,KAAKG,GAAGqC,oBAAoB,mBAAoBxC,KAAKk0B,gBACrDl0B,KAAKG,GAAGqC,oBAAoB,mBAAoBxC,KAAKm0B,gBACrDn0B,KAAKG,GAAGqC,oBAAoB,4BAA6BxC,KAAKo0B,wBAC9Dp0B,KAAKG,GAAGqC,oBAAoB,oBAAqBxC,KAAK0mB,iBACtD1mB,KAAKG,GAAGqC,oBAAoB,aAAcxC,KAAKq0B,UACjD,EAEAW,cAAcC,GAEZj1B,KAAKmW,MAAMmZ,SAAW2F,EACtBj1B,KAAKwzB,aAAa/L,aAAa,iBAAkB,CAAC6H,SAAUtvB,KAAKmW,MAAMmZ,UACzE,EAEA4F,aAAaC,GAGGn1B,KAAKG,GAAG4oB,QAAQC,WAAW,cAAc7S,MAC5Cgd,aAEXnzB,KAAKy0B,WAAWK,YAActtB,KAAK4tB,MAEnCp1B,KAAK+0B,QAAQjZ,WAAY,EACzB9b,KAAK+0B,QAAQ/Y,QAAUmZ,EACvBn1B,KAAK+0B,QAAQpF,UAAY3vB,KAAKmW,MAAMwZ,UACpC3vB,KAAK+0B,QAAQ9E,OAASjwB,KAAKy0B,WAAWK,YAAc90B,KAAKy0B,WAAWI,UACpE70B,KAAKq1B,YAELr1B,KAAKmW,MAAMmZ,WACXtvB,KAAKmW,MAAMwZ,YACX3vB,KAAKwzB,aAAa/L,aAAa,iBAAkB,CAAC6H,SAAUtvB,KAAKmW,MAAMmZ,WAGvEtvB,KAAKmW,MAAMqe,iBAAmB,IAC9Bx0B,KAAKy0B,WAAWC,aAAeltB,KAAK4tB,MACtC,EAEAC,YACgBr1B,KAAKG,GAAG4oB,QAAQC,WAAW,cAAc7S,MAC5Cgd,YACXnzB,KAAKG,GAAGgoB,KAAK,aAAcnoB,KAAK+0B,QAClC,EAEArJ,eACE1rB,KAAKs1B,WAAW,qBAClB,EAEAxB,YAEA,EAEAC,gBACE/zB,KAAKs1B,WAAW,YAClB,EAEAtB,cACEh0B,KAAKs1B,WAAW,YAClB,EAEAA,WAAW9F,GACTxvB,KAAKwzB,aAAa/L,aAAa,iBAAkB,CAAC+H,QAASA,GAC7D,EAEAyE,SAGE,OAAQj0B,KAAKmW,MAAMme,UAEjB,IAAK,OACHt0B,KAAKmW,MAAMme,SAAW,QACtBt0B,KAAKs1B,WAAW,UAChBt1B,KAAKqsB,WAAW,qBAEhBrsB,KAAKy0B,WAAWC,aAAeltB,KAAK4tB,MACpC,MAEF,IAAK,OACHp1B,KAAKmW,MAAMme,SAAW,OACtBt0B,KAAKs1B,WAAW,kBAChBt1B,KAAKqsB,WAAW,oBAGhBrsB,KAAK+0B,QAAQpF,UAAY3vB,KAAKmW,MAAMwZ,UACpC,MAAM3J,EAAchmB,KAAKG,GAAG4oB,QAAQC,WAAW,eAAe3nB,KAAK2kB,YACnEhmB,KAAK+0B,QAAQ7J,MAAQlrB,KAAKmW,MAAMqe,iBAAmBxO,EACnDhmB,KAAKq1B,YAGLr1B,KAAKmW,MAAMqe,iBAAmB,IAC9B,MAEF,IAAK,KACHx0B,KAAKmW,MAAMme,SAAW,OACtBt0B,KAAKs1B,WAAW,gBAChBt1B,KAAKk1B,cAAa,GACU,IAAxBl1B,KAAKmW,MAAMmZ,UACbtvB,KAAKqsB,WAAW,mBAChBrsB,KAAKmW,MAAMoe,QAAS,GAEW,IAAxBv0B,KAAKmW,MAAMmZ,SAClBtvB,KAAKqsB,WAAW,mBAGhBrsB,KAAKqsB,WAAW,eAElB,MAEF,QACE9qB,QAAQ+d,MAAM,gCAAiCtf,KAAKmW,MAAMme,UAEhE,EAEAJ,iBAGE,OAAQl0B,KAAKmW,MAAMme,UAEjB,IAAK,OACHt0B,KAAKs1B,WAAW,sCAChB,MAEF,IAAK,QACL,IAAK,OACHt1B,KAAKmW,MAAMme,SAAW,OACtBt0B,KAAKs1B,WAAW,iBAChBt1B,KAAKy0B,WAAWE,SAAWntB,KAAK4tB,MAGhCp1B,KAAK+0B,QAAQpF,UAAY3vB,KAAKmW,MAAMwZ,UACpC3vB,KAAK+0B,QAAQjZ,WAAY,EACzB9b,KAAK+0B,QAAQ/Y,QAAS,EACtBhc,KAAK+0B,QAAQhF,UAAY/vB,KAAKy0B,WAAWE,SAAW30B,KAAKy0B,WAAWC,aACpE10B,KAAK+0B,QAAQ/E,cAAWpgB,EACxB5P,KAAK+0B,QAAQ7J,WAAQtb,EACrB5P,KAAK+0B,QAAQ9E,YAASrgB,EACtB5P,KAAK+0B,QAAQ7E,eAAYtgB,EACzB5P,KAAK+0B,QAAQ3E,iBAAcxgB,EAC3B5P,KAAK+0B,QAAQ1E,iBAAczgB,EAC3B5P,KAAKq1B,YACL,MAEF,IAAK,KACHr1B,KAAKs1B,WAAW,8CAChB,MAEF,QACE/zB,QAAQ+d,MAAM,yCAA0Ctf,KAAKmW,MAAMme,UAGzE,EAEAH,iBAGE,OAAQn0B,KAAKmW,MAAMme,UAEjB,IAAK,OACHt0B,KAAKs1B,WAAW,8CAChB,MAEF,IAAK,OACHt1B,KAAKs1B,WAAW,cAChBt1B,KAAKosB,QAAQ,kBACbpsB,KAAKmW,MAAMme,SAAW,KACtBt0B,KAAKy0B,WAAWG,SAAWptB,KAAK4tB,MAEhCp1B,KAAK+0B,QAAQ/E,SAAWhwB,KAAKy0B,WAAWG,SAAW50B,KAAKy0B,WAAWE,SACnE30B,KAAKq1B,YACL,MAEF,IAAK,KACHr1B,KAAKs1B,WAAW,iCAChB,MAEF,QACE/zB,QAAQ+d,MAAM,yCAA0Ctf,KAAKmW,MAAMme,UAEzE,EAEAF,yBAGE,GAEO,OAFCp0B,KAAKmW,MAAMme,SAEjB,CAEE,MAAMtO,EAAchmB,KAAKG,GAAG4oB,QAAQC,WAAW,eAAe3nB,KAAK2kB,YACnEhmB,KAAK+0B,QAAQ7J,MAAQlrB,KAAKmW,MAAMqe,iBAAmBxO,EACnDhmB,KAAKq1B,WAEL,MAGA9zB,QAAQ+d,MAAM,kDAAmDtf,KAAKmW,MAAMme,SAElF,EAEA5N,kBAEE1mB,KAAKs1B,WAAW,mEAElB,EAEAjB,YACEr0B,KAAKk1B,cAAa,GAClBl1B,KAAKs1B,WAAW,mEAClB,EAEAjJ,WAAWU,GAIT,IADc/sB,KAAKG,GAAG4oB,QAAQC,WAAW,cAAc7S,MAC5Cgd,WAAY,OAGvB,GAAInzB,KAAKmW,MAAMoe,OAAQ,OAEvB,MAAMzH,EAAShc,SAASib,eAAe,gBAEvCe,EAAOsC,gBAAgB,SACvBtC,EAAOrF,aAAa,QAAS,CAACsF,IAAKA,EAAKC,UAAU,GACpD,EAEAZ,QAAQW,GAIN,IADc/sB,KAAKG,GAAG4oB,QAAQC,WAAW,cAAc7S,MAC5Cgd,WAAY,OAEvB,MAAMrG,EAAShc,SAASib,eAAe,cAEvCe,EAAOrF,aAAa,QAAS,CAACsF,IAAK,GAAIC,UAAU,IACjDF,EAAOrF,aAAa,QAAS,CAACsF,IAAKA,EAAKC,UAAU,GACpD,EAEAlE,OACEjB,YAAc7nB,KAAKG,GAAG4oB,QAAQC,WAAW,gBAAgBnB,YAErDA,YAAYhC,EAAI7lB,KAAKmW,MAAMqe,mBAC7Bx0B,KAAKmW,MAAMqe,iBAAmB3M,YAAYhC,EAC1C7lB,KAAKy0B,WAAWI,UAAYrtB,KAAK4tB,MAErC,G,WCxTFj2B,OAAOC,kBAAkB,oBAAqB,CAE5CW,OAEEC,KAAKu1B,iBAAmB,EACxBv1B,KAAKw1B,qBAAuB,EAE5Bx1B,KAAKy1B,QAAUz1B,KAAKy1B,QAAQv1B,KAAKF,MACjCA,KAAK01B,MAAQ11B,KAAK01B,MAAMx1B,KAAKF,MAE7B0J,OAAOtJ,iBAAiB,UAAWJ,KAAKy1B,SACxC/rB,OAAOtJ,iBAAiB,QAASJ,KAAK01B,MACxC,EAEAD,QAAQnsB,GAEQ,MAAVA,EAAEtD,MACJhG,KAAKw1B,sBAAwB,GAGjB,MAAVlsB,EAAEtD,MACJhG,KAAKw1B,sBAAwB,EAEjC,EAEAE,MAAMpsB,GAEU,MAAVA,EAAEtD,KAAyB,MAAVsD,EAAEtD,MACrBhG,KAAKu1B,iBAAmB,EACxBv1B,KAAKw1B,qBAAuB,EAEhC,EAEA1M,KAAKxT,EAAGqgB,GAENC,SAAWD,EAAK31B,KAAKw1B,qBAAuB,IAC5Cx1B,KAAKu1B,kBAAoBK,SACrB51B,KAAKu1B,iBAAmB,IAAGv1B,KAAKu1B,iBAAmB,GACnDv1B,KAAKu1B,kBAAoB,IAAGv1B,KAAKu1B,kBAAoB,GAEzDM,OAASF,EAAK31B,KAAKu1B,iBAAmB,IACtCv1B,KAAKG,GAAG2B,SAASwnB,SAASzD,GAAKgQ,MACjC,G,iDCvCF,IAAKnsB,OAAOwnB,SAASC,KAAKC,SAAS,cAAe,CAEhD,MAAMC,EAAO,IAAI,KAAK,sBAEtBA,EAAKG,GAAG,cAAeF,IACrBA,EAAKE,GAAG,QAASnwB,IAEfE,QAAQkH,IAAIpH,EAAK,IAEnBiwB,EAAKE,GAAG,QAAQ,KACdF,EAAKtZ,KAAK,SAAS,GACnB,IAGJqZ,EAAKG,GAAG,QAAQK,IAEUA,EAAKtjB,OAAO,MAGpBijB,GAAG,UAAUlnB,IAC3BA,EAAOwK,YAAY3H,SAAQ9B,IACzBA,EAAM8J,SAAU,CAAK,GACrB,GACF,GAEN,C,0vCClBA,IAAI2gB,GAAe,EACfC,GAAuB,EAUpB,SAASC,EAAeC,EAAUC,EAAM3I,GAC7C,MAAM4I,EAAQF,EAASE,MAAMD,GAC7B,OAAOC,GAASA,EAAM7yB,QAAUiqB,GAAOlhB,SAAS8pB,EAAM5I,GAAM,GAC9D,CAKO,SAAS6I,EAAwB1sB,EAAQ2sB,EAAiBC,GAC/D,IAAK5sB,EAAOiH,kBACV,OAEF,MAAM4lB,EAAQ7sB,EAAOiH,kBAAkB9M,UACjC2yB,EAAyBD,EAAMn2B,iBACrCm2B,EAAMn2B,iBAAmB,SAASq2B,EAAiBC,GACjD,GAAID,IAAoBJ,EACtB,OAAOG,EAAuB7X,MAAM3e,KAAMuc,WAE5C,MAAMoa,EAAmBrtB,IACvB,MAAMstB,EAAgBN,EAAQhtB,GAC1BstB,IACEF,EAAGG,YACLH,EAAGG,YAAYD,GAEfF,EAAGE,GAEP,EAOF,OALA52B,KAAK82B,UAAY92B,KAAK82B,WAAa,CAAC,EAC/B92B,KAAK82B,UAAUT,KAClBr2B,KAAK82B,UAAUT,GAAmB,IAAIhY,KAExCre,KAAK82B,UAAUT,GAAiB7X,IAAIkY,EAAIC,GACjCH,EAAuB7X,MAAM3e,KAAM,CAACy2B,EACzCE,GACJ,EAEA,MAAMI,EAA4BR,EAAM/zB,oBACxC+zB,EAAM/zB,oBAAsB,SAASi0B,EAAiBC,GACpD,GAAID,IAAoBJ,IAAoBr2B,KAAK82B,YACzC92B,KAAK82B,UAAUT,GACrB,OAAOU,EAA0BpY,MAAM3e,KAAMuc,WAE/C,IAAKvc,KAAK82B,UAAUT,GAAiBW,IAAIN,GACvC,OAAOK,EAA0BpY,MAAM3e,KAAMuc,WAE/C,MAAM0a,EAAcj3B,KAAK82B,UAAUT,GAAiBnjB,IAAIwjB,GAQxD,OAPA12B,KAAK82B,UAAUT,GAAiBa,OAAOR,GACM,IAAzC12B,KAAK82B,UAAUT,GAAiBvyB,aAC3B9D,KAAK82B,UAAUT,GAEmB,IAAvCjvB,OAAO2B,KAAK/I,KAAK82B,WAAWxzB,eACvBtD,KAAK82B,UAEPC,EAA0BpY,MAAM3e,KAAM,CAACy2B,EAC5CQ,GACJ,EAEA7vB,OAAO4L,eAAeujB,EAAO,KAAOF,EAAiB,CACnDnjB,MACE,OAAOlT,KAAK,MAAQq2B,EACtB,EACA7X,IAAIkY,GACE12B,KAAK,MAAQq2B,KACfr2B,KAAKwC,oBAAoB6zB,EACrBr2B,KAAK,MAAQq2B,WACVr2B,KAAK,MAAQq2B,IAElBK,GACF12B,KAAKI,iBAAiBi2B,EAClBr2B,KAAK,MAAQq2B,GAAmBK,EAExC,EACAS,YAAY,EACZlkB,cAAc,GAElB,CAEO,SAASmkB,EAAWC,GACzB,MAAoB,kBAATA,EACF,IAAI/xB,MAAM,yBAA2B+xB,EACxC,4BAENvB,EAAeuB,EACR,EAAS,8BACZ,6BACN,CAMO,SAASC,EAAgBD,GAC9B,MAAoB,kBAATA,EACF,IAAI/xB,MAAM,yBAA2B+xB,EACxC,4BAENtB,GAAwBsB,EACjB,oCAAsCA,EAAO,WAAa,WACnE,CAEO,SAAS5uB,IACd,GAAsB,iBAAXiB,OAAqB,CAC9B,GAAIosB,EACF,OAEqB,oBAAZv0B,SAAkD,mBAAhBA,QAAQkH,KACnDlH,QAAQkH,IAAIkW,MAAMpd,QAASgb,UAE/B,CACF,CAKO,SAASgb,EAAWC,EAAWC,GAC/B1B,GAGLx0B,QAAQC,KAAKg2B,EAAY,8BAAgCC,EACrD,YACN,CA4DA,SAASC,EAASC,GAChB,MAA+C,oBAAxCvwB,OAAOvD,UAAUwD,SAASwqB,KAAK8F,EACxC,CAOO,SAASC,EAAcv2B,GAC5B,OAAKq2B,EAASr2B,GAIP+F,OAAO2B,KAAK1H,GAAMw2B,QAAO,SAASC,EAAa9xB,GACpD,MAAM+xB,EAAQL,EAASr2B,EAAK2E,IACtBC,EAAQ8xB,EAAQH,EAAcv2B,EAAK2E,IAAQ3E,EAAK2E,GAChDgyB,EAAgBD,IAAU3wB,OAAO2B,KAAK9C,GAAO3C,OACnD,YAAcsM,IAAV3J,GAAuB+xB,EAClBF,EAEF1wB,OAAO0P,OAAOghB,EAAa,CAAC,CAAC9xB,GAAMC,GAC5C,GAAG,CAAC,GAXK5E,CAYX,CAGO,SAAS42B,EAAU3Z,EAAO4Z,EAAMC,GAChCD,IAAQC,EAAUnB,IAAIkB,EAAK5sB,MAGhC6sB,EAAU3Z,IAAI0Z,EAAK5sB,GAAI4sB,GACvB9wB,OAAO2B,KAAKmvB,GAAM/qB,SAAQF,IACpBA,EAAKmrB,SAAS,MAChBH,EAAU3Z,EAAOA,EAAMpL,IAAIglB,EAAKjrB,IAAQkrB,GAC/BlrB,EAAKmrB,SAAS,QACvBF,EAAKjrB,GAAME,SAAQ7B,IACjB2sB,EAAU3Z,EAAOA,EAAMpL,IAAI5H,GAAK6sB,EAAU,GAE9C,IAEJ,CAGO,SAASE,EAAYC,EAAQjtB,EAAOktB,GACzC,MAAMC,EAAkBD,EAAW,eAAiB,cAC9CE,EAAiB,IAAIpa,IAC3B,GAAc,OAAVhT,EACF,OAAOotB,EAET,MAAMC,EAAa,GAcnB,OAbAJ,EAAOnrB,SAAQlH,IACM,UAAfA,EAAM1G,MACN0G,EAAM0yB,kBAAoBttB,EAAMC,IAClCotB,EAAW5uB,KAAK7D,EAClB,IAEFyyB,EAAWvrB,SAAQyrB,IACjBN,EAAOnrB,SAAQmR,IACTA,EAAM/e,OAASi5B,GAAmBla,EAAMnT,UAAYytB,EAAUttB,IAChE2sB,EAAUK,EAAQha,EAAOma,EAC3B,GACA,IAEGA,CACT,CChQA,MAAMI,EAAU,EAET,SAASC,EAAiBpvB,EAAQqvB,GACvC,MAAMtH,EAAY/nB,GAAUA,EAAO+nB,UAEnC,IAAKA,EAAUC,aACb,OAGF,MAAMsH,EAAuB,SAASvzB,GACpC,GAAiB,iBAANA,GAAkBA,EAAE+W,WAAa/W,EAAEgX,SAC5C,OAAOhX,EAET,MAAMwzB,EAAK,CAAC,EA4CZ,OA3CA7xB,OAAO2B,KAAKtD,GAAG0H,SAAQnH,IACrB,GAAY,YAARA,GAA6B,aAARA,GAA8B,gBAARA,EAC7C,OAEF,MAAMkzB,EAAuB,iBAAXzzB,EAAEO,GAAqBP,EAAEO,GAAO,CAACmzB,MAAO1zB,EAAEO,SAC5C4J,IAAZspB,EAAEE,OAA0C,iBAAZF,EAAEE,QACpCF,EAAEzrB,IAAMyrB,EAAEG,IAAMH,EAAEE,OAEpB,MAAME,EAAW,SAAS7Z,EAAQxS,GAChC,OAAIwS,EACKA,EAASxS,EAAKwY,OAAO,GAAGzF,cAAgB/S,EAAKzH,MAAM,GAE3C,aAATyH,EAAuB,WAAaA,CAC9C,EACA,QAAgB2C,IAAZspB,EAAEC,MAAqB,CACzBF,EAAGxc,SAAWwc,EAAGxc,UAAY,GAC7B,IAAI8c,EAAK,CAAC,EACa,iBAAZL,EAAEC,OACXI,EAAGD,EAAS,MAAOtzB,IAAQkzB,EAAEC,MAC7BF,EAAGxc,SAAS3S,KAAKyvB,GACjBA,EAAK,CAAC,EACNA,EAAGD,EAAS,MAAOtzB,IAAQkzB,EAAEC,MAC7BF,EAAGxc,SAAS3S,KAAKyvB,KAEjBA,EAAGD,EAAS,GAAItzB,IAAQkzB,EAAEC,MAC1BF,EAAGxc,SAAS3S,KAAKyvB,GAErB,MACgB3pB,IAAZspB,EAAEE,OAA0C,iBAAZF,EAAEE,OACpCH,EAAGzc,UAAYyc,EAAGzc,WAAa,CAAC,EAChCyc,EAAGzc,UAAU8c,EAAS,GAAItzB,IAAQkzB,EAAEE,OAEpC,CAAC,MAAO,OAAOjsB,SAAQqsB,SACN5pB,IAAXspB,EAAEM,KACJP,EAAGzc,UAAYyc,EAAGzc,WAAa,CAAC,EAChCyc,EAAGzc,UAAU8c,EAASE,EAAKxzB,IAAQkzB,EAAEM,GACvC,GAEJ,IAEE/zB,EAAEg0B,WACJR,EAAGxc,UAAYwc,EAAGxc,UAAY,IAAIid,OAAOj0B,EAAEg0B,WAEtCR,CACT,EAEMU,EAAmB,SAASC,EAAaC,GAC7C,GAAId,EAAe9T,SAAW,GAC5B,OAAO4U,EAAKD,GAGd,IADAA,EAAcvsB,KAAKC,MAAMD,KAAKE,UAAUqsB,MACQ,iBAAtBA,EAAYhI,MAAoB,CACxD,MAAMkI,EAAQ,SAAShxB,EAAK9J,EAAG+6B,GACzB/6B,KAAK8J,KAASixB,KAAKjxB,KACrBA,EAAIixB,GAAKjxB,EAAI9J,UACN8J,EAAI9J,GAEf,EAEA86B,GADAF,EAAcvsB,KAAKC,MAAMD,KAAKE,UAAUqsB,KACtBhI,MAAO,kBAAmB,uBAC5CkI,EAAMF,EAAYhI,MAAO,mBAAoB,wBAC7CgI,EAAYhI,MAAQoH,EAAqBY,EAAYhI,MACvD,CACA,GAAIgI,GAA4C,iBAAtBA,EAAYtN,MAAoB,CAExD,IAAI0N,EAAOJ,EAAYtN,MAAM2N,WAC7BD,EAAOA,IAA0B,iBAATA,EAAqBA,EAAO,CAACb,MAAOa,IAC5D,MAAME,EAA6BnB,EAAe9T,QAAU,GAE5D,GAAK+U,IAAwB,SAAfA,EAAKZ,OAAmC,gBAAfY,EAAKZ,OACf,SAAfY,EAAKb,OAAmC,gBAAfa,EAAKb,UACtC1H,EAAUC,aAAayI,0BACvB1I,EAAUC,aAAayI,0BAA0BF,YAChDC,GAA6B,CAElC,IAAIE,EAMJ,UAPOR,EAAYtN,MAAM2N,WAEN,gBAAfD,EAAKZ,OAA0C,gBAAfY,EAAKb,MACvCiB,EAAU,CAAC,OAAQ,QACK,SAAfJ,EAAKZ,OAAmC,SAAfY,EAAKb,QACvCiB,EAAU,CAAC,UAETA,EAEF,OAAO3I,EAAUC,aAAa2I,mBAC7Bnc,MAAKoc,IAEJ,IAAIC,GADJD,EAAUA,EAAQ3sB,QAAO6sB,GAAgB,eAAXA,EAAE9vB,QACdoE,MAAK0rB,GAAKJ,EAAQK,MAAKtE,GACvCqE,EAAEjK,MAAMrjB,cAAckkB,SAAS+E,OAUjC,OATKoE,GAAOD,EAAQh3B,QAAU82B,EAAQhJ,SAAS,UAC7CmJ,EAAMD,EAAQA,EAAQh3B,OAAS,IAE7Bi3B,IACFX,EAAYtN,MAAMoO,SAAWV,EAAKZ,MAAQ,CAACA,MAAOmB,EAAIG,UACZ,CAACvB,MAAOoB,EAAIG,WAExDd,EAAYtN,MAAQ0M,EAAqBY,EAAYtN,OACrDuM,EAAQ,WAAaxrB,KAAKE,UAAUqsB,IAC7BC,EAAKD,EAAY,GAG9B,CACAA,EAAYtN,MAAQ0M,EAAqBY,EAAYtN,MACvD,CAEA,OADAuM,EAAQ,WAAaxrB,KAAKE,UAAUqsB,IAC7BC,EAAKD,EACd,EAEMe,EAAa,SAASrxB,GAC1B,OAAIyvB,EAAe9T,SAAW,GACrB3b,EAEF,CACL2D,KAAM,CACJ2tB,sBAAuB,kBACvBC,yBAA0B,kBAC1BprB,kBAAmB,kBACnBqrB,qBAAsB,gBACtBC,4BAA6B,uBAC7BC,gBAAiB,mBACjBC,+BAAgC,kBAChCC,wBAAyB,kBACzBC,gBAAiB,aACjBC,mBAAoB,aACpBC,mBAAoB,cACpB/xB,EAAE2D,OAAS3D,EAAE2D,KACfuiB,QAASlmB,EAAEkmB,QACX8L,WAAYhyB,EAAEgyB,YAAchyB,EAAEiyB,eAC9Bl0B,WACE,OAAOrH,KAAKiN,MAAQjN,KAAKwvB,SAAW,MAAQxvB,KAAKwvB,OACnD,EAEJ,EAgBA,GALAiC,EAAUE,aATY,SAASiI,EAAa4B,EAAWC,GACrD9B,EAAiBC,GAAan0B,IAC5BgsB,EAAUiK,mBAAmBj2B,EAAG+1B,GAAWlyB,IACrCmyB,GACFA,EAAQd,EAAWrxB,GACrB,GACA,GAEN,EACuCpJ,KAAKuxB,GAKxCA,EAAUC,aAAaC,aAAc,CACvC,MAAMgK,EAAmBlK,EAAUC,aAAaC,aAC5CzxB,KAAKuxB,EAAUC,cACnBD,EAAUC,aAAaC,aAAe,SAASiK,GAC7C,OAAOjC,EAAiBiC,GAAIn2B,GAAKk2B,EAAiBl2B,GAAGyY,MAAK5T,IACxD,GAAI7E,EAAEmsB,QAAUtnB,EAAOgT,iBAAiBha,QACpCmC,EAAE6mB,QAAUhiB,EAAOiT,iBAAiBja,OAItC,MAHAgH,EAAOwK,YAAY3H,SAAQ9B,IACzBA,EAAMkK,MAAM,IAER,IAAIsmB,aAAa,GAAI,iBAE7B,OAAOvxB,CAAM,IACZhB,GAAKqP,QAAQC,OAAO+hB,EAAWrxB,OACpC,CACF,CACF,CClLO,SAASwyB,EAAoBpyB,EAAQqyB,GACtCryB,EAAO+nB,UAAUC,cACnB,oBAAqBhoB,EAAO+nB,UAAUC,cAGlChoB,EAAO+nB,UAAsB,eAKR,mBAAhBsK,EAKXryB,EAAO+nB,UAAUC,aAAasK,gBAC5B,SAAyBpC,GACvB,OAAOmC,EAAYnC,GAChB1b,MAAK+d,IACJ,MAAMC,EAAiBtC,EAAYtN,OAASsN,EAAYtN,MAAMiD,MACxD4M,EAAkBvC,EAAYtN,OAClCsN,EAAYtN,MAAM/E,OACd6U,EAAqBxC,EAAYtN,OACrCsN,EAAYtN,MAAM+P,UAcpB,OAbAzC,EAAYtN,MAAQ,CAClB9P,UAAW,CACT8f,kBAAmB,UACnBC,oBAAqBN,EACrBO,aAAcJ,GAAsB,IAGpCF,IACFtC,EAAYtN,MAAM9P,UAAUigB,SAAWP,GAErCC,IACFvC,EAAYtN,MAAM9P,UAAUkgB,UAAYP,GAEnCzyB,EAAO+nB,UAAUC,aAAaC,aAAaiI,EAAY,GAEpE,EA5BAr4B,QAAQ+d,MAAM,+DA6BlB,CCnCO,SAASqd,EAAgBjzB,GAC9BA,EAAOqR,YAAcrR,EAAOqR,aAAerR,EAAOkzB,iBACpD,CAEO,SAASC,EAAYnzB,GAC1B,GAAsB,iBAAXA,GAAuBA,EAAOiH,qBAAuB,YAC5DjH,EAAOiH,kBAAkB9M,WAAY,CACvCuD,OAAO4L,eAAetJ,EAAOiH,kBAAkB9M,UAAW,UAAW,CACnEqP,MACE,OAAOlT,KAAK88B,QACd,EACAte,IAAIue,GACE/8B,KAAK88B,UACP98B,KAAKwC,oBAAoB,QAASxC,KAAK88B,UAEzC98B,KAAKI,iBAAiB,QAASJ,KAAK88B,SAAWC,EACjD,EACA5F,YAAY,EACZlkB,cAAc,IAEhB,MAAM+pB,EACFtzB,EAAOiH,kBAAkB9M,UAAUyK,qBACvC5E,EAAOiH,kBAAkB9M,UAAUyK,qBACjC,WAuCE,OAtCKtO,KAAKi9B,eACRj9B,KAAKi9B,aAAgB3zB,IAGnBA,EAAEgB,OAAOlK,iBAAiB,YAAY88B,IACpC,IAAI7sB,EAEFA,EADE3G,EAAOiH,kBAAkB9M,UAAU8R,aAC1B3V,KAAK2V,eACb7G,MAAKoqB,GAAKA,EAAE7tB,OAAS6tB,EAAE7tB,MAAMC,KAAO4xB,EAAG7xB,MAAMC,KAErC,CAACD,MAAO6xB,EAAG7xB,OAGxB,MAAMwI,EAAQ,IAAIrD,MAAM,SACxBqD,EAAMxI,MAAQ6xB,EAAG7xB,MACjBwI,EAAMxD,SAAWA,EACjBwD,EAAMzJ,YAAc,CAACiG,YACrBwD,EAAMvD,QAAU,CAAChH,EAAEgB,QACnBtK,KAAKiQ,cAAc4D,EAAM,IAE3BvK,EAAEgB,OAAOwK,YAAY3H,SAAQ9B,IAC3B,IAAIgF,EAEFA,EADE3G,EAAOiH,kBAAkB9M,UAAU8R,aAC1B3V,KAAK2V,eACb7G,MAAKoqB,GAAKA,EAAE7tB,OAAS6tB,EAAE7tB,MAAMC,KAAOD,EAAMC,KAElC,CAACD,SAEd,MAAMwI,EAAQ,IAAIrD,MAAM,SACxBqD,EAAMxI,MAAQA,EACdwI,EAAMxD,SAAWA,EACjBwD,EAAMzJ,YAAc,CAACiG,YACrBwD,EAAMvD,QAAU,CAAChH,EAAEgB,QACnBtK,KAAKiQ,cAAc4D,EAAM,GACzB,EAEJ7T,KAAKI,iBAAiB,YAAaJ,KAAKi9B,eAEnCD,EAAyBre,MAAM3e,KAAMuc,UAC9C,CACJ,MAIE,EAA8B7S,EAAQ,SAASJ,IACxCA,EAAEc,aACLhD,OAAO4L,eAAe1J,EAAG,cACvB,CAACrD,MAAO,CAACoK,SAAU/G,EAAE+G,YAElB/G,IAGb,CAEO,SAAS6zB,EAAuBzzB,GAErC,GAAsB,iBAAXA,GAAuBA,EAAOiH,qBACnC,eAAgBjH,EAAOiH,kBAAkB9M,YAC3C,qBAAsB6F,EAAOiH,kBAAkB9M,UAAW,CAC5D,MAAMu5B,EAAqB,SAAShtB,EAAI/E,GACtC,MAAO,CACLA,QACIgyB,WAQF,YAPmBztB,IAAf5P,KAAKs9B,QACY,UAAfjyB,EAAMX,KACR1K,KAAKs9B,MAAQltB,EAAGmtB,iBAAiBlyB,GAEjCrL,KAAKs9B,MAAQ,MAGVt9B,KAAKs9B,KACd,EACAE,IAAKptB,EAET,EAGA,IAAK1G,EAAOiH,kBAAkB9M,UAAU6R,WAAY,CAClDhM,EAAOiH,kBAAkB9M,UAAU6R,WAAa,WAE9C,OADA1V,KAAKy9B,SAAWz9B,KAAKy9B,UAAY,GAC1Bz9B,KAAKy9B,SAASj4B,OACvB,EACA,MAAMk4B,EAAeh0B,EAAOiH,kBAAkB9M,UAAUmM,SACxDtG,EAAOiH,kBAAkB9M,UAAUmM,SACjC,SAAkB3E,EAAOf,GACvB,IAAI+K,EAASqoB,EAAa/e,MAAM3e,KAAMuc,WAKtC,OAJKlH,IACHA,EAAS+nB,EAAmBp9B,KAAMqL,GAClCrL,KAAKy9B,SAAS3zB,KAAKuL,IAEdA,CACT,EAEF,MAAMsoB,EAAkBj0B,EAAOiH,kBAAkB9M,UAAUuR,YAC3D1L,EAAOiH,kBAAkB9M,UAAUuR,YACjC,SAAqBC,GACnBsoB,EAAgBhf,MAAM3e,KAAMuc,WAC5B,MAAMtH,EAAMjV,KAAKy9B,SAASjvB,QAAQ6G,IACrB,IAATJ,GACFjV,KAAKy9B,SAASjoB,OAAOP,EAAK,EAE9B,CACJ,CACA,MAAM2oB,EAAgBl0B,EAAOiH,kBAAkB9M,UAAUgR,UACzDnL,EAAOiH,kBAAkB9M,UAAUgR,UAAY,SAAmBvK,GAChEtK,KAAKy9B,SAAWz9B,KAAKy9B,UAAY,GACjCG,EAAcjf,MAAM3e,KAAM,CAACsK,IAC3BA,EAAOwK,YAAY3H,SAAQ9B,IACzBrL,KAAKy9B,SAAS3zB,KAAKszB,EAAmBp9B,KAAMqL,GAAO,GAEvD,EAEA,MAAMwyB,EAAmBn0B,EAAOiH,kBAAkB9M,UAAU4R,aAC5D/L,EAAOiH,kBAAkB9M,UAAU4R,aACjC,SAAsBnL,GACpBtK,KAAKy9B,SAAWz9B,KAAKy9B,UAAY,GACjCI,EAAiBlf,MAAM3e,KAAM,CAACsK,IAE9BA,EAAOwK,YAAY3H,SAAQ9B,IACzB,MAAMgK,EAASrV,KAAKy9B,SAAS3uB,MAAK4F,GAAKA,EAAErJ,QAAUA,IAC/CgK,GACFrV,KAAKy9B,SAASjoB,OAAOxV,KAAKy9B,SAASjvB,QAAQ6G,GAAS,EACtD,GAEJ,CACJ,MAAO,GAAsB,iBAAX3L,GAAuBA,EAAOiH,mBACrC,eAAgBjH,EAAOiH,kBAAkB9M,WACzC,qBAAsB6F,EAAOiH,kBAAkB9M,WAC/C6F,EAAOkL,gBACL,SAAUlL,EAAOkL,aAAa/Q,WAAY,CACrD,MAAMi6B,EAAiBp0B,EAAOiH,kBAAkB9M,UAAU6R,WAC1DhM,EAAOiH,kBAAkB9M,UAAU6R,WAAa,WAC9C,MAAMqoB,EAAUD,EAAenf,MAAM3e,KAAM,IAE3C,OADA+9B,EAAQ5wB,SAAQkI,GAAUA,EAAOmoB,IAAMx9B,OAChC+9B,CACT,EAEA32B,OAAO4L,eAAetJ,EAAOkL,aAAa/Q,UAAW,OAAQ,CAC3DqP,MAQE,YAPmBtD,IAAf5P,KAAKs9B,QACiB,UAApBt9B,KAAKqL,MAAMX,KACb1K,KAAKs9B,MAAQt9B,KAAKw9B,IAAID,iBAAiBv9B,KAAKqL,OAE5CrL,KAAKs9B,MAAQ,MAGVt9B,KAAKs9B,KACd,GAEJ,CACF,CAEO,SAASU,EAAat0B,GAC3B,IAAKA,EAAOiH,kBACV,OAGF,MAAMstB,EAAev0B,EAAOiH,kBAAkB9M,UAAU+Z,SACxDlU,EAAOiH,kBAAkB9M,UAAU+Z,SAAW,WAC5C,MAAOC,EAAUqgB,EAAQC,GAAS5hB,UAIlC,GAAIA,UAAUjZ,OAAS,GAAyB,mBAAbua,EACjC,OAAOogB,EAAatf,MAAM3e,KAAMuc,WAKlC,GAA4B,IAAxB0hB,EAAa36B,SAAsC,IAArBiZ,UAAUjZ,QACpB,mBAAbua,GACT,OAAOogB,EAAatf,MAAM3e,KAAM,IAGlC,MAAMo+B,EAAkB,SAASC,GAC/B,MAAMC,EAAiB,CAAC,EAiBxB,OAhBgBD,EAAS/F,SACjBnrB,SAAQoxB,IACd,MAAMC,EAAgB,CACpBlzB,GAAIizB,EAAOjzB,GACXmzB,UAAWF,EAAOE,UAClBl/B,KAAM,CACJ0f,eAAgB,kBAChBC,gBAAiB,oBACjBqf,EAAOh/B,OAASg/B,EAAOh/B,MAE3Bg/B,EAAOG,QAAQvxB,SAAQF,IACrBuxB,EAAcvxB,GAAQsxB,EAAOhgB,KAAKtR,EAAK,IAEzCqxB,EAAeE,EAAclzB,IAAMkzB,CAAa,IAG3CF,CACT,EAGMK,EAAe,SAASrgB,GAC5B,OAAO,IAAID,IAAIjX,OAAO2B,KAAKuV,GAAOvY,KAAIC,GAAO,CAACA,EAAKsY,EAAMtY,MAC3D,EAEA,GAAIuW,UAAUjZ,QAAU,EAAG,CACzB,MAAMs7B,EAA0B,SAASP,GACvCH,EAAOS,EAAaP,EAAgBC,IACtC,EAEA,OAAOJ,EAAatf,MAAM3e,KAAM,CAAC4+B,EAC/B/gB,GACJ,CAGA,OAAO,IAAIlF,SAAQ,CAACgB,EAASf,KAC3BqlB,EAAatf,MAAM3e,KAAM,CACvB,SAASq+B,GACP1kB,EAAQglB,EAAaP,EAAgBC,IACvC,EAAGzlB,GAAQ,IACZsF,KAAKggB,EAAQC,EAClB,CACF,CAEO,SAASU,EAA2Bn1B,GACzC,KAAwB,iBAAXA,GAAuBA,EAAOiH,mBACvCjH,EAAOkL,cAAgBlL,EAAOsR,gBAChC,OAIF,KAAM,aAActR,EAAOkL,aAAa/Q,WAAY,CAClD,MAAMi6B,EAAiBp0B,EAAOiH,kBAAkB9M,UAAU6R,WACtDooB,IACFp0B,EAAOiH,kBAAkB9M,UAAU6R,WAAa,WAC9C,MAAMqoB,EAAUD,EAAenf,MAAM3e,KAAM,IAE3C,OADA+9B,EAAQ5wB,SAAQkI,GAAUA,EAAOmoB,IAAMx9B,OAChC+9B,CACT,GAGF,MAAML,EAAeh0B,EAAOiH,kBAAkB9M,UAAUmM,SACpD0tB,IACFh0B,EAAOiH,kBAAkB9M,UAAUmM,SAAW,WAC5C,MAAMqF,EAASqoB,EAAa/e,MAAM3e,KAAMuc,WAExC,OADAlH,EAAOmoB,IAAMx9B,KACNqV,CACT,GAEF3L,EAAOkL,aAAa/Q,UAAU+Z,SAAW,WACvC,MAAMvI,EAASrV,KACf,OAAOA,KAAKw9B,IAAI5f,WAAWM,MAAKoa,GAK9B,EAAkBA,EAAQjjB,EAAOhK,OAAO,IAC5C,CACF,CAGA,KAAM,aAAc3B,EAAOsR,eAAenX,WAAY,CACpD,MAAMi7B,EAAmBp1B,EAAOiH,kBAAkB9M,UAAU8R,aACxDmpB,IACFp1B,EAAOiH,kBAAkB9M,UAAU8R,aACjC,WACE,MAAMopB,EAAYD,EAAiBngB,MAAM3e,KAAM,IAE/C,OADA++B,EAAU5xB,SAAQkD,GAAYA,EAASmtB,IAAMx9B,OACtC++B,CACT,GAEJ,EAA8Br1B,EAAQ,SAASJ,IAC7CA,EAAE+G,SAASmtB,IAAMl0B,EAAE01B,WACZ11B,KAETI,EAAOsR,eAAenX,UAAU+Z,SAAW,WACzC,MAAMvN,EAAWrQ,KACjB,OAAOA,KAAKw9B,IAAI5f,WAAWM,MAAKoa,GAC9B,EAAkBA,EAAQjoB,EAAShF,OAAO,IAC9C,CACF,CAEA,KAAM,aAAc3B,EAAOkL,aAAa/Q,cACpC,aAAc6F,EAAOsR,eAAenX,WACtC,OAIF,MAAMo6B,EAAev0B,EAAOiH,kBAAkB9M,UAAU+Z,SACxDlU,EAAOiH,kBAAkB9M,UAAU+Z,SAAW,WAC5C,GAAIrB,UAAUjZ,OAAS,GACnBiZ,UAAU,aAAc7S,EAAOoU,iBAAkB,CACnD,MAAMzS,EAAQkR,UAAU,GACxB,IAAIlH,EACAhF,EACA2hB,EAoBJ,OAnBAhyB,KAAK0V,aAAavI,SAAQuH,IACpBA,EAAErJ,QAAUA,IACVgK,EACF2c,GAAM,EAEN3c,EAASX,EAEb,IAEF1U,KAAK2V,eAAexI,SAAQ+rB,IACtBA,EAAE7tB,QAAUA,IACVgF,EACF2hB,GAAM,EAEN3hB,EAAW6oB,GAGRA,EAAE7tB,QAAUA,KAEjB2mB,GAAQ3c,GAAUhF,EACbsI,QAAQC,OAAO,IAAIijB,aACxB,4DACA,uBACOxmB,EACFA,EAAOuI,WACLvN,EACFA,EAASuN,WAEXjF,QAAQC,OAAO,IAAIijB,aACxB,gDACA,sBACJ,CACA,OAAOoC,EAAatf,MAAM3e,KAAMuc,UAClC,CACF,CAEO,SAAS0iB,EAAkCv1B,GAIhDA,EAAOiH,kBAAkB9M,UAAUmQ,gBACjC,WAEE,OADAhU,KAAKk/B,qBAAuBl/B,KAAKk/B,sBAAwB,CAAC,EACnD93B,OAAO2B,KAAK/I,KAAKk/B,sBACrBn5B,KAAIo5B,GAAYn/B,KAAKk/B,qBAAqBC,GAAU,IACzD,EAEF,MAAMzB,EAAeh0B,EAAOiH,kBAAkB9M,UAAUmM,SACxDtG,EAAOiH,kBAAkB9M,UAAUmM,SACjC,SAAkB3E,EAAOf,GACvB,IAAKA,EACH,OAAOozB,EAAa/e,MAAM3e,KAAMuc,WAElCvc,KAAKk/B,qBAAuBl/B,KAAKk/B,sBAAwB,CAAC,EAE1D,MAAM7pB,EAASqoB,EAAa/e,MAAM3e,KAAMuc,WAMxC,OALKvc,KAAKk/B,qBAAqB50B,EAAOgB,KAE+B,IAA1DtL,KAAKk/B,qBAAqB50B,EAAOgB,IAAIkD,QAAQ6G,IACtDrV,KAAKk/B,qBAAqB50B,EAAOgB,IAAIxB,KAAKuL,GAF1CrV,KAAKk/B,qBAAqB50B,EAAOgB,IAAM,CAAChB,EAAQ+K,GAI3CA,CACT,EAEF,MAAMuoB,EAAgBl0B,EAAOiH,kBAAkB9M,UAAUgR,UACzDnL,EAAOiH,kBAAkB9M,UAAUgR,UAAY,SAAmBvK,GAChEtK,KAAKk/B,qBAAuBl/B,KAAKk/B,sBAAwB,CAAC,EAE1D50B,EAAOwK,YAAY3H,SAAQ9B,IAEzB,GADsBrL,KAAK0V,aAAa5G,MAAK4F,GAAKA,EAAErJ,QAAUA,IAE5D,MAAM,IAAIwwB,aAAa,wBACnB,qBACN,IAEF,MAAMuD,EAAkBp/B,KAAK0V,aAC7BkoB,EAAcjf,MAAM3e,KAAMuc,WAC1B,MAAM8iB,EAAar/B,KAAK0V,aACrB/H,QAAO2xB,IAAqD,IAAxCF,EAAgB5wB,QAAQ8wB,KAC/Ct/B,KAAKk/B,qBAAqB50B,EAAOgB,IAAM,CAAChB,GAAQovB,OAAO2F,EACzD,EAEA,MAAMxB,EAAmBn0B,EAAOiH,kBAAkB9M,UAAU4R,aAC5D/L,EAAOiH,kBAAkB9M,UAAU4R,aACjC,SAAsBnL,GAGpB,OAFAtK,KAAKk/B,qBAAuBl/B,KAAKk/B,sBAAwB,CAAC,SACnDl/B,KAAKk/B,qBAAqB50B,EAAOgB,IACjCuyB,EAAiBlf,MAAM3e,KAAMuc,UACtC,EAEF,MAAMohB,EAAkBj0B,EAAOiH,kBAAkB9M,UAAUuR,YAC3D1L,EAAOiH,kBAAkB9M,UAAUuR,YACjC,SAAqBC,GAanB,OAZArV,KAAKk/B,qBAAuBl/B,KAAKk/B,sBAAwB,CAAC,EACtD7pB,GACFjO,OAAO2B,KAAK/I,KAAKk/B,sBAAsB/xB,SAAQgyB,IAC7C,MAAMlqB,EAAMjV,KAAKk/B,qBAAqBC,GAAU3wB,QAAQ6G,IAC3C,IAATJ,GACFjV,KAAKk/B,qBAAqBC,GAAU3pB,OAAOP,EAAK,GAEC,IAA/CjV,KAAKk/B,qBAAqBC,GAAU77B,eAC/BtD,KAAKk/B,qBAAqBC,EACnC,IAGGxB,EAAgBhf,MAAM3e,KAAMuc,UACrC,CACJ,CAEO,SAASgjB,EAAwB71B,EAAQqvB,GAC9C,IAAKrvB,EAAOiH,kBACV,OAGF,GAAIjH,EAAOiH,kBAAkB9M,UAAUmM,UACnC+oB,EAAe9T,SAAW,GAC5B,OAAOga,EAAkCv1B,GAK3C,MAAM81B,EAAsB91B,EAAOiH,kBAAkB9M,UAChDmQ,gBACLtK,EAAOiH,kBAAkB9M,UAAUmQ,gBACjC,WACE,MAAMyrB,EAAgBD,EAAoB7gB,MAAM3e,MAEhD,OADAA,KAAK0/B,gBAAkB1/B,KAAK0/B,iBAAmB,CAAC,EACzCD,EAAc15B,KAAIuE,GAAUtK,KAAK0/B,gBAAgBp1B,EAAOgB,KACjE,EAEF,MAAMsyB,EAAgBl0B,EAAOiH,kBAAkB9M,UAAUgR,UACzDnL,EAAOiH,kBAAkB9M,UAAUgR,UAAY,SAAmBvK,GAahE,GAZAtK,KAAK2/B,SAAW3/B,KAAK2/B,UAAY,CAAC,EAClC3/B,KAAK0/B,gBAAkB1/B,KAAK0/B,iBAAmB,CAAC,EAEhDp1B,EAAOwK,YAAY3H,SAAQ9B,IAEzB,GADsBrL,KAAK0V,aAAa5G,MAAK4F,GAAKA,EAAErJ,QAAUA,IAE5D,MAAM,IAAIwwB,aAAa,wBACnB,qBACN,KAIG77B,KAAK0/B,gBAAgBp1B,EAAOgB,IAAK,CACpC,MAAMs0B,EAAY,IAAIl2B,EAAOqR,YAAYzQ,EAAOwK,aAChD9U,KAAK2/B,SAASr1B,EAAOgB,IAAMs0B,EAC3B5/B,KAAK0/B,gBAAgBE,EAAUt0B,IAAMhB,EACrCA,EAASs1B,CACX,CACAhC,EAAcjf,MAAM3e,KAAM,CAACsK,GAC7B,EAEA,MAAMuzB,EAAmBn0B,EAAOiH,kBAAkB9M,UAAU4R,aA6D5D,SAASoqB,EAAwBzvB,EAAIb,GACnC,IAAI/E,EAAM+E,EAAY/E,IAOtB,OANApD,OAAO2B,KAAKqH,EAAGsvB,iBAAmB,IAAIvyB,SAAQ2yB,IAC5C,MAAMC,EAAiB3vB,EAAGsvB,gBAAgBI,GACpCE,EAAiB5vB,EAAGuvB,SAASI,EAAez0B,IAClDd,EAAMA,EAAIzC,QAAQ,IAAIk4B,OAAOD,EAAe10B,GAAI,KAC5Cy0B,EAAez0B,GAAG,IAEjB,IAAI4R,sBAAsB,CAC/B3d,KAAMgQ,EAAYhQ,KAClBiL,OAEJ,CAxEAd,EAAOiH,kBAAkB9M,UAAU4R,aACjC,SAAsBnL,GACpBtK,KAAK2/B,SAAW3/B,KAAK2/B,UAAY,CAAC,EAClC3/B,KAAK0/B,gBAAkB1/B,KAAK0/B,iBAAmB,CAAC,EAEhD7B,EAAiBlf,MAAM3e,KAAM,CAAEA,KAAK2/B,SAASr1B,EAAOgB,KAAOhB,WACpDtK,KAAK0/B,gBAAiB1/B,KAAK2/B,SAASr1B,EAAOgB,IAC9CtL,KAAK2/B,SAASr1B,EAAOgB,IAAIA,GAAKhB,EAAOgB,WAClCtL,KAAK2/B,SAASr1B,EAAOgB,GAC9B,EAEF5B,EAAOiH,kBAAkB9M,UAAUmM,SACjC,SAAkB3E,EAAOf,GACvB,GAA4B,WAAxBtK,KAAKmO,eACP,MAAM,IAAI0tB,aACR,sDACA,qBAEJ,MAAMvrB,EAAU,GAAG9K,MAAMqsB,KAAKtV,UAAW,GACzC,GAAuB,IAAnBjM,EAAQhN,SACPgN,EAAQ,GAAGwE,YAAYhG,MAAKwG,GAAKA,IAAMjK,IAG1C,MAAM,IAAIwwB,aACR,gHAEA,qBAIJ,GADsB77B,KAAK0V,aAAa5G,MAAK4F,GAAKA,EAAErJ,QAAUA,IAE5D,MAAM,IAAIwwB,aAAa,wBACnB,sBAGN77B,KAAK2/B,SAAW3/B,KAAK2/B,UAAY,CAAC,EAClC3/B,KAAK0/B,gBAAkB1/B,KAAK0/B,iBAAmB,CAAC,EAChD,MAAMQ,EAAYlgC,KAAK2/B,SAASr1B,EAAOgB,IACvC,GAAI40B,EAKFA,EAAUlwB,SAAS3E,GAGnBsN,QAAQgB,UAAUuE,MAAK,KACrBle,KAAKiQ,cAAc,IAAIO,MAAM,qBAAqB,QAE/C,CACL,MAAMovB,EAAY,IAAIl2B,EAAOqR,YAAY,CAAC1P,IAC1CrL,KAAK2/B,SAASr1B,EAAOgB,IAAMs0B,EAC3B5/B,KAAK0/B,gBAAgBE,EAAUt0B,IAAMhB,EACrCtK,KAAK6U,UAAU+qB,EACjB,CACA,OAAO5/B,KAAK0V,aAAa5G,MAAK4F,GAAKA,EAAErJ,QAAUA,GACjD,EA8BF,CAAC,cAAe,gBAAgB8B,SAAQ,SAAS6D,GAC/C,MAAMoO,EAAe1V,EAAOiH,kBAAkB9M,UAAUmN,GAClDmvB,EAAY,CAAC,CAACnvB,KAClB,MAAMqO,EAAO9C,UAGb,OAFqBA,UAAUjZ,QACH,mBAAjBiZ,UAAU,GAEZ6C,EAAaT,MAAM3e,KAAM,CAC7BuP,IACC,MAAM0N,EAAO4iB,EAAwB7/B,KAAMuP,GAC3C8P,EAAK,GAAGV,MAAM,KAAM,CAAC1B,GAAM,EAE5B+U,IACK3S,EAAK,IACPA,EAAK,GAAGV,MAAM,KAAMqT,EACtB,EACCzV,UAAU,KAGV6C,EAAaT,MAAM3e,KAAMuc,WAC/B2B,MAAK3O,GAAeswB,EAAwB7/B,KAAMuP,IACrD,GACA7F,EAAOiH,kBAAkB9M,UAAUmN,GAAUmvB,EAAUnvB,EACzD,IAEA,MAAMovB,EACF12B,EAAOiH,kBAAkB9M,UAAUwK,oBACvC3E,EAAOiH,kBAAkB9M,UAAUwK,oBACjC,WACE,OAAKkO,UAAUjZ,QAAWiZ,UAAU,GAAGhd,MAGvCgd,UAAU,GA7Cd,SAAiCnM,EAAIb,GACnC,IAAI/E,EAAM+E,EAAY/E,IAOtB,OANApD,OAAO2B,KAAKqH,EAAGsvB,iBAAmB,IAAIvyB,SAAQ2yB,IAC5C,MAAMC,EAAiB3vB,EAAGsvB,gBAAgBI,GACpCE,EAAiB5vB,EAAGuvB,SAASI,EAAez0B,IAClDd,EAAMA,EAAIzC,QAAQ,IAAIk4B,OAAOF,EAAez0B,GAAI,KAC5C00B,EAAe10B,GAAG,IAEjB,IAAI4R,sBAAsB,CAC/B3d,KAAMgQ,EAAYhQ,KAClBiL,OAEJ,CAiCmB61B,CAAwBrgC,KAAMuc,UAAU,IAChD6jB,EAAwBzhB,MAAM3e,KAAMuc,YAHlC6jB,EAAwBzhB,MAAM3e,KAAMuc,UAI/C,EAIF,MAAM+jB,EAAuBl5B,OAAOm5B,yBAChC72B,EAAOiH,kBAAkB9M,UAAW,oBACxCuD,OAAO4L,eAAetJ,EAAOiH,kBAAkB9M,UAC3C,mBAAoB,CAClBqP,MACE,MAAM3D,EAAc+wB,EAAqBptB,IAAIyL,MAAM3e,MACnD,MAAyB,KAArBuP,EAAYhQ,KACPgQ,EAEFswB,EAAwB7/B,KAAMuP,EACvC,IAGN7F,EAAOiH,kBAAkB9M,UAAUuR,YACjC,SAAqBC,GACnB,GAA4B,WAAxBrV,KAAKmO,eACP,MAAM,IAAI0tB,aACR,sDACA,qBAIJ,IAAKxmB,EAAOmoB,IACV,MAAM,IAAI3B,aAAa,yFAC2B,aAGpD,GADgBxmB,EAAOmoB,MAAQx9B,KAE7B,MAAM,IAAI67B,aAAa,6CACnB,sBAKN,IAAIvxB,EADJtK,KAAK2/B,SAAW3/B,KAAK2/B,UAAY,CAAC,EAElCv4B,OAAO2B,KAAK/I,KAAK2/B,UAAUxyB,SAAQqzB,IAChBxgC,KAAK2/B,SAASa,GAAU1rB,YACtChG,MAAKzD,GAASgK,EAAOhK,QAAUA,MAEhCf,EAAStK,KAAK2/B,SAASa,GACzB,IAGEl2B,IACgC,IAA9BA,EAAOwK,YAAYxR,OAGrBtD,KAAKyV,aAAazV,KAAK0/B,gBAAgBp1B,EAAOgB,KAG9ChB,EAAO8K,YAAYC,EAAOhK,OAE5BrL,KAAKiQ,cAAc,IAAIO,MAAM,sBAEjC,CACJ,CAEO,SAASiwB,EAAmB/2B,EAAQqvB,IACpCrvB,EAAOiH,mBAAqBjH,EAAOg3B,0BAEtCh3B,EAAOiH,kBAAoBjH,EAAOg3B,yBAE/Bh3B,EAAOiH,mBAKRooB,EAAe9T,QAAU,IAC3B,CAAC,sBAAuB,uBAAwB,mBAC3C9X,SAAQ,SAAS6D,GAChB,MAAMoO,EAAe1V,EAAOiH,kBAAkB9M,UAAUmN,GAClDmvB,EAAY,CAAC,CAACnvB,KAIlB,OAHAuL,UAAU,GAAK,IAAiB,oBAAXvL,EACjBtH,EAAOi3B,gBACPj3B,EAAOwT,uBAAuBX,UAAU,IACrC6C,EAAaT,MAAM3e,KAAMuc,UAClC,GACA7S,EAAOiH,kBAAkB9M,UAAUmN,GAAUmvB,EAAUnvB,EACzD,GAER,CAGO,SAAS4vB,EAAqBl3B,EAAQqvB,GAC3C,EAA8BrvB,EAAQ,qBAAqBJ,IACzD,MAAM8G,EAAK9G,EAAEu3B,OACb,KAAI9H,EAAe9T,QAAU,IAAO7U,EAAG2D,kBACI,WAAvC3D,EAAG2D,mBAAmB+sB,eACE,WAAtB1wB,EAAGjC,eAIT,OAAO7E,CAAC,GAEZ,C,sBCnrBO,SAAS,EAAiBI,GAC/B,MAAM+nB,EAAY/nB,GAAUA,EAAO+nB,UAc7BkK,EAAmBlK,EAAUC,aAAaC,aAC5CzxB,KAAKuxB,EAAUC,cACnBD,EAAUC,aAAaC,aAAe,SAASlsB,GAC7C,OAAOk2B,EAAiBl2B,GAAGssB,OAAMzoB,GAAKqP,QAAQC,OAf7B,SAAStP,GAC1B,MAAO,CACL2D,KAAM,CAAC2tB,sBAAuB,mBAAmBtxB,EAAE2D,OAAS3D,EAAE2D,KAC9DuiB,QAASlmB,EAAEkmB,QACX8L,WAAYhyB,EAAEgyB,WACdj0B,WACE,OAAOrH,KAAKiN,IACd,EAEJ,CAMuD0tB,CAAWrxB,KAClE,CACF,CCpBO,SAAS,EAAoBI,GAC5B,oBAAqBA,EAAO+nB,WAG5B/nB,EAAO+nB,UAAsB,eAG/B/nB,EAAO+nB,UAAUC,cACnB,oBAAqBhoB,EAAO+nB,UAAUC,eAGxChoB,EAAO+nB,UAAUC,aAAasK,gBAC5BtyB,EAAO+nB,UAAUuK,gBAAgB97B,KAAKwJ,EAAO+nB,YACjD,CCNO,SAAS,EAAmB/nB,EAAQqvB,GACzC,GAAIrvB,EAAO6I,iBACJ7I,EAAOi3B,kBACVj3B,EAAOi3B,gBAAkB,SAAyBthB,GAChD,OAAOA,CACT,GAEG3V,EAAOwT,wBACVxT,EAAOwT,sBAAwB,SAA+BmC,GAC5D,OAAOA,CACT,GAKE0Z,EAAe9T,QAAU,OAAO,CAClC,MAAM8b,EAAiB35B,OAAOm5B,yBAC1B72B,EAAOoU,iBAAiBja,UAAW,WACvCuD,OAAO4L,eAAetJ,EAAOoU,iBAAiBja,UAAW,UAAW,CAClE2a,IAAIvY,GACF86B,EAAeviB,IAAIqT,KAAK7xB,KAAMiG,GAC9B,MAAM+6B,EAAK,IAAIxwB,MAAM,WACrBwwB,EAAG7rB,QAAUlP,EACbjG,KAAKiQ,cAAc+wB,EACrB,GAEJ,CAKEt3B,EAAOkL,gBAAkB,SAAUlL,EAAOkL,aAAa/Q,YACzDuD,OAAO4L,eAAetJ,EAAOkL,aAAa/Q,UAAW,OAAQ,CAC3DqP,MAQE,YAPmBtD,IAAf5P,KAAKs9B,QACiB,UAApBt9B,KAAKqL,MAAMX,KACb1K,KAAKs9B,MAAQ,IAAI5zB,EAAOu3B,cAAcjhC,MACT,UAApBA,KAAKqL,MAAMX,OACpB1K,KAAKs9B,MAAQ,OAGVt9B,KAAKs9B,KACd,IAKA5zB,EAAOu3B,gBAAkBv3B,EAAOw3B,gBAClCx3B,EAAOw3B,cAAgBx3B,EAAOu3B,eAGhC,MAAME,EAAwB,IAAsBz3B,EAChDqvB,EAAe9T,SACnBvb,EAAOiH,kBAAoB,SAA2BC,GAMpD,OALIA,GAAUA,EAAOkB,aACnBlB,EAAOkB,WCxDN,SAA0BA,EAAYhC,GAC3C,IAAIiC,GAAU,EAEd,OADAD,EAAazE,KAAKC,MAAMD,KAAKE,UAAUuE,KACrBnE,QAAOqE,IACvB,GAAIA,IAAWA,EAAOC,MAAQD,EAAOE,KAAM,CACzC,IAAID,EAAOD,EAAOC,MAAQD,EAAOE,IAC7BF,EAAOE,MAAQF,EAAOC,MACxB,EAAiB,mBAAoB,qBAEvC,MAAME,EAA2B,iBAATF,EAsBxB,OArBIE,IACFF,EAAO,CAACA,IAEVA,EAAOA,EAAKtE,QAAOuE,IAEjB,GAA6B,IAAzBA,EAAI1D,QAAQ,SACd,OAAO,EAGT,MAAM4yB,EAAYlvB,EAAI5K,WAAW,UAC5B4K,EAAI5K,WAAW,WAChB4K,EAAIkf,SAAS,iBACjB,OAAIgQ,IAAcrvB,GAChBA,GAAU,GACH,GAEFqvB,IAAcrvB,CAAO,WAGvBC,EAAOE,IACdF,EAAOC,KAAOE,EAAWF,EAAK,GAAKA,IAC1BA,EAAK3O,MAChB,IAEJ,CDsB0B8O,CAAiBxB,EAAOkB,WAC1CinB,EAAe9T,SACjB,EAAU,+BAAgCrU,EAAOkB,aAE5C,IAAIqvB,EAAsBvwB,EACnC,EACAlH,EAAOiH,kBAAkB9M,UAAYs9B,EAAsBt9B,SAC7D,CAEO,SAASw9B,EAAiB33B,GAE3BA,EAAOkL,gBACL,iBAAkBlL,EAAOkL,aAAa/Q,aAC1C6F,EAAOkL,aAAa/Q,UAAUy9B,aAC1B53B,EAAOkL,aAAa/Q,UAAU09B,SAEtC,CE5EO,SAAS,EAAiB73B,EAAQqvB,GACvC,MAAMtH,EAAY/nB,GAAUA,EAAO+nB,UAC7B3T,EAAmBpU,GAAUA,EAAOoU,iBAS1C,GAPA2T,EAAUE,aAAe,SAASiI,EAAa4B,EAAWC,GAExD,EAAiB,yBACb,uCACJhK,EAAUC,aAAaC,aAAaiI,GAAa1b,KAAKsd,EAAWC,EACnE,IAEM1C,EAAe9T,QAAU,IAC3B,oBAAqBwM,EAAUC,aAAayI,2BAA4B,CAC1E,MAAML,EAAQ,SAAShxB,EAAK9J,EAAG+6B,GACzB/6B,KAAK8J,KAASixB,KAAKjxB,KACrBA,EAAIixB,GAAKjxB,EAAI9J,UACN8J,EAAI9J,GAEf,EAEMwiC,EAAqB/P,EAAUC,aAAaC,aAC9CzxB,KAAKuxB,EAAUC,cAUnB,GATAD,EAAUC,aAAaC,aAAe,SAASlsB,GAM7C,MALiB,iBAANA,GAAqC,iBAAZA,EAAEmsB,QACpCnsB,EAAI4H,KAAKC,MAAMD,KAAKE,UAAU9H,IAC9Bq0B,EAAMr0B,EAAEmsB,MAAO,kBAAmB,sBAClCkI,EAAMr0B,EAAEmsB,MAAO,mBAAoB,wBAE9B4P,EAAmB/7B,EAC5B,EAEIqY,GAAoBA,EAAiBja,UAAU49B,YAAa,CAC9D,MAAMC,EAAoB5jB,EAAiBja,UAAU49B,YACrD3jB,EAAiBja,UAAU49B,YAAc,WACvC,MAAM34B,EAAM44B,EAAkB/iB,MAAM3e,KAAMuc,WAG1C,OAFAud,EAAMhxB,EAAK,qBAAsB,mBACjCgxB,EAAMhxB,EAAK,sBAAuB,oBAC3BA,CACT,CACF,CAEA,GAAIgV,GAAoBA,EAAiBja,UAAU89B,iBAAkB,CACnE,MAAMC,EACJ9jB,EAAiBja,UAAU89B,iBAC7B7jB,EAAiBja,UAAU89B,iBAAmB,SAASl8B,GAMrD,MALkB,UAAdzF,KAAK0K,MAAiC,iBAANjF,IAClCA,EAAI4H,KAAKC,MAAMD,KAAKE,UAAU9H,IAC9Bq0B,EAAMr0B,EAAG,kBAAmB,sBAC5Bq0B,EAAMr0B,EAAG,mBAAoB,wBAExBm8B,EAAuBjjB,MAAM3e,KAAM,CAACyF,GAC7C,CACF,CACF,CACF,CCxDO,SAAS,EAAoBiE,EAAQm4B,GACtCn4B,EAAO+nB,UAAUC,cACnB,oBAAqBhoB,EAAO+nB,UAAUC,cAGlChoB,EAAO+nB,UAAsB,eAGnC/nB,EAAO+nB,UAAUC,aAAasK,gBAC5B,SAAyBpC,GACvB,IAAMA,IAAeA,EAAYtN,MAAQ,CACvC,MAAM0F,EAAM,IAAI6J,aAAa,0DAK7B,OAHA7J,EAAI/kB,KAAO,gBAEX+kB,EAAIruB,KAAO,EACJgV,QAAQC,OAAOoZ,EACxB,CAMA,OAL0B,IAAtB4H,EAAYtN,MACdsN,EAAYtN,MAAQ,CAACwV,YAAaD,GAElCjI,EAAYtN,MAAMwV,YAAcD,EAE3Bn4B,EAAO+nB,UAAUC,aAAaC,aAAaiI,EACpD,EACJ,CCrBO,SAAS,EAAYlwB,GACJ,iBAAXA,GAAuBA,EAAOq4B,eACpC,aAAcr4B,EAAOq4B,cAAcl+B,aAClC,gBAAiB6F,EAAOq4B,cAAcl+B,YAC1CuD,OAAO4L,eAAetJ,EAAOq4B,cAAcl+B,UAAW,cAAe,CACnEqP,MACE,MAAO,CAAC7C,SAAUrQ,KAAKqQ,SACzB,GAGN,CAEO,SAAS,EAAmB3G,EAAQqvB,GACzC,GAAsB,iBAAXrvB,IACLA,EAAOiH,oBAAqBjH,EAAOs4B,qBACvC,QAEGt4B,EAAOiH,mBAAqBjH,EAAOs4B,uBAEtCt4B,EAAOiH,kBAAoBjH,EAAOs4B,sBAGhCjJ,EAAe9T,QAAU,IAE3B,CAAC,sBAAuB,uBAAwB,mBAC3C9X,SAAQ,SAAS6D,GAChB,MAAMoO,EAAe1V,EAAOiH,kBAAkB9M,UAAUmN,GAClDmvB,EAAY,CAAC,CAACnvB,KAIlB,OAHAuL,UAAU,GAAK,IAAiB,oBAAXvL,EACjBtH,EAAOi3B,gBACPj3B,EAAOwT,uBAAuBX,UAAU,IACrC6C,EAAaT,MAAM3e,KAAMuc,UAClC,GACA7S,EAAOiH,kBAAkB9M,UAAUmN,GAAUmvB,EAAUnvB,EACzD,IAGN,MAAMixB,EAAmB,CACvBnjB,WAAY,cACZC,YAAa,eACbC,cAAe,iBACfC,eAAgB,kBAChBC,gBAAiB,oBAGbgjB,EAAiBx4B,EAAOiH,kBAAkB9M,UAAU+Z,SAC1DlU,EAAOiH,kBAAkB9M,UAAU+Z,SAAW,WAC5C,MAAOC,EAAUqgB,EAAQC,GAAS5hB,UAClC,OAAO2lB,EAAevjB,MAAM3e,KAAM,CAAC6d,GAAY,OAC5CK,MAAKI,IACJ,GAAIya,EAAe9T,QAAU,KAAOiZ,EAGlC,IACE5f,EAAMnR,SAAQoR,IACZA,EAAKhf,KAAO0iC,EAAiB1jB,EAAKhf,OAASgf,EAAKhf,IAAI,GAExD,CAAE,MAAO+J,GACP,GAAe,cAAXA,EAAE2D,KACJ,MAAM3D,EAGRgV,EAAMnR,SAAQ,CAACoR,EAAMtf,KACnBqf,EAAME,IAAIvf,EAAGmI,OAAO0P,OAAO,CAAC,EAAGyH,EAAM,CACnChf,KAAM0iC,EAAiB1jB,EAAKhf,OAASgf,EAAKhf,OACzC,GAEP,CAEF,OAAO+e,CAAK,IAEbJ,KAAKggB,EAAQC,EAClB,CACF,CAEO,SAASgE,EAAmBz4B,GACjC,GAAwB,iBAAXA,IAAuBA,EAAOiH,oBACvCjH,EAAOkL,aACT,OAEF,GAAIlL,EAAOkL,cAAgB,aAAclL,EAAOkL,aAAa/Q,UAC3D,OAEF,MAAMi6B,EAAiBp0B,EAAOiH,kBAAkB9M,UAAU6R,WACtDooB,IACFp0B,EAAOiH,kBAAkB9M,UAAU6R,WAAa,WAC9C,MAAMqoB,EAAUD,EAAenf,MAAM3e,KAAM,IAE3C,OADA+9B,EAAQ5wB,SAAQkI,GAAUA,EAAOmoB,IAAMx9B,OAChC+9B,CACT,GAGF,MAAML,EAAeh0B,EAAOiH,kBAAkB9M,UAAUmM,SACpD0tB,IACFh0B,EAAOiH,kBAAkB9M,UAAUmM,SAAW,WAC5C,MAAMqF,EAASqoB,EAAa/e,MAAM3e,KAAMuc,WAExC,OADAlH,EAAOmoB,IAAMx9B,KACNqV,CACT,GAEF3L,EAAOkL,aAAa/Q,UAAU+Z,SAAW,WACvC,OAAO5d,KAAKqL,MAAQrL,KAAKw9B,IAAI5f,SAAS5d,KAAKqL,OACvCsN,QAAQgB,QAAQ,IAAI0E,IAC1B,CACF,CAEO,SAAS+jB,EAAqB14B,GACnC,GAAwB,iBAAXA,IAAuBA,EAAOiH,oBACvCjH,EAAOkL,aACT,OAEF,GAAIlL,EAAOkL,cAAgB,aAAclL,EAAOsR,eAAenX,UAC7D,OAEF,MAAMi7B,EAAmBp1B,EAAOiH,kBAAkB9M,UAAU8R,aACxDmpB,IACFp1B,EAAOiH,kBAAkB9M,UAAU8R,aAAe,WAChD,MAAMopB,EAAYD,EAAiBngB,MAAM3e,KAAM,IAE/C,OADA++B,EAAU5xB,SAAQkD,GAAYA,EAASmtB,IAAMx9B,OACtC++B,CACT,GAEF,EAA8Br1B,EAAQ,SAASJ,IAC7CA,EAAE+G,SAASmtB,IAAMl0B,EAAE01B,WACZ11B,KAETI,EAAOsR,eAAenX,UAAU+Z,SAAW,WACzC,OAAO5d,KAAKw9B,IAAI5f,SAAS5d,KAAKqL,MAChC,CACF,CAEO,SAASg3B,EAAiB34B,GAC1BA,EAAOiH,qBACR,iBAAkBjH,EAAOiH,kBAAkB9M,aAG/C6F,EAAOiH,kBAAkB9M,UAAU4R,aACjC,SAAsBnL,GACpB,EAAiB,eAAgB,eACjCtK,KAAK0V,aAAavI,SAAQkI,IACpBA,EAAOhK,OAASf,EAAOwK,YAAYsc,SAAS/b,EAAOhK,QACrDrL,KAAKoV,YAAYC,EACnB,GAEJ,EACJ,CAEO,SAASitB,EAAmB54B,GAG7BA,EAAO64B,cAAgB74B,EAAO84B,iBAChC94B,EAAO84B,eAAiB94B,EAAO64B,YAEnC,CAEO,SAASE,EAAmB/4B,GAIjC,GAAwB,iBAAXA,IAAuBA,EAAOiH,kBACzC,OAEF,MAAM+xB,EAAqBh5B,EAAOiH,kBAAkB9M,UAAU8+B,eAC1DD,IACFh5B,EAAOiH,kBAAkB9M,UAAU8+B,eACjC,WACE3iC,KAAK4iC,sBAAwB,GAC7B,MAAMC,EAAiBtmB,UAAU,GAC3BumB,EAAqBD,GACD,kBAAmBA,EACzCC,GAEFD,EAAeE,cAAc51B,SAAS61B,IACpC,GAAI,QAASA,IACM,oBACHC,KAAKD,EAAcE,KAC/B,MAAM,IAAIvzB,UAAU,+BAGxB,GAAI,0BAA2BqzB,KACvBG,WAAWH,EAAcI,wBAA0B,GACvD,MAAM,IAAIC,WAAW,2CAGzB,GAAI,iBAAkBL,KACdG,WAAWH,EAAcM,eAAiB,GAC9C,MAAM,IAAID,WAAW,+BAEzB,IAGJ,MAAMj5B,EAAcs4B,EAAmB/jB,MAAM3e,KAAMuc,WACnD,GAAIumB,EAAoB,CAQtB,MAAM,OAACztB,GAAUjL,EACX8N,EAAS7C,EAAOkuB,mBAChB,cAAerrB,IAEY,IAA5BA,EAAOC,UAAU7U,QAC2B,IAA5C8D,OAAO2B,KAAKmP,EAAOC,UAAU,IAAI7U,UACpC4U,EAAOC,UAAY0qB,EAAeE,cAClC1tB,EAAO0tB,cAAgBF,EAAeE,cACtC/iC,KAAK4iC,sBAAsB94B,KAAKuL,EAAOmuB,cAActrB,GAClDgG,MAAK,YACG7I,EAAO0tB,aAAa,IAC1BhR,OAAM,YACA1c,EAAO0tB,aAAa,KAInC,CACA,OAAO34B,CACT,EAEN,CAEO,SAASq5B,EAAkB/5B,GAChC,GAAwB,iBAAXA,IAAuBA,EAAOkL,aACzC,OAEF,MAAM8uB,EAAoBh6B,EAAOkL,aAAa/Q,UAAU0/B,cACpDG,IACFh6B,EAAOkL,aAAa/Q,UAAU0/B,cAC5B,WACE,MAAMrrB,EAASwrB,EAAkB/kB,MAAM3e,KAAMuc,WAI7C,MAHM,cAAerE,IACnBA,EAAOC,UAAY,GAAGuhB,OAAO15B,KAAK+iC,eAAiB,CAAC,CAAC,KAEhD7qB,CACT,EAEN,CAEO,SAASyrB,EAAgBj6B,GAI9B,GAAwB,iBAAXA,IAAuBA,EAAOiH,kBACzC,OAEF,MAAMizB,EAAkBl6B,EAAOiH,kBAAkB9M,UAAUsY,YAC3DzS,EAAOiH,kBAAkB9M,UAAUsY,YAAc,WAC/C,OAAInc,KAAK4iC,uBAAyB5iC,KAAK4iC,sBAAsBt/B,OACpDqV,QAAQsF,IAAIje,KAAK4iC,uBACvB1kB,MAAK,IACG0lB,EAAgBjlB,MAAM3e,KAAMuc,aAEpCsnB,SAAQ,KACP7jC,KAAK4iC,sBAAwB,EAAE,IAG5BgB,EAAgBjlB,MAAM3e,KAAMuc,UACrC,CACF,CAEO,SAASunB,EAAiBp6B,GAI/B,GAAwB,iBAAXA,IAAuBA,EAAOiH,kBACzC,OAEF,MAAMozB,EAAmBr6B,EAAOiH,kBAAkB9M,UAAUsZ,aAC5DzT,EAAOiH,kBAAkB9M,UAAUsZ,aAAe,WAChD,OAAInd,KAAK4iC,uBAAyB5iC,KAAK4iC,sBAAsBt/B,OACpDqV,QAAQsF,IAAIje,KAAK4iC,uBACvB1kB,MAAK,IACG6lB,EAAiBplB,MAAM3e,KAAMuc,aAErCsnB,SAAQ,KACP7jC,KAAK4iC,sBAAwB,EAAE,IAG5BmB,EAAiBplB,MAAM3e,KAAMuc,UACtC,CACF,CC7RO,SAASynB,EAAoBt6B,GAClC,GAAsB,iBAAXA,GAAwBA,EAAOiH,kBAA1C,CAYA,GATM,oBAAqBjH,EAAOiH,kBAAkB9M,YAClD6F,EAAOiH,kBAAkB9M,UAAUmQ,gBACjC,WAIE,OAHKhU,KAAKikC,gBACRjkC,KAAKikC,cAAgB,IAEhBjkC,KAAKikC,aACd,KAEE,cAAev6B,EAAOiH,kBAAkB9M,WAAY,CACxD,MAAMqgC,EAAYx6B,EAAOiH,kBAAkB9M,UAAUmM,SACrDtG,EAAOiH,kBAAkB9M,UAAUgR,UAAY,SAAmBvK,GAC3DtK,KAAKikC,gBACRjkC,KAAKikC,cAAgB,IAElBjkC,KAAKikC,cAAc7S,SAAS9mB,IAC/BtK,KAAKikC,cAAcn6B,KAAKQ,GAI1BA,EAAOgT,iBAAiBnQ,SAAQ9B,GAAS64B,EAAUrS,KAAK7xB,KAAMqL,EAC5Df,KACFA,EAAOiT,iBAAiBpQ,SAAQ9B,GAAS64B,EAAUrS,KAAK7xB,KAAMqL,EAC5Df,IACJ,EAEAZ,EAAOiH,kBAAkB9M,UAAUmM,SACjC,SAAkB3E,KAAUiF,GAU1B,OATIA,GACFA,EAAQnD,SAAS7C,IACVtK,KAAKikC,cAEEjkC,KAAKikC,cAAc7S,SAAS9mB,IACtCtK,KAAKikC,cAAcn6B,KAAKQ,GAFxBtK,KAAKikC,cAAgB,CAAC35B,EAGxB,IAGG45B,EAAUvlB,MAAM3e,KAAMuc,UAC/B,CACJ,CACM,iBAAkB7S,EAAOiH,kBAAkB9M,YAC/C6F,EAAOiH,kBAAkB9M,UAAU4R,aACjC,SAAsBnL,GACftK,KAAKikC,gBACRjkC,KAAKikC,cAAgB,IAEvB,MAAM/gC,EAAQlD,KAAKikC,cAAcz1B,QAAQlE,GACzC,IAAe,IAAXpH,EACF,OAEFlD,KAAKikC,cAAczuB,OAAOtS,EAAO,GACjC,MAAMihC,EAAS75B,EAAOwK,YACtB9U,KAAK0V,aAAavI,SAAQkI,IACpB8uB,EAAO/S,SAAS/b,EAAOhK,QACzBrL,KAAKoV,YAAYC,EACnB,GAEJ,EA1DJ,CA4DF,CAEO,SAAS+uB,EAAqB16B,GACnC,GAAsB,iBAAXA,GAAwBA,EAAOiH,oBAGpC,qBAAsBjH,EAAOiH,kBAAkB9M,YACnD6F,EAAOiH,kBAAkB9M,UAAUoQ,iBACjC,WACE,OAAOjU,KAAKqkC,eAAiBrkC,KAAKqkC,eAAiB,EACrD,KAEE,gBAAiB36B,EAAOiH,kBAAkB9M,YAAY,CAC1DuD,OAAO4L,eAAetJ,EAAOiH,kBAAkB9M,UAAW,cAAe,CACvEqP,MACE,OAAOlT,KAAKskC,YACd,EACA9lB,IAAIue,GACE/8B,KAAKskC,eACPtkC,KAAKwC,oBAAoB,YAAaxC,KAAKskC,cAC3CtkC,KAAKwC,oBAAoB,QAASxC,KAAKukC,mBAEzCvkC,KAAKI,iBAAiB,YAAaJ,KAAKskC,aAAevH,GACvD/8B,KAAKI,iBAAiB,QAASJ,KAAKukC,iBAAoBj7B,IACtDA,EAAEgH,QAAQnD,SAAQ7C,IAIhB,GAHKtK,KAAKqkC,iBACRrkC,KAAKqkC,eAAiB,IAEpBrkC,KAAKqkC,eAAejT,SAAS9mB,GAC/B,OAEFtK,KAAKqkC,eAAev6B,KAAKQ,GACzB,MAAMuJ,EAAQ,IAAIrD,MAAM,aACxBqD,EAAMvJ,OAASA,EACftK,KAAKiQ,cAAc4D,EAAM,GACzB,EAEN,IAEF,MAAMmpB,EACJtzB,EAAOiH,kBAAkB9M,UAAUyK,qBACrC5E,EAAOiH,kBAAkB9M,UAAUyK,qBACjC,WACE,MAAM8B,EAAKpQ,KAiBX,OAhBKA,KAAKukC,kBACRvkC,KAAKI,iBAAiB,QAASJ,KAAKukC,iBAAmB,SAASj7B,GAC9DA,EAAEgH,QAAQnD,SAAQ7C,IAIhB,GAHK8F,EAAGi0B,iBACNj0B,EAAGi0B,eAAiB,IAElBj0B,EAAGi0B,eAAe71B,QAAQlE,IAAW,EACvC,OAEF8F,EAAGi0B,eAAev6B,KAAKQ,GACvB,MAAMuJ,EAAQ,IAAIrD,MAAM,aACxBqD,EAAMvJ,OAASA,EACf8F,EAAGH,cAAc4D,EAAM,GAE3B,GAEKmpB,EAAyBre,MAAMvO,EAAImM,UAC5C,CACJ,CACF,CAEO,SAASioB,EAAiB96B,GAC/B,GAAsB,iBAAXA,IAAwBA,EAAOiH,kBACxC,OAEF,MAAM9M,EAAY6F,EAAOiH,kBAAkB9M,UACrC+/B,EAAkB//B,EAAUsY,YAC5B4nB,EAAmBlgC,EAAUsZ,aAC7B9O,EAAsBxK,EAAUwK,oBAChCC,EAAuBzK,EAAUyK,qBACjCmP,EAAkB5Z,EAAU4Z,gBAElC5Z,EAAUsY,YACR,SAAqBsoB,EAAiBC,GACpC,MAAMC,EAAWpoB,UAAUjZ,QAAU,EAAKiZ,UAAU,GAAKA,UAAU,GAC7DqoB,EAAUhB,EAAgBjlB,MAAM3e,KAAM,CAAC2kC,IAC7C,OAAKD,GAGLE,EAAQ1mB,KAAKumB,EAAiBC,GACvB/rB,QAAQgB,WAHNirB,CAIX,EAEF/gC,EAAUsZ,aACR,SAAsBsnB,EAAiBC,GACrC,MAAMC,EAAWpoB,UAAUjZ,QAAU,EAAKiZ,UAAU,GAAKA,UAAU,GAC7DqoB,EAAUb,EAAiBplB,MAAM3e,KAAM,CAAC2kC,IAC9C,OAAKD,GAGLE,EAAQ1mB,KAAKumB,EAAiBC,GACvB/rB,QAAQgB,WAHNirB,CAIX,EAEF,IAAIC,EAAe,SAASt1B,EAAak1B,EAAiBC,GACxD,MAAME,EAAUv2B,EAAoBsQ,MAAM3e,KAAM,CAACuP,IACjD,OAAKm1B,GAGLE,EAAQ1mB,KAAKumB,EAAiBC,GACvB/rB,QAAQgB,WAHNirB,CAIX,EACA/gC,EAAUwK,oBAAsBw2B,EAEhCA,EAAe,SAASt1B,EAAak1B,EAAiBC,GACpD,MAAME,EAAUt2B,EAAqBqQ,MAAM3e,KAAM,CAACuP,IAClD,OAAKm1B,GAGLE,EAAQ1mB,KAAKumB,EAAiBC,GACvB/rB,QAAQgB,WAHNirB,CAIX,EACA/gC,EAAUyK,qBAAuBu2B,EAEjCA,EAAe,SAASl2B,EAAW81B,EAAiBC,GAClD,MAAME,EAAUnnB,EAAgBkB,MAAM3e,KAAM,CAAC2O,IAC7C,OAAK+1B,GAGLE,EAAQ1mB,KAAKumB,EAAiBC,GACvB/rB,QAAQgB,WAHNirB,CAIX,EACA/gC,EAAU4Z,gBAAkBonB,CAC9B,CAEO,SAAS,GAAiBn7B,GAC/B,MAAM+nB,EAAY/nB,GAAUA,EAAO+nB,UAEnC,GAAIA,EAAUC,cAAgBD,EAAUC,aAAaC,aAAc,CAEjE,MAAMD,EAAeD,EAAUC,aACzBoT,EAAgBpT,EAAaC,aAAazxB,KAAKwxB,GACrDD,EAAUC,aAAaC,aAAgBiI,GAC9BkL,EAAcC,GAAgBnL,GAEzC,EAEKnI,EAAUE,cAAgBF,EAAUC,cACvCD,EAAUC,aAAaC,eACvBF,EAAUE,aAAe,SAAsBiI,EAAalD,EAAIsO,GAC9DvT,EAAUC,aAAaC,aAAaiI,GACnC1b,KAAKwY,EAAIsO,EACZ,EAAE9kC,KAAKuxB,GAEX,CAEO,SAASsT,GAAgBnL,GAC9B,OAAIA,QAAqChqB,IAAtBgqB,EAAYtN,MACtBllB,OAAO0P,OAAO,CAAC,EACpB8iB,EACA,CAACtN,MAAO,EAAoBsN,EAAYtN,SAIrCsN,CACT,CAEO,SAASqL,GAAqBv7B,GACnC,IAAKA,EAAOiH,kBACV,OAGF,MAAMu0B,EAAqBx7B,EAAOiH,kBAClCjH,EAAOiH,kBACL,SAA2Bw0B,EAAUC,GACnC,GAAID,GAAYA,EAASrzB,WAAY,CACnC,MAAMuzB,EAAgB,GACtB,IAAK,IAAIpmC,EAAI,EAAGA,EAAIkmC,EAASrzB,WAAWxO,OAAQrE,IAAK,CACnD,IAAI+S,EAASmzB,EAASrzB,WAAW7S,IAC5B+S,EAAO/I,eAAe,SACvB+I,EAAO/I,eAAe,QACxB,EAAiB,mBAAoB,qBACrC+I,EAAS3E,KAAKC,MAAMD,KAAKE,UAAUyE,IACnCA,EAAOC,KAAOD,EAAOE,WACdF,EAAOE,IACdmzB,EAAcv7B,KAAKkI,IAEnBqzB,EAAcv7B,KAAKq7B,EAASrzB,WAAW7S,GAE3C,CACAkmC,EAASrzB,WAAauzB,CACxB,CACA,OAAO,IAAIH,EAAmBC,EAAUC,EAC1C,EACF17B,EAAOiH,kBAAkB9M,UAAYqhC,EAAmBrhC,UAEpD,wBAAyBqhC,GAC3B99B,OAAO4L,eAAetJ,EAAOiH,kBAAmB,sBAAuB,CACrEuC,IAAG,IACMgyB,EAAmBI,qBAIlC,CAEO,SAASC,GAA0B77B,GAElB,iBAAXA,GAAuBA,EAAOq4B,eACrC,aAAcr4B,EAAOq4B,cAAcl+B,aACjC,gBAAiB6F,EAAOq4B,cAAcl+B,YAC1CuD,OAAO4L,eAAetJ,EAAOq4B,cAAcl+B,UAAW,cAAe,CACnEqP,MACE,MAAO,CAAC7C,SAAUrQ,KAAKqQ,SACzB,GAGN,CAEO,SAASm1B,GAAsB97B,GACpC,MAAMk6B,EAAkBl6B,EAAOiH,kBAAkB9M,UAAUsY,YAC3DzS,EAAOiH,kBAAkB9M,UAAUsY,YACjC,SAAqBG,GACnB,GAAIA,EAAc,MACgC,IAArCA,EAAaI,sBAEtBJ,EAAaI,sBACTJ,EAAaI,qBAEnB,MAAM+oB,EAAmBzlC,KAAK0lC,kBAAkB52B,MAAK1E,GACf,UAApCA,EAAYiG,SAAShF,MAAMX,QACY,IAArC4R,EAAaI,qBAAiC+oB,EACb,aAA/BA,EAAiBtrB,UACfsrB,EAAiBE,aACnBF,EAAiBE,aAAa,YAE9BF,EAAiBtrB,UAAY,WAES,aAA/BsrB,EAAiBtrB,YACtBsrB,EAAiBE,aACnBF,EAAiBE,aAAa,YAE9BF,EAAiBtrB,UAAY,aAGa,IAArCmC,EAAaI,qBACnB+oB,GACHzlC,KAAK2iC,eAAe,cAG0B,IAArCrmB,EAAaK,sBAEtBL,EAAaK,sBACTL,EAAaK,qBAEnB,MAAMipB,EAAmB5lC,KAAK0lC,kBAAkB52B,MAAK1E,GACf,UAApCA,EAAYiG,SAAShF,MAAMX,QACY,IAArC4R,EAAaK,qBAAiCipB,EACb,aAA/BA,EAAiBzrB,UACfyrB,EAAiBD,aACnBC,EAAiBD,aAAa,YAE9BC,EAAiBzrB,UAAY,WAES,aAA/ByrB,EAAiBzrB,YACtByrB,EAAiBD,aACnBC,EAAiBD,aAAa,YAE9BC,EAAiBzrB,UAAY,aAGa,IAArCmC,EAAaK,qBACnBipB,GACH5lC,KAAK2iC,eAAe,QAExB,CACA,OAAOiB,EAAgBjlB,MAAM3e,KAAMuc,UACrC,CACJ,CAEO,SAASspB,GAAiBn8B,GACT,iBAAXA,GAAuBA,EAAOo8B,eAGzCp8B,EAAOo8B,aAAep8B,EAAOq8B,mBAC/B,C,yBClVO,SAASC,GAAoBt8B,GAGlC,IAAKA,EAAOi3B,iBAAoBj3B,EAAOi3B,iBAAmB,eACtDj3B,EAAOi3B,gBAAgB98B,UACzB,OAGF,MAAMoiC,EAAwBv8B,EAAOi3B,gBACrCj3B,EAAOi3B,gBAAkB,SAAyBthB,GAQhD,GANoB,iBAATA,GAAqBA,EAAK1Q,WACA,IAAjC0Q,EAAK1Q,UAAUH,QAAQ,SACzB6Q,EAAOhS,KAAKC,MAAMD,KAAKE,UAAU8R,KAC5B1Q,UAAY0Q,EAAK1Q,UAAUmL,OAAO,IAGrCuF,EAAK1Q,WAAa0Q,EAAK1Q,UAAUrL,OAAQ,CAE3C,MAAM4iC,EAAkB,IAAID,EAAsB5mB,GAC5C8mB,EAAkB,oBAAwB9mB,EAAK1Q,WAC/Cy3B,EAAqBh/B,OAAO0P,OAAOovB,EACrCC,GAWJ,OARAC,EAAmBpvB,OAAS,WAC1B,MAAO,CACLrI,UAAWy3B,EAAmBz3B,UAC9B4H,OAAQ6vB,EAAmB7vB,OAC3BV,cAAeuwB,EAAmBvwB,cAClCc,iBAAkByvB,EAAmBzvB,iBAEzC,EACOyvB,CACT,CACA,OAAO,IAAIH,EAAsB5mB,EACnC,EACA3V,EAAOi3B,gBAAgB98B,UAAYoiC,EAAsBpiC,UAIzD,EAA8B6F,EAAQ,gBAAgBJ,IAChDA,EAAEqF,WACJvH,OAAO4L,eAAe1J,EAAG,YAAa,CACpCrD,MAAO,IAAIyD,EAAOi3B,gBAAgBr3B,EAAEqF,WACpCoH,SAAU,UAGPzM,IAEX,CAEO,SAAS+8B,GAAmB38B,EAAQqvB,GACzC,IAAKrvB,EAAOiH,kBACV,OAGI,SAAUjH,EAAOiH,kBAAkB9M,WACvCuD,OAAO4L,eAAetJ,EAAOiH,kBAAkB9M,UAAW,OAAQ,CAChEqP,MACE,YAA6B,IAAflT,KAAKsmC,MAAwB,KAAOtmC,KAAKsmC,KACzD,IAIJ,MAmFMtJ,EACFtzB,EAAOiH,kBAAkB9M,UAAUyK,qBACvC5E,EAAOiH,kBAAkB9M,UAAUyK,qBACjC,WAKE,GAJAtO,KAAKsmC,MAAQ,KAIkB,WAA3BvN,EAAewN,SAAwBxN,EAAe9T,SAAW,GAAI,CACvE,MAAM,aAAC6b,GAAgB9gC,KAAK+T,mBACP,WAAjB+sB,GACF15B,OAAO4L,eAAehT,KAAM,OAAQ,CAClCkT,MACE,YAA6B,IAAflT,KAAKsmC,MAAwB,KAAOtmC,KAAKsmC,KACzD,EACAnP,YAAY,EACZlkB,cAAc,GAGpB,CAEA,GAxGsB,SAAS1D,GACjC,IAAKA,IAAgBA,EAAY/E,IAC/B,OAAO,EAET,MAAMyM,EAAW,mBAAuB1H,EAAY/E,KAEpD,OADAyM,EAASnB,QACFmB,EAASwjB,MAAK3hB,IACnB,MAAM0tB,EAAQ,gBAAoB1tB,GAClC,OAAO0tB,GAAwB,gBAAfA,EAAM97B,OACqB,IAApC87B,EAAMp3B,SAASZ,QAAQ,OAAc,GAEhD,CA6FQi4B,CAAkBlqB,UAAU,IAAK,CAEnC,MAAMmqB,EA7FoB,SAASn3B,GAEvC,MAAM4mB,EAAQ5mB,EAAY/E,IAAI2rB,MAAM,mCACpC,GAAc,OAAVA,GAAkBA,EAAM7yB,OAAS,EACnC,OAAQ,EAEV,MAAM2hB,EAAU5Y,SAAS8pB,EAAM,GAAI,IAEnC,OAAOlR,GAAYA,GAAW,EAAIA,CACpC,CAoFwB0hB,CAAwBpqB,UAAU,IAG9CqqB,EArFqB,SAASC,GAKxC,IAAIC,EAAwB,MAwB5B,MAvB+B,YAA3B/N,EAAewN,UAKbO,EAJA/N,EAAe9T,QAAU,IACF,IAArB4hB,EAGsB,MAIA,WAEjB9N,EAAe9T,QAAU,GAML,KAA3B8T,EAAe9T,QAAiB,MAAQ,MAGlB,YAGrB6hB,CACT,CAuDyBC,CAAyBL,GAGtCM,EAxDc,SAASz3B,EAAas3B,GAG9C,IAAIziB,EAAiB,MAKU,YAA3B2U,EAAewN,SACgB,KAA3BxN,EAAe9T,UACrBb,EAAiB,OAGnB,MAAM+R,EAAQ,iBAAqB5mB,EAAY/E,IAC7C,uBAUF,OATI2rB,EAAM7yB,OAAS,EACjB8gB,EAAiB/X,SAAS8pB,EAAM,GAAGrc,OAAO,IAAK,IACX,YAA3Bif,EAAewN,UACO,IAArBM,IAIVziB,EAAiB,YAEZA,CACT,CA+BwB6iB,CAAkB1qB,UAAU,GAAImqB,GAGlD,IAAItiB,EAEFA,EADiB,IAAfwiB,GAAkC,IAAdI,EACLE,OAAOC,kBACA,IAAfP,GAAkC,IAAdI,EACZ5hC,KAAKi0B,IAAIuN,EAAYI,GAErB5hC,KAAKqI,IAAIm5B,EAAYI,GAKxC,MAAMpiB,EAAO,CAAC,EACdxd,OAAO4L,eAAe4R,EAAM,iBAAkB,CAC5C1R,IAAG,IACMkR,IAGXpkB,KAAKsmC,MAAQ1hB,CACf,CAEA,OAAOoY,EAAyBre,MAAM3e,KAAMuc,UAC9C,CACJ,CAEO,SAAS6qB,GAAuB19B,GACrC,IAAMA,EAAOiH,qBACT,sBAAuBjH,EAAOiH,kBAAkB9M,WAClD,OAOF,SAASwjC,EAAWC,EAAIl3B,GACtB,MAAMm3B,EAAsBD,EAAGtvB,KAC/BsvB,EAAGtvB,KAAO,WACR,MAAM3W,EAAOkb,UAAU,GACjBjZ,EAASjC,EAAKiC,QAAUjC,EAAKyC,MAAQzC,EAAKkC,WAChD,GAAsB,SAAlB+jC,EAAGE,YACHp3B,EAAGwU,MAAQthB,EAAS8M,EAAGwU,KAAKR,eAC9B,MAAM,IAAIzU,UAAU,4CAClBS,EAAGwU,KAAKR,eAAiB,WAE7B,OAAOmjB,EAAoB5oB,MAAM2oB,EAAI/qB,UACvC,CACF,CACA,MAAMkrB,EACJ/9B,EAAOiH,kBAAkB9M,UAAU6jC,kBACrCh+B,EAAOiH,kBAAkB9M,UAAU6jC,kBACjC,WACE,MAAMC,EAAcF,EAAsB9oB,MAAM3e,KAAMuc,WAEtD,OADA8qB,EAAWM,EAAa3nC,MACjB2nC,CACT,EACF,EAA8Bj+B,EAAQ,eAAeJ,IACnD+9B,EAAW/9B,EAAEs+B,QAASt+B,EAAEu3B,QACjBv3B,IAEX,CAUO,SAASu+B,GAAoBn+B,GAClC,IAAKA,EAAOiH,mBACR,oBAAqBjH,EAAOiH,kBAAkB9M,UAChD,OAEF,MAAM0yB,EAAQ7sB,EAAOiH,kBAAkB9M,UACvCuD,OAAO4L,eAAeujB,EAAO,kBAAmB,CAC9CrjB,MACE,MAAO,CACL4I,UAAW,YACXF,SAAU,cACV5b,KAAKuR,qBAAuBvR,KAAKuR,kBACrC,EACA4lB,YAAY,EACZlkB,cAAc,IAEhB7L,OAAO4L,eAAeujB,EAAO,0BAA2B,CACtDrjB,MACE,OAAOlT,KAAK8nC,0BAA4B,IAC1C,EACAtpB,IAAIkY,GACE12B,KAAK8nC,2BACP9nC,KAAKwC,oBAAoB,wBACrBxC,KAAK8nC,iCACF9nC,KAAK8nC,0BAEVpR,GACF12B,KAAKI,iBAAiB,wBAClBJ,KAAK8nC,yBAA2BpR,EAExC,EACAS,YAAY,EACZlkB,cAAc,IAGhB,CAAC,sBAAuB,wBAAwB9F,SAAS6D,IACvD,MAAM+2B,EAAaxR,EAAMvlB,GACzBulB,EAAMvlB,GAAU,WAcd,OAbKhR,KAAKgoC,6BACRhoC,KAAKgoC,2BAA6B1+B,IAChC,MAAM8G,EAAK9G,EAAEu3B,OACb,GAAIzwB,EAAG63B,uBAAyB73B,EAAGoB,gBAAiB,CAClDpB,EAAG63B,qBAAuB73B,EAAGoB,gBAC7B,MAAM02B,EAAW,IAAI13B,MAAM,wBAAyBlH,GACpD8G,EAAGH,cAAci4B,EACnB,CACA,OAAO5+B,CAAC,EAEVtJ,KAAKI,iBAAiB,2BACpBJ,KAAKgoC,6BAEFD,EAAWppB,MAAM3e,KAAMuc,UAChC,CAAC,GAEL,CAEO,SAAS4rB,GAAuBz+B,EAAQqvB,GAE7C,IAAKrvB,EAAOiH,kBACV,OAEF,GAA+B,WAA3BooB,EAAewN,SAAwBxN,EAAe9T,SAAW,GACnE,OAEF,GAA+B,WAA3B8T,EAAewN,SAAwBxN,EAAe9T,SAAW,IACnE,OAEF,MAAMmjB,EAAY1+B,EAAOiH,kBAAkB9M,UAAUyK,qBACrD5E,EAAOiH,kBAAkB9M,UAAUyK,qBACnC,SAA8B2O,GAC5B,GAAIA,GAAQA,EAAKzS,MAAuD,IAAhDyS,EAAKzS,IAAIgE,QAAQ,0BAAkC,CACzE,MAAMhE,EAAMyS,EAAKzS,IAAIuP,MAAM,MAAMpM,QAAQ3M,GAChB,yBAAhBA,EAAK2c,SACXvG,KAAK,MAEJ1N,EAAOwT,uBACPD,aAAgBvT,EAAOwT,sBACzBX,UAAU,GAAK,IAAI7S,EAAOwT,sBAAsB,CAC9C3d,KAAM0d,EAAK1d,KACXiL,QAGFyS,EAAKzS,IAAMA,CAEf,CACA,OAAO49B,EAAUzpB,MAAM3e,KAAMuc,UAC/B,CACF,CAEO,SAAS8rB,GAA+B3+B,EAAQqvB,GAKrD,IAAMrvB,EAAOiH,oBAAqBjH,EAAOiH,kBAAkB9M,UACzD,OAEF,MAAMykC,EACF5+B,EAAOiH,kBAAkB9M,UAAU4Z,gBAClC6qB,GAA0D,IAAjCA,EAAsBhlC,SAGpDoG,EAAOiH,kBAAkB9M,UAAU4Z,gBACjC,WACE,OAAKlB,UAAU,IAWkB,WAA3Bwc,EAAewN,SAAwBxN,EAAe9T,QAAU,IAClC,YAA3B8T,EAAewN,SACZxN,EAAe9T,QAAU,IACD,WAA3B8T,EAAewN,UACjBhqB,UAAU,IAAiC,KAA3BA,UAAU,GAAG5N,UAC3BgK,QAAQgB,UAEV2uB,EAAsB3pB,MAAM3e,KAAMuc,YAjBnCA,UAAU,IACZA,UAAU,GAAGoC,MAAM,MAEdhG,QAAQgB,UAenB,EACJ,CCrXA,MAAM4uB,GCIC,UAAwB,OAAC7+B,GAAU,CAAC,EAAGi7B,EAAU,CACtD6D,YAAY,EACZC,aAAa,EACbC,UAAU,EACVC,YAAY,IAGZ,MAAM9P,EAAU,EACVE,Ed6HD,SAAuBrvB,GAE5B,MAAM4uB,EAAS,CAACiO,QAAS,KAAMthB,QAAS,MAGxC,QAAsB,IAAXvb,IAA2BA,EAAO+nB,UAE3C,OADA6G,EAAOiO,QAAU,iBACVjO,EAGT,MAAM,UAAC7G,GAAa/nB,EAEpB,GAAI+nB,EAAUmX,gBACZtQ,EAAOiO,QAAU,UACjBjO,EAAOrT,QAAU+Q,EAAevE,EAAUoX,UACtC,mBAAoB,QACnB,GAAIpX,EAAUiK,qBACW,IAA3BhyB,EAAOo/B,iBAA6Bp/B,EAAOg3B,0BAC1Ch3B,EAAO6I,eAKX+lB,EAAOiO,QAAU,SACjBjO,EAAOrT,QAAU+Q,EAAevE,EAAUoX,UACtC,wBAAyB,QACxB,GAAIpX,EAAUC,cACjBD,EAAUoX,UAAU1S,MAAM,sBAC5BmC,EAAOiO,QAAU,OACjBjO,EAAOrT,QAAU+Q,EAAevE,EAAUoX,UACtC,qBAAsB,OACrB,KAAIn/B,EAAOiH,oBACd8gB,EAAUoX,UAAU1S,MAAM,wBAQ5B,OADAmC,EAAOiO,QAAU,2BACVjO,EAPPA,EAAOiO,QAAU,SACjBjO,EAAOrT,QAAU+Q,EAAevE,EAAUoX,UACtC,uBAAwB,GAC5BvQ,EAAOyQ,oBAAsBr/B,EAAOs/B,mBAChC,qBAAsBt/B,EAAOs/B,kBAAkBnlC,SAIrD,CAEA,OAAOy0B,CACT,CczKyB,CAAoB5uB,GAErC6+B,EAAU,CACdxP,iBACAkQ,WAAU,EACVjT,eAAgB,EAChBoB,WAAY,EACZE,gBAAiB,GAInB,OAAQyB,EAAewN,SACrB,IAAK,SACH,IAAK,IAAe,IACf5B,EAAQ6D,WAEX,OADA3P,EAAQ,wDACD0P,EAET,GAA+B,OAA3BxP,EAAe9T,QAEjB,OADA4T,EAAQ,wDACD0P,EAET1P,EAAQ,+BAER0P,EAAQW,YAAc,EAGtB,GAA0Cx/B,EAAQqvB,GAElD,EAA4BrvB,EAAQqvB,GACpC,EAA2BrvB,GAC3B,EAA8BA,EAAQqvB,GACtC,EAAuBrvB,GACvB,EAAmCA,EAAQqvB,GAC3C,EAAkCrvB,GAClC,EAAwBA,GACxB,EAAsCA,GACtC,EAAgCA,EAAQqvB,GAExC,GAA+BrvB,GAC/B,GAA+BA,GAC/B,GAA8BA,EAAQqvB,GACtC,GAAkCrvB,GAClC,GAAkCA,EAAQqvB,GAC1C,MACF,IAAK,UACH,IAAK,IAAgB,IAChB4L,EAAQ8D,YAEX,OADA5P,EAAQ,yDACD0P,EAET1P,EAAQ,gCAER0P,EAAQW,YAAc,EAGtB,GAA0Cx/B,EAAQqvB,GAElD,EAA6BrvB,EAAQqvB,GACrC,EAA+BrvB,EAAQqvB,GACvC,EAAwBrvB,GACxB,EAA6BA,GAC7B,EAA+BA,GAC/B,EAAiCA,GACjC,EAA+BA,GAC/B,EAA+BA,GAC/B,EAA8BA,GAC9B,EAA4BA,GAC5B,EAA6BA,GAE7B,GAA+BA,GAC/B,GAA+BA,GAC/B,GAA8BA,EAAQqvB,GACtC,GAAkCrvB,GAClC,MACF,IAAK,OACH,IAAK,IAAa,IAAgCi7B,EAAQ+D,SAExD,OADA7P,EAAQ,yDACD0P,EAET1P,EAAQ,6BAER0P,EAAQW,YAAc,EAEtB,EAA0Bx/B,GAC1B,EAA6BA,GAC7B,EAA4BA,EAAQqvB,GACpC,EAA0BrvB,GAI1B,GAA8BA,EAAQqvB,GACtC,GAAkCrvB,GAClC,MACF,IAAK,SACH,IAAK,IAAei7B,EAAQgE,WAE1B,OADA9P,EAAQ,wDACD0P,EAET1P,EAAQ,+BAER0P,EAAQW,YAAc,EAGtB,GAA0Cx/B,EAAQqvB,GAElD,GAAgCrvB,GAChC,GAAiCA,GACjC,EAA4BA,GAC5B,EAA+BA,GAC/B,EAAgCA,GAChC,GAAqCA,GACrC,GAA4BA,GAC5B,GAA4BA,GAE5B,GAA+BA,GAC/B,GAA8BA,EAAQqvB,GACtC,GAAkCrvB,GAClC,GAAkCA,EAAQqvB,GAC1C,MACF,QACEF,EAAQ,wBAIZ,OAAO0P,CACT,CDzIEY,CAAe,CAACz/B,OAA0B,oBAAXA,YAAyBkG,EAAYlG,SACtE,MEZA,SAAS0/B,GAAe9/B,EAAGJ,EAAGmgC,EAAG30B,GAC/BtN,OAAO4L,eAAe1J,EAAGJ,EAAG,CAACgK,IAAKm2B,EAAG7qB,IAAK9J,EAAGyiB,YAAY,EAAMlkB,cAAc,GAC/E,CAGA,IAAIq2B,GACJ,YAAgC,GAC5BC,GAA4C,IAAmB,WAC/D,SAASC,IACLxpC,KAAKypC,MAAQ,CACT,OACA,SACA,QACFrY,SAASK,UAAUiY,UACrB1pC,KAAK2pC,kBAAoB,CACrB,UACA,SACA,UAEJ3pC,KAAK4pC,kBAAoB,GACzB5pC,KAAK6pC,iBAAmB,GACxB7pC,KAAK8pC,iBAAmB,GAC5B,CAwCA,OAvCAN,EAAQ3lC,UAAUkmC,kBAAoB,WAClC,MAAoC,oBAAtBp5B,iBAClB,EACA64B,EAAQ3lC,UAAUmmC,mBAAqB,WACnC,IAAIzD,EAAUvmC,KAAKiqC,aACfhlB,EAAUjlB,KAAKkqC,aAEnB,QADmBlqC,KAAK2pC,kBAAkBvY,SAASmV,KAEnC,WAAZA,EAA6BthB,GAAWjlB,KAAK6pC,iBACjC,YAAZtD,EAA8BthB,GAAWjlB,KAAK4pC,kBAClC,WAAZrD,IAA8BvmC,KAAKypC,OAASxkB,GAAWjlB,KAAK8pC,iBAEpE,EACAN,EAAQ3lC,UAAUomC,WAAa,WAC3B,OAAOX,GAAoCvQ,eAAewN,OAC9D,EACAiD,EAAQ3lC,UAAUqmC,WAAa,WAC3B,OAAOZ,GAAoCvQ,eAAe9T,SAAW,CACzE,EACAukB,EAAQ3lC,UAAUsmC,uBAAyB,WACvC,IAKIC,EALA7D,EAAUvmC,KAAKiqC,aACfhlB,EAAUqkB,GAAoCvQ,eAAe9T,SAAW,EAC5E,GAAgB,WAAZshB,GAAwBthB,EAAUjlB,KAAK6pC,iBAAkB,OAAO,EACpE,GAAgB,YAAZtD,GAAyBthB,GAAWjlB,KAAK4pC,kBAAmB,OAAO,EACvE,IAAKlgC,OAAOs/B,qBAAuB,qBAAsBA,kBAAkBnlC,WAAY,OAAO,EAE9F,IAAIwmC,GAAY,EAChB,KACID,EAAS,IAAIz5B,mBACNgyB,eAAe,SACtB0H,GAAY,CAChB,CAAE,MAAO/gC,GAAI,CAAE,QACP8gC,GAAQA,EAAO5uB,OACvB,CACA,OAAO6uB,CACX,EACAb,EAAQ3lC,UAAUwD,SAAW,WACzB,MAAO,0BAA0BqyB,OAAO15B,KAAKiqC,aAAc,kBAAkBvQ,OAAO15B,KAAKkqC,aAAc,gBAAgBxQ,OAAO15B,KAAKypC,MAAO,4BAA4B/P,OAAO15B,KAAK+pC,oBAAqB,6BAA6BrQ,OAAO15B,KAAKgqC,qBAAsB,iCAAiCtQ,OAAO15B,KAAKmqC,yBACvT,EACOX,CACX,CAxDkE,IA2D9Dc,GAAuC,CACvCx4B,WAAY,CACR,CACIG,KAAM,gCAEV,CACIA,KAAM,CACF,iCACA,kCAEJkT,SAAU,SACVolB,WAAY,YAGpBzJ,aAAc,gBAyGd0J,GAA4C,IAvGD,WAC3C,SAASC,IACLzqC,KAAK0qC,WAAa,eAClB1qC,KAAK2qC,WAAa,IAElB3qC,KAAK4qC,gBAAkB,CACnBC,OAAQ,EACRC,OAAQ,GAEZ9qC,KAAK+qC,WAAa,MAElB/qC,KAAKgrC,cAAgBV,GACrBtqC,KAAKumC,QAAUgD,GAA0CU,aACzDjqC,KAAKirC,eAAiB1B,GAA0CW,aAEhElqC,KAAKkrC,SAAW,WACZ,IASI96B,EATAi6B,EAAY,CACZ9D,QAASgD,GAA0CS,qBACnDmB,OAAQ5B,GAA0CQ,oBAClDqB,YAAY,EACZ/pC,MAAM,EACNgqC,YAAY,EACZC,UAAU,GAEd,IAAKjB,EAAUc,OAAQ,OAAOd,EAE9B,IACIj6B,EAAK,IAAIO,kBAAkB25B,IAC3BD,EAAUe,YAAa,EACvB,IAAI9D,OAAK,EACT,IACIA,EAAKl3B,EAAGs3B,kBAAkB,cAAe,CACrC6D,SAAS,IAEblB,EAAUhpC,MAAO,EACjBgpC,EAAUiB,WAAahE,EAAGiE,QAE1B,IACIjE,EAAGkE,WAAa,OAChBnB,EAAUgB,YAAc9B,GAA0CE,KACtE,CAAE,MAAOngC,GAAI,CACjB,CAAE,MAAOA,GAAI,CAAE,QACPg+B,GAAIA,EAAG9rB,OACf,CACJ,CAAE,MAAOlS,GAAI,CAAE,QACP8G,GAAIA,EAAGoL,OACf,CACA,OAAO6uB,CACX,CAjCgB,GAkChBrqC,KAAK8C,KAAO,OACZ9C,KAAK4C,OAAS,SAEd5C,KAAKyrC,WAAa,CACtB,CAgDA,OA/CAhB,EAAK5mC,UAAU6nC,KAAO,WAAY,EAElCjB,EAAK5mC,UAAU8nC,WAAa,SAASrgC,GAEjC,OAAQA,GAAM,uCAAuC23B,KAAK33B,EAC9D,EACAm/B,EAAK5mC,UAAU+nC,MAAQ,SAASjkC,GAM5B,IALA,IAAIkkC,EAAS,GACT/nC,EAAO6D,EAAK7D,KACZgoC,EAAQ1mC,KAAK2mC,KAAKjoC,EAAO0mC,GAA0CO,YACnE7nC,EAAQ,EACRuW,EAAQ,EACNA,EAAQ3V,GAAK,CACf,IAAIoS,EAAM9Q,KAAKqI,IAAI3J,EAAM2V,EAAQ+wB,GAA0CO,YACvEhR,EAAIpyB,EAAKnC,MAAMiU,EAAOvD,GACtB01B,EAAQ,CACRI,WAAYhsC,KAAKyrC,WACjBviC,EAAGhG,EACH7B,KAAM04B,EACN+R,MAAOA,GAEXD,EAAO/hC,KAAK8hC,GACZnyB,EAAQvD,EACRhT,GACJ,CAEA,OADAlD,KAAKyrC,aACEI,CACX,EACApB,EAAK5mC,UAAUooC,kBAAoB,SAAStkC,EAAM+uB,GAC9C,IAAIwV,EAAK,IAAIC,WAKb,OAJAD,EAAGE,OAAS,SAAS91B,GACbA,EAAIuqB,QAAQnK,EAAGpgB,EAAIuqB,OAAOvI,OAClC,EACA4T,EAAGG,kBAAkB1kC,GACdukC,CACX,EACAzB,EAAK5mC,UAAUyoC,0BAA4B,SAASC,GAEhD,IADA,IAAIC,EAAY,IAAInpC,WAAWkpC,EAAOjpC,QAC9BrE,EAAI,EAAGA,EAAIstC,EAAOjpC,OAAQrE,IAAIutC,EAAUvtC,GAA4B,IAAvBstC,EAAO3oC,WAAW3E,GACvE,OAAOutC,EAAUrlC,MACrB,EACAsjC,EAAK5mC,UAAU4oC,YAAc,WACzB,OAAOrnC,KAAKma,SAASlY,SAAS,IAAI7B,MAAM,EAC5C,EACAilC,EAAK5mC,UAAU6oC,SAAW,WACtB,MAA6B,WAAtBxb,SAAS9hB,QACpB,EACOq7B,CACX,CAtG+C,IA4G/CrB,GAFgC,CAAC,EAES,QAAQ,IAAMuD,KAA4CtD,GAAMsD,GAA4CtD,IACtJ,IAAIuD,GAEAC,GAA4BzlC,OAAOvD,UAAUoF,eAAgB6jC,GAA+B,IAO5F,SAASC,KAAgC,CAwBzC,SAASC,GAAyBC,EAAIC,EAASC,GAC/CntC,KAAKitC,GAAKA,EACVjtC,KAAKktC,QAAUA,EACfltC,KAAKmtC,KAAOA,IAAQ,CACxB,CAWI,SAASC,GAAkCC,EAASx5B,EAAOo5B,EAAIC,EAASC,GACxE,GAAkB,mBAAPF,EAAmB,MAAM,IAAIt9B,UAAU,mCAClD,IAAI29B,EAAW,IAAIN,GAAyBC,EAAIC,GAAWG,EAASF,GAAO72B,EAAMw2B,GAA+BA,GAA+Bj5B,EAAQA,EAOvJ,OANKw5B,EAAQE,QAAQj3B,GACX+2B,EAAQE,QAAQj3B,GAAK22B,GAC1BI,EAAQE,QAAQj3B,GAAO,CACxB+2B,EAAQE,QAAQj3B,GAChBg3B,GAH+BD,EAAQE,QAAQj3B,GAAKxM,KAAKwjC,IADlCD,EAAQE,QAAQj3B,GAAOg3B,EAAUD,EAAQG,gBAM7DH,CACX,CAOI,SAASI,GAAiCJ,EAAS/2B,GACpB,KAAzB+2B,EAAQG,aAAoBH,EAAQE,QAAU,IAAIR,UAC5CM,EAAQE,QAAQj3B,EAChC,CAOI,SAASo3B,KACT1tC,KAAKutC,QAAU,IAAIR,GACnB/sC,KAAKwtC,aAAe,CACxB,CA7DIpmC,OAAOumC,SACPZ,GAA6BlpC,UAAYuD,OAAOumC,OAAO,OAKlD,IAAIZ,IAA+Ba,YAAWd,IAA+B,IA8DlFY,GAAmC7pC,UAAUgqC,WAAa,WAC1D,IAAgBC,EAAQ7gC,EAApByxB,EAAQ,GACZ,GAA0B,IAAtB1+B,KAAKwtC,aAAoB,OAAO9O,EACpC,IAAIzxB,KAAQ6gC,EAAS9tC,KAAKutC,QAAYV,GAA0Bhb,KAAKic,EAAQ7gC,IAAOyxB,EAAM50B,KAAKgjC,GAA+B7/B,EAAKzH,MAAM,GAAKyH,GAC9I,OAAI7F,OAAO2mC,sBAA8BrP,EAAMhF,OAAOtyB,OAAO2mC,sBAAsBD,IAC5EpP,CACX,EAOIgP,GAAmC7pC,UAAUmqC,UAAY,SAAmBn6B,GAC5E,IAAIyC,EAAMw2B,GAA+BA,GAA+Bj5B,EAAQA,EAAOo6B,EAAWjuC,KAAKutC,QAAQj3B,GAC/G,IAAK23B,EAAU,MAAO,GACtB,GAAIA,EAAShB,GAAI,MAAO,CACpBgB,EAAShB,IAEb,IAAI,IAAIhuC,EAAI,EAAGivC,EAAID,EAAS3qC,OAAQ6qC,EAAK,IAAIroC,MAAMooC,GAAIjvC,EAAIivC,EAAGjvC,IAAIkvC,EAAGlvC,GAAKgvC,EAAShvC,GAAGguC,GACtF,OAAOkB,CACX,EAOIT,GAAmC7pC,UAAUuqC,cAAgB,SAAuBv6B,GACpF,IAAIyC,EAAMw2B,GAA+BA,GAA+Bj5B,EAAQA,EAAOm6B,EAAYhuC,KAAKutC,QAAQj3B,GAChH,OAAK03B,EACDA,EAAUf,GAAW,EAClBe,EAAU1qC,OAFM,CAG3B,EAOIoqC,GAAmC7pC,UAAUskB,KAAO,SAActU,EAAOw6B,EAAIC,EAAIC,EAAIC,EAAIC,GACzF,IAAIn4B,EAAMw2B,GAA+BA,GAA+Bj5B,EAAQA,EAChF,IAAK7T,KAAKutC,QAAQj3B,GAAM,OAAO,EAC/B,IAA2D+I,EAAMpgB,EAA7D+uC,EAAYhuC,KAAKutC,QAAQj3B,GAAMo4B,EAAMnyB,UAAUjZ,OACnD,GAAI0qC,EAAUf,GAAI,CAEd,OADIe,EAAUb,MAAMntC,KAAK2uC,eAAe96B,EAAOm6B,EAAUf,QAAIr9B,GAAW,GACjE8+B,GACH,KAAK,EACD,OAAOV,EAAUf,GAAGpb,KAAKmc,EAAUd,UAAU,EACjD,KAAK,EACD,OAAOc,EAAUf,GAAGpb,KAAKmc,EAAUd,QAASmB,IAAK,EACrD,KAAK,EACD,OAAOL,EAAUf,GAAGpb,KAAKmc,EAAUd,QAASmB,EAAIC,IAAK,EACzD,KAAK,EACD,OAAON,EAAUf,GAAGpb,KAAKmc,EAAUd,QAASmB,EAAIC,EAAIC,IAAK,EAC7D,KAAK,EACD,OAAOP,EAAUf,GAAGpb,KAAKmc,EAAUd,QAASmB,EAAIC,EAAIC,EAAIC,IAAK,EACjE,KAAK,EACD,OAAOR,EAAUf,GAAGpb,KAAKmc,EAAUd,QAASmB,EAAIC,EAAIC,EAAIC,EAAIC,IAAK,EAEzE,IAAIxvC,EAAI,EAAGogB,EAAO,IAAIvZ,MAAM4oC,EAAM,GAAIzvC,EAAIyvC,EAAKzvC,IAAIogB,EAAKpgB,EAAI,GAAKsd,UAAUtd,GAC3E+uC,EAAUf,GAAGtuB,MAAMqvB,EAAUd,QAAS7tB,EAC1C,KAAO,CACH,IAA+BhZ,EAA3B/C,EAAS0qC,EAAU1qC,OACvB,IAAIrE,EAAI,EAAGA,EAAIqE,EAAQrE,IAEnB,OADI+uC,EAAU/uC,GAAGkuC,MAAMntC,KAAK2uC,eAAe96B,EAAOm6B,EAAU/uC,GAAGguC,QAAIr9B,GAAW,GACvE8+B,GACH,KAAK,EACDV,EAAU/uC,GAAGguC,GAAGpb,KAAKmc,EAAU/uC,GAAGiuC,SAClC,MACJ,KAAK,EACDc,EAAU/uC,GAAGguC,GAAGpb,KAAKmc,EAAU/uC,GAAGiuC,QAASmB,GAC3C,MACJ,KAAK,EACDL,EAAU/uC,GAAGguC,GAAGpb,KAAKmc,EAAU/uC,GAAGiuC,QAASmB,EAAIC,GAC/C,MACJ,KAAK,EACDN,EAAU/uC,GAAGguC,GAAGpb,KAAKmc,EAAU/uC,GAAGiuC,QAASmB,EAAIC,EAAIC,GACnD,MACJ,QACI,IAAKlvB,EAAM,IAAIhZ,EAAI,EAAGgZ,EAAO,IAAIvZ,MAAM4oC,EAAM,GAAIroC,EAAIqoC,EAAKroC,IAAIgZ,EAAKhZ,EAAI,GAAKkW,UAAUlW,GACtF2nC,EAAU/uC,GAAGguC,GAAGtuB,MAAMqvB,EAAU/uC,GAAGiuC,QAAS7tB,GAG5D,CACA,OAAO,CACX,EASIquB,GAAmC7pC,UAAU2tB,GAAK,SAAY3d,EAAOo5B,EAAIC,GACzE,OAAOE,GAAkCptC,KAAM6T,EAAOo5B,EAAIC,GAAS,EACvE,EASIQ,GAAmC7pC,UAAUspC,KAAO,SAAct5B,EAAOo5B,EAAIC,GAC7E,OAAOE,GAAkCptC,KAAM6T,EAAOo5B,EAAIC,GAAS,EACvE,EAUIQ,GAAmC7pC,UAAU8qC,eAAiB,SAAwB96B,EAAOo5B,EAAIC,EAASC,GAC1G,IAAI72B,EAAMw2B,GAA+BA,GAA+Bj5B,EAAQA,EAChF,IAAK7T,KAAKutC,QAAQj3B,GAAM,OAAOtW,KAC/B,IAAKitC,EAED,OADAQ,GAAiCztC,KAAMsW,GAChCtW,KAEX,IAAIguC,EAAYhuC,KAAKutC,QAAQj3B,GAC7B,GAAI03B,EAAUf,GACNe,EAAUf,KAAOA,GAAQE,IAAQa,EAAUb,MAAWD,GAAWc,EAAUd,UAAYA,GAAUO,GAAiCztC,KAAMsW,OACzI,CACH,IAAI,IAAIrX,EAAI,EAAG6uC,EAAS,GAAIxqC,EAAS0qC,EAAU1qC,OAAQrE,EAAIqE,EAAQrE,KAAQ+uC,EAAU/uC,GAAGguC,KAAOA,GAAME,IAASa,EAAU/uC,GAAGkuC,MAAQD,GAAWc,EAAU/uC,GAAGiuC,UAAYA,IAASY,EAAOhkC,KAAKkkC,EAAU/uC,IAIlM6uC,EAAOxqC,OAAQtD,KAAKutC,QAAQj3B,GAAyB,IAAlBw3B,EAAOxqC,OAAewqC,EAAO,GAAKA,EACpEL,GAAiCztC,KAAMsW,EAChD,CACA,OAAOtW,IACX,EAOI0tC,GAAmC7pC,UAAU+qC,mBAAqB,SAA4B/6B,GAC9F,IAAIyC,EAQJ,OAPIzC,GACAyC,EAAMw2B,GAA+BA,GAA+Bj5B,EAAQA,EACxE7T,KAAKutC,QAAQj3B,IAAMm3B,GAAiCztC,KAAMsW,KAE9DtW,KAAKutC,QAAU,IAAIR,GACnB/sC,KAAKwtC,aAAe,GAEjBxtC,IACX,EAIA0tC,GAAmC7pC,UAAUgrC,IAAMnB,GAAmC7pC,UAAU8qC,eAChGjB,GAAmC7pC,UAAUirC,YAAcpB,GAAmC7pC,UAAU2tB,GAIxGkc,GAAmCqB,SAAWjC,GAI9CY,GAAmCsB,aAAetB,GAClDd,GAA4Bc,GAI5B,IAAIuB,GAA4B,CAAC,EAEjC7F,GAAe6F,GAA2B,YAAY,IAAMC,KAA4C7F,GAAM6F,GAA4C7F,IAC1JD,GAAe6F,GAA2B,WAAW,IAAME,KAA2C9F,GAAM8F,GAA2C9F,IACvJ,IA6BI6F,GA7BAE,GAAgE,SAASC,EAAGnmC,GAC5E,IAAIxF,EAAsB,mBAAX4rC,QAAyBD,EAAEC,OAAOC,UACjD,IAAK7rC,EAAG,OAAO2rC,EACf,IAAmBnW,EAAY5vB,EAA3BrK,EAAIyE,EAAEmuB,KAAKwd,GAAOG,EAAK,GAC3B,IACI,WAAa,IAANtmC,GAAgBA,KAAM,MAAQgwB,EAAIj6B,EAAEwwC,QAAQpkB,MAAKmkB,EAAG1lC,KAAKovB,EAAEjzB,MACtE,CAAE,MAAOqZ,GACLhW,EAAI,CACAgW,MAAOA,EAEf,CAAE,QACE,IACQ4Z,IAAMA,EAAE7N,OAAS3nB,EAAIzE,EAAU,SAAIyE,EAAEmuB,KAAK5yB,EAClD,CAAE,QACE,GAAIqK,EAAG,MAAMA,EAAEgW,KACnB,CACJ,CACA,OAAOkwB,CACX,EACIE,GAA8E,SAASzgB,EAAID,EAAMlsB,GACjG,GAAIA,GAA6B,IAArByZ,UAAUjZ,OAClB,IAAI,IAA4BksC,EAAxBvwC,EAAI,EAAGivC,EAAIlf,EAAK1rB,OAAYrE,EAAIivC,EAAGjvC,KAAQuwC,GAAQvwC,KAAK+vB,IACvDwgB,IAAIA,EAAK1pC,MAAMjC,UAAU2B,MAAMqsB,KAAK7C,EAAM,EAAG/vB,IAClDuwC,EAAGvwC,GAAK+vB,EAAK/vB,IAGrB,OAAOgwB,EAAGyK,OAAO8V,GAAM1pC,MAAMjC,UAAU2B,MAAMqsB,KAAK7C,GACtD,GAGA,SAAUkgB,GACNA,EAA0CA,EAAoD,SAAI,GAAK,WACvGA,EAA0CA,EAAkD,OAAI,GAAK,SACrGA,EAA0CA,EAAoD,SAAI,GAAK,WACvGA,EAA0CA,EAA+C,IAAI,GAAK,KACrG,CALD,CAKGA,KAA8CA,GAA4C,CAAC,IAC9F,IA+DIS,GAKAC,GAeAC,GAMAC,GAOAC,GAeAC,GAxDAb,GAA2C,IAvDE,WAC7C,SAASc,IACLjwC,KAAKkwC,UAAYhB,GAA0CiB,QAC/D,CAkDA,OAjDA/oC,OAAO4L,eAAei9B,EAAOpsC,UAAW,WAAY,CAChDqP,IAAK,WACD,OAAOlT,KAAKkwC,SAChB,EACA1xB,IAAK,SAAS4xB,GACVpwC,KAAKkwC,UAAYE,CACrB,EACAjZ,YAAY,EACZlkB,cAAc,IAElBg9B,EAAOpsC,UAAU4E,IAAM,WAEnB,IADA,IAAI4W,EAAO,GACHgxB,EAAK,EAAGA,EAAK9zB,UAAUjZ,OAAQ+sC,IAAKhxB,EAAKgxB,GAAM9zB,UAAU8zB,GAC7DrwC,KAAKkwC,WAAahB,GAA0CoB,KAAKtwC,KAAKuwC,OAAO5xB,MAAM3e,KAAM0vC,GAAoC,CAC7HR,GAA0CoB,KAC3ClB,GAA6B/vB,IAAO,GAC3C,EACA4wB,EAAOpsC,UAAUrC,KAAO,WAEpB,IADA,IAAI6d,EAAO,GACHgxB,EAAK,EAAGA,EAAK9zB,UAAUjZ,OAAQ+sC,IAAKhxB,EAAKgxB,GAAM9zB,UAAU8zB,GAC7DrwC,KAAKkwC,WAAahB,GAA0CsB,UAAUxwC,KAAKuwC,OAAO5xB,MAAM3e,KAAM0vC,GAAoC,CAClIR,GAA0CsB,UAC3CpB,GAA6B/vB,IAAO,GAC3C,EACA4wB,EAAOpsC,UAAUyb,MAAQ,WAErB,IADA,IAAID,EAAO,GACHgxB,EAAK,EAAGA,EAAK9zB,UAAUjZ,OAAQ+sC,IAAKhxB,EAAKgxB,GAAM9zB,UAAU8zB,GAC7DrwC,KAAKkwC,WAAahB,GAA0CuB,QAAQzwC,KAAKuwC,OAAO5xB,MAAM3e,KAAM0vC,GAAoC,CAChIR,GAA0CuB,QAC3CrB,GAA6B/vB,IAAO,GAC3C,EACA4wB,EAAOpsC,UAAU6sC,eAAiB,SAASzD,GACvCjtC,KAAKuwC,OAAStD,CAClB,EACAgD,EAAOpsC,UAAU0sC,OAAS,SAASH,GAE/B,IADA,IAAIO,EAAO,GACHN,EAAK,EAAGA,EAAK9zB,UAAUjZ,OAAQ+sC,IAAKM,EAAKN,EAAK,GAAK9zB,UAAU8zB,GACrE,IAAIpmB,EAAOylB,GAAoC,CAjDhB,YAmD5BN,GAA6BuB,IAAO,GACvC,IAAI,IAAI1xC,KAAKgrB,EAASA,EAAKhrB,aAAcqG,QAAO2kB,EAAKhrB,GAAK,IAAMgrB,EAAKhrB,GAAGgO,KAAO,KAAOgd,EAAKhrB,GAAGuwB,SAC1F4gB,GAAYlB,GAA0CoB,IAAK/uC,QAAQkH,IAAIkW,MAAMpd,QAASmuC,GAAoC,GAAIN,GAA6BnlB,IAAO,IAC7JmmB,GAAYlB,GAA0CsB,SAAUjvC,QAAQC,KAAKmd,MAAMpd,QAASmuC,GAAoC,CACrI,WACDN,GAA6BnlB,IAAO,IAC9BmmB,GAAYlB,GAA0CuB,QAAQlvC,QAAQ+d,MAAMX,MAAMpd,QAASmuC,GAAoC,CACpI,SACDN,GAA6BnlB,IAAO,GAC3C,EACOgmB,CACX,CAtDiD,IA0D7CW,GAA4B,CAAC,EAEjCxH,GAAewH,GAA2B,UAAU,IAAMC,KAA4CxH,GAAMwH,GAA4CxH,IAIxJ,SAAUsG,GACNA,EAAgD,KAAI,OACpDA,EAAiD,MAAI,OACxD,CAHD,CAGGA,KAA8CA,GAA4C,CAAC,IAE9F,SAAUC,GACNA,EAA+D,oBAAI,uBACnEA,EAAwD,aAAI,eAC5DA,EAAqD,UAAI,aACzDA,EAAsD,WAAI,cAC1DA,EAAmD,QAAI,UACvDA,EAA2D,gBAAI,mBAC/DA,EAA0D,eAAI,kBAC9DA,EAAuD,YAAI,eAC3DA,EAAuD,YAAI,eAC3DA,EAAwD,aAAI,gBAC5DA,EAAyD,cAAI,iBAC7DA,EAAkD,OAAI,QACzD,CAbD,CAaGA,KAA8CA,GAA4C,CAAC,IAE9F,SAAUC,GACNA,EAAiD,OAAI,SACrDA,EAAqD,WAAI,cACzDA,EAA+C,KAAI,MACtD,CAJD,CAIGA,KAA6CA,GAA2C,CAAC,IAE5F,SAAUC,GACNA,EAAmD,QAAI,UACvDA,EAAwD,aAAI,eAC5DA,EAAiD,MAAI,QACrDA,EAAiD,MAAI,OACxD,CALD,CAKGA,KAA8CA,GAA4C,CAAC,IAE9F,SAAUC,GACNA,EAAqD,UAAI,YACzDA,EAAqD,UAAI,YACzDA,EAAiD,MAAI,QACrDA,EAAkD,OAAI,SACtDA,EAAgD,KAAI,OACpDA,EAAiD,MAAI,QACrDA,EAAmD,QAAI,WACvDA,EAAsD,WAAI,cAC1DA,EAAiD,MAAI,QACrDA,EAAkD,OAAI,QACzD,CAXD,CAWGA,KAA8CA,GAA4C,CAAC,IAI9FC,GAA4B3iC,KAAKC,MAAM,ijKAGvC,IACQwjC,GADJC,IACID,GAAgB,SAASE,EAAIC,GAQ7B,OAPAH,GAAgB1pC,OAAO8pC,gBAAkB,CACrCtD,UAAW,cACD9nC,OAAS,SAAS00B,EAAGT,GAC/BS,EAAEoT,UAAY7T,CAClB,GAAK,SAASS,EAAGT,GACb,IAAI,IAAIvhB,KAAKuhB,EAAM3yB,OAAOvD,UAAUoF,eAAe4oB,KAAKkI,EAAGvhB,KAAIgiB,EAAEhiB,GAAKuhB,EAAEvhB,GAC5E,GACqBw4B,EAAIC,EAC7B,EACO,SAASzW,EAAGT,GACf,GAAiB,mBAANA,GAA0B,OAANA,EAAY,MAAM,IAAIpqB,UAAU,uBAAyBhK,OAAOo0B,GAAK,iCAEpG,SAASoX,IACLnxC,KAAK4G,YAAc4zB,CACvB,CAHAsW,GAActW,EAAGT,GAIjBS,EAAE32B,UAAkB,OAANk2B,EAAa3yB,OAAOumC,OAAO5T,IAAMoX,EAAGttC,UAAYk2B,EAAEl2B,UAAW,IAAIstC,EACnF,GA+CIN,GAA0D,SAASO,GAEvE,SAASP,EAA0CQ,EAAQC,EAAMpiC,EAAMqiC,EAAMvrC,EAAKwrC,QACzD,IAAjBA,IAAyBA,EAAe,KAC5C,IAAIC,EAAQL,EAAOvf,KAAK7xB,OAASA,KACjCyxC,EAAMD,aAAeA,EACrBC,EAAMC,eAAgB,EACtBD,EAAME,eAAiB,GACvB,IAAIC,EAAaP,EAAS,SAAW,QAErC,OADAI,EAAMI,SAAWD,EAAaN,EAAO,IAAMpiC,EAAOqiC,EAAO,cAAgBvrC,EAClEyrC,CACX,CA2GA,OArHAV,GAAgCF,EAA2CO,GAW3EP,EAA0ChtC,UAAU4V,MAAQ,SAASnO,EAAIwmC,GACrE,IAAIL,EAAQzxC,KACZA,KAAK+xC,IAAMzmC,EACX,IAAI0mC,EAAQ,GAAGtY,OAAO15B,KAAK6xC,SAAU,QAAQnY,OAAOpuB,EAAI,WAAWouB,OAAOoY,IACpE9xC,KAAKiyC,SAAYjyC,KAAK0xC,gBAC5B1xC,KAAKiyC,QAAU,IAAIC,UAAUF,EAAQ,YAAchC,GAA0B/qB,SAC7EjlB,KAAK0xC,eAAgB,EACrB1xC,KAAKiyC,QAAQE,UAAY,SAASt+B,GAC9B,IAAIxS,EACJ,IACIA,EAAOgM,KAAKC,MAAMuG,EAAMxS,MACxB4tC,GAA0BzvC,QAAQiJ,IAAI,2BAA4BpH,EACtE,CAAE,MAAOiI,GAEL,YADA2lC,GAA0BzvC,QAAQiJ,IAAI,yBAA0BoL,EAAMxS,KAE1E,CACAowC,EAAMtpB,KAAK2nB,GAA0CsC,QAAS/wC,EAClE,EACArB,KAAKiyC,QAAQI,QAAU,SAASx+B,GACxB49B,EAAMC,gBACVzC,GAA0BzvC,QAAQiJ,IAAI,iBAAkBoL,GACxD49B,EAAMa,WACNb,EAAMC,eAAgB,EACtBD,EAAMtpB,KAAK2nB,GAA0CyC,cACzD,EAGAvyC,KAAKiyC,QAAQO,OAAS,WACdf,EAAMC,gBACVD,EAAMgB,sBACNxD,GAA0BzvC,QAAQiJ,IAAI,eACtCgpC,EAAMiB,qBACV,EACJ,EACA7B,EAA0ChtC,UAAU6uC,mBAAqB,WACrE,IAAIjB,EAAQzxC,KACZA,KAAK2yC,aAAeliC,YAAW,WAC3BghC,EAAMmB,gBACV,GAAG5yC,KAAKwxC,aACZ,EACAX,EAA0ChtC,UAAU+uC,eAAiB,WACjE,GAAK5yC,KAAK6yC,UAAV,CAIA,IAAIrjB,EAAUniB,KAAKE,UAAU,CACzBhO,KAAMwwC,GAA0C+C,YAEpD9yC,KAAKiyC,QAAQj6B,KAAKwX,GAClBxvB,KAAK0yC,oBALL,MAFIzD,GAA0BzvC,QAAQiJ,IAAI,+CAQ9C,EACwCooC,EAA0ChtC,UAAUgvC,QAAU,WAClG,QAAS7yC,KAAKiyC,SAAuC,IAA5BjyC,KAAKiyC,QAAQzK,UAC1C,EAC6BqJ,EAA0ChtC,UAAU4uC,oBAAsB,WACnG,IAAIM,EAAKC,EAGLC,EAhGsE,SAAShkB,EAAID,EAAMlsB,GACjG,GAAIA,GAA6B,IAArByZ,UAAUjZ,OAClB,IAAI,IAA4BksC,EAAxBvwC,EAAI,EAAGivC,EAAIlf,EAAK1rB,OAAYrE,EAAIivC,EAAGjvC,KAAQuwC,GAAQvwC,KAAK+vB,IACvDwgB,IAAIA,EAAK1pC,MAAMjC,UAAU2B,MAAMqsB,KAAK7C,EAAM,EAAG/vB,IAClDuwC,EAAGvwC,GAAK+vB,EAAK/vB,IAGrB,OAAOgwB,EAAGyK,OAAO8V,GAAM1pC,MAAMjC,UAAU2B,MAAMqsB,KAAK7C,GACtD,CAwF0BkkB,CAAoC,GAnHM,SAAS7D,EAAGnmC,GAC5E,IAAIxF,EAAsB,mBAAX4rC,QAAyBD,EAAEC,OAAOC,UACjD,IAAK7rC,EAAG,OAAO2rC,EACf,IAAmBnW,EAAY5vB,EAA3BrK,EAAIyE,EAAEmuB,KAAKwd,GAAOG,EAAK,GAC3B,IACI,WAAa,IAANtmC,GAAgBA,KAAM,MAAQgwB,EAAIj6B,EAAEwwC,QAAQpkB,MAAKmkB,EAAG1lC,KAAKovB,EAAEjzB,MACtE,CAAE,MAAOqZ,GACLhW,EAAI,CACAgW,MAAOA,EAEf,CAAE,QACE,IACQ4Z,IAAMA,EAAE7N,OAAS3nB,EAAIzE,EAAU,SAAIyE,EAAEmuB,KAAK5yB,EAClD,CAAE,QACE,GAAIqK,EAAG,MAAMA,EAAEgW,KACnB,CACJ,CACA,OAAOkwB,CACX,CAiGkE2D,CAA6BnzC,KAAK2xC,iBAAiB,GAC7G3xC,KAAK2xC,eAAiB,GACtB,IACI,IAAI,IAAIyB,EA1FoD,SAAS/D,GAC7E,IAAI36B,EAAsB,mBAAX46B,QAAyBA,OAAOC,SAAU7rC,EAAIgR,GAAK26B,EAAE36B,GAAIzV,EAAI,EAC5E,GAAIyE,EAAG,OAAOA,EAAEmuB,KAAKwd,GACrB,GAAIA,GAAyB,iBAAbA,EAAE/rC,OAAqB,MAAO,CAC1CmsC,KAAM,WAEF,OADIJ,GAAKpwC,GAAKowC,EAAE/rC,SAAQ+rC,OAAI,GACrB,CACHppC,MAAOopC,GAAKA,EAAEpwC,KACdosB,MAAOgkB,EAEf,GAEJ,MAAM,IAAI1/B,UAAU+E,EAAI,0BAA4B,kCACxD,CA6EoC2+B,CAA+BJ,GAAcK,EAAkBF,EAAc3D,QAAS6D,EAAgBjoB,KAAMioB,EAAkBF,EAAc3D,OAAO,CACvK,IAAIjgB,EAAU8jB,EAAgBrtC,MAC9BjG,KAAKgY,KAAKwX,EACd,CACJ,CAAE,MAAO+jB,GACLR,EAAM,CACFzzB,MAAOi0B,EAEf,CAAE,QACE,IACQD,IAAoBA,EAAgBjoB,OAAS2nB,EAAKI,EAAcI,SAASR,EAAGnhB,KAAKuhB,EACzF,CAAE,QACE,GAAIL,EAAK,MAAMA,EAAIzzB,KACvB,CACJ,CACJ,EACmCuxB,EAA0ChtC,UAAUmU,KAAO,SAAS3W,GACnG,IAAIrB,KAAK0xC,cAGT,GAAK1xC,KAAK+xC,IAIV,GAAK1wC,EAAK9B,MAIV,GAAKS,KAAK6yC,UAAV,CACA,IAAIrjB,EAAUniB,KAAKE,UAAUlM,GAC7BrB,KAAKiyC,QAAQj6B,KAAKwX,EAFS,OAHvBxvB,KAAKmoB,KAAK2nB,GAA0CxqC,MAAO,wBAJ3DtF,KAAK2xC,eAAe7nC,KAAKzI,EAUjC,EACAwvC,EAA0ChtC,UAAU2X,MAAQ,WACpDxb,KAAK0xC,gBACT1xC,KAAKsyC,WACLtyC,KAAK0xC,eAAgB,EACzB,EACAb,EAA0ChtC,UAAUyuC,SAAW,WACvDtyC,KAAKiyC,UACLjyC,KAAKiyC,QAAQO,OAASxyC,KAAKiyC,QAAQE,UAAYnyC,KAAKiyC,QAAQI,QAAU,KACtEryC,KAAKiyC,QAAQz2B,QACbxb,KAAKiyC,aAAUriC,GAEnB6jC,aAAazzC,KAAK2yC,aACtB,EACO9B,CACX,CAvHkE,CAuHhEjE,GAA0BoC,cAGxB0E,GAA4B,CAAC,EAEjCtK,GAAesK,GAA2B,mBAAmB,IAAMC,KAA4CtK,GAAMsK,GAA4CtK,IAGjK,IAAIuK,GAA4B,CAAC,EAEjCxK,GAAewK,GAA2B,cAAc,IAAMC,KAA2CxK,GAAMwK,GAA2CxK,IAI1J,IAAIyK,GAAoE,WAQpE,OAPAA,GAAiC1sC,OAAO0P,QAAU,SAASxB,GACvD,IAAI,IAAIZ,EAAGzV,EAAI,EAAGiK,EAAIqT,UAAUjZ,OAAQrE,EAAIiK,EAAGjK,IAE3C,IAAI,IAAIuZ,KADR9D,EAAI6H,UAAUtd,GACKmI,OAAOvD,UAAUoF,eAAe4oB,KAAKnd,EAAG8D,KAAIlD,EAAEkD,GAAK9D,EAAE8D,IAE5E,OAAOlD,CACX,EACOw+B,GAA+Bn1B,MAAM3e,KAAMuc,UACtD,EACIw3B,GAAsE,SAASC,EAASC,EAAYC,EAAGC,GAMvG,OAAO,IAAKD,IAAMA,EAAIv7B,WAAU,SAASgB,EAASf,GAC9C,SAASw7B,EAAUnuC,GACf,IACIouC,EAAKF,EAAU1E,KAAKxpC,GACxB,CAAE,MAAOqD,GACLsP,EAAOtP,EACX,CACJ,CACA,SAAS6P,EAASlT,GACd,IACIouC,EAAKF,EAAiB,MAAEluC,GAC5B,CAAE,MAAOqD,GACLsP,EAAOtP,EACX,CACJ,CACA,SAAS+qC,EAAK/b,GApBlB,IAAeryB,EAqBPqyB,EAAOjN,KAAO1R,EAAQ2e,EAAOryB,QArBtBA,EAqBqCqyB,EAAOryB,MApBhDA,aAAiBiuC,EAAIjuC,EAAQ,IAAIiuC,GAAE,SAASv6B,GAC/CA,EAAQ1T,EACZ,KAkB8DiY,KAAKk2B,EAAWj7B,EAC9E,CACAk7B,GAAMF,EAAYA,EAAUx1B,MAAMq1B,EAASC,GAAc,KAAKxE,OAClE,GACJ,EACI6E,GAA0E,SAASN,EAASO,GAC5F,IAQGxX,EAAGlX,EAAGvQ,EAAGk/B,EARRC,EAAI,CACJlkB,MAAO,EACPmkB,KAAM,WACF,GAAW,EAAPp/B,EAAE,GAAQ,MAAMA,EAAE,GACtB,OAAOA,EAAE,EACb,EACAq/B,KAAM,GACNC,IAAK,IAET,OAAOJ,EAAI,CACP/E,KAAMoF,EAAK,GACX,MAASA,EAAK,GACd,OAAUA,EAAK,IACE,mBAAXvF,SAA0BkF,EAAElF,OAAOC,UAAY,WACrD,OAAOvvC,IACX,GAAIw0C,EACJ,SAASK,EAAK3rC,GACV,OAAO,SAASmgC,GACZ,OAMR,SAAcyL,GACV,GAAI/X,EAAG,MAAM,IAAIptB,UAAU,mCAC3B,KAAM8kC,OACF,GAAI1X,EAAI,EAAGlX,IAAMvQ,EAAY,EAARw/B,EAAG,GAASjvB,EAAU,OAAIivB,EAAG,GAAKjvB,EAAS,SAAOvQ,EAAIuQ,EAAU,SAAMvQ,EAAEuc,KAAKhM,GAAI,GAAKA,EAAE4pB,SAAWn6B,EAAIA,EAAEuc,KAAKhM,EAAGivB,EAAG,KAAKzpB,KAAM,OAAO/V,EAK3J,OAJIuQ,EAAI,EAAGvQ,IAAGw/B,EAAK,CACP,EAARA,EAAG,GACHx/B,EAAErP,QAEC6uC,EAAG,IACN,KAAK,EACL,KAAK,EACDx/B,EAAIw/B,EACJ,MACJ,KAAK,EAED,OADAL,EAAElkB,QACK,CACHtqB,MAAO6uC,EAAG,GACVzpB,MAAM,GAEd,KAAK,EACDopB,EAAElkB,QACF1K,EAAIivB,EAAG,GACPA,EAAK,CACD,GAEJ,SACJ,KAAK,EACDA,EAAKL,EAAEG,IAAIG,MACXN,EAAEE,KAAKI,MACP,SACJ,QACI,MAAkBz/B,GAAZA,EAAIm/B,EAAEE,MAAYrxC,OAAS,GAAKgS,EAAEA,EAAEhS,OAAS,KAAkB,IAAVwxC,EAAG,IAAsB,IAAVA,EAAG,IAAW,CACpFL,EAAI,EACJ,QACJ,CACA,GAAc,IAAVK,EAAG,MAAcx/B,GAAKw/B,EAAG,GAAKx/B,EAAE,IAAMw/B,EAAG,GAAKx/B,EAAE,IAAK,CACrDm/B,EAAElkB,MAAQukB,EAAG,GACb,KACJ,CACA,GAAc,IAAVA,EAAG,IAAYL,EAAElkB,MAAQjb,EAAE,GAAI,CAC/Bm/B,EAAElkB,MAAQjb,EAAE,GACZA,EAAIw/B,EACJ,KACJ,CACA,GAAIx/B,GAAKm/B,EAAElkB,MAAQjb,EAAE,GAAI,CACrBm/B,EAAElkB,MAAQjb,EAAE,GACZm/B,EAAEG,IAAI9qC,KAAKgrC,GACX,KACJ,CACIx/B,EAAE,IAAIm/B,EAAEG,IAAIG,MAChBN,EAAEE,KAAKI,MACP,SAERD,EAAKP,EAAK1iB,KAAKmiB,EAASS,EAC5B,CAAE,MAAOnrC,GACLwrC,EAAK,CACD,EACAxrC,GAEJuc,EAAI,CACR,CAAE,QACEkX,EAAIznB,EAAI,CACZ,CACA,GAAY,EAARw/B,EAAG,GAAQ,MAAMA,EAAG,GACxB,MAAO,CACH7uC,MAAO6uC,EAAG,GAAKA,EAAG,QAAK,EACvBzpB,MAAM,EAEd,CA1EegpB,CAAK,CACRnrC,EACAmgC,GAER,CACJ,CAsEJ,EAGQwK,GAAyD,WAC7D,SAASA,EAAyCmB,GAC9Ch1C,KAAKg1C,WAAaA,CACtB,CAkZA,OAjZ2EnB,EAAyChwC,UAAUoxC,gBAAkB,SAAStQ,GACrJ,IAAIuQ,EAAiBl1C,KAAKm1C,uBAK1B,GAHAn1C,KAAKg1C,WAAWE,eAAiBA,EAC7Bl1C,KAAKg1C,WAAWz1C,OAASowC,GAA0CyF,OAASzQ,EAAQ0Q,SAASr1C,KAAKs1C,uBAAuB3Q,EAAQ0Q,QAASH,GAE1IvQ,EAAQ4Q,WAAY,CACpB,GAAIv1C,KAAKg1C,WAAWz1C,OAASowC,GAA0C6F,KAAM,CACzE,IAAIC,EAAiBz1C,KAAKg1C,WACtBpkC,EAAS,CACT26B,UAAW5G,EAAQ2G,UAEnB3D,EAAcuN,EAAexN,kBAAkB+N,EAAellB,MAAO3f,GACzE6kC,EAAeC,WAAW/N,EAC9B,CACA3nC,KAAK21C,YACT,MAAO31C,KAAK41C,UAAU,QAASjR,EAAQn6B,IAC3C,EACmBqpC,EAAyChwC,UAAUsxC,qBAAuB,WACzFlG,GAA0BzvC,QAAQiJ,IAAI,+BACtC,IAAIysC,EAAiB,IAAIvkC,kBAAkB3Q,KAAKg1C,WAAWa,SAASlR,QAAQ/zB,QAE5E,OADA5Q,KAAK81C,gBAAgBZ,GACdA,CACX,EACwCrB,EAAyChwC,UAAUiyC,gBAAkB,SAASZ,GAClH,IAAIzD,EAAQzxC,KACR+1C,EAAS/1C,KAAKg1C,WAAW3jB,KACzB2kB,EAAeh2C,KAAKg1C,WAAWgB,aAC/BC,EAAiBj2C,KAAKg1C,WAAWz1C,KACjCs2C,EAAW71C,KAAKg1C,WAAWa,SAE/B5G,GAA0BzvC,QAAQiJ,IAAI,iCACtCysC,EAAe/hC,eAAiB,SAASmD,GAChCA,EAAI3H,WAAc2H,EAAI3H,UAAUA,YACrCsgC,GAA0BzvC,QAAQiJ,IAAI,+BAA+BixB,OAAOqc,EAAQ,KAAMz/B,EAAI3H,WAC9FknC,EAASK,OAAOl+B,KAAK,CACjBzY,KAAMwwC,GAA0CoG,UAChDC,QAAS,CACLznC,UAAW2H,EAAI3H,UACfpP,KAAM02C,EACND,aAAcA,GAElBK,IAAKN,IAEb,EACAb,EAAe1hC,2BAA6B,WACxC,OAAO0hC,EAAe3jC,oBAClB,IAAK,SACD09B,GAA0BzvC,QAAQiJ,IAAI,wDAA0DstC,GAChGtE,EAAMuD,WAAW7sB,KAAK,QAAS,IAAI7iB,MAAM,gCAAkCywC,EAAS,aACpFtE,EAAMuD,WAAWx5B,QACjB,MACJ,IAAK,SACDyzB,GAA0BzvC,QAAQiJ,IAAI,wDAA0DstC,GAChGtE,EAAMuD,WAAW7sB,KAAK,QAAS,IAAI7iB,MAAM,iBAAmBywC,EAAS,aACrEtE,EAAMuD,WAAWx5B,QACjB,MACJ,IAAK,eACDyzB,GAA0BzvC,QAAQiJ,IAAI,qEAAuEstC,GAC7G,MACJ,IAAK,YACDb,EAAe/hC,eAAiBq3B,GAA0CkB,KAGlF+F,EAAMuD,WAAW7sB,KAAK,kBAAmB+sB,EAAe3jC,mBAC5D,EAEA09B,GAA0BzvC,QAAQiJ,IAAI,8BAGtCysC,EAAethC,cAAgB,SAAS0C,GACpC24B,GAA0BzvC,QAAQiJ,IAAI,yBACtC,IAAIk/B,EAAcrxB,EAAIsxB,QACLiO,EAASS,cAAcP,EAAQC,GACrCN,WAAW/N,EAC1B,EAEAsH,GAA0BzvC,QAAQiJ,IAAI,+BACtCysC,EAAe7hC,QAAU,SAASiD,GAC9B24B,GAA0BzvC,QAAQiJ,IAAI,0BACtC,IAAI6B,EAASgM,EAAIhG,QAAQ,GACrB0kC,EAAaa,EAASS,cAAcP,EAAQC,GAChD,GAAIhB,EAAWz1C,OAASowC,GAA0CyF,MAAO,CACrE,IAAImB,EAAkBvB,EACtBvD,EAAM+E,4BAA4BlsC,EAAQisC,EAC9C,CACJ,CACJ,EACA1C,EAAyChwC,UAAU4yC,QAAU,WACzDxH,GAA0BzvC,QAAQiJ,IAAI,iCAAmCzI,KAAKg1C,WAAW3jB,MACzF,IAAI6jB,EAAiBl1C,KAAKg1C,WAAWE,eACrC,GAAKA,EAAL,CACAl1C,KAAKg1C,WAAWE,eAAiB,KAEjCA,EAAe/hC,eAAiB+hC,EAAe1hC,2BAA6B0hC,EAAethC,cAAgBshC,EAAe7hC,QAAU,WAAY,EAChJ,IAAIqjC,EAA4D,WAAlCxB,EAAe/mC,eACzCwoC,GAAuB,EAC3B,GAAI32C,KAAKg1C,WAAWz1C,OAASowC,GAA0C6F,KAAM,CACzE,IACI7N,EADiB3nC,KAAKg1C,WACOrN,YAC7BA,IAAagP,IAAyBhP,EAAYH,YAAyC,WAA3BG,EAAYH,WACpF,EACIkP,GAA2BC,IAAsBzB,EAAe15B,OAXzC,CAY/B,EACAq4B,EAAyChwC,UAAU8xC,WAAa,WAC5D,OAAO5B,GAAgC/zC,UAAM,EAAQ2Y,SAAS,WAC1D,IAAIu8B,EAAgBW,EAAUznC,EAAOgoC,EAASX,EAAgBmB,EAAOC,EACrE,OAAOvC,GAAkCt0C,MAAM,SAASgzC,GACpD,OAAOA,EAAGziB,OACN,KAAK,EACD2kB,EAAiBl1C,KAAKg1C,WAAWE,eACjCW,EAAW71C,KAAKg1C,WAAWa,SAC3B7C,EAAGziB,MAAQ,EACf,KAAK,EAOD,OANAyiB,EAAG2B,KAAK7qC,KAAK,CACT,EACA,EACA,CACA,IAEG,CACH,EACAorC,EAAe/4B,YAAYnc,KAAKg1C,WAAWrQ,QAAQ/K,cAE3D,KAAK,EACDxrB,EAAQ4kC,EAAG0B,OACXzF,GAA0BzvC,QAAQiJ,IAAI,kBAClCzI,KAAKg1C,WAAWrQ,QAAQmS,cAAgE,mBAAzC92C,KAAKg1C,WAAWrQ,QAAQmS,eAA6B1oC,EAAM5D,IAAMxK,KAAKg1C,WAAWrQ,QAAQmS,aAAa1oC,EAAM5D,MAAQ4D,EAAM5D,KAC7KwoC,EAAGziB,MAAQ,EACf,KAAK,EAOD,OANAyiB,EAAG2B,KAAK7qC,KAAK,CACT,EACA,EACA,CACA,IAEG,CACH,EACAorC,EAAe7mC,oBAAoBD,IAE3C,KAAK,EAuBD,OAtBA4kC,EAAG0B,OACHzF,GAA0BzvC,QAAQiJ,IAAI,wBAAyB2F,EAAO,OAAOsrB,OAAO15B,KAAKg1C,WAAW3jB,OACpG+kB,EAAU,CACN5rC,IAAK4D,EACL7O,KAAMS,KAAKg1C,WAAWz1C,KACtBy2C,aAAch2C,KAAKg1C,WAAWgB,aAC9Be,SAAU/2C,KAAKg1C,WAAW+B,SAC1BxQ,QAASiE,GAA0CjE,SAEnDvmC,KAAKg1C,WAAWz1C,OAASowC,GAA0C6F,OACnEC,EAAiBz1C,KAAKg1C,WACtBoB,EAAUtC,GAA+BA,GAA+B,CAAC,EAAGsC,GAAU,CAClF7lB,MAAOklB,EAAellB,MACtB+a,SAAUmK,EAAenK,SACzB0L,cAAevB,EAAeuB,iBAGtCnB,EAASK,OAAOl+B,KAAK,CACjBzY,KAAMwwC,GAA0CkH,MAChDb,QAASA,EACTC,IAAKr2C,KAAKg1C,WAAW3jB,OAElB,CACH,EACA,GAER,KAAK,EAOD,MAJa,2FAFbulB,EAAQ5D,EAAG0B,UAGPmB,EAASqB,UAAUtH,GAA0CuH,OAAQP,GACrE3H,GAA0BzvC,QAAQiJ,IAAI,kCAAmCmuC,IAEtE,CACH,EACA,GAER,KAAK,EACD,MAAO,CACH,EACA,GAER,KAAK,EAID,OAHAC,EAAU7D,EAAG0B,OACbmB,EAASqB,UAAUtH,GAA0CuH,OAAQN,GACrE5H,GAA0BzvC,QAAQiJ,IAAI,0BAA2BouC,GAC1D,CACH,EACA,GAER,KAAK,EACD,MAAO,CACH,GAGhB,GACJ,GACJ,EACAhD,EAAyChwC,UAAUuzC,YAAc,WAC7D,OAAOrD,GAAgC/zC,UAAM,EAAQ2Y,SAAS,WAC1D,IAAIu8B,EAAgBW,EAAUtnC,EAAQ8oC,EAAOC,EAC7C,OAAOhD,GAAkCt0C,MAAM,SAASgzC,GACpD,OAAOA,EAAGziB,OACN,KAAK,EACD2kB,EAAiBl1C,KAAKg1C,WAAWE,eACjCW,EAAW71C,KAAKg1C,WAAWa,SAC3B7C,EAAGziB,MAAQ,EACf,KAAK,EAOD,OANAyiB,EAAG2B,KAAK7qC,KAAK,CACT,EACA,EACA,CACA,IAEG,CACH,EACAorC,EAAe/3B,gBAEvB,KAAK,EACD5O,EAASykC,EAAG0B,OACZzF,GAA0BzvC,QAAQiJ,IAAI,mBAClCzI,KAAKg1C,WAAWrQ,QAAQmS,cAAgE,mBAAzC92C,KAAKg1C,WAAWrQ,QAAQmS,eAA6BvoC,EAAO/D,IAAMxK,KAAKg1C,WAAWrQ,QAAQmS,aAAavoC,EAAO/D,MAAQ+D,EAAO/D,KAChLwoC,EAAGziB,MAAQ,EACf,KAAK,EAOD,OANAyiB,EAAG2B,KAAK7qC,KAAK,CACT,EACA,EACA,CACA,IAEG,CACH,EACAorC,EAAe7mC,oBAAoBE,IAE3C,KAAK,EAaD,OAZAykC,EAAG0B,OACHzF,GAA0BzvC,QAAQiJ,IAAI,wBAAyB8F,EAAQ,OAAOmrB,OAAO15B,KAAKg1C,WAAW3jB,OACrGwkB,EAASK,OAAOl+B,KAAK,CACjBzY,KAAMwwC,GAA0CwH,OAChDnB,QAAS,CACL5rC,IAAK+D,EACLhP,KAAMS,KAAKg1C,WAAWz1C,KACtBy2C,aAAch2C,KAAKg1C,WAAWgB,aAC9BzP,QAASiE,GAA0CjE,SAEvD8P,IAAKr2C,KAAKg1C,WAAW3jB,OAElB,CACH,EACA,GAER,KAAK,EAID,OAHAgmB,EAAQrE,EAAG0B,OACXmB,EAASqB,UAAUtH,GAA0CuH,OAAQE,GACrEpI,GAA0BzvC,QAAQiJ,IAAI,kCAAmC4uC,GAClE,CACH,EACA,GAER,KAAK,EACD,MAAO,CACH,EACA,GAER,KAAK,EAID,OAHAC,EAAUtE,EAAG0B,OACbmB,EAASqB,UAAUtH,GAA0CuH,OAAQG,GACrErI,GAA0BzvC,QAAQiJ,IAAI,4BAA6B6uC,GAC5D,CACH,EACA,GAER,KAAK,EACD,MAAO,CACH,GAGhB,GACJ,GACJ,EACsBzD,EAAyChwC,UAAU+xC,UAAY,SAASr2C,EAAMiL,GAChG,OAAOupC,GAAgC/zC,UAAM,EAAQ2Y,SAAS,WAC1D,IAAIu8B,EAAgBW,EAAU32C,EAAMs4C,EACpC,OAAOlD,GAAkCt0C,MAAM,SAASgzC,GACpD,OAAOA,EAAGziB,OACN,KAAK,EACD/lB,EAAM,IAAI0S,sBAAsB1S,GAChC0qC,EAAiBl1C,KAAKg1C,WAAWE,eACjCW,EAAW71C,KAAKg1C,WAAWa,SAC3B5G,GAA0BzvC,QAAQiJ,IAAI,6BAA8B+B,GACpEtL,EAAOc,KACPgzC,EAAGziB,MAAQ,EACf,KAAK,EAOD,OANAyiB,EAAG2B,KAAK7qC,KAAK,CACT,EACA,EACA,CACA,IAEG,CACH,EACAorC,EAAe5mC,qBAAqB9D,IAE5C,KAAK,EAGD,OAFAwoC,EAAG0B,OACHzF,GAA0BzvC,QAAQiJ,IAAI,yBAAyBixB,OAAOn6B,EAAM,SAASm6B,OAAO15B,KAAKg1C,WAAW3jB,OAC7F,UAAT9xB,EAA0B,CAC5B,EACA,GAEG,CACH,EACAL,EAAKk4C,eAEb,KAAK,EACDpE,EAAG0B,OACH1B,EAAGziB,MAAQ,EACf,KAAK,EACD,MAAO,CACH,EACA,GAER,KAAK,EAID,OAHAinB,EAAQxE,EAAG0B,OACXmB,EAASqB,UAAUtH,GAA0CuH,OAAQK,GACrEvI,GAA0BzvC,QAAQiJ,IAAI,mCAAoC+uC,GACnE,CACH,EACA,GAER,KAAK,EACD,MAAO,CACH,GAGhB,GACJ,GACJ,EAC2B3D,EAAyChwC,UAAU4zC,gBAAkB,SAASC,GACrG,OAAO3D,GAAgC/zC,UAAM,EAAQ2Y,SAAS,WAC1D,IAAIhK,EAAWkH,EAAeU,EAAQ2+B,EAAgBW,EAAU8B,EAChE,OAAOrD,GAAkCt0C,MAAM,SAASgzC,GACpD,OAAOA,EAAGziB,OACN,KAAK,EACD0e,GAA0BzvC,QAAQiJ,IAAI,mBAAoBivC,GAC1D/oC,EAAY+oC,EAAI/oC,UAChBkH,EAAgB6hC,EAAI7hC,cACpBU,EAASmhC,EAAInhC,OACb2+B,EAAiBl1C,KAAKg1C,WAAWE,eACjCW,EAAW71C,KAAKg1C,WAAWa,SAC3B7C,EAAGziB,MAAQ,EACf,KAAK,EAOD,OANAyiB,EAAG2B,KAAK7qC,KAAK,CACT,EACA,EACA,CACA,IAEG,CACH,EACAorC,EAAez3B,gBAAgB,IAAIkjB,gBAAgB,CAC/CpqB,OAAQA,EACRV,cAAeA,EACflH,UAAWA,MAGvB,KAAK,EAGD,OAFAqkC,EAAG0B,OACHzF,GAA0BzvC,QAAQiJ,IAAI,2BAA2BixB,OAAO15B,KAAKg1C,WAAW3jB,OACjF,CACH,EACA,GAER,KAAK,EAID,OAHAsmB,EAAQ3E,EAAG0B,OACXmB,EAASqB,UAAUtH,GAA0CuH,OAAQQ,GACrE1I,GAA0BzvC,QAAQiJ,IAAI,8BAA+BkvC,GAC9D,CACH,EACA,GAER,KAAK,EACD,MAAO,CACH,GAGhB,GACJ,GACJ,EACA9D,EAAyChwC,UAAUyxC,uBAAyB,SAAShrC,EAAQ4qC,GAEzF,GADAjG,GAA0BzvC,QAAQiJ,IAAI,0BAA0BixB,OAAOpvB,EAAOgB,GAAI,yBAC7E4pC,EAAellC,SAAU,OAAOi/B,GAA0BzvC,QAAQ8f,MAAM,oEAC7EhV,EAAOwK,YAAY3H,SAAQ,SAAS9B,GAChC6pC,EAAellC,SAAS3E,EAAOf,EACnC,GACJ,EACAupC,EAAyChwC,UAAU2yC,4BAA8B,SAASlsC,EAAQisC,GAC9FtH,GAA0BzvC,QAAQiJ,IAAI,cAAcixB,OAAOpvB,EAAOgB,GAAI,yBAAyBouB,OAAO6c,EAAgBP,eACtHO,EAAgB1hC,UAAUvK,EAC9B,EACOupC,CACX,CAtZiE,GA0Z7D+D,GAA4B,CAAC,EAEjCxO,GAAewO,GAA2B,kBAAkB,IAAMC,KAA4CxO,GAAMwO,GAA4CxO,IAEhK,IAAIyO,GAAsE,WACtE,IAAIhH,EAAgB,SAASE,EAAIC,GAQ7B,OAPAH,EAAgB1pC,OAAO8pC,gBAAkB,CACrCtD,UAAW,cACD9nC,OAAS,SAAS00B,EAAGT,GAC/BS,EAAEoT,UAAY7T,CAClB,GAAK,SAASS,EAAGT,GACb,IAAI,IAAIvhB,KAAKuhB,EAAM3yB,OAAOvD,UAAUoF,eAAe4oB,KAAKkI,EAAGvhB,KAAIgiB,EAAEhiB,GAAKuhB,EAAEvhB,GAC5E,GACqBw4B,EAAIC,EAC7B,EACA,OAAO,SAASzW,EAAGT,GACf,GAAiB,mBAANA,GAA0B,OAANA,EAAY,MAAM,IAAIpqB,UAAU,uBAAyBhK,OAAOo0B,GAAK,iCAEpG,SAASoX,IACLnxC,KAAK4G,YAAc4zB,CACvB,CAHAsW,EAActW,EAAGT,GAIjBS,EAAE32B,UAAkB,OAANk2B,EAAa3yB,OAAOumC,OAAO5T,IAAMoX,EAAGttC,UAAYk2B,EAAEl2B,UAAW,IAAIstC,EACnF,CACJ,CAnB0E,GAoBtE0G,GAA0D,SAASzG,GAEnE,SAASyG,EAA0CxmB,EAAMwkB,EAAUlR,GAC/D,IAAI8M,EAAQL,EAAOvf,KAAK7xB,OAASA,KAMjC,OALAyxC,EAAMpgB,KAAOA,EACbogB,EAAMoE,SAAWA,EACjBpE,EAAM9M,QAAUA,EAChB8M,EAAMsG,OAAQ,EACdtG,EAAMsF,SAAWpS,EAAQoS,SAClBtF,CACX,CAQA,OAjBAqG,GAAgCD,EAA2CzG,GAU3EhqC,OAAO4L,eAAe6kC,EAA0Ch0C,UAAW,OAAQ,CAC/EqP,IAAK,WACD,OAAOlT,KAAK+3C,KAChB,EACA5gB,YAAY,EACZlkB,cAAc,IAEX4kC,CACX,CAnB8D,CAmB5DjL,GAA0BoC,cAGxBgJ,GAAsE,WACtE,IAAIlH,EAAgB,SAASE,EAAIC,GAQ7B,OAPAH,EAAgB1pC,OAAO8pC,gBAAkB,CACrCtD,UAAW,cACD9nC,OAAS,SAAS00B,EAAGT,GAC/BS,EAAEoT,UAAY7T,CAClB,GAAK,SAASS,EAAGT,GACb,IAAI,IAAIvhB,KAAKuhB,EAAM3yB,OAAOvD,UAAUoF,eAAe4oB,KAAKkI,EAAGvhB,KAAIgiB,EAAEhiB,GAAKuhB,EAAEvhB,GAC5E,GACqBw4B,EAAIC,EAC7B,EACA,OAAO,SAASzW,EAAGT,GACf,GAAiB,mBAANA,GAA0B,OAANA,EAAY,MAAM,IAAIpqB,UAAU,uBAAyBhK,OAAOo0B,GAAK,iCAEpG,SAASoX,IACLnxC,KAAK4G,YAAc4zB,CACvB,CAHAsW,EAActW,EAAGT,GAIjBS,EAAE32B,UAAkB,OAANk2B,EAAa3yB,OAAOumC,OAAO5T,IAAMoX,EAAGttC,UAAYk2B,EAAEl2B,UAAW,IAAIstC,EACnF,CACJ,CAnB0E,GAoBtE8G,GAAoE,WAQpE,OAPAA,GAAiC7wC,OAAO0P,QAAU,SAASxB,GACvD,IAAI,IAAIZ,EAAGzV,EAAI,EAAGiK,EAAIqT,UAAUjZ,OAAQrE,EAAIiK,EAAGjK,IAE3C,IAAI,IAAIuZ,KADR9D,EAAI6H,UAAUtd,GACKmI,OAAOvD,UAAUoF,eAAe4oB,KAAKnd,EAAG8D,KAAIlD,EAAEkD,GAAK9D,EAAE8D,IAE5E,OAAOlD,CACX,EACO2iC,GAA+Bt5B,MAAM3e,KAAMuc,UACtD,EAiBQo3B,GAA0D,SAASvC,GAEvE,SAASuC,EAA0CoC,EAAQF,EAAUlR,GACjE,IAAI8M,EAAQL,EAAOvf,KAAK7xB,KAAM+1C,EAAQF,EAAUlR,IAAY3kC,KAQ5D,OAPAyxC,EAAMyG,aAAezG,EAAM9M,QAAQ0Q,QACnC5D,EAAMuE,aAAevE,EAAM9M,QAAQqR,cAAgBrC,EAA0CwE,UAAY3N,GAA0CiC,cACnJgF,EAAM2G,YAAc,IAAIxE,GAA0ByE,WAAW5G,GACzDA,EAAMyG,cAAczG,EAAM2G,YAAYnD,gBAAgB,CACtDI,QAAS5D,EAAMyG,aACf3C,YAAY,IAET9D,CACX,CA+FA,OA1GAuG,GAAgCrE,EAA2CvC,GAY3EhqC,OAAO4L,eAAe2gC,EAA0C9vC,UAAW,OAAQ,CAC/EqP,IAAK,WACD,OAAOy8B,GAA0CyF,KACrD,EACAje,YAAY,EACZlkB,cAAc,IAElB7L,OAAO4L,eAAe2gC,EAA0C9vC,UAAW,cAAe,CACtFqP,IAAK,WACD,OAAOlT,KAAKk4C,YAChB,EACA/gB,YAAY,EACZlkB,cAAc,IAElB7L,OAAO4L,eAAe2gC,EAA0C9vC,UAAW,eAAgB,CACvFqP,IAAK,WACD,OAAOlT,KAAKs4C,aAChB,EACAnhB,YAAY,EACZlkB,cAAc,IAElB0gC,EAA0C9vC,UAAUgR,UAAY,SAAS0jC,GACrEtJ,GAA0BzvC,QAAQiJ,IAAI,mBAAoB8vC,GAC1Dv4C,KAAKs4C,cAAgBC,EACrBnH,EAAOvtC,UAAUskB,KAAK0J,KAAK7xB,KAAM,SAAUu4C,EAC/C,EACA5E,EAA0C9vC,UAAU20C,cAAgB,SAAShpB,GACzE,IAAIjwB,EAAOiwB,EAAQjwB,KACf62C,EAAU5mB,EAAQ4mB,QACtB,OAAO5mB,EAAQjwB,MACX,KAAKwwC,GAA0CwH,OAE3Cv3C,KAAKo4C,YAAYxC,UAAUr2C,EAAM62C,EAAQ5rC,KACzCxK,KAAK+3C,OAAQ,EACb,MACJ,KAAKhI,GAA0CoG,UAC3Cn2C,KAAKo4C,YAAYX,gBAAgBrB,EAAQznC,WACzC,MACJ,QACIsgC,GAA0BzvC,QAAQgC,KAAK,6BAA6Bk4B,OAAOn6B,EAAM,eAAem6B,OAAO15B,KAAKqxB,OAGxH,EACAsiB,EAA0C9vC,UAAU0K,OAAS,SAASjE,EAAQq6B,GAC1E,IAAIoO,EAAKC,EAET,QADgB,IAAZrO,IAAoBA,EAAU,CAAC,GAC/B3kC,KAAKk4C,aACLjJ,GAA0BzvC,QAAQgC,KAAK,4FAD3C,CAIAxB,KAAKk4C,aAAe5tC,EAChBq6B,GAAWA,EAAQmS,eAAc92C,KAAK2kC,QAAQmS,aAAenS,EAAQmS,cACzE92C,KAAKo4C,YAAYnD,gBAAgBgD,GAA+BA,GAA+B,CAAC,EAAGj4C,KAAK2kC,QAAQ8T,UAAW,CACvHpD,QAAS/qC,KAGb,IAAIouC,EAAW14C,KAAK61C,SAAS8C,aAAa34C,KAAKg2C,cAC/C,IACI,IAAI,IAAI4C,EAvFoD,SAASvJ,GAC7E,IAAI36B,EAAsB,mBAAX46B,QAAyBA,OAAOC,SAAU7rC,EAAIgR,GAAK26B,EAAE36B,GAAIzV,EAAI,EAC5E,GAAIyE,EAAG,OAAOA,EAAEmuB,KAAKwd,GACrB,GAAIA,GAAyB,iBAAbA,EAAE/rC,OAAqB,MAAO,CAC1CmsC,KAAM,WAEF,OADIJ,GAAKpwC,GAAKowC,EAAE/rC,SAAQ+rC,OAAI,GACrB,CACHppC,MAAOopC,GAAKA,EAAEpwC,KACdosB,MAAOgkB,EAEf,GAEJ,MAAM,IAAI1/B,UAAU+E,EAAI,0BAA4B,kCACxD,CA0EiCmkC,CAA+BH,GAAWI,EAAeF,EAAWnJ,QAASqJ,EAAaztB,KAAMytB,EAAeF,EAAWnJ,OAAO,CAClJ,IAAIjgB,EAAUspB,EAAa7yC,MAC3BjG,KAAKw4C,cAAchpB,EACvB,CACJ,CAAE,MAAO+jB,GACLR,EAAM,CACFzzB,MAAOi0B,EAEf,CAAE,QACE,IACQuF,IAAiBA,EAAaztB,OAAS2nB,EAAK4F,EAAWpF,SAASR,EAAGnhB,KAAK+mB,EAChF,CAAE,QACE,GAAI7F,EAAK,MAAMA,EAAIzzB,KACvB,CACJ,CACAtf,KAAK+3C,OAAQ,CAxBb,CAyBJ,EAG4CpE,EAA0C9vC,UAAU2X,MAAQ,WAChGxb,KAAKo4C,cACLp4C,KAAKo4C,YAAY3B,UACjBz2C,KAAKo4C,YAAc,MAEvBp4C,KAAKk4C,aAAe,KACpBl4C,KAAKs4C,cAAgB,KACjBt4C,KAAK61C,WACL71C,KAAK61C,SAASkD,kBAAkB/4C,MAChCA,KAAK61C,SAAW,MAEhB71C,KAAK2kC,SAAW3kC,KAAK2kC,QAAQ0Q,UAASr1C,KAAK2kC,QAAQ0Q,QAAU,MAC5Dr1C,KAAKg5C,OACVh5C,KAAK+3C,OAAQ,EACb3G,EAAOvtC,UAAUskB,KAAK0J,KAAK7xB,KAAM,SACrC,EACA2zC,EAA0CwE,UAAY,MAC/CxE,CACX,CA5GkE,CA4GhEiE,GAA0BqB,gBAGxBC,GAA4B,CAAC,EAEjC9P,GAAe8P,GAA2B,kBAAkB,IAAMC,KAA4C9P,GAAM8P,GAA4C9P,IAMhK,IAAI+P,GAA4B,CAAC,EAEjChQ,GAAegQ,GAA2B,iBAAiB,IAAMC,KAA4ChQ,GAAMgQ,GAA4ChQ,IAG/J,IAAIiQ,GAAsE,WACtE,IAAIxI,EAAgB,SAASE,EAAIC,GAQ7B,OAPAH,EAAgB1pC,OAAO8pC,gBAAkB,CACrCtD,UAAW,cACD9nC,OAAS,SAAS00B,EAAGT,GAC/BS,EAAEoT,UAAY7T,CAClB,GAAK,SAASS,EAAGT,GACb,IAAI,IAAIvhB,KAAKuhB,EAAM3yB,OAAOvD,UAAUoF,eAAe4oB,KAAKkI,EAAGvhB,KAAIgiB,EAAEhiB,GAAKuhB,EAAEvhB,GAC5E,GACqBw4B,EAAIC,EAC7B,EACA,OAAO,SAASzW,EAAGT,GACf,GAAiB,mBAANA,GAA0B,OAANA,EAAY,MAAM,IAAIpqB,UAAU,uBAAyBhK,OAAOo0B,GAAK,iCAEpG,SAASoX,IACLnxC,KAAK4G,YAAc4zB,CACvB,CAHAsW,EAActW,EAAGT,GAIjBS,EAAE32B,UAAkB,OAANk2B,EAAa3yB,OAAOumC,OAAO5T,IAAMoX,EAAGttC,UAAYk2B,EAAEl2B,UAAW,IAAIstC,EACnF,CACJ,CAnB0E,GAoBtEkI,GAA0D,SAASjI,GAEnE,SAASiI,IACL,IAAI5H,EAAQL,EAAOvf,KAAK7xB,OAASA,KAejC,OAdAyxC,EAAM8H,WAAa,IAAIpN,WACvBsF,EAAM+H,OAAS,GACf/H,EAAMgI,aAAc,EACpBhI,EAAM8H,WAAWnN,OAAS,SAAS91B,GAC/Bm7B,EAAMgI,aAAc,EAChBnjC,EAAIuqB,QAAQ4Q,EAAMtpB,KAAK,OAAQ7R,EAAIuqB,OAAOvI,QAC9CmZ,EAAMiI,YACV,EACAjI,EAAM8H,WAAW1hC,QAAU,SAASvB,GAChC24B,GAA0BzvC,QAAQ8f,MAAM,uBAAwBhJ,GAChEm7B,EAAMgI,aAAc,EACpBhI,EAAMkI,UACNlI,EAAMtpB,KAAK,QAAS7R,EACxB,EACOm7B,CACX,CAqCA,OAvDA6H,GAAgCD,EAA2CjI,GAmB3EhqC,OAAO4L,eAAeqmC,EAA0Cx1C,UAAW,QAAS,CAChFqP,IAAK,WACD,OAAOlT,KAAKw5C,MAChB,EACAriB,YAAY,EACZlkB,cAAc,IAElB7L,OAAO4L,eAAeqmC,EAA0Cx1C,UAAW,OAAQ,CAC/EqP,IAAK,WACD,OAAOlT,KAAK45C,MAAMt2C,MACtB,EACA6zB,YAAY,EACZlkB,cAAc,IAElB7L,OAAO4L,eAAeqmC,EAA0Cx1C,UAAW,aAAc,CACrFqP,IAAK,WACD,OAAOlT,KAAKy5C,WAChB,EACAtiB,YAAY,EACZlkB,cAAc,IAElBomC,EAA0Cx1C,UAAUg2C,MAAQ,SAASlyC,GACjE3H,KAAK45C,MAAM9vC,KAAKnC,GACZ3H,KAAK85C,YACT95C,KAAK05C,YACT,EACAL,EAA0Cx1C,UAAU81C,QAAU,WAC1D35C,KAAKu5C,WAAWQ,QAChB/5C,KAAKw5C,OAAS,EAClB,EACAH,EAA0Cx1C,UAAU61C,WAAa,WAC3C,IAAd15C,KAAK8D,OACL9D,KAAK85C,aACT95C,KAAKy5C,aAAc,EACnBz5C,KAAKu5C,WAAWlN,kBAAkBrsC,KAAK45C,MAAM9jC,UACjD,EACOujC,CACX,CAzD8D,CAyD5DzM,GAA0BoC,cAGxBgL,GAAsE,WACtE,IAAIlJ,EAAgB,SAASE,EAAIC,GAQ7B,OAPAH,EAAgB1pC,OAAO8pC,gBAAkB,CACrCtD,UAAW,cACD9nC,OAAS,SAAS00B,EAAGT,GAC/BS,EAAEoT,UAAY7T,CAClB,GAAK,SAASS,EAAGT,GACb,IAAI,IAAIvhB,KAAKuhB,EAAM3yB,OAAOvD,UAAUoF,eAAe4oB,KAAKkI,EAAGvhB,KAAIgiB,EAAEhiB,GAAKuhB,EAAEvhB,GAC5E,GACqBw4B,EAAIC,EAC7B,EACA,OAAO,SAASzW,EAAGT,GACf,GAAiB,mBAANA,GAA0B,OAANA,EAAY,MAAM,IAAIpqB,UAAU,uBAAyBhK,OAAOo0B,GAAK,iCAEpG,SAASoX,IACLnxC,KAAK4G,YAAc4zB,CACvB,CAHAsW,EAActW,EAAGT,GAIjBS,EAAE32B,UAAkB,OAANk2B,EAAa3yB,OAAOumC,OAAO5T,IAAMoX,EAAGttC,UAAYk2B,EAAEl2B,UAAW,IAAIstC,EACnF,CACJ,CAnB0E,GAoClEgI,GAA0D,SAAS/H,GAEvE,SAAS+H,EAA0CpD,EAAQF,EAAUlR,GACjE,IAAI8M,EAAQL,EAAOvf,KAAK7xB,KAAM+1C,EAAQF,EAAUlR,IAAY3kC,KAuB5D,OAtBAyxC,EAAMlkC,UAAYF,KAAKE,UACvBkkC,EAAMnkC,MAAQD,KAAKC,MACnBmkC,EAAMwI,QAAU,GAChBxI,EAAMyI,YAAc,EACpBzI,EAAM0I,YAAa,EACnB1I,EAAM2I,aAAe,CAAC,EACtB3I,EAAM4I,eAAiB,IAAIjB,GAA0BkB,cACrD7I,EAAMuE,aAAevE,EAAM9M,QAAQqR,cAAgBmD,EAA0ChB,UAAY3N,GAA0CiC,cACnJgF,EAAMlhB,MAAQkhB,EAAM9M,QAAQpU,OAASkhB,EAAMuE,aAC3CvE,EAAMuF,cAAgBvF,EAAM9M,QAAQqS,eAAiBnH,GAAyC0K,OAC9F9I,EAAMnG,WAAamG,EAAM9M,QAAQ2G,SACjCmG,EAAM4I,eAAe7oB,GAAG,QAAQ,SAASgpB,GACrC/I,EAAMgJ,cAAcD,EACxB,IACA/I,EAAM4I,eAAe7oB,GAAG,SAAS,WAC7Byd,GAA0BzvC,QAAQ8f,MAAM,MAAMoa,OAAO+X,EAAMuE,aAAc,mEACzEvE,EAAMj2B,OACV,IACAi2B,EAAM2G,YAAc,IAAIxE,GAA0ByE,WAAW5G,GAC7DA,EAAM2G,YAAYnD,gBAAgBxD,EAAM9M,QAAQ8T,UAAY,CACxDlD,YAAY,IAET9D,CACX,CAwNA,OAlPAuI,GAAgCb,EAA2C/H,GA2B3EhqC,OAAO4L,eAAemmC,EAA0Ct1C,UAAW,OAAQ,CAC/EqP,IAAK,WACD,OAAOy8B,GAA0C6F,IACrD,EACAre,YAAY,EACZlkB,cAAc,IAElB7L,OAAO4L,eAAemmC,EAA0Ct1C,UAAW,cAAe,CACtFqP,IAAK,WACD,OAAOlT,KAAK06C,GAChB,EACAvjB,YAAY,EACZlkB,cAAc,IAElB7L,OAAO4L,eAAemmC,EAA0Ct1C,UAAW,aAAc,CACrFqP,IAAK,WACD,OAAOlT,KAAKk6C,WAChB,EACA/iB,YAAY,EACZlkB,cAAc,IAE6CkmC,EAA0Ct1C,UAAU6xC,WAAa,SAASpO,GACrItnC,KAAK06C,IAAMpT,EACXtnC,KAAK26C,uBACT,EACAxB,EAA0Ct1C,UAAU82C,sBAAwB,WACxE,IAAIlJ,EAAQzxC,KACPwqC,GAA0CU,SAASG,aAAcb,GAA0CU,SAASI,WAAUtrC,KAAK2nC,YAAY6D,WAAa,eACjKxrC,KAAK2nC,YAAY6K,OAAS,WACtBvD,GAA0BzvC,QAAQiJ,IAAI,MAAMixB,OAAO+X,EAAMuE,aAAc,2BACvEvE,EAAMsG,OAAQ,EACdtG,EAAMtpB,KAAK,OACf,EACAnoB,KAAK2nC,YAAYwK,UAAY,SAAS7oC,GAClC2lC,GAA0BzvC,QAAQiJ,IAAI,MAAMixB,OAAO+X,EAAMuE,aAAc,kBAAmB1sC,EAAEjI,MAC5FowC,EAAMmJ,mBAAmBtxC,EAC7B,EACAtJ,KAAK2nC,YAAY0K,QAAU,WACvBpD,GAA0BzvC,QAAQiJ,IAAI,MAAMixB,OAAO+X,EAAMuE,aAAc,mBAAoBvE,EAAMpgB,MACjGogB,EAAMj2B,OACV,CACJ,EAEA29B,EAA0Ct1C,UAAU+2C,mBAAqB,SAAS5H,GAC9E,IAAIvB,EAAQzxC,KACRqB,EAAO2xC,EAAG3xC,KACVw5C,EAAWx5C,EAAKuF,YAEhBk0C,EAAmBz5C,EACvB,GAF4BrB,KAAKg3C,gBAAkBnH,GAAyC0K,QAAUv6C,KAAKg3C,gBAAkBnH,GAAyCkL,WAE3I,CACvB,GAAIF,IAAa/zC,KAMb,YAJA0jC,GAA0CyB,kBAAkB5qC,GAAM,SAASm5C,GACvE,IAAIQ,EAAexQ,GAA0C5nC,OAAO43C,GACpE/I,EAAMtpB,KAAK,OAAQ6yB,EACvB,IAEG,GAAIH,IAAa5zC,YAAa6zC,EAAmBtQ,GAA0C5nC,OAAOvB,QACpG,GAAIw5C,IAAal1C,OAAQ,CAE1B,IAAIs1C,EAAMzQ,GAA0C8B,0BAA0BjrC,GAC9Ey5C,EAAmBtQ,GAA0C5nC,OAAOq4C,EACxE,CACJ,MAAWj7C,KAAKg3C,gBAAkBnH,GAAyCxiC,OAAMytC,EAAmB96C,KAAKsN,MAAMjM,IAG3Gy5C,EAAiB9O,WACjBhsC,KAAKk7C,aAAaJ,GAGtB1J,EAAOvtC,UAAUskB,KAAK0J,KAAK7xB,KAAM,OAAQ86C,EAC7C,EACA3B,EAA0Ct1C,UAAUq3C,aAAe,SAAS75C,GACxE,IAAIiK,EAAKjK,EAAK2qC,WACVmP,EAAYn7C,KAAKo6C,aAAa9uC,IAAO,CACrCjK,KAAM,GACN+5C,MAAO,EACPtP,MAAOzqC,EAAKyqC,OAKhB,GAHAqP,EAAU95C,KAAKA,EAAK6H,GAAK7H,EAAKA,KAC9B85C,EAAUC,QACVp7C,KAAKo6C,aAAa9uC,GAAM6vC,EACpBA,EAAUrP,QAAUqP,EAAUC,MAAO,QAE9Bp7C,KAAKo6C,aAAa9uC,GAEzB,IAAI+vC,EAAS,IAAIv0C,KAAKq0C,EAAU95C,MAChCrB,KAAK46C,mBAAmB,CACpBv5C,KAAMg6C,GAEd,CACJ,EAG4ClC,EAA0Ct1C,UAAU2X,MAAQ,WACpGxb,KAAKi6C,QAAU,GACfj6C,KAAKk6C,YAAc,EACnBl6C,KAAKo6C,aAAe,CAAC,EACjBp6C,KAAKo4C,cACLp4C,KAAKo4C,YAAY3B,UACjBz2C,KAAKo4C,YAAc,MAEnBp4C,KAAK61C,WACL71C,KAAK61C,SAASkD,kBAAkB/4C,MAChCA,KAAK61C,SAAW,MAEhB71C,KAAK2nC,cACL3nC,KAAK2nC,YAAY6K,OAAS,KAC1BxyC,KAAK2nC,YAAYwK,UAAY,KAC7BnyC,KAAK2nC,YAAY0K,QAAU,KAC3BryC,KAAK06C,IAAM,MAEX16C,KAAKq6C,iBACLr6C,KAAKq6C,eAAeV,UACpB35C,KAAKq6C,eAAezL,qBACpB5uC,KAAKq6C,eAAiB,MAErBr6C,KAAKg5C,OACVh5C,KAAK+3C,OAAQ,EACb3G,EAAOvtC,UAAUskB,KAAK0J,KAAK7xB,KAAM,SACrC,EACiCm5C,EAA0Ct1C,UAAUmU,KAAO,SAAS3W,EAAMi6C,GACvG,GAAKt7C,KAAKg5C,KAIV,GAAIh5C,KAAKg3C,gBAAkBnH,GAAyCxiC,KAAMrN,KAAKy6C,cAAcz6C,KAAKuN,UAAUlM,SACvG,GAAIrB,KAAKg3C,gBAAkBnH,GAAyC0K,QAAUv6C,KAAKg3C,gBAAkBnH,GAAyCkL,WAAY,CAC3J,IAAIpzC,EAAO6iC,GAA0C1nC,KAAKzB,GAC1D,IAAKi6C,GAAW3zC,EAAK7D,KAAO0mC,GAA0CO,WAElE,YADA/qC,KAAKu7C,YAAY5zC,GAGhB6iC,GAA0CU,SAASG,WAGnDrrC,KAAKy6C,cAAc9yC,GADxB3H,KAAKq6C,eAAeR,MAAMlyC,EAE9B,MAAO3H,KAAKy6C,cAAcp5C,QAdtB+vC,EAAOvtC,UAAUskB,KAAK0J,KAAK7xB,KAAM,QAAS,IAAIsF,MAAM,2FAe5D,EACA6zC,EAA0Ct1C,UAAU42C,cAAgB,SAASe,IACrEx7C,KAAKm6C,YAAen6C,KAAKy7C,SAASD,KAClCx7C,KAAKi6C,QAAQnwC,KAAK0xC,GAClBx7C,KAAKk6C,YAAcl6C,KAAKi6C,QAAQ32C,OAExC,EAEA61C,EAA0Ct1C,UAAU43C,SAAW,SAASD,GACpE,IAAI/J,EAAQzxC,KACZ,IAAKA,KAAKg5C,KAAM,OAAO,EACvB,GAAIh5C,KAAK2nC,YAAY+T,eAAiBvC,EAA0CwC,oBAM5E,OALA37C,KAAKm6C,YAAa,EAClB1pC,YAAW,WACPghC,EAAM0I,YAAa,EACnB1I,EAAMmK,YACV,GAAG,KACI,EAEX,IACI57C,KAAK2nC,YAAY3vB,KAAKwjC,EAC1B,CAAE,MAAOlyC,GAIL,OAHA2lC,GAA0BzvC,QAAQ8f,MAAM,OAAOoa,OAAO15B,KAAKg2C,aAAc,wBAAyB1sC,GAClGtJ,KAAKm6C,YAAa,EAClBn6C,KAAKwb,SACE,CACX,CACA,OAAO,CACX,EAEA29B,EAA0Ct1C,UAAU+3C,WAAa,WAC7D,GAAK57C,KAAKg5C,MACkB,IAAxBh5C,KAAKi6C,QAAQ32C,OAAjB,CACA,IAAIk4C,EAAMx7C,KAAKi6C,QAAQ,GACnBj6C,KAAKy7C,SAASD,KACdx7C,KAAKi6C,QAAQnkC,QACb9V,KAAKk6C,YAAcl6C,KAAKi6C,QAAQ32C,OAChCtD,KAAK47C,aAL4B,CAOzC,EACAzC,EAA0Ct1C,UAAU03C,YAAc,SAAS5zC,GACvE,IAAIorC,EAAKC,EACL6I,EAAQrR,GAA0CoB,MAAMjkC,GAC5DsnC,GAA0BzvC,QAAQiJ,IAAI,MAAMixB,OAAO15B,KAAKg2C,aAAc,iBAAiBtc,OAAOmiB,EAAMv4C,OAAQ,eAC5G,IACI,IAAI,IAAIw4C,EAnOoD,SAASzM,GAC7E,IAAI36B,EAAsB,mBAAX46B,QAAyBA,OAAOC,SAAU7rC,EAAIgR,GAAK26B,EAAE36B,GAAIzV,EAAI,EAC5E,GAAIyE,EAAG,OAAOA,EAAEmuB,KAAKwd,GACrB,GAAIA,GAAyB,iBAAbA,EAAE/rC,OAAqB,MAAO,CAC1CmsC,KAAM,WAEF,OADIJ,GAAKpwC,GAAKowC,EAAE/rC,SAAQ+rC,OAAI,GACrB,CACHppC,MAAOopC,GAAKA,EAAEpwC,KACdosB,MAAOgkB,EAEf,GAEJ,MAAM,IAAI1/B,UAAU+E,EAAI,0BAA4B,kCACxD,CAsN8BqnC,CAA+BF,GAAQG,EAAYF,EAAQrM,QAASuM,EAAU3wB,KAAM2wB,EAAYF,EAAQrM,OAAO,CAC7H,IAAIwM,EAASD,EAAU/1C,MACvBjG,KAAKgY,KAAKikC,GAAQ,EACtB,CACJ,CAAE,MAAO1I,GACLR,EAAM,CACFzzB,MAAOi0B,EAEf,CAAE,QACE,IACQyI,IAAcA,EAAU3wB,OAAS2nB,EAAK8I,EAAQtI,SAASR,EAAGnhB,KAAKiqB,EACvE,CAAE,QACE,GAAI/I,EAAK,MAAMA,EAAIzzB,KACvB,CACJ,CACJ,EACA65B,EAA0Ct1C,UAAU20C,cAAgB,SAAShpB,GACzE,IAAI4mB,EAAU5mB,EAAQ4mB,QACtB,OAAO5mB,EAAQjwB,MACX,KAAKwwC,GAA0CwH,OAC3Cv3C,KAAKo4C,YAAYxC,UAAUpmB,EAAQjwB,KAAM62C,EAAQ5rC,KACjD,MACJ,KAAKulC,GAA0CoG,UAC3Cn2C,KAAKo4C,YAAYX,gBAAgBrB,EAAQznC,WACzC,MACJ,QACIsgC,GAA0BzvC,QAAQgC,KAAK,6BAA8BguB,EAAQjwB,KAAM,aAAcS,KAAKqxB,MAGlH,EACA8nB,EAA0ChB,UAAY,MACtDgB,EAA0CwC,oBAAsB,QACzDxC,CACX,CApPkE,CAoPhEvB,GAA0BqB,gBAIxBiD,GAA4B,CAAC,EAEjC9S,GAAe8S,GAA2B,OAAO,IAAMC,KAA4C9S,GAAM8S,GAA4C9S,IAIrJ,IAAI+S,GAAsE,SAASpI,EAASC,EAAYC,EAAGC,GAMvG,OAAO,IAAKD,IAAMA,EAAIv7B,WAAU,SAASgB,EAASf,GAC9C,SAASw7B,EAAUnuC,GACf,IACIouC,EAAKF,EAAU1E,KAAKxpC,GACxB,CAAE,MAAOqD,GACLsP,EAAOtP,EACX,CACJ,CACA,SAAS6P,EAASlT,GACd,IACIouC,EAAKF,EAAiB,MAAEluC,GAC5B,CAAE,MAAOqD,GACLsP,EAAOtP,EACX,CACJ,CACA,SAAS+qC,EAAK/b,GApBlB,IAAeryB,EAqBPqyB,EAAOjN,KAAO1R,EAAQ2e,EAAOryB,QArBtBA,EAqBqCqyB,EAAOryB,MApBhDA,aAAiBiuC,EAAIjuC,EAAQ,IAAIiuC,GAAE,SAASv6B,GAC/CA,EAAQ1T,EACZ,KAkB8DiY,KAAKk2B,EAAWj7B,EAC9E,CACAk7B,GAAMF,EAAYA,EAAUx1B,MAAMq1B,EAASC,GAAc,KAAKxE,OAClE,GACJ,EACI4M,GAA0E,SAASrI,EAASO,GAC5F,IAQGxX,EAAGlX,EAAGvQ,EAAGk/B,EARRC,EAAI,CACJlkB,MAAO,EACPmkB,KAAM,WACF,GAAW,EAAPp/B,EAAE,GAAQ,MAAMA,EAAE,GACtB,OAAOA,EAAE,EACb,EACAq/B,KAAM,GACNC,IAAK,IAET,OAAOJ,EAAI,CACP/E,KAAMoF,EAAK,GACX,MAASA,EAAK,GACd,OAAUA,EAAK,IACE,mBAAXvF,SAA0BkF,EAAElF,OAAOC,UAAY,WACrD,OAAOvvC,IACX,GAAIw0C,EACJ,SAASK,EAAK3rC,GACV,OAAO,SAASmgC,GACZ,OAMR,SAAcyL,GACV,GAAI/X,EAAG,MAAM,IAAIptB,UAAU,mCAC3B,KAAM8kC,OACF,GAAI1X,EAAI,EAAGlX,IAAMvQ,EAAY,EAARw/B,EAAG,GAASjvB,EAAU,OAAIivB,EAAG,GAAKjvB,EAAS,SAAOvQ,EAAIuQ,EAAU,SAAMvQ,EAAEuc,KAAKhM,GAAI,GAAKA,EAAE4pB,SAAWn6B,EAAIA,EAAEuc,KAAKhM,EAAGivB,EAAG,KAAKzpB,KAAM,OAAO/V,EAK3J,OAJIuQ,EAAI,EAAGvQ,IAAGw/B,EAAK,CACP,EAARA,EAAG,GACHx/B,EAAErP,QAEC6uC,EAAG,IACN,KAAK,EACL,KAAK,EACDx/B,EAAIw/B,EACJ,MACJ,KAAK,EAED,OADAL,EAAElkB,QACK,CACHtqB,MAAO6uC,EAAG,GACVzpB,MAAM,GAEd,KAAK,EACDopB,EAAElkB,QACF1K,EAAIivB,EAAG,GACPA,EAAK,CACD,GAEJ,SACJ,KAAK,EACDA,EAAKL,EAAEG,IAAIG,MACXN,EAAEE,KAAKI,MACP,SACJ,QACI,MAAkBz/B,GAAZA,EAAIm/B,EAAEE,MAAYrxC,OAAS,GAAKgS,EAAEA,EAAEhS,OAAS,KAAkB,IAAVwxC,EAAG,IAAsB,IAAVA,EAAG,IAAW,CACpFL,EAAI,EACJ,QACJ,CACA,GAAc,IAAVK,EAAG,MAAcx/B,GAAKw/B,EAAG,GAAKx/B,EAAE,IAAMw/B,EAAG,GAAKx/B,EAAE,IAAK,CACrDm/B,EAAElkB,MAAQukB,EAAG,GACb,KACJ,CACA,GAAc,IAAVA,EAAG,IAAYL,EAAElkB,MAAQjb,EAAE,GAAI,CAC/Bm/B,EAAElkB,MAAQjb,EAAE,GACZA,EAAIw/B,EACJ,KACJ,CACA,GAAIx/B,GAAKm/B,EAAElkB,MAAQjb,EAAE,GAAI,CACrBm/B,EAAElkB,MAAQjb,EAAE,GACZm/B,EAAEG,IAAI9qC,KAAKgrC,GACX,KACJ,CACIx/B,EAAE,IAAIm/B,EAAEG,IAAIG,MAChBN,EAAEE,KAAKI,MACP,SAERD,EAAKP,EAAK1iB,KAAKmiB,EAASS,EAC5B,CAAE,MAAOnrC,GACLwrC,EAAK,CACD,EACAxrC,GAEJuc,EAAI,CACR,CAAE,QACEkX,EAAIznB,EAAI,CACZ,CACA,GAAY,EAARw/B,EAAG,GAAQ,MAAMA,EAAG,GACxB,MAAO,CACH7uC,MAAO6uC,EAAG,GAAKA,EAAG,QAAK,EACvBzpB,MAAM,EAEd,CA1EegpB,CAAK,CACRnrC,EACAmgC,GAER,CACJ,CAsEJ,EACI8S,GAA0D,WAC1D,SAASA,EAA0CG,GAC/Ct8C,KAAKs8C,SAAWA,CACpB,CA4FA,OA3FAH,EAA0Ct4C,UAAU04C,cAAgB,SAASvrC,GACzE,IAAI5B,EAAWpP,KAAKs8C,SAASjL,OAAS,QAAU,OAC5C2B,EAAKhzC,KAAKs8C,SAAUhL,EAAO0B,EAAG1B,KAAMpiC,EAAO8jC,EAAG9jC,KAAMqiC,EAAOyB,EAAGzB,KAAMvrC,EAAMgtC,EAAGhtC,IAC7EkM,EAAM,IAAIsqC,IAAI,GAAG9iB,OAAOtqB,EAAU,OAAOsqB,OAAO4X,EAAM,KAAK5X,OAAOxqB,GAAMwqB,OAAO6X,GAAM7X,OAAO1zB,EAAK,KAAK0zB,OAAO1oB,IAIjH,OAFAkB,EAAIuqC,aAAaj+B,IAAI,KAAM,GAAGkb,OAAOlyB,KAAK4tB,OAAOsE,OAAOt0B,KAAKma,WAC7DrN,EAAIuqC,aAAaj+B,IAAI,UAAWwxB,GAA0B/qB,SACnDy3B,MAAMxqC,EAAIif,KAAM,CACnBwrB,eAAgB38C,KAAKs8C,SAASK,gBAEtC,EACuER,EAA0Ct4C,UAAU+4C,WAAa,WACpI,OAAOR,GAAgCp8C,UAAM,EAAQ2Y,SAAS,WAC1D,IAAI0lB,EAAUwe,EAASC,EACvB,OAAOT,GAAkCr8C,MAAM,SAASgzC,GACpD,OAAOA,EAAGziB,OACN,KAAK,EAOD,OANAyiB,EAAG2B,KAAK7qC,KAAK,CACT,EACA,EACA,CACA,IAEG,CACH,EACA9J,KAAKu8C,cAAc,OAE3B,KAAK,EAED,GAAwB,OADxBle,EAAW2U,EAAG0B,QACD5kB,OAAgB,MAAM,IAAIxqB,MAAM,iBAAiBo0B,OAAO2E,EAASvO,SAC9E,MAAO,CACH,EACAuO,EAAS0e,QAEjB,KAAK,EAKD,MAJAF,EAAU7J,EAAG0B,OACbzF,GAA0BzvC,QAAQ8f,MAAM,sBAAuBu9B,GAC/DC,EAAY,GACe,MAAvB98C,KAAKs8C,SAAS/K,MAAgBvxC,KAAKs8C,SAAShL,OAAS9G,GAA0CE,aAAYoS,EAAY,mIACrH,IAAIx3C,MAAM,uCAAyCw3C,GAC7D,KAAK,EACD,MAAO,CACH,GAGhB,GACJ,GACJ,EACmBX,EAA0Ct4C,UAAUm5C,aAAe,WAClF,OAAOZ,GAAgCp8C,UAAM,EAAQ2Y,SAAS,WAC1D,IAAI0lB,EAAU4e,EAAcC,EAC5B,OAAOb,GAAkCr8C,MAAM,SAASgzC,GACpD,OAAOA,EAAGziB,OACN,KAAK,EAOD,OANAyiB,EAAG2B,KAAK7qC,KAAK,CACT,EACA,EACA,CACA,IAEG,CACH,EACA9J,KAAKu8C,cAAc,UAE3B,KAAK,EAED,GAAwB,OADxBle,EAAW2U,EAAG0B,QACD5kB,OAAgB,CACzB,GAAwB,MAApBuO,EAASvO,OAIT,KAHe,GACkEmtB,EAA7Ej9C,KAAKs8C,SAAShL,OAAS9G,GAA0CE,WAA2B,sHAC5E,2FACd,IAAIplC,MAAM,+DAAiE23C,GAErF,MAAM,IAAI33C,MAAM,iBAAiBo0B,OAAO2E,EAASvO,QACrD,CACA,MAAO,CACH,EACAuO,EAAS8e,QAEjB,KAAK,EAGD,MAFAD,EAAUlK,EAAG0B,OACbzF,GAA0BzvC,QAAQ8f,MAAM,8BAA+B49B,GACjE,IAAI53C,MAAM,4CAA8C43C,GAClE,KAAK,EACD,MAAO,CACH,GAGhB,GACJ,GACJ,EACOf,CACX,CAhG8D,GAmG1DiB,GAAsE,WACtE,IAAItM,EAAgB,SAASE,EAAIC,GAQ7B,OAPAH,EAAgB1pC,OAAO8pC,gBAAkB,CACrCtD,UAAW,cACD9nC,OAAS,SAAS00B,EAAGT,GAC/BS,EAAEoT,UAAY7T,CAClB,GAAK,SAASS,EAAGT,GACb,IAAI,IAAIvhB,KAAKuhB,EAAM3yB,OAAOvD,UAAUoF,eAAe4oB,KAAKkI,EAAGvhB,KAAIgiB,EAAEhiB,GAAKuhB,EAAEvhB,GAC5E,GACqBw4B,EAAIC,EAC7B,EACA,OAAO,SAASzW,EAAGT,GACf,GAAiB,mBAANA,GAA0B,OAANA,EAAY,MAAM,IAAIpqB,UAAU,uBAAyBhK,OAAOo0B,GAAK,iCAEpG,SAASoX,IACLnxC,KAAK4G,YAAc4zB,CACvB,CAHAsW,EAActW,EAAGT,GAIjBS,EAAE32B,UAAkB,OAANk2B,EAAa3yB,OAAOumC,OAAO5T,IAAMoX,EAAGttC,UAAYk2B,EAAEl2B,UAAW,IAAIstC,EACnF,CACJ,CAnB0E,GAoBtEkM,GAAoE,WAQpE,OAPAA,GAAiCj2C,OAAO0P,QAAU,SAASxB,GACvD,IAAI,IAAIZ,EAAGzV,EAAI,EAAGiK,EAAIqT,UAAUjZ,OAAQrE,EAAIiK,EAAGjK,IAE3C,IAAI,IAAIuZ,KADR9D,EAAI6H,UAAUtd,GACKmI,OAAOvD,UAAUoF,eAAe4oB,KAAKnd,EAAG8D,KAAIlD,EAAEkD,GAAK9D,EAAE8D,IAE5E,OAAOlD,CACX,EACO+nC,GAA+B1+B,MAAM3e,KAAMuc,UACtD,EACI+gC,GAAoE,SAASjO,GAC7E,IAAI36B,EAAsB,mBAAX46B,QAAyBA,OAAOC,SAAU7rC,EAAIgR,GAAK26B,EAAE36B,GAAIzV,EAAI,EAC5E,GAAIyE,EAAG,OAAOA,EAAEmuB,KAAKwd,GACrB,GAAIA,GAAyB,iBAAbA,EAAE/rC,OAAqB,MAAO,CAC1CmsC,KAAM,WAEF,OADIJ,GAAKpwC,GAAKowC,EAAE/rC,SAAQ+rC,OAAI,GACrB,CACHppC,MAAOopC,GAAKA,EAAEpwC,KACdosB,MAAOgkB,EAEf,GAEJ,MAAM,IAAI1/B,UAAU+E,EAAI,0BAA4B,kCACxD,EACI6oC,GAAgE,SAASlO,EAAGnmC,GAC5E,IAAIxF,EAAsB,mBAAX4rC,QAAyBD,EAAEC,OAAOC,UACjD,IAAK7rC,EAAG,OAAO2rC,EACf,IAAmBnW,EAAY5vB,EAA3BrK,EAAIyE,EAAEmuB,KAAKwd,GAAOG,EAAK,GAC3B,IACI,WAAa,IAANtmC,GAAgBA,KAAM,MAAQgwB,EAAIj6B,EAAEwwC,QAAQpkB,MAAKmkB,EAAG1lC,KAAKovB,EAAEjzB,MACtE,CAAE,MAAOqZ,GACLhW,EAAI,CACAgW,MAAOA,EAEf,CAAE,QACE,IACQ4Z,IAAMA,EAAE7N,OAAS3nB,EAAIzE,EAAU,SAAIyE,EAAEmuB,KAAK5yB,EAClD,CAAE,QACE,GAAIqK,EAAG,MAAMA,EAAEgW,KACnB,CACJ,CACA,OAAOkwB,CACX,EAOQ7C,GAA0D,SAASyE,GAEvE,SAASzE,EAA0C6Q,EAAK7Y,GACpD,IASI8Y,EATAhM,EAAQL,EAAOvf,KAAK7xB,OAASA,KA0CjC,OAzCAyxC,EAAMM,IAAM,KACZN,EAAMiM,cAAgB,KAEtBjM,EAAMkM,YAAa,EACnBlM,EAAMC,eAAgB,EACtBD,EAAMsG,OAAQ,EACdtG,EAAMmM,aAAe,IAAIv/B,IACzBozB,EAAMoM,cAAgB,IAAIx/B,IAGtBm/B,GAAOA,EAAI52C,aAAeQ,OAAQu9B,EAAU6Y,EACvCA,IAAKC,EAASD,EAAIn2C,YAE3Bs9B,EAAU0Y,GAA+B,CACrCS,MAAO,EACPxM,KAAM9G,GAA0CE,WAChDx7B,KAAMs7B,GAA0CG,WAChD4G,KAAM,IACNvrC,IAAK2mC,EAA0CoR,YAC/CjM,MAAOtH,GAA0CiC,cACjD77B,OAAQ45B,GAA0CQ,cAClD2R,eAAgB,mCACjBhY,GACH8M,EAAM6K,SAAW3X,EAEW,MAAxB8M,EAAM6K,SAAShL,OAAcG,EAAM6K,SAAShL,KAAO5nC,OAAOwnB,SAAS8sB,UAEnEvM,EAAM6K,SAAS/K,OACgB,MAA3BE,EAAM6K,SAAS/K,KAAK,KAAYE,EAAM6K,SAAS/K,KAAO,IAAME,EAAM6K,SAAS/K,MACnB,MAAxDE,EAAM6K,SAAS/K,KAAKE,EAAM6K,SAAS/K,KAAKjuC,OAAS,KAAYmuC,EAAM6K,SAAS/K,MAAQ,WAG9D3hC,IAA1B6hC,EAAM6K,SAASjL,QAAwBI,EAAM6K,SAAShL,OAAS9G,GAA0CE,WAAY+G,EAAM6K,SAASjL,OAAS7G,GAA0CkC,WAClL+E,EAAM6K,SAAShL,MAAQ9G,GAA0CE,aAAY+G,EAAM6K,SAASjL,QAAS,GAE1GI,EAAM6K,SAAS2B,aAAahP,GAA0BzvC,QAAQkxC,eAAee,EAAM6K,SAAS2B,aAChGhP,GAA0BzvC,QAAQ4wC,SAAWqB,EAAM6K,SAASwB,OAAS,EACrErM,EAAMyM,KAAO,IAAIhC,GAA0BiC,IAAIxZ,GAC/C8M,EAAMQ,QAAUR,EAAM2M,0BAGjB5T,GAA0CU,SAASE,YAAeZ,GAA0CU,SAAS7pC,KAKpHo8C,IAAWjT,GAA0CmB,WAAW8R,IAClEhM,EAAM4M,cAAczO,GAA0C0O,UAAW,OAAQ5kB,OAAO+jB,EAAQ,iBACzFhM,IAEPgM,EAAQhM,EAAM8M,YAAYd,GACzBhM,EAAMyM,KAAKtB,aAAa1+B,MAAK,SAAS5S,GACvC,OAAOmmC,EAAM8M,YAAYjzC,EAC7B,IAAGymB,OAAM,SAASzS,GACd,OAAOmyB,EAAM+M,OAAO5O,GAA0C6O,YAAan/B,EAC/E,IACOmyB,IAdHA,EAAM4M,cAAczO,GAA0C8O,oBAAqB,+CAC5EjN,EAcf,CAqZA,OAjdA2L,GAAgCzQ,EAA2CyE,GA6D3EhqC,OAAO4L,eAAe25B,EAA0C9oC,UAAW,KAAM,CAGzEqP,IAAK,WACL,OAAOlT,KAAK+xC,GAChB,EACA5a,YAAY,EACZlkB,cAAc,IAElB7L,OAAO4L,eAAe25B,EAA0C9oC,UAAW,UAAW,CAClFqP,IAAK,WACD,OAAOlT,KAAKs8C,QAChB,EACAnlB,YAAY,EACZlkB,cAAc,IAElB7L,OAAO4L,eAAe25B,EAA0C9oC,UAAW,OAAQ,CAC/EqP,IAAK,WACD,OAAOlT,KAAK+3C,KAChB,EACA5gB,YAAY,EACZlkB,cAAc,IAElB7L,OAAO4L,eAAe25B,EAA0C9oC,UAAW,SAAU,CACjFqP,IAAK,WACD,OAAOlT,KAAKiyC,OAChB,EACA9a,YAAY,EACZlkB,cAAc,IAElB7L,OAAO4L,eAAe25B,EAA0C9oC,UAAW,cAAe,CAKlFqP,IAAK,WACL,IAAI6/B,EAAKC,EACL2L,EAAmBv3C,OAAOumC,OAAO,MACrC,IACI,IAAI,IAAIiR,EAAKtB,GAA+Bt9C,KAAK49C,cAAeiB,EAAKD,EAAGnP,QAASoP,EAAGxzB,KAAMwzB,EAAKD,EAAGnP,OAAO,CACrG,IAAIqP,EAAKvB,GAA6BsB,EAAG54C,MAAO,GAAI84C,EAAID,EAAG,GAAIzV,EAAIyV,EAAG,GACtEH,EAAiBI,GAAK1V,CAC1B,CACJ,CAAE,MAAOkK,GACLR,EAAM,CACFzzB,MAAOi0B,EAEf,CAAE,QACE,IACQsL,IAAOA,EAAGxzB,OAAS2nB,EAAK4L,EAAGpL,SAASR,EAAGnhB,KAAK+sB,EACpD,CAAE,QACE,GAAI7L,EAAK,MAAMA,EAAIzzB,KACvB,CACJ,CACA,OAAOq/B,CACX,EACAxnB,YAAY,EACZlkB,cAAc,IAElB7L,OAAO4L,eAAe25B,EAA0C9oC,UAAW,YAAa,CAGhFqP,IAAK,WACL,OAAOlT,KAAK29C,UAChB,EACAxmB,YAAY,EACZlkB,cAAc,IAElB7L,OAAO4L,eAAe25B,EAA0C9oC,UAAW,eAAgB,CAGnFqP,IAAK,WACL,OAAOlT,KAAK0xC,aAChB,EACAva,YAAY,EACZlkB,cAAc,IAElB05B,EAA0C9oC,UAAUu6C,wBAA0B,WAC1E,IAAI3M,EAAQzxC,KACRk2C,EAAS,IAAItF,GAA0BoO,OAAOh/C,KAAKs8C,SAASjL,OAAQrxC,KAAKs8C,SAAShL,KAAMtxC,KAAKs8C,SAASptC,KAAMlP,KAAKs8C,SAAS/K,KAAMvxC,KAAKs8C,SAASt2C,IAAKhG,KAAKs8C,SAAS9K,cAgBrK,OAfA0E,EAAO1kB,GAAGse,GAA0CsC,SAAS,SAAS/wC,GAClEowC,EAAMwN,eAAe59C,EACzB,IACA60C,EAAO1kB,GAAGse,GAA0CxqC,OAAO,SAASga,GAChEmyB,EAAM+M,OAAO5O,GAA0CsP,YAAa5/B,EACxE,IACA42B,EAAO1kB,GAAGse,GAA0CyC,cAAc,WAC1Dd,EAAM11B,eACV01B,EAAMyF,UAAUtH,GAA0CuP,QAAS,8BACnE1N,EAAM2N,aACV,IACAlJ,EAAO1kB,GAAGse,GAA0CuP,OAAO,WACnD5N,EAAM11B,cACV01B,EAAM+M,OAAO5O,GAA0C0P,aAAc,uCACzE,IACOpJ,CACX,EACgDvJ,EAA0C9oC,UAAU06C,YAAc,SAASjzC,GACvHtL,KAAK+xC,IAAMzmC,EACXtL,KAAKk2C,OAAOz8B,MAAMnO,EAAItL,KAAKs8C,SAASxK,MACxC,EACyCnF,EAA0C9oC,UAAUo7C,eAAiB,SAASzvB,GACnH,IAAI+vB,EAAKvM,EACLzzC,EAAOiwB,EAAQjwB,KACf62C,EAAU5mB,EAAQ4mB,QAClBL,EAASvmB,EAAQzC,IACrB,OAAOxtB,GACH,KAAKwwC,GAA0CyP,KAC3Cx/C,KAAK09C,cAAgB19C,KAAKsL,GAC1BtL,KAAK+3C,OAAQ,EACb/3C,KAAKmoB,KAAK,OAAQnoB,KAAKsL,IACvB,MACJ,KAAKykC,GAA0CzqC,MAC3CtF,KAAKw+C,OAAO5O,GAA0C6O,YAAarI,EAAQoF,KAC3E,MACJ,KAAKzL,GAA0C0P,QAC3Cz/C,KAAKw+C,OAAO5O,GAA0C8P,cAAe,OAAQhmB,OAAO15B,KAAKsL,GAAI,eAC7F,MACJ,KAAKykC,GAA0C4P,WAC3C3/C,KAAKw+C,OAAO5O,GAA0C+P,WAAY,YAAajmB,OAAO15B,KAAKs8C,SAASt2C,IAAK,iBACzG,MACJ,KAAK+pC,GAA0C6P,MAC3C3Q,GAA0BzvC,QAAQiJ,IAAI,+BAA+BixB,OAAOqc,IAC5E/1C,KAAK6/C,aAAa9J,GAClB/1C,KAAK49C,aAAa1mB,OAAO6e,GACzB,MACJ,KAAKhG,GAA0C+P,OAC3C9/C,KAAKk3C,UAAUtH,GAA0CmQ,gBAAiB,6BAA6BrmB,OAAOqc,IAC9G,MACJ,KAAKhG,GAA0CkH,MAE3C,IAAIjB,EAAeI,EAAQJ,aAO3B,IANIhB,EAAah1C,KAAKs2C,cAAcP,EAAQC,MAExChB,EAAWx5B,QACXyzB,GAA0BzvC,QAAQgC,KAAK,6CAA6Ck4B,OAAOsc,KAG3FI,EAAQ72C,OAASowC,GAA0CyF,MAAO,CAClE,IAAImB,EAAkB,IAAI7C,GAA0BsM,gBAAgBjK,EAAQ/1C,KAAM,CAC9Eg2C,aAAcA,EACdyC,SAAUrC,EACVW,SAAUX,EAAQW,WAEtB/B,EAAauB,EACbv2C,KAAKigD,eAAelK,EAAQf,GAC5Bh1C,KAAKmoB,KAAK,OAAQouB,EACtB,KAAO,IAAIH,EAAQ72C,OAASowC,GAA0C6F,KAclE,YADAvG,GAA0BzvC,QAAQgC,KAAK,sCAAsCk4B,OAAO0c,EAAQ72C,OAZ5F,IAAIk2C,EAAiB,IAAIyD,GAA0BgH,eAAenK,EAAQ/1C,KAAM,CAC5Eg2C,aAAcA,EACdyC,SAAUrC,EACVW,SAAUX,EAAQW,SAClBxmB,MAAO6lB,EAAQ7lB,MACfymB,cAAeZ,EAAQY,cACvB1L,SAAU8K,EAAQ9K,WAEtB0J,EAAaS,EACbz1C,KAAKigD,eAAelK,EAAQf,GAC5Bh1C,KAAKmoB,KAAK,aAAcstB,EAI5B,CAEA,IAAIiD,EAAW14C,KAAK24C,aAAa3C,GACjC,IACI,IAAI,IAAI4C,EAAa0E,GAA+B5E,GAAWI,EAAeF,EAAWnJ,QAASqJ,EAAaztB,KAAMytB,EAAeF,EAAWnJ,OAAO,CAClJ,IAAI0Q,EAAYrH,EAAa7yC,MAC7B+uC,EAAWwD,cAAc2H,EAC7B,CACJ,CAAE,MAAOC,GACLb,EAAM,CACFjgC,MAAO8gC,EAEf,CAAE,QACE,IACQtH,IAAiBA,EAAaztB,OAAS2nB,EAAK4F,EAAWpF,SAASR,EAAGnhB,KAAK+mB,EAChF,CAAE,QACE,GAAI2G,EAAK,MAAMA,EAAIjgC,KACvB,CACJ,CACA,MACJ,QACI,IAAK82B,EAED,YADAnH,GAA0BzvC,QAAQgC,KAAK,yCAAyCk4B,OAAOqc,EAAQ,aAAarc,OAAOn6B,IAGvH,IACIy1C,EADAgB,EAAeI,EAAQJ,cACvBhB,EAAah1C,KAAKs2C,cAAcP,EAAQC,KAC1BhB,EAAWE,eAC7BF,EAAWwD,cAAchpB,GAChBwmB,EACTh2C,KAAKqgD,cAAcrK,EAAcxmB,GAC5Byf,GAA0BzvC,QAAQgC,KAAK,wCAAyCguB,GAGjG,EACyEmd,EAA0C9oC,UAAUw8C,cAAgB,SAASrK,EAAcxmB,GAC3JxvB,KAAK69C,cAAc7mB,IAAIgf,IAAeh2C,KAAK69C,cAAcr/B,IAAIw3B,EAAc,IAChFh2C,KAAK69C,cAAc3qC,IAAI8iC,GAAclsC,KAAK0lB,EAC9C,EAEAmd,EAA0C9oC,UAAU80C,aAAe,SAAS3C,GACxE,IAAI0C,EAAW14C,KAAK69C,cAAc3qC,IAAI8iC,GACtC,OAAI0C,GACA14C,KAAK69C,cAAc3mB,OAAO8e,GACnB0C,GAEJ,EACX,EAKI/L,EAA0C9oC,UAAU0tB,QAAU,SAASF,EAAMsT,GAE7E,QADgB,IAAZA,IAAoBA,EAAU,CAAC,GAC/B3kC,KAAK+b,aAGL,OAFAkzB,GAA0BzvC,QAAQgC,KAAK,sPACvCxB,KAAKk3C,UAAUtH,GAA0C2C,aAAc,+DAG3E,IAAIkD,EAAiB,IAAIyD,GAA0BgH,eAAe7uB,EAAMrxB,KAAM2kC,GAE9E,OADA3kC,KAAKigD,eAAe5uB,EAAMokB,GACnBA,CACX,EAMI9I,EAA0C9oC,UAAUguB,KAAO,SAASR,EAAM/mB,EAAQq6B,GAElF,QADgB,IAAZA,IAAoBA,EAAU,CAAC,GAC/B3kC,KAAK+b,aAGL,OAFAkzB,GAA0BzvC,QAAQgC,KAAK,0KACvCxB,KAAKk3C,UAAUtH,GAA0C2C,aAAc,+DAG3E,GAAKjoC,EAAL,CAIA,IAAIisC,EAAkB,IAAI7C,GAA0BsM,gBAAgB3uB,EAAMrxB,KAAMq9C,GAA+BA,GAA+B,CAAC,EAAG1Y,GAAU,CACxJ0Q,QAAS/qC,KAGb,OADAtK,KAAKigD,eAAe5uB,EAAMklB,GACnBA,CALP,CAFItH,GAA0BzvC,QAAQ8f,MAAM,gFAQhD,EACiDqtB,EAA0C9oC,UAAUo8C,eAAiB,SAASlK,EAAQf,GACnI/F,GAA0BzvC,QAAQiJ,IAAI,kBAAkBixB,OAAOsb,EAAWz1C,KAAM,KAAKm6B,OAAOsb,EAAWgB,aAAc,eAAetc,OAAOqc,IACtI/1C,KAAK49C,aAAa5mB,IAAI+e,IAAS/1C,KAAK49C,aAAap/B,IAAIu3B,EAAQ,IAClE/1C,KAAK49C,aAAa1qC,IAAI6iC,GAAQjsC,KAAKkrC,EACvC,EAEArI,EAA0C9oC,UAAUk1C,kBAAoB,SAAS/D,GAC7E,IAAIsL,EAActgD,KAAK49C,aAAa1qC,IAAI8hC,EAAW3jB,MACnD,GAAIivB,EAAa,CACb,IAAIp9C,EAAQo9C,EAAY9xC,QAAQwmC,IACjB,IAAX9xC,GAAco9C,EAAY9qC,OAAOtS,EAAO,EAChD,CAEAlD,KAAK69C,cAAc3mB,OAAO8d,EAAWgB,aACzC,EACuDrJ,EAA0C9oC,UAAUyyC,cAAgB,SAASP,EAAQC,GACxI,IAAIuK,EAAKvN,EACLsN,EAActgD,KAAK49C,aAAa1qC,IAAI6iC,GACxC,IAAKuK,EAAa,OAAO,KACzB,IACI,IAAI,IAAIE,EAAgBlD,GAA+BgD,GAAcG,EAAkBD,EAAc/Q,QAASgR,EAAgBp1B,KAAMo1B,EAAkBD,EAAc/Q,OAAO,CACvK,IAAIuF,EAAayL,EAAgBx6C,MACjC,GAAI+uC,EAAWgB,eAAiBA,EAAc,OAAOhB,CACzD,CACJ,CAAE,MAAO0L,GACLH,EAAM,CACFjhC,MAAOohC,EAEf,CAAE,QACE,IACQD,IAAoBA,EAAgBp1B,OAAS2nB,EAAKwN,EAAchN,SAASR,EAAGnhB,KAAK2uB,EACzF,CAAE,QACE,GAAID,EAAK,MAAMA,EAAIjhC,KACvB,CACJ,CACA,OAAO,IACX,EACAqtB,EAA0C9oC,UAAUw6C,cAAgB,SAAS9+C,EAAMiwB,GAC/E,IAAIiiB,EAAQzxC,KACZyQ,YAAW,WACPghC,EAAM+M,OAAOj/C,EAAMiwB,EACvB,GAAG,EACP,EAKImd,EAA0C9oC,UAAU26C,OAAS,SAASj/C,EAAMiwB,GAC5Eyf,GAA0BzvC,QAAQ8f,MAAM,aACxCtf,KAAKk3C,UAAU33C,EAAMiwB,GAChBxvB,KAAK09C,cACL19C,KAAKo/C,aADep/C,KAAK25C,SAElC,EACoChN,EAA0C9oC,UAAUqzC,UAAY,SAAS33C,EAAMyyB,GAE/G,IAAI1S,EADJ2vB,GAA0BzvC,QAAQ8f,MAAM,SAAU0S,IAErB1S,EAAV,iBAAR0S,EAA0B,IAAI1sB,MAAM0sB,GAClCA,GACPzyB,KAAOA,EACbS,KAAKmoB,KAAK,QAAS7I,EACvB,EAMIqtB,EAA0C9oC,UAAU81C,QAAU,WAC1D35C,KAAK2gD,YACT1R,GAA0BzvC,QAAQiJ,IAAI,wBAAwBixB,OAAO15B,KAAKsL,KAC1EtL,KAAKo/C,aACLp/C,KAAKsyC,WACLtyC,KAAK29C,YAAa,EAClB39C,KAAKmoB,KAAK,SACd,EACkDwkB,EAA0C9oC,UAAUyuC,SAAW,WAC7G,IAAIsO,EAAK5N,EACT,IACI,IAAI,IAAI4L,EAAKtB,GAA+Bt9C,KAAK49C,aAAa70C,QAAS81C,EAAKD,EAAGnP,QAASoP,EAAGxzB,KAAMwzB,EAAKD,EAAGnP,OAAO,CAC5G,IAAIsG,EAAS8I,EAAG54C,MAChBjG,KAAK6/C,aAAa9J,GAClB/1C,KAAK49C,aAAa1mB,OAAO6e,EAC7B,CACJ,CAAE,MAAO8K,GACLD,EAAM,CACFthC,MAAOuhC,EAEf,CAAE,QACE,IACQhC,IAAOA,EAAGxzB,OAAS2nB,EAAK4L,EAAGpL,SAASR,EAAGnhB,KAAK+sB,EACpD,CAAE,QACE,GAAIgC,EAAK,MAAMA,EAAIthC,KACvB,CACJ,CACAtf,KAAKk2C,OAAOtH,oBAChB,EAC4CjC,EAA0C9oC,UAAUg8C,aAAe,SAAS9J,GACpH,IAAI+K,EAAK9N,EACLsN,EAActgD,KAAK49C,aAAa1qC,IAAI6iC,GACxC,GAAKuK,EACL,IACI,IAAI,IAAIS,EAAgBzD,GAA+BgD,GAAcU,EAAkBD,EAActR,QAASuR,EAAgB31B,KAAM21B,EAAkBD,EAActR,OAC/IuR,EAAgB/6C,MACtBuV,OAEnB,CAAE,MAAOylC,GACLH,EAAM,CACFxhC,MAAO2hC,EAEf,CAAE,QACE,IACQD,IAAoBA,EAAgB31B,OAAS2nB,EAAK+N,EAAcvN,SAASR,EAAGnhB,KAAKkvB,EACzF,CAAE,QACE,GAAID,EAAK,MAAMA,EAAIxhC,KACvB,CACJ,CACJ,EAMIqtB,EAA0C9oC,UAAUu7C,WAAa,WACjE,IAAIp/C,KAAK+b,aAAT,CACA,IAAImlC,EAAYlhD,KAAKsL,GACrB2jC,GAA0BzvC,QAAQiJ,IAAI,2BAA2BixB,OAAOwnB,IACxElhD,KAAK0xC,eAAgB,EACrB1xC,KAAK+3C,OAAQ,EACb/3C,KAAKk2C,OAAO16B,QACZxb,KAAK09C,cAAgBwD,EACrBlhD,KAAK+xC,IAAM,KACX/xC,KAAKmoB,KAAK,eAAgB+4B,EARG,CASjC,EAC+CvU,EAA0C9oC,UAAUs9C,UAAY,WAC3G,GAAInhD,KAAK+b,eAAiB/b,KAAK2gD,UAC3B1R,GAA0BzvC,QAAQiJ,IAAI,6CAA6CixB,OAAO15B,KAAK09C,gBAC/F19C,KAAK0xC,eAAgB,EACrB1xC,KAAKu+C,YAAYv+C,KAAK09C,mBACnB,IAAI19C,KAAK2gD,UAAW,MAAM,IAAIr7C,MAAM,4EACtC,GAAKtF,KAAK+b,cAAiB/b,KAAKg5C,KAEhC,MAAM,IAAI1zC,MAAM,QAAQo0B,OAAO15B,KAAKsL,GAAI,sEAD7C2jC,GAA0BzvC,QAAQ8f,MAAM,iEAC0E,CACtH,EAMIqtB,EAA0C9oC,UAAUm5C,aAAe,SAAStmB,GAC5E,IAAI+a,EAAQzxC,UACD,IAAP02B,IAAeA,EAAK,SAAS+d,GAAI,GACrCz0C,KAAKk+C,KAAKlB,eAAe9+B,MAAK,SAASkjC,GACnC,OAAO1qB,EAAG0qB,EACd,IAAGrvB,OAAM,SAASzS,GACd,OAAOmyB,EAAM+M,OAAO5O,GAA0C6O,YAAan/B,EAC/E,GACJ,EACAqtB,EAA0CoR,YAAc,SACjDpR,CACX,CAndkE,CAmdhEC,GAA0BoC,a,GCloFxBqS,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqB3xC,IAAjB4xC,EACH,OAAOA,EAAa5iD,QAGrB,IAAIC,EAASwiD,EAAyBE,GAAY,CAGjD3iD,QAAS,CAAC,GAOX,OAHA6iD,EAAoBF,GAAU1iD,EAAQA,EAAOD,QAAS0iD,GAG/CziD,EAAOD,OACf,C,OCrBA0iD,EAAoBp4C,EAAKrK,IACxB,IAAI6iD,EAAS7iD,GAAUA,EAAO8iD,WAC7B,IAAO9iD,EAAiB,QACxB,IAAM,EAEP,OADAyiD,EAAoB9mB,EAAEknB,EAAQ,CAAE1iD,EAAG0iD,IAC5BA,CAAM,ECLdJ,EAAoB9mB,EAAI,CAAC57B,EAASgjD,KACjC,IAAI,IAAI57C,KAAO47C,EACXN,EAAoBjS,EAAEuS,EAAY57C,KAASs7C,EAAoBjS,EAAEzwC,EAASoH,IAC5EoB,OAAO4L,eAAepU,EAASoH,EAAK,CAAEmxB,YAAY,EAAMjkB,IAAK0uC,EAAW57C,IAE1E,ECNDs7C,EAAoBjS,EAAI,CAACvmC,EAAKE,IAAU5B,OAAOvD,UAAUoF,eAAe4oB,KAAK/oB,EAAKE,GCClFs4C,EAAoBpoB,EAAKt6B,IACH,oBAAX0wC,QAA0BA,OAAOuS,aAC1Cz6C,OAAO4L,eAAepU,EAAS0wC,OAAOuS,YAAa,CAAE57C,MAAO,WAE7DmB,OAAO4L,eAAepU,EAAS,aAAc,CAAEqH,OAAO,GAAO,ECH9D,EAAQ,KACR,EAAQ,KACR,EAAQ,KACR,EAAQ,KACR,EAAQ,KACR,EAAQ,KAER,EAAQ,KACR,EAAQ,IACR,EAAQ,IACR,EAAQ,KACR,EAAQ,K","sources":["webpack://squatmaster/webpack/universalModuleDefinition","webpack://squatmaster/./node_modules/aframe-polygon-wireframe/index.js","webpack://squatmaster/./node_modules/peerjs-js-binarypack/lib/binarypack.js","webpack://squatmaster/./node_modules/peerjs-js-binarypack/lib/bufferbuilder.js","webpack://squatmaster/./node_modules/rtcpeerconnection-shim/rtcpeerconnection.js","webpack://squatmaster/./node_modules/sdp/sdp.js","webpack://squatmaster/./src/bar-monitor.js","webpack://squatmaster/./src/bar-position.js","webpack://squatmaster/./src/calibration-flow.js","webpack://squatmaster/./src/in-rack-ui.js","webpack://squatmaster/./src/phone/phone.js","webpack://squatmaster/./src/squat-rack.js","webpack://squatmaster/./src/ui-manager.js","webpack://squatmaster/./src/ui-updater.js","webpack://squatmaster/./src/vertical-controls.js","webpack://squatmaster/./src/video-stream.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/utils.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/chrome/getdisplaymedia.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/edge/getusermedia.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/edge/getdisplaymedia.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/edge/edge_shim.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/edge/filtericeservers.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/firefox/getdisplaymedia.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/safari/safari_shim.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/common_shim.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/adapter_core.js","webpack://squatmaster/./node_modules/webrtc-adapter/src/js/adapter_factory.js","webpack://squatmaster/./node_modules/peerjs/dist/bundler.mjs","webpack://squatmaster/webpack/bootstrap","webpack://squatmaster/webpack/runtime/compat get default export","webpack://squatmaster/webpack/runtime/define property getters","webpack://squatmaster/webpack/runtime/hasOwnProperty shorthand","webpack://squatmaster/webpack/runtime/make namespace object","webpack://squatmaster/./index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, () => {\nreturn ","AFRAME.registerComponent(\"polygon-wireframe\", {\r\n\r\n    schema: {\r\n        color: { type: 'color', default: 'grey' },\r\n        opacity: { type: 'number', default: 1 },\r\n        hiddenOpacity: { type: 'number', default: 0 },\r\n        dashed: { type: 'boolean', default: false },\r\n        dashSize: { type: 'number', default: 3 },\r\n        gapSize: { type: 'number', default: 1 },\r\n        dashScale: { type: 'number', default: 30 },\r\n    },\r\n\r\n    init() {\r\n\r\n      this.updateGeometry = this.updateGeometry.bind(this)\r\n      this.el.addEventListener('object3dset', this.updateGeometry)\r\n      if (this.el.getObject3D('mesh')) {\r\n        this.updateGeometry()\r\n      }\r\n    },\r\n\r\n    updateGeometry() {\r\n\r\n      const baseGeometry = this.el.getObject3D('mesh').geometry\r\n      if (!baseGeometry) {\r\n        return\r\n      }\r\n\r\n      if (this.edges) {\r\n        this.edges.dispose()\r\n      }\r\n\r\n      this.edges = new THREE.EdgesGeometry(baseGeometry);\r\n      this.update()\r\n    },\r\n\r\n    update() {\r\n\r\n      const oldMaterial = this.material\r\n      const oldLine = this.line\r\n      const oldHiddenMaterial = this.hiddenMaterial\r\n      const oldHiddenLine = this.hiddenLine\r\n\r\n      const data = this.data\r\n\r\n      this.material = this.createLineMaterial(data.color, data.opacity)\r\n\r\n      if (data.hiddenOpacity !== 0 && \r\n          data.hiddenOpacity !== data.opacity) {\r\n        // separate material needed for hidden parts\r\n        this.hiddenMaterial = this.createLineMaterial(data.color, data.hiddenOpacity)\r\n\r\n        if (data.hiddenOpacity > data.opacity) {\r\n          console.warn(\"Opacity of hidden parts cannot be higher than the opacity of non-hidden parts\")\r\n          console.warn(\"Wireframe will be rendered with opacity \", data.hiddenOpacity, \" as set on hiddenOpacity property.\")\r\n        }\r\n      }\r\n      else {\r\n        this.hiddenMaterial = null\r\n      }\r\n\r\n      if (data.hiddenOpacity !== 0) {\r\n        const material = this.hiddenMaterial || this.material\r\n        material.depthWrite = false\r\n        material.depthTest = false\r\n        material.toneMapped = false\r\n      }\r\n      \r\n      this.line = new THREE.LineSegments( this.edges, this.material );\r\n      this.line.computeLineDistances();\r\n      this.el.object3D.add( this.line );\r\n\r\n      if (this.hiddenMaterial) {\r\n        this.hiddenLine = new THREE.LineSegments( this.edges, this.hiddenMaterial );\r\n        this.hiddenLine.computeLineDistances();\r\n        this.el.object3D.add( this.hiddenLine );\r\n      }\r\n\r\n      this.el.getObject3D('mesh').visible = false;\r\n\r\n      // dispose of any old materials & lines\r\n      function removeLineAndMaterial(line, material) {\r\n        if (line) {\r\n          line.removeFromParent()\r\n        }\r\n        if (material) {\r\n          material.dispose()\r\n        }\r\n      }\r\n      this.removeLineAndMaterial(oldLine, oldMaterial)\r\n      this.removeLineAndMaterial(oldHiddenLine, oldHiddenMaterial)\r\n    },\r\n\r\n    removeLineAndMaterial(line, material) {\r\n      if (line) {\r\n        line.removeFromParent()\r\n      }\r\n      if (material) {\r\n        material.dispose()\r\n      }\r\n    },\r\n\r\n    createLineMaterial(color, opacity) {\r\n\r\n      const data = this.data\r\n      let material\r\n      if (!data.dashed) {\r\n          material = new THREE.LineBasicMaterial( { color: color } )\r\n      }\r\n      else {\r\n          material = new THREE.LineDashedMaterial( { color: color,\r\n                                                     dashSize: data.dashSize,\r\n                                                     gapSize: data.gapSize,\r\n                                                     scale: data.dashScale } )\r\n      }\r\n      material.opacity = opacity\r\n      if (opacity !== 1) {\r\n        material.transparent = true\r\n      }\r\n\r\n      return material\r\n    },\r\n\r\n    remove() {\r\n\r\n      this.el.removeEventListener('object3dset', this.updateGeometry)\r\n      this.el.getObject3D('mesh').visible = true;\r\n      if (this.edges) {\r\n        this.edges.dispose()\r\n      }\r\n\r\n      this.removeLineAndMaterial(this.line, this.material)\r\n    }\r\n})","var BufferBuilder = require('./bufferbuilder').BufferBuilder;\r\nvar binaryFeatures = require('./bufferbuilder').binaryFeatures;\r\n\r\nvar BinaryPack = {\r\n  unpack: function (data) {\r\n    var unpacker = new Unpacker(data);\r\n    return unpacker.unpack();\r\n  },\r\n  pack: function (data) {\r\n    var packer = new Packer();\r\n    packer.pack(data);\r\n    var buffer = packer.getBuffer();\r\n    return buffer;\r\n  }\r\n};\r\n\r\nmodule.exports = BinaryPack;\r\n\r\nfunction Unpacker (data) {\r\n  // Data is ArrayBuffer\r\n  this.index = 0;\r\n  this.dataBuffer = data;\r\n  this.dataView = new Uint8Array(this.dataBuffer);\r\n  this.length = this.dataBuffer.byteLength;\r\n}\r\n\r\nUnpacker.prototype.unpack = function () {\r\n  var type = this.unpack_uint8();\r\n  if (type < 0x80) {\r\n    return type;\r\n  } else if ((type ^ 0xe0) < 0x20) {\r\n    return (type ^ 0xe0) - 0x20;\r\n  }\r\n\r\n  var size;\r\n  if ((size = type ^ 0xa0) <= 0x0f) {\r\n    return this.unpack_raw(size);\r\n  } else if ((size = type ^ 0xb0) <= 0x0f) {\r\n    return this.unpack_string(size);\r\n  } else if ((size = type ^ 0x90) <= 0x0f) {\r\n    return this.unpack_array(size);\r\n  } else if ((size = type ^ 0x80) <= 0x0f) {\r\n    return this.unpack_map(size);\r\n  }\r\n\r\n  switch (type) {\r\n    case 0xc0:\r\n      return null;\r\n    case 0xc1:\r\n      return undefined;\r\n    case 0xc2:\r\n      return false;\r\n    case 0xc3:\r\n      return true;\r\n    case 0xca:\r\n      return this.unpack_float();\r\n    case 0xcb:\r\n      return this.unpack_double();\r\n    case 0xcc:\r\n      return this.unpack_uint8();\r\n    case 0xcd:\r\n      return this.unpack_uint16();\r\n    case 0xce:\r\n      return this.unpack_uint32();\r\n    case 0xcf:\r\n      return this.unpack_uint64();\r\n    case 0xd0:\r\n      return this.unpack_int8();\r\n    case 0xd1:\r\n      return this.unpack_int16();\r\n    case 0xd2:\r\n      return this.unpack_int32();\r\n    case 0xd3:\r\n      return this.unpack_int64();\r\n    case 0xd4:\r\n      return undefined;\r\n    case 0xd5:\r\n      return undefined;\r\n    case 0xd6:\r\n      return undefined;\r\n    case 0xd7:\r\n      return undefined;\r\n    case 0xd8:\r\n      size = this.unpack_uint16();\r\n      return this.unpack_string(size);\r\n    case 0xd9:\r\n      size = this.unpack_uint32();\r\n      return this.unpack_string(size);\r\n    case 0xda:\r\n      size = this.unpack_uint16();\r\n      return this.unpack_raw(size);\r\n    case 0xdb:\r\n      size = this.unpack_uint32();\r\n      return this.unpack_raw(size);\r\n    case 0xdc:\r\n      size = this.unpack_uint16();\r\n      return this.unpack_array(size);\r\n    case 0xdd:\r\n      size = this.unpack_uint32();\r\n      return this.unpack_array(size);\r\n    case 0xde:\r\n      size = this.unpack_uint16();\r\n      return this.unpack_map(size);\r\n    case 0xdf:\r\n      size = this.unpack_uint32();\r\n      return this.unpack_map(size);\r\n  }\r\n};\r\n\r\nUnpacker.prototype.unpack_uint8 = function () {\r\n  var byte = this.dataView[this.index] & 0xff;\r\n  this.index++;\r\n  return byte;\r\n};\r\n\r\nUnpacker.prototype.unpack_uint16 = function () {\r\n  var bytes = this.read(2);\r\n  var uint16 =\r\n    ((bytes[0] & 0xff) * 256) + (bytes[1] & 0xff);\r\n  this.index += 2;\r\n  return uint16;\r\n};\r\n\r\nUnpacker.prototype.unpack_uint32 = function () {\r\n  var bytes = this.read(4);\r\n  var uint32 =\r\n    ((bytes[0] * 256 +\r\n      bytes[1]) * 256 +\r\n      bytes[2]) * 256 +\r\n    bytes[3];\r\n  this.index += 4;\r\n  return uint32;\r\n};\r\n\r\nUnpacker.prototype.unpack_uint64 = function () {\r\n  var bytes = this.read(8);\r\n  var uint64 =\r\n    ((((((bytes[0] * 256 +\r\n      bytes[1]) * 256 +\r\n      bytes[2]) * 256 +\r\n      bytes[3]) * 256 +\r\n      bytes[4]) * 256 +\r\n      bytes[5]) * 256 +\r\n      bytes[6]) * 256 +\r\n    bytes[7];\r\n  this.index += 8;\r\n  return uint64;\r\n};\r\n\r\nUnpacker.prototype.unpack_int8 = function () {\r\n  var uint8 = this.unpack_uint8();\r\n  return (uint8 < 0x80) ? uint8 : uint8 - (1 << 8);\r\n};\r\n\r\nUnpacker.prototype.unpack_int16 = function () {\r\n  var uint16 = this.unpack_uint16();\r\n  return (uint16 < 0x8000) ? uint16 : uint16 - (1 << 16);\r\n};\r\n\r\nUnpacker.prototype.unpack_int32 = function () {\r\n  var uint32 = this.unpack_uint32();\r\n  return (uint32 < Math.pow(2, 31)) ? uint32\r\n    : uint32 - Math.pow(2, 32);\r\n};\r\n\r\nUnpacker.prototype.unpack_int64 = function () {\r\n  var uint64 = this.unpack_uint64();\r\n  return (uint64 < Math.pow(2, 63)) ? uint64\r\n    : uint64 - Math.pow(2, 64);\r\n};\r\n\r\nUnpacker.prototype.unpack_raw = function (size) {\r\n  if (this.length < this.index + size) {\r\n    throw new Error('BinaryPackFailure: index is out of range' +\r\n      ' ' + this.index + ' ' + size + ' ' + this.length);\r\n  }\r\n  var buf = this.dataBuffer.slice(this.index, this.index + size);\r\n  this.index += size;\r\n\r\n  // buf = util.bufferToString(buf);\r\n\r\n  return buf;\r\n};\r\n\r\nUnpacker.prototype.unpack_string = function (size) {\r\n  var bytes = this.read(size);\r\n  var i = 0;\r\n  var str = '';\r\n  var c;\r\n  var code;\r\n\r\n  while (i < size) {\r\n    c = bytes[i];\r\n    if (c < 128) {\r\n      str += String.fromCharCode(c);\r\n      i++;\r\n    } else if ((c ^ 0xc0) < 32) {\r\n      code = ((c ^ 0xc0) << 6) | (bytes[i + 1] & 63);\r\n      str += String.fromCharCode(code);\r\n      i += 2;\r\n    } else {\r\n      code = ((c & 15) << 12) | ((bytes[i + 1] & 63) << 6) |\r\n        (bytes[i + 2] & 63);\r\n      str += String.fromCharCode(code);\r\n      i += 3;\r\n    }\r\n  }\r\n\r\n  this.index += size;\r\n  return str;\r\n};\r\n\r\nUnpacker.prototype.unpack_array = function (size) {\r\n  var objects = new Array(size);\r\n  for (var i = 0; i < size; i++) {\r\n    objects[i] = this.unpack();\r\n  }\r\n  return objects;\r\n};\r\n\r\nUnpacker.prototype.unpack_map = function (size) {\r\n  var map = {};\r\n  for (var i = 0; i < size; i++) {\r\n    var key = this.unpack();\r\n    var value = this.unpack();\r\n    map[key] = value;\r\n  }\r\n  return map;\r\n};\r\n\r\nUnpacker.prototype.unpack_float = function () {\r\n  var uint32 = this.unpack_uint32();\r\n  var sign = uint32 >> 31;\r\n  var exp = ((uint32 >> 23) & 0xff) - 127;\r\n  var fraction = (uint32 & 0x7fffff) | 0x800000;\r\n  return (sign === 0 ? 1 : -1) *\r\n    fraction * Math.pow(2, exp - 23);\r\n};\r\n\r\nUnpacker.prototype.unpack_double = function () {\r\n  var h32 = this.unpack_uint32();\r\n  var l32 = this.unpack_uint32();\r\n  var sign = h32 >> 31;\r\n  var exp = ((h32 >> 20) & 0x7ff) - 1023;\r\n  var hfrac = (h32 & 0xfffff) | 0x100000;\r\n  var frac = hfrac * Math.pow(2, exp - 20) +\r\n    l32 * Math.pow(2, exp - 52);\r\n  return (sign === 0 ? 1 : -1) * frac;\r\n};\r\n\r\nUnpacker.prototype.read = function (length) {\r\n  var j = this.index;\r\n  if (j + length <= this.length) {\r\n    return this.dataView.subarray(j, j + length);\r\n  } else {\r\n    throw new Error('BinaryPackFailure: read index out of range');\r\n  }\r\n};\r\n\r\nfunction Packer () {\r\n  this.bufferBuilder = new BufferBuilder();\r\n}\r\n\r\nPacker.prototype.getBuffer = function () {\r\n  return this.bufferBuilder.getBuffer();\r\n};\r\n\r\nPacker.prototype.pack = function (value) {\r\n  var type = typeof (value);\r\n  if (type === 'string') {\r\n    this.pack_string(value);\r\n  } else if (type === 'number') {\r\n    if (Math.floor(value) === value) {\r\n      this.pack_integer(value);\r\n    } else {\r\n      this.pack_double(value);\r\n    }\r\n  } else if (type === 'boolean') {\r\n    if (value === true) {\r\n      this.bufferBuilder.append(0xc3);\r\n    } else if (value === false) {\r\n      this.bufferBuilder.append(0xc2);\r\n    }\r\n  } else if (type === 'undefined') {\r\n    this.bufferBuilder.append(0xc0);\r\n  } else if (type === 'object') {\r\n    if (value === null) {\r\n      this.bufferBuilder.append(0xc0);\r\n    } else {\r\n      var constructor = value.constructor;\r\n      if (constructor == Array) {\r\n        this.pack_array(value);\r\n      } else if (constructor == Blob || constructor == File || value instanceof Blob || value instanceof File) {\r\n        this.pack_bin(value);\r\n      } else if (constructor == ArrayBuffer) {\r\n        if (binaryFeatures.useArrayBufferView) {\r\n          this.pack_bin(new Uint8Array(value));\r\n        } else {\r\n          this.pack_bin(value);\r\n        }\r\n      } else if ('BYTES_PER_ELEMENT' in value) {\r\n        if (binaryFeatures.useArrayBufferView) {\r\n          this.pack_bin(new Uint8Array(value.buffer));\r\n        } else {\r\n          this.pack_bin(value.buffer);\r\n        }\r\n      } else if ((constructor == Object) || (constructor.toString().startsWith('class'))) {\r\n        this.pack_object(value);\r\n      } else if (constructor == Date) {\r\n        this.pack_string(value.toString());\r\n      } else if (typeof value.toBinaryPack === 'function') {\r\n        this.bufferBuilder.append(value.toBinaryPack());\r\n      } else {\r\n        throw new Error('Type \"' + constructor.toString() + '\" not yet supported');\r\n      }\r\n    }\r\n  } else {\r\n    throw new Error('Type \"' + type + '\" not yet supported');\r\n  }\r\n  this.bufferBuilder.flush();\r\n};\r\n\r\nPacker.prototype.pack_bin = function (blob) {\r\n  var length = blob.length || blob.byteLength || blob.size;\r\n  if (length <= 0x0f) {\r\n    this.pack_uint8(0xa0 + length);\r\n  } else if (length <= 0xffff) {\r\n    this.bufferBuilder.append(0xda);\r\n    this.pack_uint16(length);\r\n  } else if (length <= 0xffffffff) {\r\n    this.bufferBuilder.append(0xdb);\r\n    this.pack_uint32(length);\r\n  } else {\r\n    throw new Error('Invalid length');\r\n  }\r\n  this.bufferBuilder.append(blob);\r\n};\r\n\r\nPacker.prototype.pack_string = function (str) {\r\n  var length = utf8Length(str);\r\n\r\n  if (length <= 0x0f) {\r\n    this.pack_uint8(0xb0 + length);\r\n  } else if (length <= 0xffff) {\r\n    this.bufferBuilder.append(0xd8);\r\n    this.pack_uint16(length);\r\n  } else if (length <= 0xffffffff) {\r\n    this.bufferBuilder.append(0xd9);\r\n    this.pack_uint32(length);\r\n  } else {\r\n    throw new Error('Invalid length');\r\n  }\r\n  this.bufferBuilder.append(str);\r\n};\r\n\r\nPacker.prototype.pack_array = function (ary) {\r\n  var length = ary.length;\r\n  if (length <= 0x0f) {\r\n    this.pack_uint8(0x90 + length);\r\n  } else if (length <= 0xffff) {\r\n    this.bufferBuilder.append(0xdc);\r\n    this.pack_uint16(length);\r\n  } else if (length <= 0xffffffff) {\r\n    this.bufferBuilder.append(0xdd);\r\n    this.pack_uint32(length);\r\n  } else {\r\n    throw new Error('Invalid length');\r\n  }\r\n  for (var i = 0; i < length; i++) {\r\n    this.pack(ary[i]);\r\n  }\r\n};\r\n\r\nPacker.prototype.pack_integer = function (num) {\r\n  if (num >= -0x20 && num <= 0x7f) {\r\n    this.bufferBuilder.append(num & 0xff);\r\n  } else if (num >= 0x00 && num <= 0xff) {\r\n    this.bufferBuilder.append(0xcc);\r\n    this.pack_uint8(num);\r\n  } else if (num >= -0x80 && num <= 0x7f) {\r\n    this.bufferBuilder.append(0xd0);\r\n    this.pack_int8(num);\r\n  } else if (num >= 0x0000 && num <= 0xffff) {\r\n    this.bufferBuilder.append(0xcd);\r\n    this.pack_uint16(num);\r\n  } else if (num >= -0x8000 && num <= 0x7fff) {\r\n    this.bufferBuilder.append(0xd1);\r\n    this.pack_int16(num);\r\n  } else if (num >= 0x00000000 && num <= 0xffffffff) {\r\n    this.bufferBuilder.append(0xce);\r\n    this.pack_uint32(num);\r\n  } else if (num >= -0x80000000 && num <= 0x7fffffff) {\r\n    this.bufferBuilder.append(0xd2);\r\n    this.pack_int32(num);\r\n  } else if (num >= -0x8000000000000000 && num <= 0x7FFFFFFFFFFFFFFF) {\r\n    this.bufferBuilder.append(0xd3);\r\n    this.pack_int64(num);\r\n  } else if (num >= 0x0000000000000000 && num <= 0xFFFFFFFFFFFFFFFF) {\r\n    this.bufferBuilder.append(0xcf);\r\n    this.pack_uint64(num);\r\n  } else {\r\n    throw new Error('Invalid integer');\r\n  }\r\n};\r\n\r\nPacker.prototype.pack_double = function (num) {\r\n  var sign = 0;\r\n  if (num < 0) {\r\n    sign = 1;\r\n    num = -num;\r\n  }\r\n  var exp = Math.floor(Math.log(num) / Math.LN2);\r\n  var frac0 = num / Math.pow(2, exp) - 1;\r\n  var frac1 = Math.floor(frac0 * Math.pow(2, 52));\r\n  var b32 = Math.pow(2, 32);\r\n  var h32 = (sign << 31) | ((exp + 1023) << 20) |\r\n    (frac1 / b32) & 0x0fffff;\r\n  var l32 = frac1 % b32;\r\n  this.bufferBuilder.append(0xcb);\r\n  this.pack_int32(h32);\r\n  this.pack_int32(l32);\r\n};\r\n\r\nPacker.prototype.pack_object = function (obj) {\r\n  var keys = Object.keys(obj);\r\n  var length = keys.length;\r\n  if (length <= 0x0f) {\r\n    this.pack_uint8(0x80 + length);\r\n  } else if (length <= 0xffff) {\r\n    this.bufferBuilder.append(0xde);\r\n    this.pack_uint16(length);\r\n  } else if (length <= 0xffffffff) {\r\n    this.bufferBuilder.append(0xdf);\r\n    this.pack_uint32(length);\r\n  } else {\r\n    throw new Error('Invalid length');\r\n  }\r\n  for (var prop in obj) {\r\n    if (obj.hasOwnProperty(prop)) {\r\n      this.pack(prop);\r\n      this.pack(obj[prop]);\r\n    }\r\n  }\r\n};\r\n\r\nPacker.prototype.pack_uint8 = function (num) {\r\n  this.bufferBuilder.append(num);\r\n};\r\n\r\nPacker.prototype.pack_uint16 = function (num) {\r\n  this.bufferBuilder.append(num >> 8);\r\n  this.bufferBuilder.append(num & 0xff);\r\n};\r\n\r\nPacker.prototype.pack_uint32 = function (num) {\r\n  var n = num & 0xffffffff;\r\n  this.bufferBuilder.append((n & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((n & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((n & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((n & 0x000000ff));\r\n};\r\n\r\nPacker.prototype.pack_uint64 = function (num) {\r\n  var high = num / Math.pow(2, 32);\r\n  var low = num % Math.pow(2, 32);\r\n  this.bufferBuilder.append((high & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((high & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((high & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((high & 0x000000ff));\r\n  this.bufferBuilder.append((low & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((low & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((low & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((low & 0x000000ff));\r\n};\r\n\r\nPacker.prototype.pack_int8 = function (num) {\r\n  this.bufferBuilder.append(num & 0xff);\r\n};\r\n\r\nPacker.prototype.pack_int16 = function (num) {\r\n  this.bufferBuilder.append((num & 0xff00) >> 8);\r\n  this.bufferBuilder.append(num & 0xff);\r\n};\r\n\r\nPacker.prototype.pack_int32 = function (num) {\r\n  this.bufferBuilder.append((num >>> 24) & 0xff);\r\n  this.bufferBuilder.append((num & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((num & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((num & 0x000000ff));\r\n};\r\n\r\nPacker.prototype.pack_int64 = function (num) {\r\n  var high = Math.floor(num / Math.pow(2, 32));\r\n  var low = num % Math.pow(2, 32);\r\n  this.bufferBuilder.append((high & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((high & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((high & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((high & 0x000000ff));\r\n  this.bufferBuilder.append((low & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((low & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((low & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((low & 0x000000ff));\r\n};\r\n\r\nfunction _utf8Replace (m) {\r\n  var code = m.charCodeAt(0);\r\n\r\n  if (code <= 0x7ff) return '00';\r\n  if (code <= 0xffff) return '000';\r\n  if (code <= 0x1fffff) return '0000';\r\n  if (code <= 0x3ffffff) return '00000';\r\n  return '000000';\r\n}\r\n\r\nfunction utf8Length (str) {\r\n  if (str.length > 600) {\r\n    // Blob method faster for large strings\r\n    return (new Blob([str])).size;\r\n  } else {\r\n    return str.replace(/[^\\u0000-\\u007F]/g, _utf8Replace).length;\r\n  }\r\n}\r\n","var binaryFeatures = {};\r\nbinaryFeatures.useBlobBuilder = (function () {\r\n  try {\r\n    new Blob([]);\r\n    return false;\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n})();\r\n\r\nbinaryFeatures.useArrayBufferView = !binaryFeatures.useBlobBuilder && (function () {\r\n  try {\r\n    return (new Blob([new Uint8Array([])])).size === 0;\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n})();\r\n\r\nmodule.exports.binaryFeatures = binaryFeatures;\r\nvar BlobBuilder = module.exports.BlobBuilder;\r\nif (typeof window !== 'undefined') {\r\n  BlobBuilder = module.exports.BlobBuilder = window.WebKitBlobBuilder ||\r\n    window.MozBlobBuilder || window.MSBlobBuilder || window.BlobBuilder;\r\n}\r\n\r\nfunction BufferBuilder () {\r\n  this._pieces = [];\r\n  this._parts = [];\r\n}\r\n\r\nBufferBuilder.prototype.append = function (data) {\r\n  if (typeof data === 'number') {\r\n    this._pieces.push(data);\r\n  } else {\r\n    this.flush();\r\n    this._parts.push(data);\r\n  }\r\n};\r\n\r\nBufferBuilder.prototype.flush = function () {\r\n  if (this._pieces.length > 0) {\r\n    var buf = new Uint8Array(this._pieces);\r\n    if (!binaryFeatures.useArrayBufferView) {\r\n      buf = buf.buffer;\r\n    }\r\n    this._parts.push(buf);\r\n    this._pieces = [];\r\n  }\r\n};\r\n\r\nBufferBuilder.prototype.getBuffer = function () {\r\n  this.flush();\r\n  if (binaryFeatures.useBlobBuilder) {\r\n    var builder = new BlobBuilder();\r\n    for (var i = 0, ii = this._parts.length; i < ii; i++) {\r\n      builder.append(this._parts[i]);\r\n    }\r\n    return builder.getBlob();\r\n  } else {\r\n    return new Blob(this._parts);\r\n  }\r\n};\r\n\r\nmodule.exports.BufferBuilder = BufferBuilder;\r\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\n\nfunction fixStatsType(stat) {\n  return {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  }[stat.type] || stat.type;\n}\n\nfunction writeMediaSection(transceiver, caps, type, stream, dtlsRole) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : dtlsRole || 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    var trackId = transceiver.rtpSender._initialTrackId ||\n        transceiver.rtpSender.track.id;\n    transceiver.rtpSender._initialTrackId = trackId;\n    // spec.\n    var msid = 'msid:' + (stream ? stream.id : '-') + ' ' +\n        trackId + '\\r\\n';\n    sdp += 'a=' + msid;\n    // for Chrome. Legacy should no longer be required.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n\n    // RTX\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n}\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\n            url.indexOf('?transport=udp') === -1;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n// Determines the intersection of local and remote capabilities.\nfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\n  var commonCapabilities = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: []\n  };\n\n  var findCodecByPayloadType = function(pt, codecs) {\n    pt = parseInt(pt, 10);\n    for (var i = 0; i < codecs.length; i++) {\n      if (codecs[i].payloadType === pt ||\n          codecs[i].preferredPayloadType === pt) {\n        return codecs[i];\n      }\n    }\n  };\n\n  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\n    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n    return lCodec && rCodec &&\n        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n  };\n\n  localCapabilities.codecs.forEach(function(lCodec) {\n    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n      var rCodec = remoteCapabilities.codecs[i];\n      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n          lCodec.clockRate === rCodec.clockRate) {\n        if (lCodec.name.toLowerCase() === 'rtx' &&\n            lCodec.parameters && rCodec.parameters.apt) {\n          // for RTX we need to find the local rtx that has a apt\n          // which points to the same local codec as the remote one.\n          if (!rtxCapabilityMatches(lCodec, rCodec,\n              localCapabilities.codecs, remoteCapabilities.codecs)) {\n            continue;\n          }\n        }\n        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n        // number of channels is the highest common number of channels\n        rCodec.numChannels = Math.min(lCodec.numChannels,\n            rCodec.numChannels);\n        // push rCodec so we reply with offerer payload type\n        commonCapabilities.codecs.push(rCodec);\n\n        // determine common feedback mechanisms\n        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n            if (lCodec.rtcpFeedback[j].type === fb.type &&\n                lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n              return true;\n            }\n          }\n          return false;\n        });\n        // FIXME: also need to determine .parameters\n        //  see https://github.com/openpeer/ortc/issues/569\n        break;\n      }\n    }\n  });\n\n  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\n    for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n         i++) {\n      var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n      if (lHeaderExtension.uri === rHeaderExtension.uri) {\n        commonCapabilities.headerExtensions.push(rHeaderExtension);\n        break;\n      }\n    }\n  });\n\n  // FIXME: fecMechanisms\n  return commonCapabilities;\n}\n\n// is action=setLocalDescription with type allowed in signalingState\nfunction isActionAllowedInSignalingState(action, type, signalingState) {\n  return {\n    offer: {\n      setLocalDescription: ['stable', 'have-local-offer'],\n      setRemoteDescription: ['stable', 'have-remote-offer']\n    },\n    answer: {\n      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\n    }\n  }[type][action].indexOf(signalingState) !== -1;\n}\n\nfunction maybeAddCandidate(iceTransport, candidate) {\n  // Edge's internal representation adds some fields therefore\n  // not all fieldѕ are taken into account.\n  var alreadyAdded = iceTransport.getRemoteCandidates()\n      .find(function(remoteCandidate) {\n        return candidate.foundation === remoteCandidate.foundation &&\n            candidate.ip === remoteCandidate.ip &&\n            candidate.port === remoteCandidate.port &&\n            candidate.priority === remoteCandidate.priority &&\n            candidate.protocol === remoteCandidate.protocol &&\n            candidate.type === remoteCandidate.type;\n      });\n  if (!alreadyAdded) {\n    iceTransport.addRemoteCandidate(candidate);\n  }\n  return !alreadyAdded;\n}\n\n\nfunction makeError(name, description) {\n  var e = new Error(description);\n  e.name = name;\n  // legacy error codes from https://heycam.github.io/webidl/#idl-DOMException-error-names\n  e.code = {\n    NotSupportedError: 9,\n    InvalidStateError: 11,\n    InvalidAccessError: 15,\n    TypeError: undefined,\n    OperationError: undefined\n  }[name];\n  return e;\n}\n\nmodule.exports = function(window, edgeVersion) {\n  // https://w3c.github.io/mediacapture-main/#mediastream\n  // Helper function to add the track to the stream and\n  // dispatch the event ourselves.\n  function addTrackToStreamAndFireEvent(track, stream) {\n    stream.addTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',\n        {track: track}));\n  }\n\n  function removeTrackFromStreamAndFireEvent(track, stream) {\n    stream.removeTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',\n        {track: track}));\n  }\n\n  function fireAddTrack(pc, track, receiver, streams) {\n    var trackEvent = new Event('track');\n    trackEvent.track = track;\n    trackEvent.receiver = receiver;\n    trackEvent.transceiver = {receiver: receiver};\n    trackEvent.streams = streams;\n    window.setTimeout(function() {\n      pc._dispatchEvent('track', trackEvent);\n    });\n  }\n\n  var RTCPeerConnection = function(config) {\n    var pc = this;\n\n    var _eventTarget = document.createDocumentFragment();\n    ['addEventListener', 'removeEventListener', 'dispatchEvent']\n        .forEach(function(method) {\n          pc[method] = _eventTarget[method].bind(_eventTarget);\n        });\n\n    this.canTrickleIceCandidates = null;\n\n    this.needNegotiation = false;\n\n    this.localStreams = [];\n    this.remoteStreams = [];\n\n    this._localDescription = null;\n    this._remoteDescription = null;\n\n    this.signalingState = 'stable';\n    this.iceConnectionState = 'new';\n    this.connectionState = 'new';\n    this.iceGatheringState = 'new';\n\n    config = JSON.parse(JSON.stringify(config || {}));\n\n    this.usingBundle = config.bundlePolicy === 'max-bundle';\n    if (config.rtcpMuxPolicy === 'negotiate') {\n      throw(makeError('NotSupportedError',\n          'rtcpMuxPolicy \\'negotiate\\' is not supported'));\n    } else if (!config.rtcpMuxPolicy) {\n      config.rtcpMuxPolicy = 'require';\n    }\n\n    switch (config.iceTransportPolicy) {\n      case 'all':\n      case 'relay':\n        break;\n      default:\n        config.iceTransportPolicy = 'all';\n        break;\n    }\n\n    switch (config.bundlePolicy) {\n      case 'balanced':\n      case 'max-compat':\n      case 'max-bundle':\n        break;\n      default:\n        config.bundlePolicy = 'balanced';\n        break;\n    }\n\n    config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);\n\n    this._iceGatherers = [];\n    if (config.iceCandidatePoolSize) {\n      for (var i = config.iceCandidatePoolSize; i > 0; i--) {\n        this._iceGatherers.push(new window.RTCIceGatherer({\n          iceServers: config.iceServers,\n          gatherPolicy: config.iceTransportPolicy\n        }));\n      }\n    } else {\n      config.iceCandidatePoolSize = 0;\n    }\n\n    this._config = config;\n\n    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n    // everything that is needed to describe a SDP m-line.\n    this.transceivers = [];\n\n    this._sdpSessionId = SDPUtils.generateSessionId();\n    this._sdpSessionVersion = 0;\n\n    this._dtlsRole = undefined; // role for a=setup to use in answers.\n\n    this._isClosed = false;\n  };\n\n  Object.defineProperty(RTCPeerConnection.prototype, 'localDescription', {\n    configurable: true,\n    get: function() {\n      return this._localDescription;\n    }\n  });\n  Object.defineProperty(RTCPeerConnection.prototype, 'remoteDescription', {\n    configurable: true,\n    get: function() {\n      return this._remoteDescription;\n    }\n  });\n\n  // set up event handlers on prototype\n  RTCPeerConnection.prototype.onicecandidate = null;\n  RTCPeerConnection.prototype.onaddstream = null;\n  RTCPeerConnection.prototype.ontrack = null;\n  RTCPeerConnection.prototype.onremovestream = null;\n  RTCPeerConnection.prototype.onsignalingstatechange = null;\n  RTCPeerConnection.prototype.oniceconnectionstatechange = null;\n  RTCPeerConnection.prototype.onconnectionstatechange = null;\n  RTCPeerConnection.prototype.onicegatheringstatechange = null;\n  RTCPeerConnection.prototype.onnegotiationneeded = null;\n  RTCPeerConnection.prototype.ondatachannel = null;\n\n  RTCPeerConnection.prototype._dispatchEvent = function(name, event) {\n    if (this._isClosed) {\n      return;\n    }\n    this.dispatchEvent(event);\n    if (typeof this['on' + name] === 'function') {\n      this['on' + name](event);\n    }\n  };\n\n  RTCPeerConnection.prototype._emitGatheringStateChange = function() {\n    var event = new Event('icegatheringstatechange');\n    this._dispatchEvent('icegatheringstatechange', event);\n  };\n\n  RTCPeerConnection.prototype.getConfiguration = function() {\n    return this._config;\n  };\n\n  RTCPeerConnection.prototype.getLocalStreams = function() {\n    return this.localStreams;\n  };\n\n  RTCPeerConnection.prototype.getRemoteStreams = function() {\n    return this.remoteStreams;\n  };\n\n  // internal helper to create a transceiver object.\n  // (which is not yet the same as the WebRTC 1.0 transceiver)\n  RTCPeerConnection.prototype._createTransceiver = function(kind, doNotAdd) {\n    var hasBundleTransport = this.transceivers.length > 0;\n    var transceiver = {\n      track: null,\n      iceGatherer: null,\n      iceTransport: null,\n      dtlsTransport: null,\n      localCapabilities: null,\n      remoteCapabilities: null,\n      rtpSender: null,\n      rtpReceiver: null,\n      kind: kind,\n      mid: null,\n      sendEncodingParameters: null,\n      recvEncodingParameters: null,\n      stream: null,\n      associatedRemoteMediaStreams: [],\n      wantReceive: true\n    };\n    if (this.usingBundle && hasBundleTransport) {\n      transceiver.iceTransport = this.transceivers[0].iceTransport;\n      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n    } else {\n      var transports = this._createIceAndDtlsTransports();\n      transceiver.iceTransport = transports.iceTransport;\n      transceiver.dtlsTransport = transports.dtlsTransport;\n    }\n    if (!doNotAdd) {\n      this.transceivers.push(transceiver);\n    }\n    return transceiver;\n  };\n\n  RTCPeerConnection.prototype.addTrack = function(track, stream) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call addTrack on a closed peerconnection.');\n    }\n\n    var alreadyExists = this.transceivers.find(function(s) {\n      return s.track === track;\n    });\n\n    if (alreadyExists) {\n      throw makeError('InvalidAccessError', 'Track already exists.');\n    }\n\n    var transceiver;\n    for (var i = 0; i < this.transceivers.length; i++) {\n      if (!this.transceivers[i].track &&\n          this.transceivers[i].kind === track.kind) {\n        transceiver = this.transceivers[i];\n      }\n    }\n    if (!transceiver) {\n      transceiver = this._createTransceiver(track.kind);\n    }\n\n    this._maybeFireNegotiationNeeded();\n\n    if (this.localStreams.indexOf(stream) === -1) {\n      this.localStreams.push(stream);\n    }\n\n    transceiver.track = track;\n    transceiver.stream = stream;\n    transceiver.rtpSender = new window.RTCRtpSender(track,\n        transceiver.dtlsTransport);\n    return transceiver.rtpSender;\n  };\n\n  RTCPeerConnection.prototype.addStream = function(stream) {\n    var pc = this;\n    if (edgeVersion >= 15025) {\n      stream.getTracks().forEach(function(track) {\n        pc.addTrack(track, stream);\n      });\n    } else {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      // Fixed in 15025 (or earlier)\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      clonedStream.getTracks().forEach(function(track) {\n        pc.addTrack(track, clonedStream);\n      });\n    }\n  };\n\n  RTCPeerConnection.prototype.removeTrack = function(sender) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call removeTrack on a closed peerconnection.');\n    }\n\n    if (!(sender instanceof window.RTCRtpSender)) {\n      throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +\n          'does not implement interface RTCRtpSender.');\n    }\n\n    var transceiver = this.transceivers.find(function(t) {\n      return t.rtpSender === sender;\n    });\n\n    if (!transceiver) {\n      throw makeError('InvalidAccessError',\n          'Sender was not created by this connection.');\n    }\n    var stream = transceiver.stream;\n\n    transceiver.rtpSender.stop();\n    transceiver.rtpSender = null;\n    transceiver.track = null;\n    transceiver.stream = null;\n\n    // remove the stream from the set of local streams\n    var localStreams = this.transceivers.map(function(t) {\n      return t.stream;\n    });\n    if (localStreams.indexOf(stream) === -1 &&\n        this.localStreams.indexOf(stream) > -1) {\n      this.localStreams.splice(this.localStreams.indexOf(stream), 1);\n    }\n\n    this._maybeFireNegotiationNeeded();\n  };\n\n  RTCPeerConnection.prototype.removeStream = function(stream) {\n    var pc = this;\n    stream.getTracks().forEach(function(track) {\n      var sender = pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (sender) {\n        pc.removeTrack(sender);\n      }\n    });\n  };\n\n  RTCPeerConnection.prototype.getSenders = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpSender;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpSender;\n    });\n  };\n\n  RTCPeerConnection.prototype.getReceivers = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpReceiver;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpReceiver;\n    });\n  };\n\n\n  RTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,\n      usingBundle) {\n    var pc = this;\n    if (usingBundle && sdpMLineIndex > 0) {\n      return this.transceivers[0].iceGatherer;\n    } else if (this._iceGatherers.length) {\n      return this._iceGatherers.shift();\n    }\n    var iceGatherer = new window.RTCIceGatherer({\n      iceServers: this._config.iceServers,\n      gatherPolicy: this._config.iceTransportPolicy\n    });\n    Object.defineProperty(iceGatherer, 'state',\n        {value: 'new', writable: true}\n    );\n\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];\n    this.transceivers[sdpMLineIndex].bufferCandidates = function(event) {\n      var end = !event.candidate || Object.keys(event.candidate).length === 0;\n      // polyfill since RTCIceGatherer.state is not implemented in\n      // Edge 10547 yet.\n      iceGatherer.state = end ? 'completed' : 'gathering';\n      if (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {\n        pc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);\n      }\n    };\n    iceGatherer.addEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    return iceGatherer;\n  };\n\n  // start gathering from an RTCIceGatherer.\n  RTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {\n    var pc = this;\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer.onlocalcandidate) {\n      return;\n    }\n    var bufferedCandidateEvents =\n      this.transceivers[sdpMLineIndex].bufferedCandidateEvents;\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;\n    iceGatherer.removeEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    iceGatherer.onlocalcandidate = function(evt) {\n      if (pc.usingBundle && sdpMLineIndex > 0) {\n        // if we know that we use bundle we can drop candidates with\n        // ѕdpMLineIndex > 0. If we don't do this then our state gets\n        // confused since we dispose the extra ice gatherer.\n        return;\n      }\n      var event = new Event('icecandidate');\n      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n      var cand = evt.candidate;\n      // Edge emits an empty object for RTCIceCandidateComplete‥\n      var end = !cand || Object.keys(cand).length === 0;\n      if (end) {\n        // polyfill since RTCIceGatherer.state is not implemented in\n        // Edge 10547 yet.\n        if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {\n          iceGatherer.state = 'completed';\n        }\n      } else {\n        if (iceGatherer.state === 'new') {\n          iceGatherer.state = 'gathering';\n        }\n        // RTCIceCandidate doesn't have a component, needs to be added\n        cand.component = 1;\n        // also the usernameFragment. TODO: update SDP to take both variants.\n        cand.ufrag = iceGatherer.getLocalParameters().usernameFragment;\n\n        var serializedCandidate = SDPUtils.writeCandidate(cand);\n        event.candidate = Object.assign(event.candidate,\n            SDPUtils.parseCandidate(serializedCandidate));\n\n        event.candidate.candidate = serializedCandidate;\n        event.candidate.toJSON = function() {\n          return {\n            candidate: event.candidate.candidate,\n            sdpMid: event.candidate.sdpMid,\n            sdpMLineIndex: event.candidate.sdpMLineIndex,\n            usernameFragment: event.candidate.usernameFragment\n          };\n        };\n      }\n\n      // update local description.\n      var sections = SDPUtils.getMediaSections(pc._localDescription.sdp);\n      if (!end) {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      } else {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=end-of-candidates\\r\\n';\n      }\n      pc._localDescription.sdp =\n          SDPUtils.getDescription(pc._localDescription.sdp) +\n          sections.join('');\n      var complete = pc.transceivers.every(function(transceiver) {\n        return transceiver.iceGatherer &&\n            transceiver.iceGatherer.state === 'completed';\n      });\n\n      if (pc.iceGatheringState !== 'gathering') {\n        pc.iceGatheringState = 'gathering';\n        pc._emitGatheringStateChange();\n      }\n\n      // Emit candidate. Also emit null candidate when all gatherers are\n      // complete.\n      if (!end) {\n        pc._dispatchEvent('icecandidate', event);\n      }\n      if (complete) {\n        pc._dispatchEvent('icecandidate', new Event('icecandidate'));\n        pc.iceGatheringState = 'complete';\n        pc._emitGatheringStateChange();\n      }\n    };\n\n    // emit already gathered candidates.\n    window.setTimeout(function() {\n      bufferedCandidateEvents.forEach(function(e) {\n        iceGatherer.onlocalcandidate(e);\n      });\n    }, 0);\n  };\n\n  // Create ICE transport and DTLS transport.\n  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\n    var pc = this;\n    var iceTransport = new window.RTCIceTransport(null);\n    iceTransport.onicestatechange = function() {\n      pc._updateIceConnectionState();\n      pc._updateConnectionState();\n    };\n\n    var dtlsTransport = new window.RTCDtlsTransport(iceTransport);\n    dtlsTransport.ondtlsstatechange = function() {\n      pc._updateConnectionState();\n    };\n    dtlsTransport.onerror = function() {\n      // onerror does not set state to failed by itself.\n      Object.defineProperty(dtlsTransport, 'state',\n          {value: 'failed', writable: true});\n      pc._updateConnectionState();\n    };\n\n    return {\n      iceTransport: iceTransport,\n      dtlsTransport: dtlsTransport\n    };\n  };\n\n  // Destroy ICE gatherer, ICE transport and DTLS transport.\n  // Without triggering the callbacks.\n  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\n      sdpMLineIndex) {\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer) {\n      delete iceGatherer.onlocalcandidate;\n      delete this.transceivers[sdpMLineIndex].iceGatherer;\n    }\n    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n    if (iceTransport) {\n      delete iceTransport.onicestatechange;\n      delete this.transceivers[sdpMLineIndex].iceTransport;\n    }\n    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n    if (dtlsTransport) {\n      delete dtlsTransport.ondtlsstatechange;\n      delete dtlsTransport.onerror;\n      delete this.transceivers[sdpMLineIndex].dtlsTransport;\n    }\n  };\n\n  // Start the RTP Sender and Receiver for a transceiver.\n  RTCPeerConnection.prototype._transceive = function(transceiver,\n      send, recv) {\n    var params = getCommonCapabilities(transceiver.localCapabilities,\n        transceiver.remoteCapabilities);\n    if (send && transceiver.rtpSender) {\n      params.encodings = transceiver.sendEncodingParameters;\n      params.rtcp = {\n        cname: SDPUtils.localCName,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.recvEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpSender.send(params);\n    }\n    if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {\n      // remove RTX field in Edge 14942\n      if (transceiver.kind === 'video'\n          && transceiver.recvEncodingParameters\n          && edgeVersion < 15019) {\n        transceiver.recvEncodingParameters.forEach(function(p) {\n          delete p.rtx;\n        });\n      }\n      if (transceiver.recvEncodingParameters.length) {\n        params.encodings = transceiver.recvEncodingParameters;\n      } else {\n        params.encodings = [{}];\n      }\n      params.rtcp = {\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.rtcpParameters.cname) {\n        params.rtcp.cname = transceiver.rtcpParameters.cname;\n      }\n      if (transceiver.sendEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpReceiver.receive(params);\n    }\n  };\n\n  RTCPeerConnection.prototype.setLocalDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setLocalDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set local ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var sections;\n    var sessionpart;\n    if (description.type === 'offer') {\n      // VERY limited support for SDP munging. Limited to:\n      // * changing the order of codecs\n      sections = SDPUtils.splitSections(description.sdp);\n      sessionpart = sections.shift();\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var caps = SDPUtils.parseRtpParameters(mediaSection);\n        pc.transceivers[sdpMLineIndex].localCapabilities = caps;\n      });\n\n      pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n        pc._gather(transceiver.mid, sdpMLineIndex);\n      });\n    } else if (description.type === 'answer') {\n      sections = SDPUtils.splitSections(pc._remoteDescription.sdp);\n      sessionpart = sections.shift();\n      var isIceLite = SDPUtils.matchPrefix(sessionpart,\n          'a=ice-lite').length > 0;\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        var iceGatherer = transceiver.iceGatherer;\n        var iceTransport = transceiver.iceTransport;\n        var dtlsTransport = transceiver.dtlsTransport;\n        var localCapabilities = transceiver.localCapabilities;\n        var remoteCapabilities = transceiver.remoteCapabilities;\n\n        // treat bundle-only as not-rejected.\n        var rejected = SDPUtils.isRejected(mediaSection) &&\n            SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n\n        if (!rejected && !transceiver.rejected) {\n          var remoteIceParameters = SDPUtils.getIceParameters(\n              mediaSection, sessionpart);\n          var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n              mediaSection, sessionpart);\n          if (isIceLite) {\n            remoteDtlsParameters.role = 'server';\n          }\n\n          if (!pc.usingBundle || sdpMLineIndex === 0) {\n            pc._gather(transceiver.mid, sdpMLineIndex);\n            if (iceTransport.state === 'new') {\n              iceTransport.start(iceGatherer, remoteIceParameters,\n                  isIceLite ? 'controlling' : 'controlled');\n            }\n            if (dtlsTransport.state === 'new') {\n              dtlsTransport.start(remoteDtlsParameters);\n            }\n          }\n\n          // Calculate intersection of capabilities.\n          var params = getCommonCapabilities(localCapabilities,\n              remoteCapabilities);\n\n          // Start the RTCRtpSender. The RTCRtpReceiver for this\n          // transceiver has already been started in setRemoteDescription.\n          pc._transceive(transceiver,\n              params.codecs.length > 0,\n              false);\n        }\n      });\n    }\n\n    pc._localDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-local-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.setRemoteDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setRemoteDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set remote ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var streams = {};\n    pc.remoteStreams.forEach(function(stream) {\n      streams[stream.id] = stream;\n    });\n    var receiverList = [];\n    var sections = SDPUtils.splitSections(description.sdp);\n    var sessionpart = sections.shift();\n    var isIceLite = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-lite').length > 0;\n    var usingBundle = SDPUtils.matchPrefix(sessionpart,\n        'a=group:BUNDLE ').length > 0;\n    pc.usingBundle = usingBundle;\n    var iceOptions = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-options:')[0];\n    if (iceOptions) {\n      pc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n          .indexOf('trickle') >= 0;\n    } else {\n      pc.canTrickleIceCandidates = false;\n    }\n\n    sections.forEach(function(mediaSection, sdpMLineIndex) {\n      var lines = SDPUtils.splitLines(mediaSection);\n      var kind = SDPUtils.getKind(mediaSection);\n      // treat bundle-only as not-rejected.\n      var rejected = SDPUtils.isRejected(mediaSection) &&\n          SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n      var protocol = lines[0].substr(2).split(' ')[2];\n\n      var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n      var remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n      // Reject datachannels which are not implemented yet.\n      if (rejected || (kind === 'application' && (protocol === 'DTLS/SCTP' ||\n          protocol === 'UDP/DTLS/SCTP'))) {\n        // TODO: this is dangerous in the case where a non-rejected m-line\n        //     becomes rejected.\n        pc.transceivers[sdpMLineIndex] = {\n          mid: mid,\n          kind: kind,\n          protocol: protocol,\n          rejected: true\n        };\n        return;\n      }\n\n      if (!rejected && pc.transceivers[sdpMLineIndex] &&\n          pc.transceivers[sdpMLineIndex].rejected) {\n        // recycle a rejected transceiver.\n        pc.transceivers[sdpMLineIndex] = pc._createTransceiver(kind, true);\n      }\n\n      var transceiver;\n      var iceGatherer;\n      var iceTransport;\n      var dtlsTransport;\n      var rtpReceiver;\n      var sendEncodingParameters;\n      var recvEncodingParameters;\n      var localCapabilities;\n\n      var track;\n      // FIXME: ensure the mediaSection has rtcp-mux set.\n      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n      var remoteIceParameters;\n      var remoteDtlsParameters;\n      if (!rejected) {\n        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters.role = 'client';\n      }\n      recvEncodingParameters =\n          SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n      var isComplete = SDPUtils.matchPrefix(mediaSection,\n          'a=end-of-candidates', sessionpart).length > 0;\n      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n          .map(function(cand) {\n            return SDPUtils.parseCandidate(cand);\n          })\n          .filter(function(cand) {\n            return cand.component === 1;\n          });\n\n      // Check if we can use BUNDLE and dispose transports.\n      if ((description.type === 'offer' || description.type === 'answer') &&\n          !rejected && usingBundle && sdpMLineIndex > 0 &&\n          pc.transceivers[sdpMLineIndex]) {\n        pc._disposeIceAndDtlsTransports(sdpMLineIndex);\n        pc.transceivers[sdpMLineIndex].iceGatherer =\n            pc.transceivers[0].iceGatherer;\n        pc.transceivers[sdpMLineIndex].iceTransport =\n            pc.transceivers[0].iceTransport;\n        pc.transceivers[sdpMLineIndex].dtlsTransport =\n            pc.transceivers[0].dtlsTransport;\n        if (pc.transceivers[sdpMLineIndex].rtpSender) {\n          pc.transceivers[sdpMLineIndex].rtpSender.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n        if (pc.transceivers[sdpMLineIndex].rtpReceiver) {\n          pc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n      }\n      if (description.type === 'offer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex] ||\n            pc._createTransceiver(kind);\n        transceiver.mid = mid;\n\n        if (!transceiver.iceGatherer) {\n          transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n              usingBundle);\n        }\n\n        if (cands.length && transceiver.iceTransport.state === 'new') {\n          if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n            transceiver.iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);\n\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        if (edgeVersion < 15019) {\n          localCapabilities.codecs = localCapabilities.codecs.filter(\n              function(codec) {\n                return codec.name !== 'rtx';\n              });\n        }\n\n        sendEncodingParameters = transceiver.sendEncodingParameters || [{\n          ssrc: (2 * sdpMLineIndex + 2) * 1001\n        }];\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        var isNewTrack = false;\n        if (direction === 'sendrecv' || direction === 'sendonly') {\n          isNewTrack = !transceiver.rtpReceiver;\n          rtpReceiver = transceiver.rtpReceiver ||\n              new window.RTCRtpReceiver(transceiver.dtlsTransport, kind);\n\n          if (isNewTrack) {\n            var stream;\n            track = rtpReceiver.track;\n            // FIXME: does not work with Plan B.\n            if (remoteMsid && remoteMsid.stream === '-') {\n              // no-op. a stream id of '-' means: no associated stream.\n            } else if (remoteMsid) {\n              if (!streams[remoteMsid.stream]) {\n                streams[remoteMsid.stream] = new window.MediaStream();\n                Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                  get: function() {\n                    return remoteMsid.stream;\n                  }\n                });\n              }\n              Object.defineProperty(track, 'id', {\n                get: function() {\n                  return remoteMsid.track;\n                }\n              });\n              stream = streams[remoteMsid.stream];\n            } else {\n              if (!streams.default) {\n                streams.default = new window.MediaStream();\n              }\n              stream = streams.default;\n            }\n            if (stream) {\n              addTrackToStreamAndFireEvent(track, stream);\n              transceiver.associatedRemoteMediaStreams.push(stream);\n            }\n            receiverList.push([track, rtpReceiver, stream]);\n          }\n        } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {\n          transceiver.associatedRemoteMediaStreams.forEach(function(s) {\n            var nativeTrack = s.getTracks().find(function(t) {\n              return t.id === transceiver.rtpReceiver.track.id;\n            });\n            if (nativeTrack) {\n              removeTrackFromStreamAndFireEvent(nativeTrack, s);\n            }\n          });\n          transceiver.associatedRemoteMediaStreams = [];\n        }\n\n        transceiver.localCapabilities = localCapabilities;\n        transceiver.remoteCapabilities = remoteCapabilities;\n        transceiver.rtpReceiver = rtpReceiver;\n        transceiver.rtcpParameters = rtcpParameters;\n        transceiver.sendEncodingParameters = sendEncodingParameters;\n        transceiver.recvEncodingParameters = recvEncodingParameters;\n\n        // Start the RTCRtpReceiver now. The RTPSender is started in\n        // setLocalDescription.\n        pc._transceive(pc.transceivers[sdpMLineIndex],\n            false,\n            isNewTrack);\n      } else if (description.type === 'answer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex];\n        iceGatherer = transceiver.iceGatherer;\n        iceTransport = transceiver.iceTransport;\n        dtlsTransport = transceiver.dtlsTransport;\n        rtpReceiver = transceiver.rtpReceiver;\n        sendEncodingParameters = transceiver.sendEncodingParameters;\n        localCapabilities = transceiver.localCapabilities;\n\n        pc.transceivers[sdpMLineIndex].recvEncodingParameters =\n            recvEncodingParameters;\n        pc.transceivers[sdpMLineIndex].remoteCapabilities =\n            remoteCapabilities;\n        pc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n        if (cands.length && iceTransport.state === 'new') {\n          if ((isIceLite || isComplete) &&\n              (!usingBundle || sdpMLineIndex === 0)) {\n            iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        if (!usingBundle || sdpMLineIndex === 0) {\n          if (iceTransport.state === 'new') {\n            iceTransport.start(iceGatherer, remoteIceParameters,\n                'controlling');\n          }\n          if (dtlsTransport.state === 'new') {\n            dtlsTransport.start(remoteDtlsParameters);\n          }\n        }\n\n        // If the offer contained RTX but the answer did not,\n        // remove RTX from sendEncodingParameters.\n        var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n        var hasRtx = commonCapabilities.codecs.filter(function(c) {\n          return c.name.toLowerCase() === 'rtx';\n        }).length;\n        if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n          delete transceiver.sendEncodingParameters[0].rtx;\n        }\n\n        pc._transceive(transceiver,\n            direction === 'sendrecv' || direction === 'recvonly',\n            direction === 'sendrecv' || direction === 'sendonly');\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        if (rtpReceiver &&\n            (direction === 'sendrecv' || direction === 'sendonly')) {\n          track = rtpReceiver.track;\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);\n            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams.default);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        } else {\n          // FIXME: actually the receiver should be created later.\n          delete transceiver.rtpReceiver;\n        }\n      }\n    });\n\n    if (pc._dtlsRole === undefined) {\n      pc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';\n    }\n\n    pc._remoteDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-remote-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n    Object.keys(streams).forEach(function(sid) {\n      var stream = streams[sid];\n      if (stream.getTracks().length) {\n        if (pc.remoteStreams.indexOf(stream) === -1) {\n          pc.remoteStreams.push(stream);\n          var event = new Event('addstream');\n          event.stream = stream;\n          window.setTimeout(function() {\n            pc._dispatchEvent('addstream', event);\n          });\n        }\n\n        receiverList.forEach(function(item) {\n          var track = item[0];\n          var receiver = item[1];\n          if (stream.id !== item[2].id) {\n            return;\n          }\n          fireAddTrack(pc, track, receiver, [stream]);\n        });\n      }\n    });\n    receiverList.forEach(function(item) {\n      if (item[2]) {\n        return;\n      }\n      fireAddTrack(pc, item[0], item[1], []);\n    });\n\n    // check whether addIceCandidate({}) was called within four seconds after\n    // setRemoteDescription.\n    window.setTimeout(function() {\n      if (!(pc && pc.transceivers)) {\n        return;\n      }\n      pc.transceivers.forEach(function(transceiver) {\n        if (transceiver.iceTransport &&\n            transceiver.iceTransport.state === 'new' &&\n            transceiver.iceTransport.getRemoteCandidates().length > 0) {\n          console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n              'an end-of-candidates notification');\n          transceiver.iceTransport.addRemoteCandidate({});\n        }\n      });\n    }, 4000);\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.close = function() {\n    this.transceivers.forEach(function(transceiver) {\n      /* not yet\n      if (transceiver.iceGatherer) {\n        transceiver.iceGatherer.close();\n      }\n      */\n      if (transceiver.iceTransport) {\n        transceiver.iceTransport.stop();\n      }\n      if (transceiver.dtlsTransport) {\n        transceiver.dtlsTransport.stop();\n      }\n      if (transceiver.rtpSender) {\n        transceiver.rtpSender.stop();\n      }\n      if (transceiver.rtpReceiver) {\n        transceiver.rtpReceiver.stop();\n      }\n    });\n    // FIXME: clean up tracks, local streams, remote streams, etc\n    this._isClosed = true;\n    this._updateSignalingState('closed');\n  };\n\n  // Update the signaling state.\n  RTCPeerConnection.prototype._updateSignalingState = function(newState) {\n    this.signalingState = newState;\n    var event = new Event('signalingstatechange');\n    this._dispatchEvent('signalingstatechange', event);\n  };\n\n  // Determine whether to fire the negotiationneeded event.\n  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\n    var pc = this;\n    if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n      return;\n    }\n    this.needNegotiation = true;\n    window.setTimeout(function() {\n      if (pc.needNegotiation) {\n        pc.needNegotiation = false;\n        var event = new Event('negotiationneeded');\n        pc._dispatchEvent('negotiationneeded', event);\n      }\n    }, 0);\n  };\n\n  // Update the ice connection state.\n  RTCPeerConnection.prototype._updateIceConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      checking: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n      }\n    });\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.checking > 0) {\n      newState = 'checking';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    } else if (states.completed > 0) {\n      newState = 'completed';\n    }\n\n    if (newState !== this.iceConnectionState) {\n      this.iceConnectionState = newState;\n      var event = new Event('iceconnectionstatechange');\n      this._dispatchEvent('iceconnectionstatechange', event);\n    }\n  };\n\n  // Update the connection state.\n  RTCPeerConnection.prototype._updateConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      connecting: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && transceiver.dtlsTransport &&\n          !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n        states[transceiver.dtlsTransport.state]++;\n      }\n    });\n    // ICETransport.completed and connected are the same for this purpose.\n    states.connected += states.completed;\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.connecting > 0) {\n      newState = 'connecting';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    }\n\n    if (newState !== this.connectionState) {\n      this.connectionState = newState;\n      var event = new Event('connectionstatechange');\n      this._dispatchEvent('connectionstatechange', event);\n    }\n  };\n\n  RTCPeerConnection.prototype.createOffer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createOffer after close'));\n    }\n\n    var numAudioTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'audio';\n    }).length;\n    var numVideoTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'video';\n    }).length;\n\n    // Determine number of audio and video tracks we need to send/recv.\n    var offerOptions = arguments[0];\n    if (offerOptions) {\n      // Reject Chrome legacy constraints.\n      if (offerOptions.mandatory || offerOptions.optional) {\n        throw new TypeError(\n            'Legacy mandatory/optional constraints not supported.');\n      }\n      if (offerOptions.offerToReceiveAudio !== undefined) {\n        if (offerOptions.offerToReceiveAudio === true) {\n          numAudioTracks = 1;\n        } else if (offerOptions.offerToReceiveAudio === false) {\n          numAudioTracks = 0;\n        } else {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n      }\n      if (offerOptions.offerToReceiveVideo !== undefined) {\n        if (offerOptions.offerToReceiveVideo === true) {\n          numVideoTracks = 1;\n        } else if (offerOptions.offerToReceiveVideo === false) {\n          numVideoTracks = 0;\n        } else {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n    }\n\n    pc.transceivers.forEach(function(transceiver) {\n      if (transceiver.kind === 'audio') {\n        numAudioTracks--;\n        if (numAudioTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      } else if (transceiver.kind === 'video') {\n        numVideoTracks--;\n        if (numVideoTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      }\n    });\n\n    // Create M-lines for recvonly streams.\n    while (numAudioTracks > 0 || numVideoTracks > 0) {\n      if (numAudioTracks > 0) {\n        pc._createTransceiver('audio');\n        numAudioTracks--;\n      }\n      if (numVideoTracks > 0) {\n        pc._createTransceiver('video');\n        numVideoTracks--;\n      }\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      // For each track, create an ice gatherer, ice transport,\n      // dtls transport, potentially rtpsender and rtpreceiver.\n      var track = transceiver.track;\n      var kind = transceiver.kind;\n      var mid = transceiver.mid || SDPUtils.generateIdentifier();\n      transceiver.mid = mid;\n\n      if (!transceiver.iceGatherer) {\n        transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n            pc.usingBundle);\n      }\n\n      var localCapabilities = window.RTCRtpSender.getCapabilities(kind);\n      // filter RTX until additional stuff needed for RTX is implemented\n      // in adapter.js\n      if (edgeVersion < 15019) {\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n      }\n      localCapabilities.codecs.forEach(function(codec) {\n        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n        // by adding level-asymmetry-allowed=1\n        if (codec.name === 'H264' &&\n            codec.parameters['level-asymmetry-allowed'] === undefined) {\n          codec.parameters['level-asymmetry-allowed'] = '1';\n        }\n\n        // for subsequent offers, we might have to re-use the payload\n        // type of the last offer.\n        if (transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.codecs) {\n          transceiver.remoteCapabilities.codecs.forEach(function(remoteCodec) {\n            if (codec.name.toLowerCase() === remoteCodec.name.toLowerCase() &&\n                codec.clockRate === remoteCodec.clockRate) {\n              codec.preferredPayloadType = remoteCodec.payloadType;\n            }\n          });\n        }\n      });\n      localCapabilities.headerExtensions.forEach(function(hdrExt) {\n        var remoteExtensions = transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.headerExtensions || [];\n        remoteExtensions.forEach(function(rHdrExt) {\n          if (hdrExt.uri === rHdrExt.uri) {\n            hdrExt.id = rHdrExt.id;\n          }\n        });\n      });\n\n      // generate an ssrc now, to be used later in rtpSender.send\n      var sendEncodingParameters = transceiver.sendEncodingParameters || [{\n        ssrc: (2 * sdpMLineIndex + 1) * 1001\n      }];\n      if (track) {\n        // add RTX\n        if (edgeVersion >= 15019 && kind === 'video' &&\n            !sendEncodingParameters[0].rtx) {\n          sendEncodingParameters[0].rtx = {\n            ssrc: sendEncodingParameters[0].ssrc + 1\n          };\n        }\n      }\n\n      if (transceiver.wantReceive) {\n        transceiver.rtpReceiver = new window.RTCRtpReceiver(\n            transceiver.dtlsTransport, kind);\n      }\n\n      transceiver.localCapabilities = localCapabilities;\n      transceiver.sendEncodingParameters = sendEncodingParameters;\n    });\n\n    // always offer BUNDLE and dispose on return if not supported.\n    if (pc._config.bundlePolicy !== 'max-compat') {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      sdp += writeMediaSection(transceiver, transceiver.localCapabilities,\n          'offer', transceiver.stream, pc._dtlsRole);\n      sdp += 'a=rtcp-rsize\\r\\n';\n\n      if (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&\n          (sdpMLineIndex === 0 || !pc.usingBundle)) {\n        transceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {\n          cand.component = 1;\n          sdp += 'a=' + SDPUtils.writeCandidate(cand) + '\\r\\n';\n        });\n\n        if (transceiver.iceGatherer.state === 'completed') {\n          sdp += 'a=end-of-candidates\\r\\n';\n        }\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'offer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.createAnswer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer after close'));\n    }\n\n    if (!(pc.signalingState === 'have-remote-offer' ||\n        pc.signalingState === 'have-local-pranswer')) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer in signalingState ' + pc.signalingState));\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    if (pc.usingBundle) {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    var mediaSectionsInOffer = SDPUtils.getMediaSections(\n        pc._remoteDescription.sdp).length;\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      if (sdpMLineIndex + 1 > mediaSectionsInOffer) {\n        return;\n      }\n      if (transceiver.rejected) {\n        if (transceiver.kind === 'application') {\n          if (transceiver.protocol === 'DTLS/SCTP') { // legacy fmt\n            sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n';\n          } else {\n            sdp += 'm=application 0 ' + transceiver.protocol +\n                ' webrtc-datachannel\\r\\n';\n          }\n        } else if (transceiver.kind === 'audio') {\n          sdp += 'm=audio 0 UDP/TLS/RTP/SAVPF 0\\r\\n' +\n              'a=rtpmap:0 PCMU/8000\\r\\n';\n        } else if (transceiver.kind === 'video') {\n          sdp += 'm=video 0 UDP/TLS/RTP/SAVPF 120\\r\\n' +\n              'a=rtpmap:120 VP8/90000\\r\\n';\n        }\n        sdp += 'c=IN IP4 0.0.0.0\\r\\n' +\n            'a=inactive\\r\\n' +\n            'a=mid:' + transceiver.mid + '\\r\\n';\n        return;\n      }\n\n      // FIXME: look at direction.\n      if (transceiver.stream) {\n        var localTrack;\n        if (transceiver.kind === 'audio') {\n          localTrack = transceiver.stream.getAudioTracks()[0];\n        } else if (transceiver.kind === 'video') {\n          localTrack = transceiver.stream.getVideoTracks()[0];\n        }\n        if (localTrack) {\n          // add RTX\n          if (edgeVersion >= 15019 && transceiver.kind === 'video' &&\n              !transceiver.sendEncodingParameters[0].rtx) {\n            transceiver.sendEncodingParameters[0].rtx = {\n              ssrc: transceiver.sendEncodingParameters[0].ssrc + 1\n            };\n          }\n        }\n      }\n\n      // Calculate intersection of capabilities.\n      var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n      var hasRtx = commonCapabilities.codecs.filter(function(c) {\n        return c.name.toLowerCase() === 'rtx';\n      }).length;\n      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n        delete transceiver.sendEncodingParameters[0].rtx;\n      }\n\n      sdp += writeMediaSection(transceiver, commonCapabilities,\n          'answer', transceiver.stream, pc._dtlsRole);\n      if (transceiver.rtcpParameters &&\n          transceiver.rtcpParameters.reducedSize) {\n        sdp += 'a=rtcp-rsize\\r\\n';\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'answer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n    var pc = this;\n    var sections;\n    if (candidate && !(candidate.sdpMLineIndex !== undefined ||\n        candidate.sdpMid)) {\n      return Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));\n    }\n\n    // TODO: needs to go into ops queue.\n    return new Promise(function(resolve, reject) {\n      if (!pc._remoteDescription) {\n        return reject(makeError('InvalidStateError',\n            'Can not add ICE candidate without a remote description'));\n      } else if (!candidate || candidate.candidate === '') {\n        for (var j = 0; j < pc.transceivers.length; j++) {\n          if (pc.transceivers[j].rejected) {\n            continue;\n          }\n          pc.transceivers[j].iceTransport.addRemoteCandidate({});\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[j] += 'a=end-of-candidates\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n          if (pc.usingBundle) {\n            break;\n          }\n        }\n      } else {\n        var sdpMLineIndex = candidate.sdpMLineIndex;\n        if (candidate.sdpMid) {\n          for (var i = 0; i < pc.transceivers.length; i++) {\n            if (pc.transceivers[i].mid === candidate.sdpMid) {\n              sdpMLineIndex = i;\n              break;\n            }\n          }\n        }\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        if (transceiver) {\n          if (transceiver.rejected) {\n            return resolve();\n          }\n          var cand = Object.keys(candidate.candidate).length > 0 ?\n              SDPUtils.parseCandidate(candidate.candidate) : {};\n          // Ignore Chrome's invalid candidates since Edge does not like them.\n          if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n            return resolve();\n          }\n          // Ignore RTCP candidates, we assume RTCP-MUX.\n          if (cand.component && cand.component !== 1) {\n            return resolve();\n          }\n          // when using bundle, avoid adding candidates to the wrong\n          // ice transport. And avoid adding candidates added in the SDP.\n          if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&\n              transceiver.iceTransport !== pc.transceivers[0].iceTransport)) {\n            if (!maybeAddCandidate(transceiver.iceTransport, cand)) {\n              return reject(makeError('OperationError',\n                  'Can not add ICE candidate'));\n            }\n          }\n\n          // update the remoteDescription.\n          var candidateString = candidate.candidate.trim();\n          if (candidateString.indexOf('a=') === 0) {\n            candidateString = candidateString.substr(2);\n          }\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[sdpMLineIndex] += 'a=' +\n              (cand.type ? candidateString : 'end-of-candidates')\n              + '\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n        } else {\n          return reject(makeError('OperationError',\n              'Can not add ICE candidate'));\n        }\n      }\n      resolve();\n    });\n  };\n\n  RTCPeerConnection.prototype.getStats = function(selector) {\n    if (selector && selector instanceof window.MediaStreamTrack) {\n      var senderOrReceiver = null;\n      this.transceivers.forEach(function(transceiver) {\n        if (transceiver.rtpSender &&\n            transceiver.rtpSender.track === selector) {\n          senderOrReceiver = transceiver.rtpSender;\n        } else if (transceiver.rtpReceiver &&\n            transceiver.rtpReceiver.track === selector) {\n          senderOrReceiver = transceiver.rtpReceiver;\n        }\n      });\n      if (!senderOrReceiver) {\n        throw makeError('InvalidAccessError', 'Invalid selector.');\n      }\n      return senderOrReceiver.getStats();\n    }\n\n    var promises = [];\n    this.transceivers.forEach(function(transceiver) {\n      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n          'dtlsTransport'].forEach(function(method) {\n            if (transceiver[method]) {\n              promises.push(transceiver[method].getStats());\n            }\n          });\n    });\n    return Promise.all(promises).then(function(allStats) {\n      var results = new Map();\n      allStats.forEach(function(stats) {\n        stats.forEach(function(stat) {\n          results.set(stat.id, stat);\n        });\n      });\n      return results;\n    });\n  };\n\n  // fix low-level stat names and return Map instead of object.\n  var ortcObjects = ['RTCRtpSender', 'RTCRtpReceiver', 'RTCIceGatherer',\n    'RTCIceTransport', 'RTCDtlsTransport'];\n  ortcObjects.forEach(function(ortcObjectName) {\n    var obj = window[ortcObjectName];\n    if (obj && obj.prototype && obj.prototype.getStats) {\n      var nativeGetstats = obj.prototype.getStats;\n      obj.prototype.getStats = function() {\n        return nativeGetstats.apply(this)\n        .then(function(nativeStats) {\n          var mapStats = new Map();\n          Object.keys(nativeStats).forEach(function(id) {\n            nativeStats[id].type = fixStatsType(nativeStats[id]);\n            mapStats.set(id, nativeStats[id]);\n          });\n          return mapStats;\n        });\n      };\n    }\n  });\n\n  // legacy callback shims. Should be moved to adapter.js some days.\n  var methods = ['createOffer', 'createAnswer'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[0] === 'function' ||\n          typeof args[1] === 'function') { // legacy\n        return nativeMethod.apply(this, [arguments[2]])\n        .then(function(description) {\n          if (typeof args[0] === 'function') {\n            args[0].apply(null, [description]);\n          }\n        }, function(error) {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  methods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function' ||\n          typeof args[2] === 'function') { // legacy\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        }, function(error) {\n          if (typeof args[2] === 'function') {\n            args[2].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // getStats is special. It doesn't have a spec legacy method yet we support\n  // getStats(something, cb) without error callbacks.\n  ['getStats'].forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function') {\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  return RTCPeerConnection;\n};\n","/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// returns the session description.\nSDPUtils.getDescription = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n};\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  var channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      if (codec.parameters[param]) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\nSDPUtils.parseSsrcGroup = function(line) {\n  var parts = line.substr(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(function(ssrc) {\n      return parseInt(ssrc, 10);\n    })\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n};\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3),\n  };\n};\n\nSDPUtils.writeCryptoLine = function(parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' +\n    parameters.cryptoSuite + ' ' +\n    (typeof parameters.keyParams === 'object'\n      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\n      : parameters.keyParams) +\n    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\n    '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function(keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  var parts = keyParams.substr(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function(keyParams) {\n  return keyParams.keyMethod + ':'\n    + keyParams.keySalt +\n    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\n    (keyParams.mkiValue && keyParams.mkiLength\n      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\n      : '');\n};\n\n// Extracts all SDES paramters.\nSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-ufrag:')[0];\n  var pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substr(12),\n    password: pwd.substr(10),\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(function(extension) {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(parts) {\n      return parts.attribute === 'cname';\n    });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(function(line) {\n      var parts = line.substr(17).split(' ');\n      return parts.map(function(part) {\n        return parseInt(part, 10);\n      });\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10)\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  // Gets the first SSRC. Note tha with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(obj) {\n      return obj.attribute === 'cname';\n    })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrіbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(msidParts) {\n      return msidParts.attribute === 'msid';\n    });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  var mline = SDPUtils.parseMLine(mediaSection);\n  var maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  var maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substr(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  var sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substr(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize: maxMessageSize\n    };\n  }\n  var sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    var parts = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:')[0]\n      .substr(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize: maxMessageSize\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  var output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n'\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n'\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  var user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n    transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n    transceiver.dtlsTransport.getLocalParameters(),\n    type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var parts = lines[0].substr(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' ')\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  var parts = line.substr(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5]\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  var lines = SDPUtils.splitLines(blob);\n  for (var i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n","// component set on scene.\r\n// Contains configuration of key bar thresholds.\r\n// Monitors bar position and generates events when thresholds are hit.\r\nAFRAME.registerComponent('bar-monitor', {\r\n\r\n  dependencies: ['bar-position'],\r\n\r\n  schema: {\r\n    // Position of bar when on hooks (before the lift begins)\r\n    // Co-ordinates in rack space.\r\n    hookPosition : {type: 'vec3', default: {x: 0, y: 1.5, z: -0.5}},\r\n\r\n    // height of bar when lifter is standing up straight.\r\n    topHeight : {default: 0},\r\n\r\n    // target depth for bar, to achieve parallel thighs.\r\n    targetDepth: {default: 0},\r\n\r\n    // height of the bar when it hits the safety pins.\r\n    safetyPinHeight: {default: 0},\r\n\r\n    // width of rack in meters\r\n    rackWidth: {default: 1},\r\n\r\n    // depth (z-direction) of rack in meters\r\n    rackDepth: {default: 1},\r\n\r\n    // whether to show planes\r\n    showPlanes: {default: true},\r\n\r\n    // opacity of planes (if used)\r\n    opacity: {default: 0.3}\r\n\r\n  },\r\n\r\n  init() {\r\n\r\n    this.state = {\r\n      insideRack : false,\r\n      lifterAtHooks : false,\r\n      barOnShoulders : false,\r\n      atTop : false,\r\n      belowDepth : false,\r\n      belowSafetyPins : false,\r\n    }\r\n   },\r\n\r\n  update() {\r\n    this.deletePlanes()\r\n\r\n    if (this.data.showPlanes) {\r\n      this.createPlanes()\r\n    }\r\n  },\r\n\r\n  createPlanes() {\r\n\r\n    //this.aboveTopPlane = this.createPlane(this.data.topHeight, 'green')\r\n    this.topPlaneUpwards = this.createPlane(this.data.topHeight - 0.05, 'green')\r\n    this.depthPlaneUpwards = this.createPlane(this.data.targetDepth, 'green')\r\n    this.safetyPlaneTop = this.createPlane(this.data.safetyPinHeight, 'orange')\r\n    this.safetyPlaneBottom = this.createPlane(this.data.safetyPinHeight - 0.05, 'red')\r\n  },\r\n\r\n  deletePlanes() {\r\n\r\n    deletePlane = (plane) => {\r\n      if (plane) {\r\n        plane.parentNode.removeChild(plane)\r\n      }\r\n    }\r\n\r\n    deletePlane(this.aboveTopPlane)\r\n    deletePlane(this.topPlaneUpwards)\r\n    deletePlane(this.depthPlaneUpwards)\r\n    deletePlane(this.safetyPlaneTop)\r\n    deletePlane(this.safetyPlaneBottom)\r\n\r\n    this.aboveTopPlane = null\r\n    this.aboveTopPlane = null\r\n    this.topPlaneUpwards = null\r\n    this.depthPlaneUpwards = null\r\n    this.safetyPlaneTop = null\r\n    this.safetyPlaneBottom = null\r\n  },\r\n\r\n  createPlane(height, color) {\r\n    const plane = document.createElement('a-entity')\r\n    plane.setAttribute('plane-visualization', {height: height, color: color})\r\n    \r\n    const rackEl = document.querySelector('#rack')\r\n    rackEl.appendChild(plane)\r\n\r\n    return plane\r\n  },\r\n\r\n  isInsideRack(barPosition) {\r\n\r\n    let insideLR, insideFB\r\n\r\n    if (Math.abs(barPosition.x - this.data.hookPosition.x) < this.data.rackWidth / 2) {\r\n      insideLR = true\r\n    }\r\n\r\n    // zOffset relative to hook Position will be positive (up to rack depth)\r\n    // or very small negative (to 10cm tolerance) when inside the rack.\r\n    const zOffset = barPosition.z - this.data.hookPosition.z\r\n    if ((zOffset) < this.data.rackDepth && \r\n        (zOffset) > -0.1) {\r\n      insideFB = true\r\n    }\r\n\r\n    return (insideLR && insideFB)\r\n\r\n  },\r\n\r\n  checkIfInsideRack(barPosition) {\r\n    if (this.isInsideRack(barPosition)) {\r\n\r\n      if (!this.state.insideRack) {\r\n        this.el.emit('entered-rack')\r\n      }\r\n\r\n      this.state.insideRack = true\r\n    }\r\n    else {\r\n      if (this.state.insideRack) {\r\n        this.el.emit('exited-rack')\r\n      }\r\n\r\n      this.state.insideRack = false\r\n    }\r\n\r\n    return this.state.insideRack\r\n  },\r\n\r\n  isAtHooks(barPosition) {\r\n\r\n    let atHooksLR, atHooksFB\r\n\r\n    // for L-R, anywhere in rack will do.\r\n    if (Math.abs(barPosition.x - this.data.hookPosition.x) < this.data.rackWidth / 2) {\r\n      atHooksLR = true\r\n    }\r\n\r\n    // 10cm tolerance for Front-Back.\r\n\r\n    // Note: user can subvert logic by bringing in bar very close to pins, then lowering directly in front of pins.\r\n    // App will assume bar has been returned to rack, when in fact it's still on users' shoulders.\r\n    // This behaviour seems really unlikely to happen, unless user is deliberatly trying to subvert the app...\r\n\r\n    // Not sure we can do any better without introducing risk of false negatives when bar\r\n    // is legitimately returned to the hooks.\r\n    if (Math.abs(this.data.hookPosition.z - barPosition.z) < 0.05) {\r\n      atHooksFB = true\r\n    }\r\n\r\n    return atHooksLR && atHooksFB\r\n  },\r\n\r\n  checkIfAtHooks(barPosition) {\r\n\r\n    if (this.isAtHooks(barPosition)) {\r\n      if (!this.state.lifterAtHooks) {\r\n        this.el.emit('reached-hooks')\r\n      }\r\n      this.state.lifterAtHooks = true\r\n    }\r\n    else {\r\n      if (this.state.lifterAtHooks) {\r\n        // lifter leaving hooks.\r\n        // may or may not have bar on shoulders.  Determine based on y position.\r\n\r\n        if (barPosition.y > this.data.hookPosition.y) {\r\n          // bar above hooks - must be on shoulders.\r\n\r\n          if (!this.state.barOnShoulders) {\r\n\r\n            this.el.emit('shouldered-bar')\r\n          }\r\n          \r\n          this.state.barOnShoulders = true\r\n        }\r\n        else {\r\n          // bar below hooks - must have deposited it back on the hooks.\r\n\r\n          if (this.state.barOnShoulders) {\r\n\r\n            this.el.emit('returned-bar')\r\n          }\r\n          \r\n          this.state.barOnShoulders = false\r\n        }\r\n\r\n        this.el.emit('left-hooks')\r\n      }\r\n      this.state.lifterAtHooks = false\r\n    }\r\n\r\n    return this.state.lifterAtHooks\r\n  },\r\n\r\n  isAtTop(barPosition) {\r\n\r\n    // 5cm tolerance.  Anything over top is considered at top.\r\n    if (this.data.topHeight - barPosition.y < 0.05) {\r\n      return true\r\n    }\r\n    else {\r\n      return false\r\n    }\r\n  },\r\n\r\n  checkIfAtTop(barPosition) {\r\n    if (this.isAtTop(barPosition)) {\r\n\r\n      if (!this.state.atTop) {\r\n        this.el.emit('hit-top')\r\n      }\r\n\r\n      this.state.atTop = true\r\n    }\r\n    else {\r\n      if (this.state.atTop) {\r\n        this.el.emit('lowered-from-top')\r\n      }\r\n\r\n      this.state.atTop = false\r\n    }\r\n\r\n    return this.state.atTop\r\n  },\r\n\r\n  isBelowDepth(barPosition) {\r\n\r\n    // Below target depth.  No tolerance - must pass target depth.\r\n    if (barPosition.y < this.data.targetDepth) {\r\n      return true\r\n    }\r\n    else {\r\n      return false\r\n    }\r\n  },\r\n\r\n  checkIfBelowDepth(barPosition) {\r\n    if (this.isBelowDepth(barPosition)) {\r\n\r\n      if (!this.state.belowDepth) {\r\n        this.el.emit('hit-target-depth')\r\n      }\r\n\r\n      this.state.belowDepth = true\r\n    }\r\n    else {\r\n      if (this.state.belowDepth) {\r\n        this.el.emit('upwards-from-target-depth')\r\n      }\r\n\r\n      this.state.belowDepth = false\r\n    }\r\n\r\n    return this.state.belowDepth\r\n  },\r\n\r\n  isBelowSafetyPins(barPosition) {\r\n\r\n    // Below safety pins\r\n    // wait until fully 5cm below, to be sure lifter is bailing out, not just performing a deep rep.\r\n    if (barPosition.y < (this.data.safetyPinHeight - 0.05)) {\r\n      return true\r\n    }\r\n    else {\r\n      return false\r\n    }\r\n  },\r\n\r\n  checkIfBelowSafetyPins(barPosition) {\r\n    if (this.isBelowSafetyPins(barPosition)) {\r\n\r\n      if (!this.state.belowSafetyPins) {\r\n        this.el.emit('below-safety-pins')\r\n      }\r\n\r\n      this.state.belowSafetyPins = true\r\n    }\r\n    else {\r\n      if (this.state.belowSafetyPins) {\r\n        this.el.emit('bailed-out')\r\n\r\n        // following bail-out, bar is no longer on the shoulders.\r\n        this.state.barOnShoulders = false\r\n      }\r\n\r\n      this.state.belowSafetyPins = false\r\n    }\r\n\r\n    return this.state.belowSafetyPins\r\n  },\r\n\r\n  tick() {\r\n    barPosition = this.el.sceneEl.components['bar-position'].barPosition\r\n\r\n    // is the lifter inside the rack?\r\n    const insideRack = this.checkIfInsideRack(barPosition)\r\n\r\n    // if not inside rack, nothing else can happen.\r\n    if (!insideRack) return\r\n\r\n    // is the lifter at the pins (likely either taking on, or dropping off the bar?)\r\n    // This also updates state about whether or not the lifter has the bar on their shoulders.\r\n    this.checkIfAtHooks(barPosition)\r\n\r\n    // is the lifter at the top of a rep?\r\n    this.checkIfAtTop(barPosition)\r\n\r\n    // has the lifter gone below target depth?\r\n    this.checkIfBelowDepth(barPosition)\r\n\r\n    // has the lifter bailed out on the safety pins?\r\n    this.checkIfBelowSafetyPins(barPosition)\r\n\r\n  }\r\n})\r\n\r\nAFRAME.registerComponent('plane-visualization', {\r\n\r\n  schema: {\r\n    height: {default: 0},\r\n    color: {default: 'red'}\r\n  },\r\n\r\n  init() {\r\n\r\n    const {height, color} = this.data\r\n\r\n    this.createRing(height, color, 0.8, 0.5)\r\n    this.createRing(height, color, 1.0, 0.75)\r\n    this.createRing(height, color, 1.2, 1)\r\n\r\n  },\r\n\r\n  createRing(height, color, radius, opacity) {\r\n\r\n    const ring = document.createElement('a-torus')\r\n    ring.object3D.rotation.x = Math.PI / 2\r\n    ring.object3D.position.y = height\r\n    ring.setAttribute('radius', radius)\r\n    ring.setAttribute('radius-tubular', 0.001)\r\n    ring.setAttribute('segments-tubular', 128)\r\n    ring.setAttribute('material', {color: color,\r\n                                   opacity: opacity,\r\n                                   transparent: (opacity < 1)})\r\n    this.el.appendChild(ring)\r\n\r\n    return ring\r\n  }\r\n})","\r\n// Component set on scene.\r\n// Tracks camera and maintains public data for\r\n// - cameraPostion\r\n// - cameraQuaternion\r\n// - barPosition\r\n// All as measured in rack space.\r\n\r\n// No implemented support for switching camera / multi-camera\r\n\r\n// as far as possible, we try to work in rack space.\r\n// In rack space, x is left-right and z is forward (+ve) and backward (-ve)\r\n// Typically this will not align with world space.\r\n\r\nAFRAME.registerComponent('bar-position', {\r\n  \r\n  init() {\r\n    // called once when component is added to an entity\r\n\r\n    // camera position & quaternion in Rack Space.  Updated every tick.\r\n    this.cameraPosition = new THREE.Vector3()\r\n    this.cameraQuaternion = new THREE.Quaternion()\r\n\r\n    // for working\r\n    this.tempQuaternion = new THREE.Quaternion()\r\n\r\n    // world position of rack.\r\n    this.rackEl = document.querySelector('#rack')\r\n    rack = this.rackEl.object3D\r\n    this.rackInverseTransform = new THREE.Matrix4()\r\n    rack.updateWorldMatrix()\r\n    this.rackInverseTransform.copy(rack.matrixWorld)\r\n    this.rackInverseTransform.invert()\r\n\r\n    // now if I apply rackInverseTransform to an object in worldSpace, I get it's transform in rack space.\r\n    // vector to track bar position, in rack-space.\r\n    // Public.\r\n    this.barPosition = new THREE.Vector3()\r\n    \r\n    this.barOffset = new THREE.Vector3()\r\n    // Potential for bar offset, but setting to zero for now.\r\n    // Plane visualization doesn't accoutn for this and would need to be updated if we added this back in.\r\n    //this.barOffset.set(0, -0.1, -0.2)\r\n    this.getCameraAndBarPosition()\r\n    \r\n  },\r\n\r\n  getCameraAndBarPosition() {\r\n\r\n    const position = this.cameraPosition\r\n    const quaternion = this.cameraQuaternion\r\n\r\n    this.el.sceneEl.camera.getWorldPosition(position);\r\n    this.el.sceneEl.camera.getWorldQuaternion(quaternion);\r\n\r\n    const rackInverseTransform = this.rackInverseTransform\r\n    position.applyMatrix4(rackInverseTransform)\r\n    this.tempQuaternion.setFromRotationMatrix(rackInverseTransform)\r\n    quaternion.multiply(this.tempQuaternion)\r\n\r\n    this.barPosition.addVectors(this.cameraPosition, this.barOffset)\r\n\r\n    // bar quaternion is assumed to always be the identity\r\n    // bar in standard orientation across the rack.\r\n  },\r\n\r\n  update() {\r\n    // called whenever component properties are updated\r\n\r\n  },\r\n\r\n  tick() {\r\n\r\n    this.getCameraAndBarPosition()\r\n  }\r\n})","const calibrationUIImages = {\r\n  start: '#calibration0',\r\n  bar: '#calibration1',\r\n  hooks: '#calibration2',\r\n  top: '#calibration3', \r\n  depth: '#calibration4',\r\n  safety: '#calibration5',\r\n  review: '#calibration6',\r\n  done: '#calibration7',\r\n}\r\n\r\nconst calibrationUISounds = {\r\n  start: '#sound1',\r\n  bar: '#sound4',\r\n  hooks: '#sound5',\r\n  top: '#sound7', \r\n  depth: '#sound8',\r\n  safety: '#sound9',\r\n  review: '#sound10',\r\n  done: '#sound11',\r\n}\r\n\r\nconst calibrationUIFollowOnSounds = {\r\n  start: '#sound2',\r\n  hooks: '#sound6',\r\n  top: '#sound6',\r\n  depth: '#sound6',\r\n  safety: '#sound6',\r\n  done: '#sound12',\r\n}\r\n\r\nconst calibrationUIFollowOnSounds2 = {\r\n  start: '#sound3'\r\n}\r\n\r\nAFRAME.registerComponent('calibration-flow', {\r\n\r\n  dependencies: ['bar-position'],\r\n\r\n  schema: {\r\n    skip: {default: false} // for testing: skip calibration & just set up with some defaults.\r\n  },\r\n\r\n  init() {\r\n\r\n    this.reachedHooks = this.reachedHooks.bind(this)\r\n    this.forwardEvent = this.forwardEvent.bind(this)\r\n    this.backEvent = this.backEvent.bind(this)\r\n    \r\n    this.el.addEventListener('click-forward', this.forwardEvent);\r\n    this.el.addEventListener('click-back', this.backEvent);\r\n    this.el.addEventListener('reached-hooks', this.reachedHooks);\r\n\r\n    // UI state\r\n    this.stage = 'start' // one of: start, hooks, top, depth, safety, review, done\r\n    \r\n    this.calibrationUI = document.getElementById('calibration-ui')\r\n\r\n    this.cameraWorldPosition = new THREE.Vector3()\r\n    this.cameraWorldQuaternion = new THREE.Quaternion()\r\n    this.forwardVector = new THREE.Vector3(0, 0, -1)\r\n    this.directionVector = new THREE.Vector3()\r\n\r\n    this.el.addEventListener('enter-vr', () => {\r\n      this.playSFX('#sfx-welcome')\r\n      setTimeout(() => this.playPrompt(this.stage), 5000)\r\n      \r\n      const video = document.querySelector('#video1')\r\n      if (video) {\r\n        video.play()\r\n      }\r\n    })\r\n\r\n    if (this.data.skip) {\r\n\r\n      this.el.setAttribute('bar-monitor', \r\n                            `topHeight: 1.6;\r\n                             targetDepth: 0.9;\r\n                             safetyPinHeight: 0.75`)\r\n\r\n      this.endCalibrationProcess()\r\n    }\r\n  },\r\n\r\n  update() {\r\n    this.updateUI()\r\n  },\r\n\r\n  remove() {\r\n    this.el.removeEventListener('click-forward', this.forwardEvent);\r\n    this.el.removeEventListener('click-back', this.backEvent);\r\n  },\r\n\r\n  beginCalibrationProcess() {\r\n\r\n    this.stage = 'start'\r\n    this.calibrationUI.object3D.visible = true\r\n    this.updateUI()\r\n\r\n  },\r\n\r\n  endCalibrationProcess() {\r\n    this.calibrationUI.object3D.visible = false\r\n    this.el.emit('calibration-complete')\r\n  },\r\n\r\n  getBarPosition() {\r\n\r\n    const component = this.el.components['bar-position']\r\n    return component.barPosition\r\n  },\r\n\r\n  moveToStage(stage) {\r\n\r\n    this.playPrompt(stage)\r\n    this.stage = stage\r\n    this.updateUI()\r\n  },\r\n\r\n  // equivalent function when moving back a stage...\r\n  moveBackToStage(stage) {\r\n\r\n    this.playPrompt(stage)\r\n    this.stage = stage\r\n    this.updateUI()\r\n  },\r\n\r\n  playPrompt(stage) {\r\n    const origin = document.getElementById('sound-origin')\r\n\r\n    origin.setAttribute('sound', {src: calibrationUISounds[stage], autoplay: true})\r\n    //origin.components.sound.playSound();\r\n\r\n    if (calibrationUIFollowOnSounds[stage]) {\r\n      setTimeout(() => {\r\n        origin.setAttribute('sound', {src: calibrationUIFollowOnSounds[stage], autoplay: true})\r\n        origin.components.sound.playSound();\r\n      }, 2000)\r\n    }\r\n\r\n    if (calibrationUIFollowOnSounds2[stage]) {\r\n      setTimeout(() => {\r\n        origin.setAttribute('sound', {src: calibrationUIFollowOnSounds2[stage], autoplay: true})\r\n        origin.components.sound.playSound();\r\n      }, 5000)\r\n    }\r\n  },\r\n\r\n  playSFX(src) {\r\n    const origin = document.getElementById('sfx-origin')\r\n\r\n    origin.setAttribute('sound', {src: '', autoplay: false})\r\n    origin.setAttribute('sound', {src: src, autoplay: true})\r\n  },\r\n\r\n  reachedHooks() {\r\n\r\n    // special case for step 6 -> 7 transition, based on reaching hooks again,\r\n    // not based on nods...\r\n\r\n    if (this.stage === 'review') {\r\n      this.playSFX('#sfx-interaction')\r\n      this.moveToStage('done')\r\n    }\r\n  },\r\n\r\n  forwardEvent() {\r\n\r\n    let yPos\r\n\r\n    switch (this.stage) {\r\n\r\n      case 'start':\r\n        // At this nod, we set the position of '#rack' to the current headset position (x & z co-ords only)\r\n        const rack = document.querySelector('#rack')\r\n        const position = this.cameraWorldPosition\r\n        const quaternion = this.cameraWorldQuaternion\r\n\r\n        this.el.sceneEl.camera.getWorldPosition(position);\r\n        this.el.sceneEl.camera.getWorldQuaternion(quaternion);\r\n        rack.object3D.position.x = position.x\r\n        rack.object3D.position.y = 0\r\n        rack.object3D.position.z = position.z\r\n\r\n        // rotate forward vector by quaternion, zero out y axis component, then find\r\n        // quaternion that rotates forward to this vector.\r\n        // That's the vector to use for the rack orientation\r\n        const forward = this.forwardVector\r\n        const direction = this.directionVector\r\n        direction.copy(forward)\r\n        direction.applyQuaternion(quaternion)\r\n        direction.y = 0\r\n        direction.normalize()\r\n\r\n        rack.object3D.quaternion.setFromUnitVectors(forward, direction)\r\n\r\n        this.moveToStage('bar')\r\n        this.playSFX('#sfx-interaction')\r\n        break\r\n\r\n      case 'bar':\r\n        // no data to record yet.\r\n        this.moveToStage('hooks')\r\n        this.playSFX('#sfx-interaction')\r\n        break\r\n\r\n      case 'hooks':\r\n        // new Vector3 to ensure update happens.\r\n        const pos = new THREE.Vector3()\r\n        pos.copy(this.getBarPosition())\r\n        this.el.setAttribute('bar-monitor', {hookPosition: pos})\r\n        this.moveToStage('top')\r\n\r\n        this.playSFX('#sfx-data-saved')\r\n        break\r\n  \r\n      case 'top':\r\n        ypos = this.getBarPosition().y\r\n        this.el.setAttribute('bar-monitor', {topHeight: ypos})\r\n        this.moveToStage('depth')\r\n        this.playSFX('#sfx-data-saved')\r\n        break\r\n\r\n      case 'depth':\r\n        ypos = this.getBarPosition().y\r\n        this.el.setAttribute('bar-monitor', {targetDepth: ypos})\r\n        this.moveToStage('safety')\r\n        this.playSFX('#sfx-data-saved')\r\n        break\r\n\r\n      case 'safety':\r\n        ypos = this.getBarPosition().y\r\n        this.el.setAttribute('bar-monitor', {safetyPinHeight: ypos})\r\n        this.moveToStage('review')\r\n        this.playSFX('#sfx-data-saved')\r\n        break\r\n\r\n      case 'review':\r\n        // No action\r\n        // Final move step 6 -> 7 is based on 'reached-hooks' event\r\n        // but can also use forward button\r\n        this.moveToStage('done')\r\n        this.playSFX('#sfx-interaction')\r\n        break\r\n\r\n      case 'done':\r\n        this.endCalibrationProcess()\r\n        this.playSFX('#sfx-interaction')\r\n        break\r\n\r\n      default:\r\n        console.error(\"Hit Forward in unexpected state: \", this.stage)\r\n        break\r\n    }\r\n  },\r\n\r\n  backEvent() {\r\n\r\n    switch (this.stage) {\r\n\r\n      case 'start':\r\n        // no effect\r\n        break\r\n\r\n      case 'bar':\r\n        this.moveBackToStage('start')\r\n        this.playSFX('#sfx-data-reoved')\r\n        break\r\n\r\n      case 'hooks':\r\n        this.moveBackToStage('bar')\r\n        this.playSFX('#sfx-data-reoved')\r\n        break\r\n  \r\n      case 'top':\r\n        this.moveBackToStage('hooks')\r\n        this.playSFX('#sfx-data-reoved')\r\n        break\r\n\r\n      case 'depth':\r\n        this.moveBackToStage('top')\r\n        this.playSFX('#sfx-data-reoved')\r\n        break\r\n\r\n      case 'safety':\r\n        this.moveBackToStage('depth')\r\n        this.playSFX('#sfx-data-reoved')\r\n        break\r\n\r\n      case 'review':\r\n        this.moveBackToStage('safety')\r\n        this.playSFX('#sfx-data-reoved')\r\n        break\r\n\r\n      case 'done':\r\n        this.moveBackToStage('review')\r\n        this.playSFX('#sfx-data-reoved')\r\n        break\r\n         \r\n      default:\r\n        console.error(\"Hit Back in unexpected state: \", this.stage)\r\n        break\r\n    }\r\n  },\r\n\r\n  updateUI() {\r\n\r\n    const forward = true // always a forward button\r\n    const back = (this.stage !== 'start')\r\n\r\n    this.calibrationUI.setAttribute('calibration-ui',\r\n                                     {saving: this.saving,\r\n                                      deleting: this.deleting,\r\n                                      forwardButton: forward,\r\n                                      backButton: back,\r\n                                      imageSelector: calibrationUIImages[this.stage]})\r\n  }\r\n})\r\n\r\nAFRAME.registerComponent('calibration-ui', {\r\n\r\n  schema: {\r\n    imageSelector: {type: 'string'},\r\n    fowardButton: {default: false}, \r\n    backButton: {default: false}\r\n  },\r\n\r\n  init() {\r\n    this.circle = document.createElement('a-entity')\r\n    this.circle.setAttribute('geometry', 'primitive: circle; radius: 1; segments: 128')\r\n    this.circle.setAttribute('material', 'color: white; opacity: 0.8; transparent: true')\r\n    this.el.appendChild(this.circle)\r\n  },\r\n\r\n  update() {\r\n\r\n    this.deleteImage()\r\n    if (this.data.imageSelector) {\r\n   \r\n      this.createImage(this.circle, this.data.imageSelector, 2)\r\n    }\r\n\r\n    this.deleteButtons() \r\n    this.createButtons()\r\n  },\r\n\r\n  createButtons() {\r\n\r\n    if (this.data.forwardButton && !this.data.backButton) {\r\n      this.forwardButton = this.createButton(0, -1, '#check', 'click-forward')\r\n    }\r\n\r\n    if (!this.data.forwardButton && this.data.backButton) {\r\n      this.backButton = this.createButton(0, -1, '#cross', 'click-back')\r\n    }\r\n\r\n    if (this.data.forwardButton && this.data.backButton) {\r\n      this.forwardButton = this.createButton(0.4, -1, '#check', 'click-forward')\r\n      this.backButton = this.createButton(-0.4, -1, '#cross', 'click-back')\r\n    }\r\n  },\r\n\r\n  createButton(x, y, imageSrc, eventName) {\r\n\r\n    button = document.createElement('a-entity')\r\n    button.object3D.position.x = x\r\n    button.object3D.position.y = y\r\n    button.object3D.position.z = 0.001\r\n    button.setAttribute('animated-button', {imageSrc: imageSrc, eventName: eventName})\r\n    this.circle.appendChild(button)\r\n\r\n    return button\r\n  },\r\n\r\n  deleteButtons() {\r\n\r\n    deleteButton = (el) => {\r\n      if (el && el.parentNode) {\r\n        el.parentNode.removeChild(el)\r\n      }\r\n    }\r\n    deleteButton(this.forwardButton)\r\n    deleteButton(this.backButton)\r\n    this.forwardButton = null\r\n    this.backButton = null\r\n  },\r\n\r\n  createImage(parent, src, dimension) {\r\n\r\n    this.image = document.createElement('a-image')\r\n    this.image.setAttribute('alpha-test', 0.1)\r\n    this.image.setAttribute('width', dimension)\r\n    this.image.setAttribute('height', dimension)\r\n    this.image.setAttribute('transparent', true)\r\n    this.image.object3D.position.z = 0.001\r\n    this.image.setAttribute('src', src)\r\n    parent.appendChild(this.image)\r\n\r\n  },\r\n\r\n  deleteImage() {\r\n\r\n    if (this.image) {\r\n      this.image.parentNode.removeChild(this.image)\r\n      this.image = null\r\n    }\r\n  }\r\n});\r\n\r\nAFRAME.registerComponent('animated-button', {\r\n\r\n  schema: {\r\n    imageSrc : {type: 'string'},\r\n    eventName: {type: 'string'}\r\n  },\r\n\r\n  init() {\r\n\r\n    const button = document.createElement('a-entity')\r\n    button.setAttribute('geometry', 'primitive: circle; radius: 0.28; segments: 128')\r\n    button.setAttribute('material', 'color: white; shader: flat')\r\n    button.classList.add('clickable');\r\n    this.el.appendChild(button)\r\n  \r\n    const ring = document.createElement('a-ring')\r\n    ring.setAttribute('radius-inner', 0.28)\r\n    ring.setAttribute('radius-outer', 0.29)\r\n    ring.setAttribute('segments-theta', 128)\r\n    ring.setAttribute('segments-phi', 1)\r\n    ring.setAttribute('material', 'color: grey; shader: flat')\r\n    ring.object3D.position.z = 0.001\r\n    button.appendChild(ring)\r\n  \r\n    this.createImage(button, this.data.imageSrc, 0.3)\r\n  \r\n    const animatedRing = document.createElement('a-ring')\r\n    animatedRing.setAttribute('radius-inner', 0.25)\r\n    animatedRing.setAttribute('radius-outer', 0.32)\r\n    animatedRing.setAttribute('segments-theta', 128)\r\n    animatedRing.setAttribute('segments-phi', 1)\r\n    animatedRing.setAttribute('theta-start', 90)\r\n    animatedRing.setAttribute('theta-length', 0)\r\n    animatedRing.setAttribute('scale', '-1 1 1')\r\n    animatedRing.setAttribute('material', 'color: grey; shader: flat')\r\n  \r\n    animatedRing.object3D.position.z = 0.001\r\n    ring.appendChild(animatedRing)\r\n  \r\n    button.addEventListener('fusing', () => {\r\n      animatedRing.setAttribute('animation', {property: 'geometry.thetaLength',\r\n                                              from: 0,\r\n                                              to: 360,\r\n                                              dur: 1150,\r\n                                              easing: 'easeInQuad'})\r\n    })\r\n  \r\n    button.addEventListener('mouseleave', () => {\r\n      animatedRing.removeAttribute('animation')\r\n      animatedRing.setAttribute('geometry', 'thetaLength: 0')\r\n    })\r\n  \r\n    button.addEventListener('click', () => {\r\n      this.el.sceneEl.emit(this.data.eventName)\r\n    })\r\n  },\r\n\r\n  createImage(parent, src, dimension) {\r\n\r\n    this.image = document.createElement('a-image')\r\n    this.image.setAttribute('alpha-test', 0.1)\r\n    this.image.setAttribute('width', dimension)\r\n    this.image.setAttribute('height', dimension)\r\n    this.image.setAttribute('transparent', true)\r\n    this.image.object3D.position.z = 0.001\r\n    this.image.setAttribute('src', src)\r\n    parent.appendChild(this.image)\r\n\r\n  }\r\n\r\n})\r\n\r\n","AFRAME.registerComponent('inside-rack-ui', {\r\n\r\n  schema: {\r\n    totalReps: {default: 5},\r\n    repsToGo: {default: 5},\r\n    width: {default: 4},\r\n    message: {default: ''}\r\n  },\r\n\r\n  init() {\r\n\r\n    this.reps = []\r\n\r\n    for (let ii = 0; ii < this.data.totalReps; ii++) {\r\n      const rep = document.createElement('a-entity')\r\n      rep.setAttribute('rep-report', {repNumber: ii})\r\n      const reps = this.data.totalReps\r\n      rep.object3D.position.x = (ii - (reps - 1) / 2) * (this.data.width / this.data.totalReps)\r\n      this.el.appendChild(rep)\r\n      this.reps.push(rep)\r\n    }\r\n\r\n    this.repReport = this.repReport.bind(this)\r\n\r\n    this.el.sceneEl.addEventListener('rep-report', this.repReport)\r\n\r\n  },\r\n\r\n  repReport(e) {\r\n\r\n    const data = e.detail\r\n    const {repNumber, completed, failed} = data\r\n\r\n    console.log(\"Rep Report\", data)\r\n\r\n    const rep = this.reps[repNumber]\r\n\r\n    if (!rep) return // user doing more reps than specified!  We don't report them.\r\n\r\n    let status\r\n\r\n    if (completed) {\r\n      status = failed ? 'failed' : 'done'\r\n    }\r\n    else {\r\n      status = 'doing'\r\n    }\r\n    rep.setAttribute('rep-report', {repNumber: repNumber,\r\n                                    status: status,\r\n                                    restPrior: data.restPrior / 1000, // msecs -> secs\r\n                                    timeDown: data.timeDown / 1000, // msecs -> secs\r\n                                    depth: -data.depth * 100, // m -> cm, flip sign.\r\n                                    timeUp: data.timeUp / 1000, // msecs -> secs\r\n                                    turnSpeed: data.turnSpeed,\r\n                                    daviationLR: data.deviationLR, \r\n                                    deviationFB: data.deviationFB})\r\n  }\r\n});\r\n\r\nconst reportStats = [\r\n  {key: 'restPrior', label: 'Rest', units: 's'},\r\n  {key: 'timeDown', label: 'Rest', units: 's'},\r\n  {key: 'depth', label: 'Rest', units: 'cm'},\r\n  {key: 'timeUp', label: 'Rest', units: 's'}\r\n]\r\n\r\nAFRAME.registerComponent('rep-report', {\r\n  schema: {\r\n    repNumber: { type: 'number'},\r\n    status: { type: 'string', default: 'todo'}, // one of: todo, doing, done, failed\r\n    restPrior: {type: 'number'},\r\n    timeDown: {type: 'number'},\r\n    depth: {type: 'number'},\r\n    timeUp: {type: 'number'},\r\n    turnSpeed: {type: 'number'},\r\n    deviationLR: {type: 'number'},\r\n    deviationFB: {type: 'number'}\r\n  }, \r\n\r\n  init() {\r\n\r\n    this.circle = document.createElement('a-circle')\r\n    this.circle.setAttribute('radius', 0.3)\r\n    this.circle.setAttribute('material', {opacity: 0.8, transparent: true})\r\n    this.circle.object3D.position.y = 0.5\r\n    this.el.appendChild(this.circle)\r\n\r\n    this.number = document.createElement('a-entity')\r\n    this.number.setAttribute('text', {color: 'black',\r\n                                      wrapCount: 5,\r\n                                      value: this.data.repNumber + 1,\r\n                                      align: 'center'})\r\n    this.circle.appendChild(this.number)\r\n\r\n    this.childStats = []\r\n  },\r\n\r\n  update() {\r\n\r\n    this.deleteImage()\r\n\r\n    let imgSrc\r\n    const status = this.data.status\r\n    if (status === 'done') {\r\n      imgSrc = '#check'\r\n    }\r\n    if (status === 'failed') {\r\n      imgSrc = '#cross'\r\n    }\r\n    if (imgSrc) {\r\n      this.createImage(this.circle, imgSrc, 0.4)\r\n    }\r\n\r\n    if (status === 'todo' || status === 'doing') {\r\n      this.number.object3D.visible = true\r\n    }\r\n    else {\r\n      this.number.object3D.visible = false\r\n    }\r\n\r\n    this.deleteReportStats()\r\n\r\n    reportStats.forEach((stat, index) => {\r\n      const {key, units} = stat\r\n\r\n      if (this.data[key]) {\r\n        const child = document.createElement('a-entity')\r\n        child.setAttribute('rep-report-stat', {\r\n          value: this.data[key],\r\n          ypos: -0.2 - (index * 0.7),\r\n          units: units\r\n        })\r\n        this.el.appendChild(child)\r\n        this.childStats.push(child)\r\n      }\r\n    })\r\n  },\r\n\r\n  deleteReportStats() {\r\n    this.childStats.forEach((el) => {\r\n      el.parentNode.removeChild(el)\r\n    })\r\n    this.childStats = []\r\n  },\r\n\r\n  createImage(parent, src, dimension) {\r\n\r\n    this.image = document.createElement('a-image')\r\n    this.image.setAttribute('alpha-test', 0.1)\r\n    this.image.setAttribute('width', dimension)\r\n    this.image.setAttribute('height', dimension)\r\n    this.image.setAttribute('transparent', true)\r\n    this.image.object3D.position.z = 0.001\r\n    this.image.setAttribute('src', src)\r\n    parent.appendChild(this.image)\r\n\r\n  },\r\n\r\n  deleteImage() {\r\n\r\n    if (this.image) {\r\n      this.image.parentNode.removeChild(this.image)\r\n      this.image = null\r\n    }\r\n  }\r\n})\r\n\r\n\r\nAFRAME.registerComponent('rep-report-stat', {\r\n  schema: {\r\n    value: { type: 'number'},\r\n    ypos: {type: 'number'},\r\n    units: {type: 'string'}\r\n  }, \r\n\r\n  init() {\r\n\r\n    this.circle = document.createElement('a-circle')\r\n    this.circle.setAttribute('radius', 0.3)\r\n    this.circle.setAttribute('material', {opacity: 0.8, transparent: true, color: 'white'})\r\n    this.circle.object3D.position.y = this.data.ypos\r\n    this.el.appendChild(this.circle)\r\n\r\n    this.number = document.createElement('a-entity')\r\n\r\n    this.circle.appendChild(this.number)\r\n  },\r\n\r\n  update() {\r\n    const numberText = this.data.value.toFixed(1) + this.data.units\r\n    this.number.removeAttribute('text')\r\n    this.number.setAttribute('text', {color: 'black',\r\n                                      wrapCount: 10,\r\n                                      value: numberText,\r\n                                      align: 'center'})\r\n    \r\n    if (this.data.value < 0) {\r\n      this.circle.setAttribute('material', {color: 'orange'})\r\n    }\r\n    else {\r\n      this.circle.setAttribute('material', {color: 'white'})\r\n    }\r\n  }\r\n})\r\n","/* global: Peer */\r\nimport { Peer } from \"peerjs\";\r\n\r\nif (window.location.href.includes(\"phone.html\")) {\r\n  const peer = new Peer();\r\n\r\n  const conn = peer.connect(\"squatmaster-oculus\");\r\n  conn.on(\"open\", () => {\r\n    conn.send(\"hi!\");\r\n    console.log(\"Sending hi!\")\r\n  });\r\n\r\n  navigator.mediaDevices.getUserMedia({video: true, audio: true})\r\n  .then((stream) => {\r\n    let call = peer.call(\"squatmaster-oculus\", stream);\r\n    call.on('stream', renderVideo);\r\n  })\r\n  .catch((err) => {\r\n    console.log('Failed to get local stream', err);\r\n  });\r\n\r\n}\r\n\r\n","AFRAME.registerGeometry('squatRack', {\r\n\r\n  schema: {\r\n    schema: {\r\n      width: {default: 1},\r\n      depth: {default: 1},\r\n      frontHeight: {default: 2.2},\r\n      rearHeight: {default: 1.8},\r\n      frameWidth: {default: 0.08},\r\n      hookRadiusSmall: {default: 0.02},\r\n      hookRadiusLarge: {default: 0.04},\r\n      hookDepth: {default: 0.08},\r\n      hookHeight: {default: 1.5},\r\n      safetyHeight: {default: 0.75},\r\n      safetyRadius: {default: 0.02},\r\n    },\r\n  },\r\n\r\n  init(data) {\r\n    const geometries = []\r\n    let geometry\r\n\r\n    // Origin of rack is center of rack, at floor level.\r\n\r\n    // post, back left\r\n    geometry = new THREE.BoxGeometry(data.frameWidth, data.rearHeight, data.frameWidth)\r\n    geometry.translate(-data.width / 2, data.rearHeight / 2, data.depth / 2)\r\n    geometries.push(geometry)\r\n\r\n    // post, back right\r\n    geometry = new THREE.BoxGeometry(data.frameWidth, data.rearHeight, data.frameWidth)\r\n    geometry.translate(data.width / 2, data.rearHeight / 2, data.depth / 2)\r\n    geometries.push(geometry)\r\n\r\n    // post, front left\r\n    geometry = new THREE.BoxGeometry(data.frameWidth, data.frontHeight, data.frameWidth)\r\n    geometry.translate(-data.width / 2, data.frontHeight / 2, -data.depth / 2)\r\n    geometries.push(geometry)\r\n\r\n    // post, back right\r\n    geometry = new THREE.BoxGeometry(data.frameWidth, data.frontHeight, data.frameWidth)\r\n    geometry.translate(data.width / 2, data.frontHeight / 2, -data.depth / 2)\r\n    geometries.push(geometry)\r\n\r\n    // hooks...\r\n    // left hook\r\n    geometry = new THREE.CylinderGeometry(data.hookRadiusSmall,\r\n                                          data.hookRadiusSmall,\r\n                                          data.hookDepth)\r\n    geometry.rotateX(Math.PI/2)\r\n    geometry.translate(-data.width / 2, data.hookHeight, -data.depth / 2 + data.hookDepth / 2)\r\n    geometries.push(geometry)\r\n\r\n    geometry = new THREE.CylinderGeometry(data.hookRadiusLarge,\r\n                                          data.hookRadiusLarge,\r\n                                          0.01)\r\n                                          geometry.rotateX(Math.PI/2)\r\n    geometry.translate(-data.width / 2, data.hookHeight, -data.depth / 2 + data.hookDepth)\r\n    geometries.push(geometry)\r\n\r\n    // right hook\r\n    geometry = new THREE.CylinderGeometry(data.hookRadiusSmall,\r\n                                          data.hookRadiusSmall,\r\n                                          data.hookDepth)\r\n    geometry.rotateX(Math.PI/2)\r\n    geometry.translate(data.width / 2, data.hookHeight, -data.depth / 2 + data.hookDepth / 2)\r\n    geometries.push(geometry)\r\n\r\n    geometry = new THREE.CylinderGeometry(data.hookRadiusLarge,\r\n                                          data.hookRadiusLarge,\r\n                                          0.01)\r\n                                          geometry.rotateX(Math.PI/2)\r\n    geometry.translate(data.width / 2, data.hookHeight, -data.depth / 2 + data.hookDepth)\r\n    geometries.push(geometry)\r\n\r\n    // left safety pin\r\n    geometry = new THREE.CylinderGeometry(data.safetyRadius,\r\n                                          data.safetyRadius,\r\n                                          data.depth)\r\n    geometry.rotateX(Math.PI/2)\r\n    geometry.translate(-data.width / 2, data.safetyHeight, 0)\r\n    geometries.push(geometry)\r\n\r\n    // right safety pin\r\n    geometry = new THREE.CylinderGeometry(data.safetyRadius,\r\n                                          data.safetyRadius,\r\n                                          data.depth)\r\n    geometry.rotateX(Math.PI/2)\r\n    geometry.translate(data.width / 2, data.safetyHeight, 0)\r\n    geometries.push(geometry)\r\n\r\n    this.geometry = THREE.BufferGeometryUtils.mergeBufferGeometries(geometries);\r\n  }\r\n\r\n})\r\n\r\nAFRAME.registerComponent('squat-rack', {\r\n\r\n  schema: {\r\n    width: {default: 1},\r\n    depth: {default: 1},\r\n    frontHeight: {default: 2.2},\r\n    rearHeight: {default: 1.8},\r\n    frameWidth: {default: 0.08},\r\n    hookRadiusSmall: {default: 0.02},\r\n    hookRadiusLarge: {default: 0.04},\r\n    hookDepth: {default: 0.08},\r\n    hookHeight: {default: 1.4},\r\n    safetyHeight: {default: 0.65},\r\n    safetyRadius: {default: 0.02},\r\n  },\r\n\r\n  init() {\r\n\r\n    this.el.setAttribute('geometry', {primitive: 'squatRack', \r\n                                      width: this.data.width,\r\n                                      depth: this.data.depth,\r\n                                      frontHeight: this.data.frontHeight,\r\n                                      rearHeight: this.data.rearHeight,\r\n                                      frameWidth: this.data.frameWidth,\r\n                                      hookRadiusSmall: this.data.hookRadiusSmall,\r\n                                      hookRadiusLarge: this.data.hookRadiusLarge,\r\n                                      hookDepth: this.data.hookDepth,\r\n                                      hookHeight: this.data.hookHeight,\r\n                                      safetyHeight: this.data.safetyHeight,\r\n                                      safetyRadius: this.data.safetyRadius})\r\n\r\n    this.el.setAttribute('material', {color: '#333'})\r\n  }\r\n})","// Top-level UI component that manages visibility of other UIs\r\nAFRAME.registerComponent('ui-manager', {\r\n\r\n  init() {\r\n    this.state = {\r\n      calibrated: false,\r\n      inRack: false,\r\n    }\r\n\r\n    this.calibrationComplete = this.calibrationComplete.bind(this)\r\n    this.enteredRack = this.enteredRack.bind(this)\r\n    this.exitedRack = this.exitedRack.bind(this)\r\n    this.el.addEventListener('calibration-complete', this.calibrationComplete)\r\n    this.el.addEventListener('entered-rack', this.enteredRack);\r\n    this.el.addEventListener('exited-rack', this.exitedRack);\r\n\r\n\r\n    this.calibrationUI = document.getElementById('calibration-ui')\r\n    this.insideRackUI = document.getElementById('inside-rack-ui')\r\n    this.outsideRackUI = document.getElementById('outside-rack-ui')\r\n    this.cursor = document.getElementById('cursor')\r\n    this.videoFrame = document.getElementById('video-frame')\r\n\r\n    this.updateUIs()\r\n  },\r\n\r\n  calibrationComplete() {\r\n    this.state.calibrated = true\r\n    this.updateUIs()\r\n  },\r\n\r\n  enteredRack() {\r\n    this.state.inRack = true\r\n    this.updateUIs()\r\n  },\r\n\r\n  exitedRack() {\r\n    this.state.inRack = false\r\n    this.updateUIs()\r\n  },\r\n\r\n  updateUIs() {\r\n\r\n    updateVisibility = (el, visible) => {\r\n      if (el && el.object3D) {\r\n        el.object3D.visible = visible\r\n      }\r\n    }\r\n\r\n    if (this.state.calibrated) {\r\n\r\n      if (this.state.inRack) {\r\n        updateVisibility(this.calibrationUI, false)\r\n        updateVisibility(this.insideRackUI, true)\r\n        updateVisibility(this.outsideRackUI, false)\r\n      }\r\n      else {\r\n        updateVisibility(this.calibrationUI, false)\r\n        updateVisibility(this.insideRackUI, false)\r\n        updateVisibility(this.outsideRackUI, true)\r\n      }\r\n\r\n      updateVisibility(this.cursor, false)\r\n    }\r\n    else {\r\n      updateVisibility(this.calibrationUI, true)\r\n      updateVisibility(this.insideRackUI, false)\r\n      updateVisibility(this.outsideRackUI, false)\r\n      updateVisibility(this.cursor, true)\r\n    }\r\n\r\n    if (this.state.inRack) {\r\n      updateVisibility(this.videoFrame, true)\r\n    }\r\n    else {\r\n      updateVisibility(this.videoFrame, false)\r\n    }\r\n  }\r\n})","// Configure on scene.\r\n\r\n// Updates UI component(s) to display rep status\r\n\r\nAFRAME.registerComponent('ui-updater', {\r\n\r\n  dependencies: ['bar-position', 'bar-monitor'],\r\n\r\n  init() {\r\n\r\n    this.reachedHooks = this.reachedHooks.bind(this)\r\n    this.leftHooks = this.leftHooks.bind(this)\r\n    this.shoulderedBar = this.shoulderedBar.bind(this)\r\n    this.returnedBar = this.returnedBar.bind(this)\r\n    this.hitTop = this.hitTop.bind(this)\r\n    this.loweredFromTop = this.loweredFromTop.bind(this)\r\n    this.hitTargetDepth = this.hitTargetDepth.bind(this)\r\n    this.upwardsFromTargetDepth = this.upwardsFromTargetDepth.bind(this)\r\n    this.belowSafetyPins = this.belowSafetyPins.bind(this)\r\n    this.bailedOut = this.bailedOut.bind(this)\r\n\r\n    this.el.addEventListener('reached-hooks', this.reachedHooks);\r\n    this.el.addEventListener('left-hooks', this.leftHooks);\r\n    this.el.addEventListener('shouldered-bar', this.shoulderedBar);\r\n    this.el.addEventListener('returned-bar', this.returnedBar);\r\n    this.el.addEventListener('hit-top', this.hitTop);\r\n    this.el.addEventListener('lowered-from-top', this.loweredFromTop);\r\n    this.el.addEventListener('hit-target-depth', this.hitTargetDepth);\r\n    this.el.addEventListener('upwards-from-target-depth', this.upwardsFromTargetDepth);\r\n    this.el.addEventListener('below-safety-pins', this.belowSafetyPins);\r\n    this.el.addEventListener('bailed-out', this.bailedOut);\r\n\r\n    this.state = {\r\n      repPhase: 'none',  // one of: none, ready, down, up, rest\r\n      repNumber: 0,\r\n      repsToGo: 5,\r\n      shutUp: false, // set to stop coaching on the set.\r\n      minHeightThisRep: 1000\r\n    }\r\n\r\n    this.timestamps = {\r\n      finishedLast: undefined,\r\n      beganRep: undefined,\r\n      hitDepth: undefined,\r\n      hitBottom: undefined,\r\n      finishedRep: undefined\r\n    }\r\n\r\n    this.insideRackUI = document.querySelector('#inside-rack-ui')\r\n    this.outsideRackUI = document.querySelector('#outside-rack-ui')\r\n\r\n    this.repData = {\r\n      repNumber: 0,\r\n      completed: false,\r\n      failed: false,\r\n      restPrior: undefined,\r\n      timeDown: undefined,\r\n      depth: undefined,\r\n      timeUp: undefined,\r\n      turnSpeed: undefined, // TO DO\r\n      deviationLR: undefined, // TO DO\r\n      deviationFB: undefined  // TO DO\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    this.el.removeEventListener('reached-hooks', this.reachedHooks);\r\n    this.el.removeEventListener('left-hooks', this.leftHooks);\r\n    this.el.removeEventListener('shouldered-bar', this.shoulderedBar);\r\n    this.el.removeEventListener('returned-bar', this.returnedBar);\r\n    this.el.removeEventListener('hit-top', this.hitTop);\r\n    this.el.removeEventListener('lowered-from-top', this.loweredFromTop);\r\n    this.el.removeEventListener('hit-target-depth', this.hitTargetDepth);\r\n    this.el.removeEventListener('upwards-from-target-depth', this.upwardsFromTargetDepth);\r\n    this.el.removeEventListener('below-safety-pins', this.belowSafetyPins);\r\n    this.el.removeEventListener('bailed-out', this.bailedOut);\r\n  },\r\n\r\n  setTargetReps(repCount) {\r\n\r\n    this.state.repsToGo = repCount\r\n    this.insideRackUI.setAttribute('inside-rack-ui', {repsToGo: this.state.repsToGo})\r\n  },\r\n\r\n  repCompleted(success) {\r\n\r\n    // don't count any reps prior to calibration\r\n    const state = this.el.sceneEl.components['ui-manager'].state\r\n    if (!state.calibrated) return\r\n\r\n    this.timestamps.finishedRep = Date.now()\r\n\r\n    this.repData.completed = true\r\n    this.repData.failed = !success\r\n    this.repData.repNumber = this.state.repNumber\r\n    this.repData.timeUp = this.timestamps.finishedRep - this.timestamps.hitBottom\r\n    this.reportRep()\r\n    \r\n    this.state.repsToGo--\r\n    this.state.repNumber++\r\n    this.insideRackUI.setAttribute('inside-rack-ui', {repsToGo: this.state.repsToGo})\r\n\r\n    // set up state for tracking next rep\r\n    this.state.minHeightThisRep = 1000\r\n    this.timestamps.finishedLast = Date.now()\r\n  },\r\n\r\n  reportRep() {\r\n    const state = this.el.sceneEl.components['ui-manager'].state\r\n    if (!state.calibrated) return\r\n    this.el.emit('rep-report', this.repData)\r\n  },\r\n\r\n  reachedHooks() {\r\n    this.setMessage('Take weight of bar')\r\n  },\r\n\r\n  leftHooks() {\r\n    // no update needed\r\n  },\r\n\r\n  shoulderedBar() {\r\n    this.setMessage('Step Back')\r\n  },\r\n\r\n  returnedBar() {\r\n    this.setMessage('Finished!')\r\n  },\r\n\r\n  setMessage(message) {\r\n    this.insideRackUI.setAttribute('inside-rack-ui', {message: message})\r\n  },\r\n\r\n  hitTop() {\r\n\r\n    // one of: none, ready, down, up, rest\r\n    switch (this.state.repPhase) {\r\n\r\n      case 'none':\r\n        this.state.repPhase = 'ready'\r\n        this.setMessage('Ready!')\r\n        this.playPrompt('#sound-here-we-go')\r\n        // track time, count this as \"rest\" start for rep 1\r\n        this.timestamps.finishedLast = Date.now()\r\n        break\r\n\r\n      case 'down':\r\n        this.state.repPhase = 'rest'\r\n        this.setMessage('Incomplete Rep')\r\n        this.playPrompt('#sound-not-quite')\r\n\r\n        // Only report rep data if calibration completed...\r\n        this.repData.repNumber = this.state.repNumber\r\n        const targetDepth = this.el.sceneEl.components['bar-monitor'].data.targetDepth\r\n        this.repData.depth = this.state.minHeightThisRep - targetDepth\r\n        this.reportRep()\r\n\r\n        // wipe data about previous effort at depth.\r\n        this.state.minHeightThisRep = 1000\r\n        break\r\n\r\n      case 'up':\r\n        this.state.repPhase = 'rest'\r\n        this.setMessage('Rep Complete')\r\n        this.repCompleted(true)\r\n        if (this.state.repsToGo === 0) {\r\n          this.playPrompt('#sound-good-job')\r\n          this.state.shutUp = true\r\n        }\r\n        else if (this.state.repsToGo === 1) {\r\n          this.playPrompt('#sound-last-one') \r\n        }\r\n        else {\r\n          this.playPrompt('#sound-nice')\r\n        }\r\n        break\r\n\r\n      default: \r\n        console.error(\"Hit Top in unexpected state: \", this.state.repPhase)\r\n    }\r\n  },\r\n\r\n  loweredFromTop() {\r\n\r\n    // one of: none, ready, down, up, rest\r\n    switch (this.state.repPhase) {\r\n\r\n      case 'none':\r\n        this.setMessage('Stand Taller before beginning reps')\r\n        break\r\n\r\n      case 'ready':\r\n      case 'rest':\r\n        this.state.repPhase = 'down'\r\n        this.setMessage('Going down...')\r\n        this.timestamps.beganRep = Date.now()\r\n\r\n        // 1st set of data for new rep.\r\n        this.repData.repNumber = this.state.repNumber\r\n        this.repData.completed = false\r\n        this.repData.failed = false\r\n        this.repData.restPrior = this.timestamps.beganRep - this.timestamps.finishedLast\r\n        this.repData.timeDown = undefined\r\n        this.repData.depth = undefined\r\n        this.repData.timeUp = undefined\r\n        this.repData.turnSpeed = undefined\r\n        this.repData.deviationLR = undefined\r\n        this.repData.deviationFB = undefined\r\n        this.reportRep()\r\n        break\r\n\r\n      case 'up':\r\n        this.setMessage('Stand at full height to complete last Rep!')\r\n        break\r\n\r\n      default: \r\n        console.error(\"Lowered From Top in unexpected state: \", this.state.repPhase)\r\n    }\r\n\r\n  },\r\n\r\n  hitTargetDepth() {\r\n\r\n    // one of: none, ready, down, up, rest\r\n    switch (this.state.repPhase) {\r\n\r\n      case 'none':\r\n        this.setMessage('Stand at full height before beginning reps')\r\n        break\r\n\r\n      case 'down':\r\n        this.setMessage('Hit Depth!')\r\n        this.playSFX('#sfx-hit-depth')\r\n        this.state.repPhase = 'up'\r\n        this.timestamps.hitDepth = Date.now()\r\n\r\n        this.repData.timeDown = this.timestamps.hitDepth - this.timestamps.beganRep\r\n        this.reportRep()\r\n        break\r\n  \r\n      case 'up':\r\n        this.setMessage('Push up to complete this rep!')\r\n        break\r\n\r\n      default: \r\n        console.error(\"Lowered From Top in unexpected state: \", this.state.repPhase)\r\n    }\r\n  },\r\n\r\n  upwardsFromTargetDepth() {\r\n\r\n    // one of: none, ready, down, up, rest\r\n    switch (this.state.repPhase) {\r\n\r\n      case 'up':\r\n        // assume we now hit our lowest point.\r\n        const targetDepth = this.el.sceneEl.components['bar-monitor'].data.targetDepth\r\n        this.repData.depth = this.state.minHeightThisRep - targetDepth\r\n        this.reportRep()\r\n\r\n        break\r\n\r\n      default: \r\n        console.error(\"Upwards from Target Depth in unexpected state: \", this.state.repPhase)\r\n    }\r\n  },\r\n\r\n  belowSafetyPins() {\r\n\r\n    this.setMessage('Failed set.  Step out of rack and remove weight plates from bar.')\r\n\r\n  },\r\n\r\n  bailedOut() {\r\n    this.repCompleted(false)\r\n    this.setMessage('Failed set.  Step out of rack and remove weight plates from bar.')\r\n  },\r\n\r\n  playPrompt(src) {\r\n\r\n    // don't play these clips until calibration is done.\r\n    const state = this.el.sceneEl.components['ui-manager'].state\r\n    if (!state.calibrated) return\r\n\r\n    // don't play clips when no reps remaining\r\n    if (this.state.shutUp) return\r\n\r\n    const origin = document.getElementById('sound-origin')\r\n\r\n    origin.removeAttribute('sound')\r\n    origin.setAttribute('sound', {src: src, autoplay: true})\r\n  },\r\n\r\n  playSFX(src) {\r\n\r\n    // don't play these clips until calibration is done.\r\n    const state = this.el.sceneEl.components['ui-manager'].state\r\n    if (!state.calibrated) return\r\n    \r\n    const origin = document.getElementById('sfx-origin')\r\n\r\n    origin.setAttribute('sound', {src: '', autoplay: false})\r\n    origin.setAttribute('sound', {src: src, autoplay: true})\r\n  },\r\n\r\n  tick() {\r\n    barPosition = this.el.sceneEl.components['bar-position'].barPosition\r\n\r\n    if (barPosition.y < this.state.minHeightThisRep) {\r\n      this.state.minHeightThisRep = barPosition.y\r\n      this.timestamps.hitBottom = Date.now() // should be accurate by end of rep!\r\n    }\r\n  }\r\n\r\n})\r\n","AFRAME.registerComponent('vertical-controls', {\r\n\r\n  init() {\r\n\r\n    this.verticalVelocity = 0\r\n    this.verticalAcceleration = 0\r\n\r\n    this.keyDown = this.keyDown.bind(this)\r\n    this.keyUp = this.keyUp.bind(this)\r\n\r\n    window.addEventListener('keydown', this.keyDown)\r\n    window.addEventListener('keyup', this.keyUp)\r\n  },\r\n\r\n  keyDown(e) {\r\n\r\n    if (e.key === \"o\") {\r\n      this.verticalAcceleration += 2\r\n    }\r\n\r\n    if (e.key === \"k\") {\r\n      this.verticalAcceleration = -2\r\n    }\r\n  },\r\n\r\n  keyUp(e) {\r\n    \r\n    if (e.key === \"o\" || e.key === \"k\") {\r\n      this.verticalVelocity = 0\r\n      this.verticalAcceleration = 0\r\n    }\r\n  },\r\n\r\n  tick(t, dt) {\r\n\r\n    velDelta = dt * this.verticalAcceleration / 1000\r\n    this.verticalVelocity += velDelta\r\n    if (this.verticalVelocity > 1) this.verticalVelocity = 1\r\n    if (this.verticalVelocity < -1) this.verticalVelocity = -1\r\n\r\n    yDelta = dt * this.verticalVelocity / 1000\r\n    this.el.object3D.position.y += yDelta\r\n  }\r\n})","/* global: Peer */\r\nimport { Peer } from \"peerjs\";\r\n\r\nif (!window.location.href.includes(\"phone.html\")) {\r\n\r\n  const peer = new Peer(\"squatmaster-oculus\");\r\n\r\n  peer.on(\"connection\", (conn) => {\r\n    conn.on(\"data\", (data) => {\r\n      // Will print 'hi!'\r\n      console.log(data);\r\n    });\r\n    conn.on(\"open\", () => {\r\n      conn.send(\"hello!\");\r\n    });\r\n  });\r\n\r\n  peer.on('call', call => {\r\n    // Answer the call\r\n    const mediaConnection = call.answer(null);\r\n\r\n    // Disable sending any media\r\n    mediaConnection.on('stream', stream => {\r\n      stream.getTracks().forEach(track => {\r\n        track.enabled = false;\r\n      });\r\n    });\r\n  });\r\n}\r\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nlet logDisabled_ = true;\nlet deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nexport function extractVersion(uastring, expr, pos) {\n  const match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nexport function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  const nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    const wrappedCallback = (e) => {\n      const modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        if (cb.handleEvent) {\n          cb.handleEvent(modifiedEvent);\n        } else {\n          cb(modifiedEvent);\n        }\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    if (!this._eventMap[eventNameToWrap]) {\n      this._eventMap[eventNameToWrap] = new Map();\n    }\n    this._eventMap[eventNameToWrap].set(cb, wrappedCallback);\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  const nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[eventNameToWrap]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    if (!this._eventMap[eventNameToWrap].has(cb)) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    const unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\n    this._eventMap[eventNameToWrap].delete(cb);\n    if (this._eventMap[eventNameToWrap].size === 0) {\n      delete this._eventMap[eventNameToWrap];\n    }\n    if (Object.keys(this._eventMap).length === 0) {\n      delete this._eventMap;\n    }\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\nexport function disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return (bool) ? 'adapter.js logging disabled' :\n      'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nexport function disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nexport function log() {\n  if (typeof window === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nexport function deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n      ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nexport function detectBrowser(window) {\n  // Returned result object.\n  const result = {browser: null, version: null};\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  const {navigator} = window;\n\n  if (navigator.mozGetUserMedia) { // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent,\n        /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia ||\n      (window.isSecureContext === false && window.webkitRTCPeerConnection &&\n       !window.RTCIceGatherer)) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent,\n        /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (navigator.mediaDevices &&\n      navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) { // Edge.\n    result.browser = 'edge';\n    result.version = extractVersion(navigator.userAgent,\n        /Edge\\/(\\d+).(\\d+)$/, 2);\n  } else if (window.RTCPeerConnection &&\n      navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent,\n        /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver &&\n        'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else { // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nexport function compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function(accumulator, key) {\n    const isObj = isObject(data[key]);\n    const value = isObj ? compactObject(data[key]) : data[key];\n    const isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, {[key]: value});\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nexport function walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(name => {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(id => {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nexport function filterStats(result, track, outbound) {\n  const streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  const filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  const trackStats = [];\n  result.forEach(value => {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(trackStat => {\n    result.forEach(stats => {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\nconst logging = utils.log;\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  const constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    const cc = {};\n    Object.keys(c).forEach(key => {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      const r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      const oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        let oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(mix => {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  const shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      const remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      let face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      const getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        let matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n          .then(devices => {\n            devices = devices.filter(d => d.kind === 'videoinput');\n            let dev = devices.find(d => matches.some(match =>\n              d.label.toLowerCase().includes(match)));\n            if (!dev && devices.length && matches.includes('back')) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :\n                                                        {ideal: dev.deviceId};\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  const shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  const getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, c => {\n      navigator.webkitGetUserMedia(c, onSuccess, e => {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, c => origGetUserMedia(c).then(stream => {\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(track => {\n            track.stop();\n          });\n          throw new DOMException('', 'NotFoundError');\n        }\n        return stream;\n      }, e => Promise.reject(shimError_(e))));\n    };\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nexport function shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' +\n        'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      return getSourceId(constraints)\n        .then(sourceId => {\n          const widthSpecified = constraints.video && constraints.video.width;\n          const heightSpecified = constraints.video &&\n            constraints.video.height;\n          const frameRateSpecified = constraints.video &&\n            constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3\n            }\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n      window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get() {\n        return this._ontrack;\n      },\n      set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n      enumerable: true,\n      configurable: true\n    });\n    const origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        if (!this._ontrackpoly) {\n          this._ontrackpoly = (e) => {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', te => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === te.track.id);\n              } else {\n                receiver = {track: te.track};\n              }\n\n              const event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(track => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === track.id);\n              } else {\n                receiver = {track};\n              }\n              const event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n          };\n          this.addEventListener('addstream', this._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver',\n          {value: {receiver: e.receiver}});\n      }\n      return e;\n    });\n  }\n}\n\nexport function shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if (typeof window === 'object' && window.RTCPeerConnection &&\n      !('getSenders' in window.RTCPeerConnection.prototype) &&\n      'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    const shimSenderWithDtmf = function(pc, track) {\n      return {\n        track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack =\n        function addTrack(track, stream) {\n          let sender = origAddTrack.apply(this, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(this, track);\n            this._senders.push(sender);\n          }\n          return sender;\n        };\n\n      const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack =\n        function removeTrack(sender) {\n          origRemoveTrack.apply(this, arguments);\n          const idx = this._senders.indexOf(sender);\n          if (idx !== -1) {\n            this._senders.splice(idx, 1);\n          }\n        };\n    }\n    const origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(track => {\n        this._senders.push(shimSenderWithDtmf(this, track));\n      });\n    };\n\n    const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        this._senders = this._senders || [];\n        origRemoveStream.apply(this, [stream]);\n\n        stream.getTracks().forEach(track => {\n          const sender = this._senders.find(s => s.track === track);\n          if (sender) { // remove sender\n            this._senders.splice(this._senders.indexOf(sender), 1);\n          }\n        });\n      };\n  } else if (typeof window === 'object' && window.RTCPeerConnection &&\n             'getSenders' in window.RTCPeerConnection.prototype &&\n             'createDTMFSender' in window.RTCPeerConnection.prototype &&\n             window.RTCRtpSender &&\n             !('dtmf' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nexport function shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 ||\n        typeof selector !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    const fixChromeStats_ = function(response) {\n      const standardReport = {};\n      const reports = response.result();\n      reports.forEach(report => {\n        const standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(name => {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    const makeMapStats = function(stats) {\n      return new Map(Object.keys(stats).map(key => [key, stats[key]]));\n    };\n\n    if (arguments.length >= 2) {\n      const successCallbackWrapper_ = function(response) {\n        onSucc(makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_,\n        selector]);\n    }\n\n    // promise-support\n    return new Promise((resolve, reject) => {\n      origGetStats.apply(this, [\n        function(response) {\n          resolve(makeMapStats(fixChromeStats_(response)));\n        }, reject]);\n    }).then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        const senders = origGetSenders.apply(this, []);\n        senders.forEach(sender => sender._pc = this);\n        return senders;\n      };\n    }\n\n    const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        const sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      const sender = this;\n      return this._pc.getStats().then(result =>\n        /* Note: this will include stats of all senders that\n         *   send a track with the same id as sender.track as\n         *   it is not possible to identify the RTCRtpSender.\n         */\n        utils.filterStats(result, sender.track, true));\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers =\n        function getReceivers() {\n          const receivers = origGetReceivers.apply(this, []);\n          receivers.forEach(receiver => receiver._pc = this);\n          return receivers;\n        };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      const receiver = this;\n      return this._pc.getStats().then(result =>\n        utils.filterStats(result, receiver.track, false));\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype &&\n      'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 &&\n        arguments[0] instanceof window.MediaStreamTrack) {\n      const track = arguments[0];\n      let sender;\n      let receiver;\n      let err;\n      this.getSenders().forEach(s => {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(r => {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || (sender && receiver)) {\n        return Promise.reject(new DOMException(\n          'There are more than one sender or receiver for the track.',\n          'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException(\n        'There is no sender or receiver for the track.',\n        'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nexport function shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams)\n        .map(streamId => this._shimmedLocalStreams[streamId][0]);\n    };\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      const sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n    });\n    const existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    const newSenders = this.getSenders()\n      .filter(newSender => existingSenders.indexOf(newSender) === -1);\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n  const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(streamId => {\n          const idx = this._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            this._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (this._shimmedLocalStreams[streamId].length === 1) {\n            delete this._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n}\n\nexport function shimAddTrackRemoveTrack(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack &&\n      browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  const origGetLocalStreams = window.RTCPeerConnection.prototype\n      .getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      const nativeStreams = origGetLocalStreams.apply(this);\n      this._reverseStreams = this._reverseStreams || {};\n      return nativeStreams.map(stream => this._reverseStreams[stream.id]);\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      const newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      origRemoveStream.apply(this, [(this._streams[stream.id] || stream)]);\n      delete this._reverseStreams[(this._streams[stream.id] ?\n          this._streams[stream.id].id : stream.id)];\n      delete this._streams[stream.id];\n    };\n\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      const streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(t => t === track)) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n      const oldStream = this._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(() => {\n          this.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        const newStream = new window.MediaStream([track]);\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        this.addStream(newStream);\n      }\n      return this.getSenders().find(s => s.track === track);\n    };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n          externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n          internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function(method) {\n    const nativeMethod = window.RTCPeerConnection.prototype[method];\n    const methodObj = {[method]() {\n      const args = arguments;\n      const isLegacyCall = arguments.length &&\n          typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [\n          (description) => {\n            const desc = replaceInternalStreamId(this, description);\n            args[0].apply(null, [desc]);\n          },\n          (err) => {\n            if (args[1]) {\n              args[1].apply(null, err);\n            }\n          }, arguments[2]\n        ]);\n      }\n      return nativeMethod.apply(this, arguments)\n      .then(description => replaceInternalStreamId(this, description));\n    }};\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n\n  const origSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(this, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(this, arguments[0]);\n      return origSetLocalDescription.apply(this, arguments);\n    };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  const origLocalDescription = Object.getOwnPropertyDescriptor(\n      window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype,\n      'localDescription', {\n        get() {\n          const description = origLocalDescription.get.apply(this);\n          if (description.type === '') {\n            return description;\n          }\n          return replaceInternalStreamId(this, description);\n        }\n      });\n\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      const isLocal = sender._pc === this;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n            'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      this._streams = this._streams || {};\n      let stream;\n      Object.keys(this._streams).forEach(streamid => {\n        const hasTrack = this._streams[streamid].getTracks()\n          .find(track => sender.track === track);\n        if (hasTrack) {\n          stream = this._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          this.removeStream(this._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        this.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          const nativeMethod = window.RTCPeerConnection.prototype[method];\n          const methodObj = {[method]() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          }};\n          window.RTCPeerConnection.prototype[method] = methodObj[method];\n        });\n  }\n}\n\n// Attempt to fix ONN in plan-b mode.\nexport function fixNegotiationNeeded(window, browserDetails) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', e => {\n    const pc = e.target;\n    if (browserDetails.version < 72 || (pc.getConfiguration &&\n        pc.getConfiguration().sdpSemantics === 'plan-b')) {\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n    }\n    return e;\n  });\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  const shimError_ = function(e) {\n    return {\n      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function(c) {\n    return origGetUserMedia(c).catch(e => Promise.reject(shimError_(e)));\n  };\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window) {\n  if (!('getDisplayMedia' in window.navigator)) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    window.navigator.getDisplayMedia.bind(window.navigator);\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nimport {filterIceServers} from './filtericeservers';\nimport shimRTCPeerConnection from 'rtcpeerconnection-shim';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (window.RTCIceGatherer) {\n    if (!window.RTCIceCandidate) {\n      window.RTCIceCandidate = function RTCIceCandidate(args) {\n        return args;\n      };\n    }\n    if (!window.RTCSessionDescription) {\n      window.RTCSessionDescription = function RTCSessionDescription(args) {\n        return args;\n      };\n    }\n    // this adds an additional event listener to MediaStrackTrack that signals\n    // when a tracks enabled property was changed. Workaround for a bug in\n    // addStream, see below. No longer required in 15025+\n    if (browserDetails.version < 15025) {\n      const origMSTEnabled = Object.getOwnPropertyDescriptor(\n          window.MediaStreamTrack.prototype, 'enabled');\n      Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\n        set(value) {\n          origMSTEnabled.set.call(this, value);\n          const ev = new Event('enabled');\n          ev.enabled = value;\n          this.dispatchEvent(ev);\n        }\n      });\n    }\n  }\n\n  // ORTC defines the DTMF sender a bit different.\n  // https://github.com/w3c/ortc/issues/714\n  if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = new window.RTCDtmfSender(this);\n          } else if (this.track.kind === 'video') {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n  // Edge currently only implements the RTCDtmfSender, not the\n  // RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*\n  if (window.RTCDtmfSender && !window.RTCDTMFSender) {\n    window.RTCDTMFSender = window.RTCDtmfSender;\n  }\n\n  const RTCPeerConnectionShim = shimRTCPeerConnection(window,\n      browserDetails.version);\n  window.RTCPeerConnection = function RTCPeerConnection(config) {\n    if (config && config.iceServers) {\n      config.iceServers = filterIceServers(config.iceServers,\n        browserDetails.version);\n      utils.log('ICE servers after filtering:', config.iceServers);\n    }\n    return new RTCPeerConnectionShim(config);\n  };\n  window.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;\n}\n\nexport function shimReplaceTrack(window) {\n  // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n  if (window.RTCRtpSender &&\n      !('replaceTrack' in window.RTCRtpSender.prototype)) {\n    window.RTCRtpSender.prototype.replaceTrack =\n        window.RTCRtpSender.prototype.setTrack;\n  }\n}\n","/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nexport function filterIceServers(iceServers, edgeVersion) {\n  let hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(server => {\n    if (server && (server.urls || server.url)) {\n      let urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      const isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(url => {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n\n        const validTurn = url.startsWith('turn') &&\n            !url.startsWith('turn:[') &&\n            url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n  const MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n        'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    const remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    const nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      const nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        const obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      const nativeApplyConstraints =\n        MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      if (!(constraints && constraints.video)) {\n        const err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      ('receiver' in window.RTCTrackEvent.prototype) &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (typeof window !== 'object' ||\n      !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          const nativeMethod = window.RTCPeerConnection.prototype[method];\n          const methodObj = {[method]() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          }};\n          window.RTCPeerConnection.prototype[method] = methodObj[method];\n        });\n  }\n\n  const modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  const nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n    return nativeGetStats.apply(this, [selector || null])\n      .then(stats => {\n        if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n          try {\n            stats.forEach(stat => {\n              stat.type = modernStatsTypes[stat.type] || stat.type;\n            });\n          } catch (e) {\n            if (e.name !== 'TypeError') {\n              throw e;\n            }\n            // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n            stats.forEach((stat, i) => {\n              stats.set(i, Object.assign({}, stat, {\n                type: modernStatsTypes[stat.type] || stat.type\n              }));\n            });\n          }\n        }\n        return stats;\n      })\n      .then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n  }\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      const sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) :\n        Promise.resolve(new Map());\n  };\n}\n\nexport function shimReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      const receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(receiver => receiver._pc = this);\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', e => {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nexport function shimRemoveStream(window) {\n  if (!window.RTCPeerConnection ||\n      'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(sender => {\n        if (sender.track && stream.getTracks().includes(sender.track)) {\n          this.removeTrack(sender);\n        }\n      });\n    };\n}\n\nexport function shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nexport function shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver =\n      function addTransceiver() {\n        this.setParametersPromises = [];\n        const initParameters = arguments[1];\n        const shouldPerformCheck = initParameters &&\n                                  'sendEncodings' in initParameters;\n        if (shouldPerformCheck) {\n          // If sendEncodings params are provided, validate grammar\n          initParameters.sendEncodings.forEach((encodingParam) => {\n            if ('rid' in encodingParam) {\n              const ridRegex = /^[a-z0-9]{0,16}$/i;\n              if (!ridRegex.test(encodingParam.rid)) {\n                throw new TypeError('Invalid RID value provided.');\n              }\n            }\n            if ('scaleResolutionDownBy' in encodingParam) {\n              if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n                throw new RangeError('scale_resolution_down_by must be >= 1.0');\n              }\n            }\n            if ('maxFramerate' in encodingParam) {\n              if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n                throw new RangeError('max_framerate must be >= 0.0');\n              }\n            }\n          });\n        }\n        const transceiver = origAddTransceiver.apply(this, arguments);\n        if (shouldPerformCheck) {\n          // Check if the init options were applied. If not we do this in an\n          // asynchronous way and save the promise reference in a global object.\n          // This is an ugly hack, but at the same time is way more robust than\n          // checking the sender parameters before and after the createOffer\n          // Also note that after the createoffer we are not 100% sure that\n          // the params were asynchronously applied so we might miss the\n          // opportunity to recreate offer.\n          const {sender} = transceiver;\n          const params = sender.getParameters();\n          if (!('encodings' in params) ||\n              // Avoid being fooled by patched getParameters() below.\n              (params.encodings.length === 1 &&\n               Object.keys(params.encodings[0]).length === 0)) {\n            params.encodings = initParameters.sendEncodings;\n            sender.sendEncodings = initParameters.sendEncodings;\n            this.setParametersPromises.push(sender.setParameters(params)\n              .then(() => {\n                delete sender.sendEncodings;\n              }).catch(() => {\n                delete sender.sendEncodings;\n              })\n            );\n          }\n        }\n        return transceiver;\n      };\n  }\n}\n\nexport function shimGetParameters(window) {\n  if (!(typeof window === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  const origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters =\n      function getParameters() {\n        const params = origGetParameters.apply(this, arguments);\n        if (!('encodings' in params)) {\n          params.encodings = [].concat(this.sendEncodings || [{}]);\n        }\n        return params;\n      };\n  }\n}\n\nexport function shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n      .then(() => {\n        return origCreateOffer.apply(this, arguments);\n      })\n      .finally(() => {\n        this.setParametersPromises = [];\n      });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nexport function shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n      .then(() => {\n        return origCreateAnswer.apply(this, arguments);\n      })\n      .finally(() => {\n        this.setParametersPromises = [];\n      });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nimport * as utils from '../utils';\n\nexport function shimLocalStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams =\n      function getLocalStreams() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    const _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n      stream.getVideoTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n    };\n\n    window.RTCPeerConnection.prototype.addTrack =\n      function addTrack(track, ...streams) {\n        if (streams) {\n          streams.forEach((stream) => {\n            if (!this._localStreams) {\n              this._localStreams = [stream];\n            } else if (!this._localStreams.includes(stream)) {\n              this._localStreams.push(stream);\n            }\n          });\n        }\n        return _addTrack.apply(this, arguments);\n      };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        const index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        const tracks = stream.getTracks();\n        this.getSenders().forEach(sender => {\n          if (tracks.includes(sender.track)) {\n            this.removeTrack(sender);\n          }\n        });\n      };\n  }\n}\n\nexport function shimRemoteStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams =\n      function getRemoteStreams() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get() {\n        return this._onaddstream;\n      },\n      set(f) {\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = (e) => {\n          e.streams.forEach(stream => {\n            if (!this._remoteStreams) {\n              this._remoteStreams = [];\n            }\n            if (this._remoteStreams.includes(stream)) {\n              return;\n            }\n            this._remoteStreams.push(stream);\n            const event = new Event('addstream');\n            event.stream = stream;\n            this.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        const pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(stream => {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              const event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n  }\n}\n\nexport function shimCallbacksAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  const prototype = window.RTCPeerConnection.prototype;\n  const origCreateOffer = prototype.createOffer;\n  const origCreateAnswer = prototype.createAnswer;\n  const setLocalDescription = prototype.setLocalDescription;\n  const setRemoteDescription = prototype.setRemoteDescription;\n  const addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer =\n    function createOffer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  prototype.createAnswer =\n    function createAnswer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  let withCallback = function(description, successCallback, failureCallback) {\n    const promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function(description, successCallback, failureCallback) {\n    const promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function(candidate, successCallback, failureCallback) {\n    const promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    const mediaDevices = navigator.mediaDevices;\n    const _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = (constraints) => {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices &&\n    navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints)\n      .then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nexport function shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({},\n      constraints,\n      {video: utils.compactObject(constraints.video)}\n    );\n  }\n\n  return constraints;\n}\n\nexport function shimRTCIceServerUrls(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  const OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection =\n    function RTCPeerConnection(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        const newIceServers = [];\n        for (let i = 0; i < pcConfig.iceServers.length; i++) {\n          let server = pcConfig.iceServers[i];\n          if (!server.hasOwnProperty('urls') &&\n              server.hasOwnProperty('url')) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in OrigPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nexport function shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      'receiver' in window.RTCTrackEvent.prototype &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimCreateOfferLegacy(window) {\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer =\n    function createOffer(offerOptions) {\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio =\n            !!offerOptions.offerToReceiveAudio;\n        }\n        const audioTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'audio');\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          this.addTransceiver('audio');\n        }\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo =\n            !!offerOptions.offerToReceiveVideo;\n        }\n        const videoTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'video');\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('sendonly');\n            } else {\n              videoTransceiver.direction = 'sendonly';\n            }\n          } else if (videoTransceiver.direction === 'recvonly') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('inactive');\n            } else {\n              videoTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          this.addTransceiver('video');\n        }\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n}\n\nexport function shimAudioContext(window) {\n  if (typeof window !== 'object' || window.AudioContext) {\n    return;\n  }\n  window.AudioContext = window.webkitAudioContext;\n}\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport SDPUtils from 'sdp';\nimport * as utils from './utils';\n\nexport function shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  const NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if (typeof args === 'object' && args.candidate &&\n        args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substr(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      const nativeCandidate = new NativeRTCIceCandidate(args);\n      const parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n      const augmentedCandidate = Object.assign(nativeCandidate,\n          parsedCandidate);\n\n      // Add a serializer that does not serialize the extra attributes.\n      augmentedCandidate.toJSON = function toJSON() {\n        return {\n          candidate: augmentedCandidate.candidate,\n          sdpMid: augmentedCandidate.sdpMid,\n          sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n          usernameFragment: augmentedCandidate.usernameFragment,\n        };\n      };\n      return augmentedCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nexport function shimMaxMessageSize(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  const sctpInDescription = function(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    const sections = SDPUtils.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(mediaSection => {\n      const mLine = SDPUtils.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application'\n          && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  const getRemoteFirefoxVersion = function(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    const match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    const version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  const getCanSendMaxMessageSize = function(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    let canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize =\n          browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  const getMaxMessageSize = function(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    let maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox'\n         && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    const match = SDPUtils.matchPrefix(description.sdp,\n      'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substr(19), 10);\n    } else if (browserDetails.browser === 'firefox' &&\n                remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n    function setRemoteDescription() {\n      this._sctp = null;\n      // Chrome decided to not expose .sctp in plan-b mode.\n      // As usual, adapter.js has to do an 'ugly worakaround'\n      // to cover up the mess.\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n        const {sdpSemantics} = this.getConfiguration();\n        if (sdpSemantics === 'plan-b') {\n          Object.defineProperty(this, 'sctp', {\n            get() {\n              return typeof this._sctp === 'undefined' ? null : this._sctp;\n            },\n            enumerable: true,\n            configurable: true,\n          });\n        }\n      }\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        const isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        const canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        const remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        let maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        const sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get() {\n            return maxMessageSize;\n          }\n        });\n        this._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n}\n\nexport function shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection &&\n      'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    const origDataChannelSend = dc.send;\n    dc.send = function send() {\n      const data = arguments[0];\n      const length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' &&\n          pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' +\n          pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  const origCreateDataChannel =\n    window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel =\n    function createDataChannel() {\n      const dataChannel = origCreateDataChannel.apply(this, arguments);\n      wrapDcSend(dataChannel, this);\n      return dataChannel;\n    };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', e => {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nexport function shimConnectionState(window) {\n  if (!window.RTCPeerConnection ||\n      'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get() {\n      return this._onconnectionstatechange || null;\n    },\n    set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange',\n            this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange',\n            this._onconnectionstatechange = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach((method) => {\n    const origMethod = proto[method];\n    proto[method] = function() {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = e => {\n          const pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            const newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange',\n          this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nexport function removeExtmapAllowMixed(window, browserDetails) {\n  /* remove a=extmap-allow-mixed for webrtc.org < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  if (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\n    return;\n  }\n  const nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n  function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      const sdp = desc.sdp.split('\\n').filter((line) => {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n      // Safari enforces read-only-ness of RTCSessionDescription fields.\n      if (window.RTCSessionDescription &&\n          desc instanceof window.RTCSessionDescription) {\n        arguments[0] = new window.RTCSessionDescription({\n          type: desc.type,\n          sdp,\n        });\n      } else {\n        desc.sdp = sdp;\n      }\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\nexport function shimAddIceCandidateNullOrEmpty(window, browserDetails) {\n  // Support for addIceCandidate(null or undefined)\n  // as well as addIceCandidate({candidate: \"\", ...})\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=978582\n  // Note: must be called before other polyfills which change the signature.\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeAddIceCandidate =\n      window.RTCPeerConnection.prototype.addIceCandidate;\n  if (!nativeAddIceCandidate || nativeAddIceCandidate.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.addIceCandidate =\n    function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      // Native support for ignoring exists for Chrome M77+.\n      // Safari ignores as well, exact version unknown but works in the same\n      // version that also ignores addIceCandidate(null).\n      if (((browserDetails.browser === 'chrome' && browserDetails.version < 78)\n           || (browserDetails.browser === 'firefox'\n               && browserDetails.version < 68)\n           || (browserDetails.browser === 'safari'))\n          && arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nimport {adapterFactory} from './adapter_factory.js';\n\nconst adapter =\n  adapterFactory({window: typeof window === 'undefined' ? undefined : window});\nexport default adapter;\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nimport * as utils from './utils';\n\n  // Browser shims.\nimport * as chromeShim from './chrome/chrome_shim';\nimport * as edgeShim from './edge/edge_shim';\nimport * as firefoxShim from './firefox/firefox_shim';\nimport * as safariShim from './safari/safari_shim';\nimport * as commonShim from './common_shim';\n\n// Shimming starts here.\nexport function adapterFactory({window} = {}, options = {\n  shimChrome: true,\n  shimFirefox: true,\n  shimEdge: true,\n  shimSafari: true,\n}) {\n  // Utils.\n  const logging = utils.log;\n  const browserDetails = utils.detectBrowser(window);\n\n  const adapter = {\n    browserDetails,\n    commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      if (browserDetails.version === null) {\n        logging('Chrome shim can not determine version, not shimming.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n\n      chromeShim.shimGetUserMedia(window, browserDetails);\n      chromeShim.shimMediaStream(window, browserDetails);\n      chromeShim.shimPeerConnection(window, browserDetails);\n      chromeShim.shimOnTrack(window, browserDetails);\n      chromeShim.shimAddTrackRemoveTrack(window, browserDetails);\n      chromeShim.shimGetSendersWithDtmf(window, browserDetails);\n      chromeShim.shimGetStats(window, browserDetails);\n      chromeShim.shimSenderReceiverGetStats(window, browserDetails);\n      chromeShim.fixNegotiationNeeded(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n\n      firefoxShim.shimGetUserMedia(window, browserDetails);\n      firefoxShim.shimPeerConnection(window, browserDetails);\n      firefoxShim.shimOnTrack(window, browserDetails);\n      firefoxShim.shimRemoveStream(window, browserDetails);\n      firefoxShim.shimSenderGetStats(window, browserDetails);\n      firefoxShim.shimReceiverGetStats(window, browserDetails);\n      firefoxShim.shimRTCDataChannel(window, browserDetails);\n      firefoxShim.shimAddTransceiver(window, browserDetails);\n      firefoxShim.shimGetParameters(window, browserDetails);\n      firefoxShim.shimCreateOffer(window, browserDetails);\n      firefoxShim.shimCreateAnswer(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\n        logging('MS edge shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = edgeShim;\n\n      edgeShim.shimGetUserMedia(window, browserDetails);\n      edgeShim.shimGetDisplayMedia(window, browserDetails);\n      edgeShim.shimPeerConnection(window, browserDetails);\n      edgeShim.shimReplaceTrack(window, browserDetails);\n\n      // the edge shim implements the full RTCIceCandidate object.\n\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      // Must be called before shimCallbackAPI.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n\n      safariShim.shimRTCIceServerUrls(window, browserDetails);\n      safariShim.shimCreateOfferLegacy(window, browserDetails);\n      safariShim.shimCallbacksAPI(window, browserDetails);\n      safariShim.shimLocalStreamsAPI(window, browserDetails);\n      safariShim.shimRemoteStreamsAPI(window, browserDetails);\n      safariShim.shimTrackEventTransceiver(window, browserDetails);\n      safariShim.shimGetUserMedia(window, browserDetails);\n      safariShim.shimAudioContext(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n","import $kKvpS$peerjsjsbinarypack from \"peerjs-js-binarypack\";\nimport $kKvpS$webrtcadapter from \"webrtc-adapter\";\n\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\n\n\nvar $af8cf1f663f490f4$var$webRTCAdapter = //@ts-ignore\n$kKvpS$webrtcadapter.default || $kKvpS$webrtcadapter;\nvar $af8cf1f663f490f4$export$25be9502477c137d = new /** @class */ (function() {\n    function class_1() {\n        this.isIOS = [\n            \"iPad\",\n            \"iPhone\",\n            \"iPod\"\n        ].includes(navigator.platform);\n        this.supportedBrowsers = [\n            \"firefox\",\n            \"chrome\",\n            \"safari\"\n        ];\n        this.minFirefoxVersion = 59;\n        this.minChromeVersion = 72;\n        this.minSafariVersion = 605;\n    }\n    class_1.prototype.isWebRTCSupported = function() {\n        return typeof RTCPeerConnection !== \"undefined\";\n    };\n    class_1.prototype.isBrowserSupported = function() {\n        var browser = this.getBrowser();\n        var version = this.getVersion();\n        var validBrowser = this.supportedBrowsers.includes(browser);\n        if (!validBrowser) return false;\n        if (browser === \"chrome\") return version >= this.minChromeVersion;\n        if (browser === \"firefox\") return version >= this.minFirefoxVersion;\n        if (browser === \"safari\") return !this.isIOS && version >= this.minSafariVersion;\n        return false;\n    };\n    class_1.prototype.getBrowser = function() {\n        return $af8cf1f663f490f4$var$webRTCAdapter.browserDetails.browser;\n    };\n    class_1.prototype.getVersion = function() {\n        return $af8cf1f663f490f4$var$webRTCAdapter.browserDetails.version || 0;\n    };\n    class_1.prototype.isUnifiedPlanSupported = function() {\n        var browser = this.getBrowser();\n        var version = $af8cf1f663f490f4$var$webRTCAdapter.browserDetails.version || 0;\n        if (browser === \"chrome\" && version < this.minChromeVersion) return false;\n        if (browser === \"firefox\" && version >= this.minFirefoxVersion) return true;\n        if (!window.RTCRtpTransceiver || !(\"currentDirection\" in RTCRtpTransceiver.prototype)) return false;\n        var tempPc;\n        var supported = false;\n        try {\n            tempPc = new RTCPeerConnection();\n            tempPc.addTransceiver(\"audio\");\n            supported = true;\n        } catch (e) {} finally{\n            if (tempPc) tempPc.close();\n        }\n        return supported;\n    };\n    class_1.prototype.toString = function() {\n        return \"Supports:\\n    browser:\".concat(this.getBrowser(), \"\\n    version:\").concat(this.getVersion(), \"\\n    isIOS:\").concat(this.isIOS, \"\\n    isWebRTCSupported:\").concat(this.isWebRTCSupported(), \"\\n    isBrowserSupported:\").concat(this.isBrowserSupported(), \"\\n    isUnifiedPlanSupported:\").concat(this.isUnifiedPlanSupported());\n    };\n    return class_1;\n}())();\n\n\nvar $06cb531ed7840f78$var$DEFAULT_CONFIG = {\n    iceServers: [\n        {\n            urls: \"stun:stun.l.google.com:19302\"\n        },\n        {\n            urls: [\n                \"turn:eu-0.turn.peerjs.com:3478\",\n                \"turn:us-0.turn.peerjs.com:3478\", \n            ],\n            username: \"peerjs\",\n            credential: \"peerjsp\"\n        }, \n    ],\n    sdpSemantics: \"unified-plan\"\n};\nvar $06cb531ed7840f78$var$Util = /** @class */ function() {\n    function Util() {\n        this.CLOUD_HOST = \"0.peerjs.com\";\n        this.CLOUD_PORT = 443;\n        // Browsers that need chunking:\n        this.chunkedBrowsers = {\n            Chrome: 1,\n            chrome: 1\n        };\n        this.chunkedMTU = 16300; // The original 60000 bytes setting does not work when sending data from Firefox to Chrome, which is \"cut off\" after 16384 bytes and delivered individually.\n        // Returns browser-agnostic default config\n        this.defaultConfig = $06cb531ed7840f78$var$DEFAULT_CONFIG;\n        this.browser = $af8cf1f663f490f4$export$25be9502477c137d.getBrowser();\n        this.browserVersion = $af8cf1f663f490f4$export$25be9502477c137d.getVersion();\n        // Lists which features are supported\n        this.supports = function() {\n            var supported = {\n                browser: $af8cf1f663f490f4$export$25be9502477c137d.isBrowserSupported(),\n                webRTC: $af8cf1f663f490f4$export$25be9502477c137d.isWebRTCSupported(),\n                audioVideo: false,\n                data: false,\n                binaryBlob: false,\n                reliable: false\n            };\n            if (!supported.webRTC) return supported;\n            var pc;\n            try {\n                pc = new RTCPeerConnection($06cb531ed7840f78$var$DEFAULT_CONFIG);\n                supported.audioVideo = true;\n                var dc = void 0;\n                try {\n                    dc = pc.createDataChannel(\"_PEERJSTEST\", {\n                        ordered: true\n                    });\n                    supported.data = true;\n                    supported.reliable = !!dc.ordered;\n                    // Binary test\n                    try {\n                        dc.binaryType = \"blob\";\n                        supported.binaryBlob = !$af8cf1f663f490f4$export$25be9502477c137d.isIOS;\n                    } catch (e) {}\n                } catch (e) {} finally{\n                    if (dc) dc.close();\n                }\n            } catch (e) {} finally{\n                if (pc) pc.close();\n            }\n            return supported;\n        }();\n        this.pack = $kKvpS$peerjsjsbinarypack.pack;\n        this.unpack = $kKvpS$peerjsjsbinarypack.unpack;\n        // Binary stuff\n        this._dataCount = 1;\n    }\n    Util.prototype.noop = function() {};\n    // Ensure alphanumeric ids\n    Util.prototype.validateId = function(id) {\n        // Allow empty ids\n        return !id || /^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(id);\n    };\n    Util.prototype.chunk = function(blob) {\n        var chunks = [];\n        var size = blob.size;\n        var total = Math.ceil(size / $06cb531ed7840f78$export$7debb50ef11d5e0b.chunkedMTU);\n        var index = 0;\n        var start = 0;\n        while(start < size){\n            var end = Math.min(size, start + $06cb531ed7840f78$export$7debb50ef11d5e0b.chunkedMTU);\n            var b = blob.slice(start, end);\n            var chunk = {\n                __peerData: this._dataCount,\n                n: index,\n                data: b,\n                total: total\n            };\n            chunks.push(chunk);\n            start = end;\n            index++;\n        }\n        this._dataCount++;\n        return chunks;\n    };\n    Util.prototype.blobToArrayBuffer = function(blob, cb) {\n        var fr = new FileReader();\n        fr.onload = function(evt) {\n            if (evt.target) cb(evt.target.result);\n        };\n        fr.readAsArrayBuffer(blob);\n        return fr;\n    };\n    Util.prototype.binaryStringToArrayBuffer = function(binary) {\n        var byteArray = new Uint8Array(binary.length);\n        for(var i = 0; i < binary.length; i++)byteArray[i] = binary.charCodeAt(i) & 0xff;\n        return byteArray.buffer;\n    };\n    Util.prototype.randomToken = function() {\n        return Math.random().toString(36).slice(2);\n    };\n    Util.prototype.isSecure = function() {\n        return location.protocol === \"https:\";\n    };\n    return Util;\n}();\nvar $06cb531ed7840f78$export$7debb50ef11d5e0b = new $06cb531ed7840f78$var$Util();\n\n\nvar $26088d7da5b03f69$exports = {};\n\n$parcel$export($26088d7da5b03f69$exports, \"Peer\", () => $26088d7da5b03f69$export$ecd1fc136c422448, (v) => $26088d7da5b03f69$export$ecd1fc136c422448 = v);\nvar $ac9b757d51178e15$exports = {};\n'use strict';\nvar $ac9b757d51178e15$var$has = Object.prototype.hasOwnProperty, $ac9b757d51178e15$var$prefix = '~';\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */ function $ac9b757d51178e15$var$Events() {}\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n    $ac9b757d51178e15$var$Events.prototype = Object.create(null);\n    //\n    // This hack is needed because the `__proto__` property is still inherited in\n    // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n    //\n    if (!new $ac9b757d51178e15$var$Events().__proto__) $ac9b757d51178e15$var$prefix = false;\n}\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */ function $ac9b757d51178e15$var$EE(fn, context, once) {\n    this.fn = fn;\n    this.context = context;\n    this.once = once || false;\n}\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */ function $ac9b757d51178e15$var$addListener(emitter, event, fn, context, once) {\n    if (typeof fn !== 'function') throw new TypeError('The listener must be a function');\n    var listener = new $ac9b757d51178e15$var$EE(fn, context || emitter, once), evt = $ac9b757d51178e15$var$prefix ? $ac9b757d51178e15$var$prefix + event : event;\n    if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n    else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n    else emitter._events[evt] = [\n        emitter._events[evt],\n        listener\n    ];\n    return emitter;\n}\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */ function $ac9b757d51178e15$var$clearEvent(emitter, evt) {\n    if (--emitter._eventsCount === 0) emitter._events = new $ac9b757d51178e15$var$Events();\n    else delete emitter._events[evt];\n}\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */ function $ac9b757d51178e15$var$EventEmitter() {\n    this._events = new $ac9b757d51178e15$var$Events();\n    this._eventsCount = 0;\n}\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */ $ac9b757d51178e15$var$EventEmitter.prototype.eventNames = function eventNames() {\n    var names = [], events, name;\n    if (this._eventsCount === 0) return names;\n    for(name in events = this._events)if ($ac9b757d51178e15$var$has.call(events, name)) names.push($ac9b757d51178e15$var$prefix ? name.slice(1) : name);\n    if (Object.getOwnPropertySymbols) return names.concat(Object.getOwnPropertySymbols(events));\n    return names;\n};\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */ $ac9b757d51178e15$var$EventEmitter.prototype.listeners = function listeners(event) {\n    var evt = $ac9b757d51178e15$var$prefix ? $ac9b757d51178e15$var$prefix + event : event, handlers = this._events[evt];\n    if (!handlers) return [];\n    if (handlers.fn) return [\n        handlers.fn\n    ];\n    for(var i = 0, l = handlers.length, ee = new Array(l); i < l; i++)ee[i] = handlers[i].fn;\n    return ee;\n};\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */ $ac9b757d51178e15$var$EventEmitter.prototype.listenerCount = function listenerCount(event) {\n    var evt = $ac9b757d51178e15$var$prefix ? $ac9b757d51178e15$var$prefix + event : event, listeners = this._events[evt];\n    if (!listeners) return 0;\n    if (listeners.fn) return 1;\n    return listeners.length;\n};\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */ $ac9b757d51178e15$var$EventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n    var evt = $ac9b757d51178e15$var$prefix ? $ac9b757d51178e15$var$prefix + event : event;\n    if (!this._events[evt]) return false;\n    var listeners = this._events[evt], len = arguments.length, args, i;\n    if (listeners.fn) {\n        if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n        switch(len){\n            case 1:\n                return listeners.fn.call(listeners.context), true;\n            case 2:\n                return listeners.fn.call(listeners.context, a1), true;\n            case 3:\n                return listeners.fn.call(listeners.context, a1, a2), true;\n            case 4:\n                return listeners.fn.call(listeners.context, a1, a2, a3), true;\n            case 5:\n                return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n            case 6:\n                return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n        }\n        for(i = 1, args = new Array(len - 1); i < len; i++)args[i - 1] = arguments[i];\n        listeners.fn.apply(listeners.context, args);\n    } else {\n        var length = listeners.length, j;\n        for(i = 0; i < length; i++){\n            if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n            switch(len){\n                case 1:\n                    listeners[i].fn.call(listeners[i].context);\n                    break;\n                case 2:\n                    listeners[i].fn.call(listeners[i].context, a1);\n                    break;\n                case 3:\n                    listeners[i].fn.call(listeners[i].context, a1, a2);\n                    break;\n                case 4:\n                    listeners[i].fn.call(listeners[i].context, a1, a2, a3);\n                    break;\n                default:\n                    if (!args) for(j = 1, args = new Array(len - 1); j < len; j++)args[j - 1] = arguments[j];\n                    listeners[i].fn.apply(listeners[i].context, args);\n            }\n        }\n    }\n    return true;\n};\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */ $ac9b757d51178e15$var$EventEmitter.prototype.on = function on(event, fn, context) {\n    return $ac9b757d51178e15$var$addListener(this, event, fn, context, false);\n};\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */ $ac9b757d51178e15$var$EventEmitter.prototype.once = function once(event, fn, context) {\n    return $ac9b757d51178e15$var$addListener(this, event, fn, context, true);\n};\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */ $ac9b757d51178e15$var$EventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n    var evt = $ac9b757d51178e15$var$prefix ? $ac9b757d51178e15$var$prefix + event : event;\n    if (!this._events[evt]) return this;\n    if (!fn) {\n        $ac9b757d51178e15$var$clearEvent(this, evt);\n        return this;\n    }\n    var listeners = this._events[evt];\n    if (listeners.fn) {\n        if (listeners.fn === fn && (!once || listeners.once) && (!context || listeners.context === context)) $ac9b757d51178e15$var$clearEvent(this, evt);\n    } else {\n        for(var i = 0, events = [], length = listeners.length; i < length; i++)if (listeners[i].fn !== fn || once && !listeners[i].once || context && listeners[i].context !== context) events.push(listeners[i]);\n        //\n        // Reset the array, or remove it completely if we have no more listeners.\n        //\n        if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n        else $ac9b757d51178e15$var$clearEvent(this, evt);\n    }\n    return this;\n};\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */ $ac9b757d51178e15$var$EventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n    var evt;\n    if (event) {\n        evt = $ac9b757d51178e15$var$prefix ? $ac9b757d51178e15$var$prefix + event : event;\n        if (this._events[evt]) $ac9b757d51178e15$var$clearEvent(this, evt);\n    } else {\n        this._events = new $ac9b757d51178e15$var$Events();\n        this._eventsCount = 0;\n    }\n    return this;\n};\n//\n// Alias methods names because people roll like that.\n//\n$ac9b757d51178e15$var$EventEmitter.prototype.off = $ac9b757d51178e15$var$EventEmitter.prototype.removeListener;\n$ac9b757d51178e15$var$EventEmitter.prototype.addListener = $ac9b757d51178e15$var$EventEmitter.prototype.on;\n//\n// Expose the prefix.\n//\n$ac9b757d51178e15$var$EventEmitter.prefixed = $ac9b757d51178e15$var$prefix;\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\n$ac9b757d51178e15$var$EventEmitter.EventEmitter = $ac9b757d51178e15$var$EventEmitter;\n$ac9b757d51178e15$exports = $ac9b757d51178e15$var$EventEmitter;\n\n\n\nvar $1615705ecc6adca3$exports = {};\n\n$parcel$export($1615705ecc6adca3$exports, \"LogLevel\", () => $1615705ecc6adca3$export$243e62d78d3b544d, (v) => $1615705ecc6adca3$export$243e62d78d3b544d = v);\n$parcel$export($1615705ecc6adca3$exports, \"default\", () => $1615705ecc6adca3$export$2e2bcd8739ae039, (v) => $1615705ecc6adca3$export$2e2bcd8739ae039 = v);\nvar $1615705ecc6adca3$var$__read = undefined && undefined.__read || function(o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while((n === void 0 || n-- > 0) && !(r = i.next()).done)ar.push(r.value);\n    } catch (error) {\n        e = {\n            error: error\n        };\n    } finally{\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        } finally{\n            if (e) throw e.error;\n        }\n    }\n    return ar;\n};\nvar $1615705ecc6adca3$var$__spreadArray = undefined && undefined.__spreadArray || function(to, from, pack) {\n    if (pack || arguments.length === 2) {\n        for(var i = 0, l = from.length, ar; i < l; i++)if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar $1615705ecc6adca3$var$LOG_PREFIX = \"PeerJS: \";\nvar $1615705ecc6adca3$export$243e62d78d3b544d;\n(function($1615705ecc6adca3$export$243e62d78d3b544d) {\n    $1615705ecc6adca3$export$243e62d78d3b544d[$1615705ecc6adca3$export$243e62d78d3b544d[\"Disabled\"] = 0] = \"Disabled\";\n    $1615705ecc6adca3$export$243e62d78d3b544d[$1615705ecc6adca3$export$243e62d78d3b544d[\"Errors\"] = 1] = \"Errors\";\n    $1615705ecc6adca3$export$243e62d78d3b544d[$1615705ecc6adca3$export$243e62d78d3b544d[\"Warnings\"] = 2] = \"Warnings\";\n    $1615705ecc6adca3$export$243e62d78d3b544d[$1615705ecc6adca3$export$243e62d78d3b544d[\"All\"] = 3] = \"All\";\n})($1615705ecc6adca3$export$243e62d78d3b544d || ($1615705ecc6adca3$export$243e62d78d3b544d = {}));\nvar $1615705ecc6adca3$var$Logger = /** @class */ function() {\n    function Logger() {\n        this._logLevel = $1615705ecc6adca3$export$243e62d78d3b544d.Disabled;\n    }\n    Object.defineProperty(Logger.prototype, \"logLevel\", {\n        get: function() {\n            return this._logLevel;\n        },\n        set: function(logLevel) {\n            this._logLevel = logLevel;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Logger.prototype.log = function() {\n        var args = [];\n        for(var _i = 0; _i < arguments.length; _i++)args[_i] = arguments[_i];\n        if (this._logLevel >= $1615705ecc6adca3$export$243e62d78d3b544d.All) this._print.apply(this, $1615705ecc6adca3$var$__spreadArray([\n            $1615705ecc6adca3$export$243e62d78d3b544d.All\n        ], $1615705ecc6adca3$var$__read(args), false));\n    };\n    Logger.prototype.warn = function() {\n        var args = [];\n        for(var _i = 0; _i < arguments.length; _i++)args[_i] = arguments[_i];\n        if (this._logLevel >= $1615705ecc6adca3$export$243e62d78d3b544d.Warnings) this._print.apply(this, $1615705ecc6adca3$var$__spreadArray([\n            $1615705ecc6adca3$export$243e62d78d3b544d.Warnings\n        ], $1615705ecc6adca3$var$__read(args), false));\n    };\n    Logger.prototype.error = function() {\n        var args = [];\n        for(var _i = 0; _i < arguments.length; _i++)args[_i] = arguments[_i];\n        if (this._logLevel >= $1615705ecc6adca3$export$243e62d78d3b544d.Errors) this._print.apply(this, $1615705ecc6adca3$var$__spreadArray([\n            $1615705ecc6adca3$export$243e62d78d3b544d.Errors\n        ], $1615705ecc6adca3$var$__read(args), false));\n    };\n    Logger.prototype.setLogFunction = function(fn) {\n        this._print = fn;\n    };\n    Logger.prototype._print = function(logLevel) {\n        var rest = [];\n        for(var _i = 1; _i < arguments.length; _i++)rest[_i - 1] = arguments[_i];\n        var copy = $1615705ecc6adca3$var$__spreadArray([\n            $1615705ecc6adca3$var$LOG_PREFIX\n        ], $1615705ecc6adca3$var$__read(rest), false);\n        for(var i in copy)if (copy[i] instanceof Error) copy[i] = \"(\" + copy[i].name + \") \" + copy[i].message;\n        if (logLevel >= $1615705ecc6adca3$export$243e62d78d3b544d.All) console.log.apply(console, $1615705ecc6adca3$var$__spreadArray([], $1615705ecc6adca3$var$__read(copy), false));\n        else if (logLevel >= $1615705ecc6adca3$export$243e62d78d3b544d.Warnings) console.warn.apply(console, $1615705ecc6adca3$var$__spreadArray([\n            \"WARNING\"\n        ], $1615705ecc6adca3$var$__read(copy), false));\n        else if (logLevel >= $1615705ecc6adca3$export$243e62d78d3b544d.Errors) console.error.apply(console, $1615705ecc6adca3$var$__spreadArray([\n            \"ERROR\"\n        ], $1615705ecc6adca3$var$__read(copy), false));\n    };\n    return Logger;\n}();\nvar $1615705ecc6adca3$export$2e2bcd8739ae039 = new $1615705ecc6adca3$var$Logger();\n\n\nvar $31d11a8d122cb4b7$exports = {};\n\n$parcel$export($31d11a8d122cb4b7$exports, \"Socket\", () => $31d11a8d122cb4b7$export$4798917dbf149b79, (v) => $31d11a8d122cb4b7$export$4798917dbf149b79 = v);\n\n\nvar $60fadef21a2daafc$export$3157d57b4135e3bc;\n(function($60fadef21a2daafc$export$3157d57b4135e3bc) {\n    $60fadef21a2daafc$export$3157d57b4135e3bc[\"Data\"] = \"data\";\n    $60fadef21a2daafc$export$3157d57b4135e3bc[\"Media\"] = \"media\";\n})($60fadef21a2daafc$export$3157d57b4135e3bc || ($60fadef21a2daafc$export$3157d57b4135e3bc = {}));\nvar $60fadef21a2daafc$export$9547aaa2e39030ff;\n(function($60fadef21a2daafc$export$9547aaa2e39030ff) {\n    $60fadef21a2daafc$export$9547aaa2e39030ff[\"BrowserIncompatible\"] = \"browser-incompatible\";\n    $60fadef21a2daafc$export$9547aaa2e39030ff[\"Disconnected\"] = \"disconnected\";\n    $60fadef21a2daafc$export$9547aaa2e39030ff[\"InvalidID\"] = \"invalid-id\";\n    $60fadef21a2daafc$export$9547aaa2e39030ff[\"InvalidKey\"] = \"invalid-key\";\n    $60fadef21a2daafc$export$9547aaa2e39030ff[\"Network\"] = \"network\";\n    $60fadef21a2daafc$export$9547aaa2e39030ff[\"PeerUnavailable\"] = \"peer-unavailable\";\n    $60fadef21a2daafc$export$9547aaa2e39030ff[\"SslUnavailable\"] = \"ssl-unavailable\";\n    $60fadef21a2daafc$export$9547aaa2e39030ff[\"ServerError\"] = \"server-error\";\n    $60fadef21a2daafc$export$9547aaa2e39030ff[\"SocketError\"] = \"socket-error\";\n    $60fadef21a2daafc$export$9547aaa2e39030ff[\"SocketClosed\"] = \"socket-closed\";\n    $60fadef21a2daafc$export$9547aaa2e39030ff[\"UnavailableID\"] = \"unavailable-id\";\n    $60fadef21a2daafc$export$9547aaa2e39030ff[\"WebRTC\"] = \"webrtc\";\n})($60fadef21a2daafc$export$9547aaa2e39030ff || ($60fadef21a2daafc$export$9547aaa2e39030ff = {}));\nvar $60fadef21a2daafc$export$89f507cf986a947;\n(function($60fadef21a2daafc$export$89f507cf986a947) {\n    $60fadef21a2daafc$export$89f507cf986a947[\"Binary\"] = \"binary\";\n    $60fadef21a2daafc$export$89f507cf986a947[\"BinaryUTF8\"] = \"binary-utf8\";\n    $60fadef21a2daafc$export$89f507cf986a947[\"JSON\"] = \"json\";\n})($60fadef21a2daafc$export$89f507cf986a947 || ($60fadef21a2daafc$export$89f507cf986a947 = {}));\nvar $60fadef21a2daafc$export$3b5c4a4b6354f023;\n(function($60fadef21a2daafc$export$3b5c4a4b6354f023) {\n    $60fadef21a2daafc$export$3b5c4a4b6354f023[\"Message\"] = \"message\";\n    $60fadef21a2daafc$export$3b5c4a4b6354f023[\"Disconnected\"] = \"disconnected\";\n    $60fadef21a2daafc$export$3b5c4a4b6354f023[\"Error\"] = \"error\";\n    $60fadef21a2daafc$export$3b5c4a4b6354f023[\"Close\"] = \"close\";\n})($60fadef21a2daafc$export$3b5c4a4b6354f023 || ($60fadef21a2daafc$export$3b5c4a4b6354f023 = {}));\nvar $60fadef21a2daafc$export$adb4a1754da6f10d;\n(function($60fadef21a2daafc$export$adb4a1754da6f10d) {\n    $60fadef21a2daafc$export$adb4a1754da6f10d[\"Heartbeat\"] = \"HEARTBEAT\";\n    $60fadef21a2daafc$export$adb4a1754da6f10d[\"Candidate\"] = \"CANDIDATE\";\n    $60fadef21a2daafc$export$adb4a1754da6f10d[\"Offer\"] = \"OFFER\";\n    $60fadef21a2daafc$export$adb4a1754da6f10d[\"Answer\"] = \"ANSWER\";\n    $60fadef21a2daafc$export$adb4a1754da6f10d[\"Open\"] = \"OPEN\";\n    $60fadef21a2daafc$export$adb4a1754da6f10d[\"Error\"] = \"ERROR\";\n    $60fadef21a2daafc$export$adb4a1754da6f10d[\"IdTaken\"] = \"ID-TAKEN\";\n    $60fadef21a2daafc$export$adb4a1754da6f10d[\"InvalidKey\"] = \"INVALID-KEY\";\n    $60fadef21a2daafc$export$adb4a1754da6f10d[\"Leave\"] = \"LEAVE\";\n    $60fadef21a2daafc$export$adb4a1754da6f10d[\"Expire\"] = \"EXPIRE\";\n})($60fadef21a2daafc$export$adb4a1754da6f10d || ($60fadef21a2daafc$export$adb4a1754da6f10d = {}));\n\n\nvar $0d1ed891c5cb27c0$exports = {};\n$0d1ed891c5cb27c0$exports = JSON.parse(\"{\\\"name\\\":\\\"peerjs\\\",\\\"version\\\":\\\"1.4.7\\\",\\\"keywords\\\":[\\\"peerjs\\\",\\\"webrtc\\\",\\\"p2p\\\",\\\"rtc\\\"],\\\"description\\\":\\\"PeerJS client\\\",\\\"homepage\\\":\\\"https://peerjs.com\\\",\\\"bugs\\\":{\\\"url\\\":\\\"https://github.com/peers/peerjs/issues\\\"},\\\"repository\\\":{\\\"type\\\":\\\"git\\\",\\\"url\\\":\\\"https://github.com/peers/peerjs\\\"},\\\"license\\\":\\\"MIT\\\",\\\"contributors\\\":[\\\"Michelle Bu <michelle@michellebu.com>\\\",\\\"afrokick <devbyru@gmail.com>\\\",\\\"ericz <really.ez@gmail.com>\\\",\\\"Jairo <kidandcat@gmail.com>\\\",\\\"Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>\\\",\\\"Jairo Caro-Accino Viciana <jairo@galax.be>\\\",\\\"Carlos Caballero <carlos.caballero.gonzalez@gmail.com>\\\",\\\"hc <hheennrryy@gmail.com>\\\",\\\"Muhammad Asif <capripio@gmail.com>\\\",\\\"PrashoonB <prashoonbhattacharjee@gmail.com>\\\",\\\"Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>\\\",\\\"akotynski <aleksanderkotbury@gmail.com>\\\",\\\"lmb <i@lmb.io>\\\",\\\"Jairooo <jairocaro@msn.com>\\\",\\\"Moritz Stückler <moritz.stueckler@gmail.com>\\\",\\\"Simon <crydotsnakegithub@gmail.com>\\\",\\\"Denis Lukov <denismassters@gmail.com>\\\",\\\"Philipp Hancke <fippo@andyet.net>\\\",\\\"Hans Oksendahl <hansoksendahl@gmail.com>\\\",\\\"Jess <jessachandler@gmail.com>\\\",\\\"khankuan <khankuan@gmail.com>\\\",\\\"DUODVK <kurmanov.work@gmail.com>\\\",\\\"XiZhao <kwang1imsa@gmail.com>\\\",\\\"Matthias Lohr <matthias@lohr.me>\\\",\\\"=frank tree <=frnktrb@googlemail.com>\\\",\\\"Andre Eckardt <aeckardt@outlook.com>\\\",\\\"Chris Cowan <agentme49@gmail.com>\\\",\\\"Alex Chuev <alex@chuev.com>\\\",\\\"alxnull <alxnull@e.mail.de>\\\",\\\"Yemel Jardi <angel.jardi@gmail.com>\\\",\\\"Ben Parnell <benjaminparnell.94@gmail.com>\\\",\\\"Benny Lichtner <bennlich@gmail.com>\\\",\\\"fresheneesz <bitetrudpublic@gmail.com>\\\",\\\"bob.barstead@exaptive.com <bob.barstead@exaptive.com>\\\",\\\"chandika <chandika@gmail.com>\\\",\\\"emersion <contact@emersion.fr>\\\",\\\"Christopher Van <cvan@users.noreply.github.com>\\\",\\\"eddieherm <edhermoso@gmail.com>\\\",\\\"Eduardo Pinho <enet4mikeenet@gmail.com>\\\",\\\"Evandro Zanatta <ezanatta@tray.net.br>\\\",\\\"Gardner Bickford <gardner@users.noreply.github.com>\\\",\\\"Gian Luca <gianluca.cecchi@cynny.com>\\\",\\\"PatrickJS <github@gdi2290.com>\\\",\\\"jonnyf <github@jonathanfoss.co.uk>\\\",\\\"Hizkia Felix <hizkifw@gmail.com>\\\",\\\"Hristo Oskov <hristo.oskov@gmail.com>\\\",\\\"Isaac Madwed <i.madwed@gmail.com>\\\",\\\"Ilya Konanykhin <ilya.konanykhin@gmail.com>\\\",\\\"jasonbarry <jasbarry@me.com>\\\",\\\"Jonathan Burke <jonathan.burke.1311@googlemail.com>\\\",\\\"Josh Hamit <josh.hamit@gmail.com>\\\",\\\"Jordan Austin <jrax86@gmail.com>\\\",\\\"Joel Wetzell <jwetzell@yahoo.com>\\\",\\\"xizhao <kevin.wang@cloudera.com>\\\",\\\"Alberto Torres <kungfoobar@gmail.com>\\\",\\\"Jonathan Mayol <mayoljonathan@gmail.com>\\\",\\\"Jefferson Felix <me@jsfelix.dev>\\\",\\\"Rolf Erik Lekang <me@rolflekang.com>\\\",\\\"Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>\\\",\\\"Pepijn de Vos <pepijndevos@gmail.com>\\\",\\\"JooYoung <qkdlql@naver.com>\\\",\\\"Tobias Speicher <rootcommander@gmail.com>\\\",\\\"Steve Blaurock <sblaurock@gmail.com>\\\",\\\"Kyrylo Shegeda <shegeda@ualberta.ca>\\\",\\\"Diwank Singh Tomer <singh@diwank.name>\\\",\\\"Sören Balko <Soeren.Balko@gmail.com>\\\",\\\"Arpit Solanki <solankiarpit1997@gmail.com>\\\",\\\"Yuki Ito <yuki@gnnk.net>\\\",\\\"Artur Zayats <zag2art@gmail.com>\\\"],\\\"funding\\\":{\\\"type\\\":\\\"opencollective\\\",\\\"url\\\":\\\"https://opencollective.com/peer\\\"},\\\"collective\\\":{\\\"type\\\":\\\"opencollective\\\",\\\"url\\\":\\\"https://opencollective.com/peer\\\"},\\\"files\\\":[\\\"dist/*\\\"],\\\"sideEffects\\\":[\\\"lib/global.ts\\\",\\\"lib/supports.ts\\\"],\\\"main\\\":\\\"dist/bundler.cjs\\\",\\\"module\\\":\\\"dist/bundler.mjs\\\",\\\"browser-minified\\\":\\\"dist/peerjs.min.js\\\",\\\"browser-unminified\\\":\\\"dist/peerjs.js\\\",\\\"types\\\":\\\"dist/types.d.ts\\\",\\\"engines\\\":{\\\"node\\\":\\\">= 10\\\"},\\\"targets\\\":{\\\"types\\\":{\\\"source\\\":\\\"lib/exports.ts\\\"},\\\"main\\\":{\\\"source\\\":\\\"lib/exports.ts\\\",\\\"sourceMap\\\":{\\\"inlineSources\\\":true}},\\\"module\\\":{\\\"source\\\":\\\"lib/exports.ts\\\",\\\"includeNodeModules\\\":[\\\"eventemitter3\\\"],\\\"sourceMap\\\":{\\\"inlineSources\\\":true}},\\\"browser-minified\\\":{\\\"context\\\":\\\"browser\\\",\\\"outputFormat\\\":\\\"global\\\",\\\"optimize\\\":true,\\\"engines\\\":{\\\"browsers\\\":\\\"cover 99%, not dead\\\"},\\\"source\\\":\\\"lib/global.ts\\\"},\\\"browser-unminified\\\":{\\\"context\\\":\\\"browser\\\",\\\"outputFormat\\\":\\\"global\\\",\\\"optimize\\\":false,\\\"engines\\\":{\\\"browsers\\\":\\\"cover 99%, not dead\\\"},\\\"source\\\":\\\"lib/global.ts\\\"}},\\\"scripts\\\":{\\\"contributors\\\":\\\"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\\\\\\"chore(contributors): update and sort contributors list\\\\\\\"\\\",\\\"check\\\":\\\"tsc --noEmit\\\",\\\"watch\\\":\\\"parcel watch\\\",\\\"build\\\":\\\"rm -rf dist && parcel build\\\",\\\"prepublishOnly\\\":\\\"npm run build\\\",\\\"test\\\":\\\"mocha -r ts-node/register -r jsdom-global/register test/**/*.ts\\\",\\\"format\\\":\\\"prettier --write .\\\",\\\"semantic-release\\\":\\\"semantic-release\\\"},\\\"devDependencies\\\":{\\\"@parcel/config-default\\\":\\\"^2.5.0\\\",\\\"@parcel/packager-ts\\\":\\\"^2.5.0\\\",\\\"@parcel/transformer-typescript-tsc\\\":\\\"^2.5.0\\\",\\\"@parcel/transformer-typescript-types\\\":\\\"^2.5.0\\\",\\\"@semantic-release/changelog\\\":\\\"^6.0.1\\\",\\\"@semantic-release/git\\\":\\\"^10.0.1\\\",\\\"@types/chai\\\":\\\"^4.3.0\\\",\\\"@types/mocha\\\":\\\"^9.1.0\\\",\\\"@types/node\\\":\\\"^17.0.18\\\",\\\"chai\\\":\\\"^4.3.6\\\",\\\"git-authors-cli\\\":\\\"^1.0.40\\\",\\\"jsdom\\\":\\\"^19.0.0\\\",\\\"jsdom-global\\\":\\\"^3.0.2\\\",\\\"mocha\\\":\\\"^9.2.0\\\",\\\"mock-socket\\\":\\\"8.0.5\\\",\\\"parcel\\\":\\\"^2.5.0\\\",\\\"parcel-transformer-tsc-sourcemaps\\\":\\\"^1.0.2\\\",\\\"prettier\\\":\\\"^2.6.2\\\",\\\"semantic-release\\\":\\\"^19.0.2\\\",\\\"standard\\\":\\\"^16.0.4\\\",\\\"ts-node\\\":\\\"^10.5.0\\\",\\\"typescript\\\":\\\"^4.5.5\\\"},\\\"dependencies\\\":{\\\"@swc/helpers\\\":\\\"^0.3.13\\\",\\\"eventemitter3\\\":\\\"^4.0.7\\\",\\\"peerjs-js-binarypack\\\":\\\"1.0.1\\\",\\\"webrtc-adapter\\\":\\\"^7.7.1\\\"}}\");\n\n\nvar $31d11a8d122cb4b7$var$__extends = undefined && undefined.__extends || function() {\n    var extendStatics = function(d1, b1) {\n        extendStatics = Object.setPrototypeOf || ({\n            __proto__: []\n        }) instanceof Array && function(d, b) {\n            d.__proto__ = b;\n        } || function(d, b) {\n            for(var p in b)if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n        };\n        return extendStatics(d1, b1);\n    };\n    return function(d, b) {\n        if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() {\n            this.constructor = d;\n        }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n}();\nvar $31d11a8d122cb4b7$var$__read = undefined && undefined.__read || function(o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while((n === void 0 || n-- > 0) && !(r = i.next()).done)ar.push(r.value);\n    } catch (error) {\n        e = {\n            error: error\n        };\n    } finally{\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        } finally{\n            if (e) throw e.error;\n        }\n    }\n    return ar;\n};\nvar $31d11a8d122cb4b7$var$__spreadArray = undefined && undefined.__spreadArray || function(to, from, pack) {\n    if (pack || arguments.length === 2) {\n        for(var i = 0, l = from.length, ar; i < l; i++)if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar $31d11a8d122cb4b7$var$__values = undefined && undefined.__values || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function() {\n            if (o && i >= o.length) o = void 0;\n            return {\n                value: o && o[i++],\n                done: !o\n            };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n/**\n * An abstraction on top of WebSockets to provide fastest\n * possible connection for peers.\n */ var $31d11a8d122cb4b7$export$4798917dbf149b79 = /** @class */ function(_super) {\n    $31d11a8d122cb4b7$var$__extends($31d11a8d122cb4b7$export$4798917dbf149b79, _super);\n    function $31d11a8d122cb4b7$export$4798917dbf149b79(secure, host, port, path, key, pingInterval) {\n        if (pingInterval === void 0) pingInterval = 5000;\n        var _this = _super.call(this) || this;\n        _this.pingInterval = pingInterval;\n        _this._disconnected = true;\n        _this._messagesQueue = [];\n        var wsProtocol = secure ? \"wss://\" : \"ws://\";\n        _this._baseUrl = wsProtocol + host + \":\" + port + path + \"peerjs?key=\" + key;\n        return _this;\n    }\n    $31d11a8d122cb4b7$export$4798917dbf149b79.prototype.start = function(id, token) {\n        var _this = this;\n        this._id = id;\n        var wsUrl = \"\".concat(this._baseUrl, \"&id=\").concat(id, \"&token=\").concat(token);\n        if (!!this._socket || !this._disconnected) return;\n        this._socket = new WebSocket(wsUrl + \"&version=\" + $0d1ed891c5cb27c0$exports.version);\n        this._disconnected = false;\n        this._socket.onmessage = function(event) {\n            var data;\n            try {\n                data = JSON.parse(event.data);\n                $1615705ecc6adca3$exports.default.log(\"Server message received:\", data);\n            } catch (e) {\n                $1615705ecc6adca3$exports.default.log(\"Invalid server message\", event.data);\n                return;\n            }\n            _this.emit($60fadef21a2daafc$export$3b5c4a4b6354f023.Message, data);\n        };\n        this._socket.onclose = function(event) {\n            if (_this._disconnected) return;\n            $1615705ecc6adca3$exports.default.log(\"Socket closed.\", event);\n            _this._cleanup();\n            _this._disconnected = true;\n            _this.emit($60fadef21a2daafc$export$3b5c4a4b6354f023.Disconnected);\n        };\n        // Take care of the queue of connections if necessary and make sure Peer knows\n        // socket is open.\n        this._socket.onopen = function() {\n            if (_this._disconnected) return;\n            _this._sendQueuedMessages();\n            $1615705ecc6adca3$exports.default.log(\"Socket open\");\n            _this._scheduleHeartbeat();\n        };\n    };\n    $31d11a8d122cb4b7$export$4798917dbf149b79.prototype._scheduleHeartbeat = function() {\n        var _this = this;\n        this._wsPingTimer = setTimeout(function() {\n            _this._sendHeartbeat();\n        }, this.pingInterval);\n    };\n    $31d11a8d122cb4b7$export$4798917dbf149b79.prototype._sendHeartbeat = function() {\n        if (!this._wsOpen()) {\n            $1615705ecc6adca3$exports.default.log(\"Cannot send heartbeat, because socket closed\");\n            return;\n        }\n        var message = JSON.stringify({\n            type: $60fadef21a2daafc$export$adb4a1754da6f10d.Heartbeat\n        });\n        this._socket.send(message);\n        this._scheduleHeartbeat();\n    };\n    /** Is the websocket currently open? */ $31d11a8d122cb4b7$export$4798917dbf149b79.prototype._wsOpen = function() {\n        return !!this._socket && this._socket.readyState === 1;\n    };\n    /** Send queued messages. */ $31d11a8d122cb4b7$export$4798917dbf149b79.prototype._sendQueuedMessages = function() {\n        var e_1, _a;\n        //Create copy of queue and clear it,\n        //because send method push the message back to queue if smth will go wrong\n        var copiedQueue = $31d11a8d122cb4b7$var$__spreadArray([], $31d11a8d122cb4b7$var$__read(this._messagesQueue), false);\n        this._messagesQueue = [];\n        try {\n            for(var copiedQueue_1 = $31d11a8d122cb4b7$var$__values(copiedQueue), copiedQueue_1_1 = copiedQueue_1.next(); !copiedQueue_1_1.done; copiedQueue_1_1 = copiedQueue_1.next()){\n                var message = copiedQueue_1_1.value;\n                this.send(message);\n            }\n        } catch (e_1_1) {\n            e_1 = {\n                error: e_1_1\n            };\n        } finally{\n            try {\n                if (copiedQueue_1_1 && !copiedQueue_1_1.done && (_a = copiedQueue_1.return)) _a.call(copiedQueue_1);\n            } finally{\n                if (e_1) throw e_1.error;\n            }\n        }\n    };\n    /** Exposed send for DC & Peer. */ $31d11a8d122cb4b7$export$4798917dbf149b79.prototype.send = function(data) {\n        if (this._disconnected) return;\n        // If we didn't get an ID yet, we can't yet send anything so we should queue\n        // up these messages.\n        if (!this._id) {\n            this._messagesQueue.push(data);\n            return;\n        }\n        if (!data.type) {\n            this.emit($60fadef21a2daafc$export$3b5c4a4b6354f023.Error, \"Invalid message\");\n            return;\n        }\n        if (!this._wsOpen()) return;\n        var message = JSON.stringify(data);\n        this._socket.send(message);\n    };\n    $31d11a8d122cb4b7$export$4798917dbf149b79.prototype.close = function() {\n        if (this._disconnected) return;\n        this._cleanup();\n        this._disconnected = true;\n    };\n    $31d11a8d122cb4b7$export$4798917dbf149b79.prototype._cleanup = function() {\n        if (this._socket) {\n            this._socket.onopen = this._socket.onmessage = this._socket.onclose = null;\n            this._socket.close();\n            this._socket = undefined;\n        }\n        clearTimeout(this._wsPingTimer);\n    };\n    return $31d11a8d122cb4b7$export$4798917dbf149b79;\n}($ac9b757d51178e15$exports.EventEmitter);\n\n\nvar $353dee38f9ab557b$exports = {};\n\n$parcel$export($353dee38f9ab557b$exports, \"MediaConnection\", () => $353dee38f9ab557b$export$4a84e95a2324ac29, (v) => $353dee38f9ab557b$export$4a84e95a2324ac29 = v);\n\n\nvar $77f14d3e81888156$exports = {};\n\n$parcel$export($77f14d3e81888156$exports, \"Negotiator\", () => $77f14d3e81888156$export$89e6bb5ad64bf4a, (v) => $77f14d3e81888156$export$89e6bb5ad64bf4a = v);\n\n\n\nvar $77f14d3e81888156$var$__assign = undefined && undefined.__assign || function() {\n    $77f14d3e81888156$var$__assign = Object.assign || function(t) {\n        for(var s, i = 1, n = arguments.length; i < n; i++){\n            s = arguments[i];\n            for(var p in s)if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n        }\n        return t;\n    };\n    return $77f14d3e81888156$var$__assign.apply(this, arguments);\n};\nvar $77f14d3e81888156$var$__awaiter = undefined && undefined.__awaiter || function(thisArg, _arguments, P, generator) {\n    function adopt(value) {\n        return value instanceof P ? value : new P(function(resolve) {\n            resolve(value);\n        });\n    }\n    return new (P || (P = Promise))(function(resolve, reject) {\n        function fulfilled(value) {\n            try {\n                step(generator.next(value));\n            } catch (e) {\n                reject(e);\n            }\n        }\n        function rejected(value) {\n            try {\n                step(generator[\"throw\"](value));\n            } catch (e) {\n                reject(e);\n            }\n        }\n        function step(result) {\n            result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n        }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar $77f14d3e81888156$var$__generator = undefined && undefined.__generator || function(thisArg, body) {\n    var _ = {\n        label: 0,\n        sent: function() {\n            if (t[0] & 1) throw t[1];\n            return t[1];\n        },\n        trys: [],\n        ops: []\n    }, f, y, t, g;\n    return g = {\n        next: verb(0),\n        \"throw\": verb(1),\n        \"return\": verb(2)\n    }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() {\n        return this;\n    }), g;\n    function verb(n) {\n        return function(v) {\n            return step([\n                n,\n                v\n            ]);\n        };\n    }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while(_)try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [\n                op[0] & 2,\n                t.value\n            ];\n            switch(op[0]){\n                case 0:\n                case 1:\n                    t = op;\n                    break;\n                case 4:\n                    _.label++;\n                    return {\n                        value: op[1],\n                        done: false\n                    };\n                case 5:\n                    _.label++;\n                    y = op[1];\n                    op = [\n                        0\n                    ];\n                    continue;\n                case 7:\n                    op = _.ops.pop();\n                    _.trys.pop();\n                    continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                        _ = 0;\n                        continue;\n                    }\n                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                        _.label = op[1];\n                        break;\n                    }\n                    if (op[0] === 6 && _.label < t[1]) {\n                        _.label = t[1];\n                        t = op;\n                        break;\n                    }\n                    if (t && _.label < t[2]) {\n                        _.label = t[2];\n                        _.ops.push(op);\n                        break;\n                    }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop();\n                    continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) {\n            op = [\n                6,\n                e\n            ];\n            y = 0;\n        } finally{\n            f = t = 0;\n        }\n        if (op[0] & 5) throw op[1];\n        return {\n            value: op[0] ? op[1] : void 0,\n            done: true\n        };\n    }\n};\n/**\n * Manages all negotiations between Peers.\n */ var $77f14d3e81888156$export$89e6bb5ad64bf4a = /** @class */ function() {\n    function $77f14d3e81888156$export$89e6bb5ad64bf4a(connection) {\n        this.connection = connection;\n    }\n    /** Returns a PeerConnection object set up correctly (for data, media). */ $77f14d3e81888156$export$89e6bb5ad64bf4a.prototype.startConnection = function(options) {\n        var peerConnection = this._startPeerConnection();\n        // Set the connection's PC.\n        this.connection.peerConnection = peerConnection;\n        if (this.connection.type === $60fadef21a2daafc$export$3157d57b4135e3bc.Media && options._stream) this._addTracksToConnection(options._stream, peerConnection);\n        // What do we need to do now?\n        if (options.originator) {\n            if (this.connection.type === $60fadef21a2daafc$export$3157d57b4135e3bc.Data) {\n                var dataConnection = this.connection;\n                var config = {\n                    ordered: !!options.reliable\n                };\n                var dataChannel = peerConnection.createDataChannel(dataConnection.label, config);\n                dataConnection.initialize(dataChannel);\n            }\n            this._makeOffer();\n        } else this.handleSDP(\"OFFER\", options.sdp);\n    };\n    /** Start a PC. */ $77f14d3e81888156$export$89e6bb5ad64bf4a.prototype._startPeerConnection = function() {\n        $1615705ecc6adca3$exports.default.log(\"Creating RTCPeerConnection.\");\n        var peerConnection = new RTCPeerConnection(this.connection.provider.options.config);\n        this._setupListeners(peerConnection);\n        return peerConnection;\n    };\n    /** Set up various WebRTC listeners. */ $77f14d3e81888156$export$89e6bb5ad64bf4a.prototype._setupListeners = function(peerConnection) {\n        var _this = this;\n        var peerId = this.connection.peer;\n        var connectionId = this.connection.connectionId;\n        var connectionType = this.connection.type;\n        var provider = this.connection.provider;\n        // ICE CANDIDATES.\n        $1615705ecc6adca3$exports.default.log(\"Listening for ICE candidates.\");\n        peerConnection.onicecandidate = function(evt) {\n            if (!evt.candidate || !evt.candidate.candidate) return;\n            $1615705ecc6adca3$exports.default.log(\"Received ICE candidates for \".concat(peerId, \":\"), evt.candidate);\n            provider.socket.send({\n                type: $60fadef21a2daafc$export$adb4a1754da6f10d.Candidate,\n                payload: {\n                    candidate: evt.candidate,\n                    type: connectionType,\n                    connectionId: connectionId\n                },\n                dst: peerId\n            });\n        };\n        peerConnection.oniceconnectionstatechange = function() {\n            switch(peerConnection.iceConnectionState){\n                case \"failed\":\n                    $1615705ecc6adca3$exports.default.log(\"iceConnectionState is failed, closing connections to \" + peerId);\n                    _this.connection.emit(\"error\", new Error(\"Negotiation of connection to \" + peerId + \" failed.\"));\n                    _this.connection.close();\n                    break;\n                case \"closed\":\n                    $1615705ecc6adca3$exports.default.log(\"iceConnectionState is closed, closing connections to \" + peerId);\n                    _this.connection.emit(\"error\", new Error(\"Connection to \" + peerId + \" closed.\"));\n                    _this.connection.close();\n                    break;\n                case \"disconnected\":\n                    $1615705ecc6adca3$exports.default.log(\"iceConnectionState changed to disconnected on the connection with \" + peerId);\n                    break;\n                case \"completed\":\n                    peerConnection.onicecandidate = $06cb531ed7840f78$export$7debb50ef11d5e0b.noop;\n                    break;\n            }\n            _this.connection.emit(\"iceStateChanged\", peerConnection.iceConnectionState);\n        };\n        // DATACONNECTION.\n        $1615705ecc6adca3$exports.default.log(\"Listening for data channel\");\n        // Fired between offer and answer, so options should already be saved\n        // in the options hash.\n        peerConnection.ondatachannel = function(evt) {\n            $1615705ecc6adca3$exports.default.log(\"Received data channel\");\n            var dataChannel = evt.channel;\n            var connection = provider.getConnection(peerId, connectionId);\n            connection.initialize(dataChannel);\n        };\n        // MEDIACONNECTION.\n        $1615705ecc6adca3$exports.default.log(\"Listening for remote stream\");\n        peerConnection.ontrack = function(evt) {\n            $1615705ecc6adca3$exports.default.log(\"Received remote stream\");\n            var stream = evt.streams[0];\n            var connection = provider.getConnection(peerId, connectionId);\n            if (connection.type === $60fadef21a2daafc$export$3157d57b4135e3bc.Media) {\n                var mediaConnection = connection;\n                _this._addStreamToMediaConnection(stream, mediaConnection);\n            }\n        };\n    };\n    $77f14d3e81888156$export$89e6bb5ad64bf4a.prototype.cleanup = function() {\n        $1615705ecc6adca3$exports.default.log(\"Cleaning up PeerConnection to \" + this.connection.peer);\n        var peerConnection = this.connection.peerConnection;\n        if (!peerConnection) return;\n        this.connection.peerConnection = null;\n        //unsubscribe from all PeerConnection's events\n        peerConnection.onicecandidate = peerConnection.oniceconnectionstatechange = peerConnection.ondatachannel = peerConnection.ontrack = function() {};\n        var peerConnectionNotClosed = peerConnection.signalingState !== \"closed\";\n        var dataChannelNotClosed = false;\n        if (this.connection.type === $60fadef21a2daafc$export$3157d57b4135e3bc.Data) {\n            var dataConnection = this.connection;\n            var dataChannel = dataConnection.dataChannel;\n            if (dataChannel) dataChannelNotClosed = !!dataChannel.readyState && dataChannel.readyState !== \"closed\";\n        }\n        if (peerConnectionNotClosed || dataChannelNotClosed) peerConnection.close();\n    };\n    $77f14d3e81888156$export$89e6bb5ad64bf4a.prototype._makeOffer = function() {\n        return $77f14d3e81888156$var$__awaiter(this, void 0, Promise, function() {\n            var peerConnection, provider, offer, payload, dataConnection, err_2, err_1_1;\n            return $77f14d3e81888156$var$__generator(this, function(_a) {\n                switch(_a.label){\n                    case 0:\n                        peerConnection = this.connection.peerConnection;\n                        provider = this.connection.provider;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([\n                            1,\n                            7,\n                            ,\n                            8\n                        ]);\n                        return [\n                            4 /*yield*/ ,\n                            peerConnection.createOffer(this.connection.options.constraints)\n                        ];\n                    case 2:\n                        offer = _a.sent();\n                        $1615705ecc6adca3$exports.default.log(\"Created offer.\");\n                        if (this.connection.options.sdpTransform && typeof this.connection.options.sdpTransform === \"function\") offer.sdp = this.connection.options.sdpTransform(offer.sdp) || offer.sdp;\n                        _a.label = 3;\n                    case 3:\n                        _a.trys.push([\n                            3,\n                            5,\n                            ,\n                            6\n                        ]);\n                        return [\n                            4 /*yield*/ ,\n                            peerConnection.setLocalDescription(offer)\n                        ];\n                    case 4:\n                        _a.sent();\n                        $1615705ecc6adca3$exports.default.log(\"Set localDescription:\", offer, \"for:\".concat(this.connection.peer));\n                        payload = {\n                            sdp: offer,\n                            type: this.connection.type,\n                            connectionId: this.connection.connectionId,\n                            metadata: this.connection.metadata,\n                            browser: $06cb531ed7840f78$export$7debb50ef11d5e0b.browser\n                        };\n                        if (this.connection.type === $60fadef21a2daafc$export$3157d57b4135e3bc.Data) {\n                            dataConnection = this.connection;\n                            payload = $77f14d3e81888156$var$__assign($77f14d3e81888156$var$__assign({}, payload), {\n                                label: dataConnection.label,\n                                reliable: dataConnection.reliable,\n                                serialization: dataConnection.serialization\n                            });\n                        }\n                        provider.socket.send({\n                            type: $60fadef21a2daafc$export$adb4a1754da6f10d.Offer,\n                            payload: payload,\n                            dst: this.connection.peer\n                        });\n                        return [\n                            3 /*break*/ ,\n                            6\n                        ];\n                    case 5:\n                        err_2 = _a.sent();\n                        // TODO: investigate why _makeOffer is being called from the answer\n                        if (err_2 != \"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer\") {\n                            provider.emitError($60fadef21a2daafc$export$9547aaa2e39030ff.WebRTC, err_2);\n                            $1615705ecc6adca3$exports.default.log(\"Failed to setLocalDescription, \", err_2);\n                        }\n                        return [\n                            3 /*break*/ ,\n                            6\n                        ];\n                    case 6:\n                        return [\n                            3 /*break*/ ,\n                            8\n                        ];\n                    case 7:\n                        err_1_1 = _a.sent();\n                        provider.emitError($60fadef21a2daafc$export$9547aaa2e39030ff.WebRTC, err_1_1);\n                        $1615705ecc6adca3$exports.default.log(\"Failed to createOffer, \", err_1_1);\n                        return [\n                            3 /*break*/ ,\n                            8\n                        ];\n                    case 8:\n                        return [\n                            2 /*return*/ \n                        ];\n                }\n            });\n        });\n    };\n    $77f14d3e81888156$export$89e6bb5ad64bf4a.prototype._makeAnswer = function() {\n        return $77f14d3e81888156$var$__awaiter(this, void 0, Promise, function() {\n            var peerConnection, provider, answer, err_3, err_1_2;\n            return $77f14d3e81888156$var$__generator(this, function(_a) {\n                switch(_a.label){\n                    case 0:\n                        peerConnection = this.connection.peerConnection;\n                        provider = this.connection.provider;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([\n                            1,\n                            7,\n                            ,\n                            8\n                        ]);\n                        return [\n                            4 /*yield*/ ,\n                            peerConnection.createAnswer()\n                        ];\n                    case 2:\n                        answer = _a.sent();\n                        $1615705ecc6adca3$exports.default.log(\"Created answer.\");\n                        if (this.connection.options.sdpTransform && typeof this.connection.options.sdpTransform === \"function\") answer.sdp = this.connection.options.sdpTransform(answer.sdp) || answer.sdp;\n                        _a.label = 3;\n                    case 3:\n                        _a.trys.push([\n                            3,\n                            5,\n                            ,\n                            6\n                        ]);\n                        return [\n                            4 /*yield*/ ,\n                            peerConnection.setLocalDescription(answer)\n                        ];\n                    case 4:\n                        _a.sent();\n                        $1615705ecc6adca3$exports.default.log(\"Set localDescription:\", answer, \"for:\".concat(this.connection.peer));\n                        provider.socket.send({\n                            type: $60fadef21a2daafc$export$adb4a1754da6f10d.Answer,\n                            payload: {\n                                sdp: answer,\n                                type: this.connection.type,\n                                connectionId: this.connection.connectionId,\n                                browser: $06cb531ed7840f78$export$7debb50ef11d5e0b.browser\n                            },\n                            dst: this.connection.peer\n                        });\n                        return [\n                            3 /*break*/ ,\n                            6\n                        ];\n                    case 5:\n                        err_3 = _a.sent();\n                        provider.emitError($60fadef21a2daafc$export$9547aaa2e39030ff.WebRTC, err_3);\n                        $1615705ecc6adca3$exports.default.log(\"Failed to setLocalDescription, \", err_3);\n                        return [\n                            3 /*break*/ ,\n                            6\n                        ];\n                    case 6:\n                        return [\n                            3 /*break*/ ,\n                            8\n                        ];\n                    case 7:\n                        err_1_2 = _a.sent();\n                        provider.emitError($60fadef21a2daafc$export$9547aaa2e39030ff.WebRTC, err_1_2);\n                        $1615705ecc6adca3$exports.default.log(\"Failed to create answer, \", err_1_2);\n                        return [\n                            3 /*break*/ ,\n                            8\n                        ];\n                    case 8:\n                        return [\n                            2 /*return*/ \n                        ];\n                }\n            });\n        });\n    };\n    /** Handle an SDP. */ $77f14d3e81888156$export$89e6bb5ad64bf4a.prototype.handleSDP = function(type, sdp) {\n        return $77f14d3e81888156$var$__awaiter(this, void 0, Promise, function() {\n            var peerConnection, provider, self, err_4;\n            return $77f14d3e81888156$var$__generator(this, function(_a) {\n                switch(_a.label){\n                    case 0:\n                        sdp = new RTCSessionDescription(sdp);\n                        peerConnection = this.connection.peerConnection;\n                        provider = this.connection.provider;\n                        $1615705ecc6adca3$exports.default.log(\"Setting remote description\", sdp);\n                        self = this;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([\n                            1,\n                            5,\n                            ,\n                            6\n                        ]);\n                        return [\n                            4 /*yield*/ ,\n                            peerConnection.setRemoteDescription(sdp)\n                        ];\n                    case 2:\n                        _a.sent();\n                        $1615705ecc6adca3$exports.default.log(\"Set remoteDescription:\".concat(type, \" for:\").concat(this.connection.peer));\n                        if (!(type === \"OFFER\")) return [\n                            3 /*break*/ ,\n                            4\n                        ];\n                        return [\n                            4 /*yield*/ ,\n                            self._makeAnswer()\n                        ];\n                    case 3:\n                        _a.sent();\n                        _a.label = 4;\n                    case 4:\n                        return [\n                            3 /*break*/ ,\n                            6\n                        ];\n                    case 5:\n                        err_4 = _a.sent();\n                        provider.emitError($60fadef21a2daafc$export$9547aaa2e39030ff.WebRTC, err_4);\n                        $1615705ecc6adca3$exports.default.log(\"Failed to setRemoteDescription, \", err_4);\n                        return [\n                            3 /*break*/ ,\n                            6\n                        ];\n                    case 6:\n                        return [\n                            2 /*return*/ \n                        ];\n                }\n            });\n        });\n    };\n    /** Handle a candidate. */ $77f14d3e81888156$export$89e6bb5ad64bf4a.prototype.handleCandidate = function(ice) {\n        return $77f14d3e81888156$var$__awaiter(this, void 0, Promise, function() {\n            var candidate, sdpMLineIndex, sdpMid, peerConnection, provider, err_5;\n            return $77f14d3e81888156$var$__generator(this, function(_a) {\n                switch(_a.label){\n                    case 0:\n                        $1615705ecc6adca3$exports.default.log(\"handleCandidate:\", ice);\n                        candidate = ice.candidate;\n                        sdpMLineIndex = ice.sdpMLineIndex;\n                        sdpMid = ice.sdpMid;\n                        peerConnection = this.connection.peerConnection;\n                        provider = this.connection.provider;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([\n                            1,\n                            3,\n                            ,\n                            4\n                        ]);\n                        return [\n                            4 /*yield*/ ,\n                            peerConnection.addIceCandidate(new RTCIceCandidate({\n                                sdpMid: sdpMid,\n                                sdpMLineIndex: sdpMLineIndex,\n                                candidate: candidate\n                            }))\n                        ];\n                    case 2:\n                        _a.sent();\n                        $1615705ecc6adca3$exports.default.log(\"Added ICE candidate for:\".concat(this.connection.peer));\n                        return [\n                            3 /*break*/ ,\n                            4\n                        ];\n                    case 3:\n                        err_5 = _a.sent();\n                        provider.emitError($60fadef21a2daafc$export$9547aaa2e39030ff.WebRTC, err_5);\n                        $1615705ecc6adca3$exports.default.log(\"Failed to handleCandidate, \", err_5);\n                        return [\n                            3 /*break*/ ,\n                            4\n                        ];\n                    case 4:\n                        return [\n                            2 /*return*/ \n                        ];\n                }\n            });\n        });\n    };\n    $77f14d3e81888156$export$89e6bb5ad64bf4a.prototype._addTracksToConnection = function(stream, peerConnection) {\n        $1615705ecc6adca3$exports.default.log(\"add tracks from stream \".concat(stream.id, \" to peer connection\"));\n        if (!peerConnection.addTrack) return $1615705ecc6adca3$exports.default.error(\"Your browser does't support RTCPeerConnection#addTrack. Ignored.\");\n        stream.getTracks().forEach(function(track) {\n            peerConnection.addTrack(track, stream);\n        });\n    };\n    $77f14d3e81888156$export$89e6bb5ad64bf4a.prototype._addStreamToMediaConnection = function(stream, mediaConnection) {\n        $1615705ecc6adca3$exports.default.log(\"add stream \".concat(stream.id, \" to media connection \").concat(mediaConnection.connectionId));\n        mediaConnection.addStream(stream);\n    };\n    return $77f14d3e81888156$export$89e6bb5ad64bf4a;\n}();\n\n\n\nvar $0b3b332fd86c5202$exports = {};\n\n$parcel$export($0b3b332fd86c5202$exports, \"BaseConnection\", () => $0b3b332fd86c5202$export$23a2a68283c24d80, (v) => $0b3b332fd86c5202$export$23a2a68283c24d80 = v);\n\nvar $0b3b332fd86c5202$var$__extends = undefined && undefined.__extends || function() {\n    var extendStatics = function(d1, b1) {\n        extendStatics = Object.setPrototypeOf || ({\n            __proto__: []\n        }) instanceof Array && function(d, b) {\n            d.__proto__ = b;\n        } || function(d, b) {\n            for(var p in b)if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n        };\n        return extendStatics(d1, b1);\n    };\n    return function(d, b) {\n        if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() {\n            this.constructor = d;\n        }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n}();\nvar $0b3b332fd86c5202$export$23a2a68283c24d80 = /** @class */ function(_super) {\n    $0b3b332fd86c5202$var$__extends($0b3b332fd86c5202$export$23a2a68283c24d80, _super);\n    function $0b3b332fd86c5202$export$23a2a68283c24d80(peer, provider, options) {\n        var _this = _super.call(this) || this;\n        _this.peer = peer;\n        _this.provider = provider;\n        _this.options = options;\n        _this._open = false;\n        _this.metadata = options.metadata;\n        return _this;\n    }\n    Object.defineProperty($0b3b332fd86c5202$export$23a2a68283c24d80.prototype, \"open\", {\n        get: function() {\n            return this._open;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return $0b3b332fd86c5202$export$23a2a68283c24d80;\n}($ac9b757d51178e15$exports.EventEmitter);\n\n\nvar $353dee38f9ab557b$var$__extends = undefined && undefined.__extends || function() {\n    var extendStatics = function(d1, b1) {\n        extendStatics = Object.setPrototypeOf || ({\n            __proto__: []\n        }) instanceof Array && function(d, b) {\n            d.__proto__ = b;\n        } || function(d, b) {\n            for(var p in b)if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n        };\n        return extendStatics(d1, b1);\n    };\n    return function(d, b) {\n        if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() {\n            this.constructor = d;\n        }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n}();\nvar $353dee38f9ab557b$var$__assign = undefined && undefined.__assign || function() {\n    $353dee38f9ab557b$var$__assign = Object.assign || function(t) {\n        for(var s, i = 1, n = arguments.length; i < n; i++){\n            s = arguments[i];\n            for(var p in s)if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n        }\n        return t;\n    };\n    return $353dee38f9ab557b$var$__assign.apply(this, arguments);\n};\nvar $353dee38f9ab557b$var$__values = undefined && undefined.__values || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function() {\n            if (o && i >= o.length) o = void 0;\n            return {\n                value: o && o[i++],\n                done: !o\n            };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n/**\n * Wraps the streaming interface between two Peers.\n */ var $353dee38f9ab557b$export$4a84e95a2324ac29 = /** @class */ function(_super) {\n    $353dee38f9ab557b$var$__extends($353dee38f9ab557b$export$4a84e95a2324ac29, _super);\n    function $353dee38f9ab557b$export$4a84e95a2324ac29(peerId, provider, options) {\n        var _this = _super.call(this, peerId, provider, options) || this;\n        _this._localStream = _this.options._stream;\n        _this.connectionId = _this.options.connectionId || $353dee38f9ab557b$export$4a84e95a2324ac29.ID_PREFIX + $06cb531ed7840f78$export$7debb50ef11d5e0b.randomToken();\n        _this._negotiator = new $77f14d3e81888156$exports.Negotiator(_this);\n        if (_this._localStream) _this._negotiator.startConnection({\n            _stream: _this._localStream,\n            originator: true\n        });\n        return _this;\n    }\n    Object.defineProperty($353dee38f9ab557b$export$4a84e95a2324ac29.prototype, \"type\", {\n        get: function() {\n            return $60fadef21a2daafc$export$3157d57b4135e3bc.Media;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty($353dee38f9ab557b$export$4a84e95a2324ac29.prototype, \"localStream\", {\n        get: function() {\n            return this._localStream;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty($353dee38f9ab557b$export$4a84e95a2324ac29.prototype, \"remoteStream\", {\n        get: function() {\n            return this._remoteStream;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    $353dee38f9ab557b$export$4a84e95a2324ac29.prototype.addStream = function(remoteStream) {\n        $1615705ecc6adca3$exports.default.log(\"Receiving stream\", remoteStream);\n        this._remoteStream = remoteStream;\n        _super.prototype.emit.call(this, \"stream\", remoteStream); // Should we call this `open`?\n    };\n    $353dee38f9ab557b$export$4a84e95a2324ac29.prototype.handleMessage = function(message) {\n        var type = message.type;\n        var payload = message.payload;\n        switch(message.type){\n            case $60fadef21a2daafc$export$adb4a1754da6f10d.Answer:\n                // Forward to negotiator\n                this._negotiator.handleSDP(type, payload.sdp);\n                this._open = true;\n                break;\n            case $60fadef21a2daafc$export$adb4a1754da6f10d.Candidate:\n                this._negotiator.handleCandidate(payload.candidate);\n                break;\n            default:\n                $1615705ecc6adca3$exports.default.warn(\"Unrecognized message type:\".concat(type, \" from peer:\").concat(this.peer));\n                break;\n        }\n    };\n    $353dee38f9ab557b$export$4a84e95a2324ac29.prototype.answer = function(stream, options) {\n        var e_1, _a;\n        if (options === void 0) options = {};\n        if (this._localStream) {\n            $1615705ecc6adca3$exports.default.warn(\"Local stream already exists on this MediaConnection. Are you answering a call twice?\");\n            return;\n        }\n        this._localStream = stream;\n        if (options && options.sdpTransform) this.options.sdpTransform = options.sdpTransform;\n        this._negotiator.startConnection($353dee38f9ab557b$var$__assign($353dee38f9ab557b$var$__assign({}, this.options._payload), {\n            _stream: stream\n        }));\n        // Retrieve lost messages stored because PeerConnection not set up.\n        var messages = this.provider._getMessages(this.connectionId);\n        try {\n            for(var messages_1 = $353dee38f9ab557b$var$__values(messages), messages_1_1 = messages_1.next(); !messages_1_1.done; messages_1_1 = messages_1.next()){\n                var message = messages_1_1.value;\n                this.handleMessage(message);\n            }\n        } catch (e_1_1) {\n            e_1 = {\n                error: e_1_1\n            };\n        } finally{\n            try {\n                if (messages_1_1 && !messages_1_1.done && (_a = messages_1.return)) _a.call(messages_1);\n            } finally{\n                if (e_1) throw e_1.error;\n            }\n        }\n        this._open = true;\n    };\n    /**\n     * Exposed functionality for users.\n     */ /** Allows user to close connection. */ $353dee38f9ab557b$export$4a84e95a2324ac29.prototype.close = function() {\n        if (this._negotiator) {\n            this._negotiator.cleanup();\n            this._negotiator = null;\n        }\n        this._localStream = null;\n        this._remoteStream = null;\n        if (this.provider) {\n            this.provider._removeConnection(this);\n            this.provider = null;\n        }\n        if (this.options && this.options._stream) this.options._stream = null;\n        if (!this.open) return;\n        this._open = false;\n        _super.prototype.emit.call(this, \"close\");\n    };\n    $353dee38f9ab557b$export$4a84e95a2324ac29.ID_PREFIX = \"mc_\";\n    return $353dee38f9ab557b$export$4a84e95a2324ac29;\n}($0b3b332fd86c5202$exports.BaseConnection);\n\n\nvar $3356170d7bce7f20$exports = {};\n\n$parcel$export($3356170d7bce7f20$exports, \"DataConnection\", () => $3356170d7bce7f20$export$d365f7ad9d7df9c9, (v) => $3356170d7bce7f20$export$d365f7ad9d7df9c9 = v);\n\n\n\n\n\nvar $3014d862dcc9946b$exports = {};\n\n$parcel$export($3014d862dcc9946b$exports, \"EncodingQueue\", () => $3014d862dcc9946b$export$c6913ae0ed687038, (v) => $3014d862dcc9946b$export$c6913ae0ed687038 = v);\n\n\nvar $3014d862dcc9946b$var$__extends = undefined && undefined.__extends || function() {\n    var extendStatics = function(d1, b1) {\n        extendStatics = Object.setPrototypeOf || ({\n            __proto__: []\n        }) instanceof Array && function(d, b) {\n            d.__proto__ = b;\n        } || function(d, b) {\n            for(var p in b)if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n        };\n        return extendStatics(d1, b1);\n    };\n    return function(d, b) {\n        if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() {\n            this.constructor = d;\n        }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n}();\nvar $3014d862dcc9946b$export$c6913ae0ed687038 = /** @class */ function(_super) {\n    $3014d862dcc9946b$var$__extends($3014d862dcc9946b$export$c6913ae0ed687038, _super);\n    function $3014d862dcc9946b$export$c6913ae0ed687038() {\n        var _this = _super.call(this) || this;\n        _this.fileReader = new FileReader();\n        _this._queue = [];\n        _this._processing = false;\n        _this.fileReader.onload = function(evt) {\n            _this._processing = false;\n            if (evt.target) _this.emit(\"done\", evt.target.result);\n            _this.doNextTask();\n        };\n        _this.fileReader.onerror = function(evt) {\n            $1615705ecc6adca3$exports.default.error(\"EncodingQueue error:\", evt);\n            _this._processing = false;\n            _this.destroy();\n            _this.emit(\"error\", evt);\n        };\n        return _this;\n    }\n    Object.defineProperty($3014d862dcc9946b$export$c6913ae0ed687038.prototype, \"queue\", {\n        get: function() {\n            return this._queue;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty($3014d862dcc9946b$export$c6913ae0ed687038.prototype, \"size\", {\n        get: function() {\n            return this.queue.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty($3014d862dcc9946b$export$c6913ae0ed687038.prototype, \"processing\", {\n        get: function() {\n            return this._processing;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    $3014d862dcc9946b$export$c6913ae0ed687038.prototype.enque = function(blob) {\n        this.queue.push(blob);\n        if (this.processing) return;\n        this.doNextTask();\n    };\n    $3014d862dcc9946b$export$c6913ae0ed687038.prototype.destroy = function() {\n        this.fileReader.abort();\n        this._queue = [];\n    };\n    $3014d862dcc9946b$export$c6913ae0ed687038.prototype.doNextTask = function() {\n        if (this.size === 0) return;\n        if (this.processing) return;\n        this._processing = true;\n        this.fileReader.readAsArrayBuffer(this.queue.shift());\n    };\n    return $3014d862dcc9946b$export$c6913ae0ed687038;\n}($ac9b757d51178e15$exports.EventEmitter);\n\n\nvar $3356170d7bce7f20$var$__extends = undefined && undefined.__extends || function() {\n    var extendStatics = function(d1, b1) {\n        extendStatics = Object.setPrototypeOf || ({\n            __proto__: []\n        }) instanceof Array && function(d, b) {\n            d.__proto__ = b;\n        } || function(d, b) {\n            for(var p in b)if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n        };\n        return extendStatics(d1, b1);\n    };\n    return function(d, b) {\n        if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() {\n            this.constructor = d;\n        }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n}();\nvar $3356170d7bce7f20$var$__values = undefined && undefined.__values || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function() {\n            if (o && i >= o.length) o = void 0;\n            return {\n                value: o && o[i++],\n                done: !o\n            };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n/**\n * Wraps a DataChannel between two Peers.\n */ var $3356170d7bce7f20$export$d365f7ad9d7df9c9 = /** @class */ function(_super) {\n    $3356170d7bce7f20$var$__extends($3356170d7bce7f20$export$d365f7ad9d7df9c9, _super);\n    function $3356170d7bce7f20$export$d365f7ad9d7df9c9(peerId, provider, options) {\n        var _this = _super.call(this, peerId, provider, options) || this;\n        _this.stringify = JSON.stringify;\n        _this.parse = JSON.parse;\n        _this._buffer = [];\n        _this._bufferSize = 0;\n        _this._buffering = false;\n        _this._chunkedData = {};\n        _this._encodingQueue = new $3014d862dcc9946b$exports.EncodingQueue();\n        _this.connectionId = _this.options.connectionId || $3356170d7bce7f20$export$d365f7ad9d7df9c9.ID_PREFIX + $06cb531ed7840f78$export$7debb50ef11d5e0b.randomToken();\n        _this.label = _this.options.label || _this.connectionId;\n        _this.serialization = _this.options.serialization || $60fadef21a2daafc$export$89f507cf986a947.Binary;\n        _this.reliable = !!_this.options.reliable;\n        _this._encodingQueue.on(\"done\", function(ab) {\n            _this._bufferedSend(ab);\n        });\n        _this._encodingQueue.on(\"error\", function() {\n            $1615705ecc6adca3$exports.default.error(\"DC#\".concat(_this.connectionId, \": Error occured in encoding from blob to arraybuffer, close DC\"));\n            _this.close();\n        });\n        _this._negotiator = new $77f14d3e81888156$exports.Negotiator(_this);\n        _this._negotiator.startConnection(_this.options._payload || {\n            originator: true\n        });\n        return _this;\n    }\n    Object.defineProperty($3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype, \"type\", {\n        get: function() {\n            return $60fadef21a2daafc$export$3157d57b4135e3bc.Data;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty($3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype, \"dataChannel\", {\n        get: function() {\n            return this._dc;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty($3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype, \"bufferSize\", {\n        get: function() {\n            return this._bufferSize;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /** Called by the Negotiator when the DataChannel is ready. */ $3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype.initialize = function(dc) {\n        this._dc = dc;\n        this._configureDataChannel();\n    };\n    $3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype._configureDataChannel = function() {\n        var _this = this;\n        if (!$06cb531ed7840f78$export$7debb50ef11d5e0b.supports.binaryBlob || $06cb531ed7840f78$export$7debb50ef11d5e0b.supports.reliable) this.dataChannel.binaryType = \"arraybuffer\";\n        this.dataChannel.onopen = function() {\n            $1615705ecc6adca3$exports.default.log(\"DC#\".concat(_this.connectionId, \" dc connection success\"));\n            _this._open = true;\n            _this.emit(\"open\");\n        };\n        this.dataChannel.onmessage = function(e) {\n            $1615705ecc6adca3$exports.default.log(\"DC#\".concat(_this.connectionId, \" dc onmessage:\"), e.data);\n            _this._handleDataMessage(e);\n        };\n        this.dataChannel.onclose = function() {\n            $1615705ecc6adca3$exports.default.log(\"DC#\".concat(_this.connectionId, \" dc closed for:\"), _this.peer);\n            _this.close();\n        };\n    };\n    // Handles a DataChannel message.\n    $3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype._handleDataMessage = function(_a) {\n        var _this = this;\n        var data = _a.data;\n        var datatype = data.constructor;\n        var isBinarySerialization = this.serialization === $60fadef21a2daafc$export$89f507cf986a947.Binary || this.serialization === $60fadef21a2daafc$export$89f507cf986a947.BinaryUTF8;\n        var deserializedData = data;\n        if (isBinarySerialization) {\n            if (datatype === Blob) {\n                // Datatype should never be blob\n                $06cb531ed7840f78$export$7debb50ef11d5e0b.blobToArrayBuffer(data, function(ab) {\n                    var unpackedData = $06cb531ed7840f78$export$7debb50ef11d5e0b.unpack(ab);\n                    _this.emit(\"data\", unpackedData);\n                });\n                return;\n            } else if (datatype === ArrayBuffer) deserializedData = $06cb531ed7840f78$export$7debb50ef11d5e0b.unpack(data);\n            else if (datatype === String) {\n                // String fallback for binary data for browsers that don't support binary yet\n                var ab1 = $06cb531ed7840f78$export$7debb50ef11d5e0b.binaryStringToArrayBuffer(data);\n                deserializedData = $06cb531ed7840f78$export$7debb50ef11d5e0b.unpack(ab1);\n            }\n        } else if (this.serialization === $60fadef21a2daafc$export$89f507cf986a947.JSON) deserializedData = this.parse(data);\n        // Check if we've chunked--if so, piece things back together.\n        // We're guaranteed that this isn't 0.\n        if (deserializedData.__peerData) {\n            this._handleChunk(deserializedData);\n            return;\n        }\n        _super.prototype.emit.call(this, \"data\", deserializedData);\n    };\n    $3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype._handleChunk = function(data) {\n        var id = data.__peerData;\n        var chunkInfo = this._chunkedData[id] || {\n            data: [],\n            count: 0,\n            total: data.total\n        };\n        chunkInfo.data[data.n] = data.data;\n        chunkInfo.count++;\n        this._chunkedData[id] = chunkInfo;\n        if (chunkInfo.total === chunkInfo.count) {\n            // Clean up before making the recursive call to `_handleDataMessage`.\n            delete this._chunkedData[id];\n            // We've received all the chunks--time to construct the complete data.\n            var data_1 = new Blob(chunkInfo.data);\n            this._handleDataMessage({\n                data: data_1\n            });\n        }\n    };\n    /**\n     * Exposed functionality for users.\n     */ /** Allows user to close connection. */ $3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype.close = function() {\n        this._buffer = [];\n        this._bufferSize = 0;\n        this._chunkedData = {};\n        if (this._negotiator) {\n            this._negotiator.cleanup();\n            this._negotiator = null;\n        }\n        if (this.provider) {\n            this.provider._removeConnection(this);\n            this.provider = null;\n        }\n        if (this.dataChannel) {\n            this.dataChannel.onopen = null;\n            this.dataChannel.onmessage = null;\n            this.dataChannel.onclose = null;\n            this._dc = null;\n        }\n        if (this._encodingQueue) {\n            this._encodingQueue.destroy();\n            this._encodingQueue.removeAllListeners();\n            this._encodingQueue = null;\n        }\n        if (!this.open) return;\n        this._open = false;\n        _super.prototype.emit.call(this, \"close\");\n    };\n    /** Allows user to send data. */ $3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype.send = function(data, chunked) {\n        if (!this.open) {\n            _super.prototype.emit.call(this, \"error\", new Error(\"Connection is not open. You should listen for the `open` event before sending messages.\"));\n            return;\n        }\n        if (this.serialization === $60fadef21a2daafc$export$89f507cf986a947.JSON) this._bufferedSend(this.stringify(data));\n        else if (this.serialization === $60fadef21a2daafc$export$89f507cf986a947.Binary || this.serialization === $60fadef21a2daafc$export$89f507cf986a947.BinaryUTF8) {\n            var blob = $06cb531ed7840f78$export$7debb50ef11d5e0b.pack(data);\n            if (!chunked && blob.size > $06cb531ed7840f78$export$7debb50ef11d5e0b.chunkedMTU) {\n                this._sendChunks(blob);\n                return;\n            }\n            if (!$06cb531ed7840f78$export$7debb50ef11d5e0b.supports.binaryBlob) // We only do this if we really need to (e.g. blobs are not supported),\n            // because this conversion is costly.\n            this._encodingQueue.enque(blob);\n            else this._bufferedSend(blob);\n        } else this._bufferedSend(data);\n    };\n    $3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype._bufferedSend = function(msg) {\n        if (this._buffering || !this._trySend(msg)) {\n            this._buffer.push(msg);\n            this._bufferSize = this._buffer.length;\n        }\n    };\n    // Returns true if the send succeeds.\n    $3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype._trySend = function(msg) {\n        var _this = this;\n        if (!this.open) return false;\n        if (this.dataChannel.bufferedAmount > $3356170d7bce7f20$export$d365f7ad9d7df9c9.MAX_BUFFERED_AMOUNT) {\n            this._buffering = true;\n            setTimeout(function() {\n                _this._buffering = false;\n                _this._tryBuffer();\n            }, 50);\n            return false;\n        }\n        try {\n            this.dataChannel.send(msg);\n        } catch (e) {\n            $1615705ecc6adca3$exports.default.error(\"DC#:\".concat(this.connectionId, \" Error when sending:\"), e);\n            this._buffering = true;\n            this.close();\n            return false;\n        }\n        return true;\n    };\n    // Try to send the first message in the buffer.\n    $3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype._tryBuffer = function() {\n        if (!this.open) return;\n        if (this._buffer.length === 0) return;\n        var msg = this._buffer[0];\n        if (this._trySend(msg)) {\n            this._buffer.shift();\n            this._bufferSize = this._buffer.length;\n            this._tryBuffer();\n        }\n    };\n    $3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype._sendChunks = function(blob) {\n        var e_1, _a;\n        var blobs = $06cb531ed7840f78$export$7debb50ef11d5e0b.chunk(blob);\n        $1615705ecc6adca3$exports.default.log(\"DC#\".concat(this.connectionId, \" Try to send \").concat(blobs.length, \" chunks...\"));\n        try {\n            for(var blobs_1 = $3356170d7bce7f20$var$__values(blobs), blobs_1_1 = blobs_1.next(); !blobs_1_1.done; blobs_1_1 = blobs_1.next()){\n                var blob_1 = blobs_1_1.value;\n                this.send(blob_1, true);\n            }\n        } catch (e_1_1) {\n            e_1 = {\n                error: e_1_1\n            };\n        } finally{\n            try {\n                if (blobs_1_1 && !blobs_1_1.done && (_a = blobs_1.return)) _a.call(blobs_1);\n            } finally{\n                if (e_1) throw e_1.error;\n            }\n        }\n    };\n    $3356170d7bce7f20$export$d365f7ad9d7df9c9.prototype.handleMessage = function(message) {\n        var payload = message.payload;\n        switch(message.type){\n            case $60fadef21a2daafc$export$adb4a1754da6f10d.Answer:\n                this._negotiator.handleSDP(message.type, payload.sdp);\n                break;\n            case $60fadef21a2daafc$export$adb4a1754da6f10d.Candidate:\n                this._negotiator.handleCandidate(payload.candidate);\n                break;\n            default:\n                $1615705ecc6adca3$exports.default.warn(\"Unrecognized message type:\", message.type, \"from peer:\", this.peer);\n                break;\n        }\n    };\n    $3356170d7bce7f20$export$d365f7ad9d7df9c9.ID_PREFIX = \"dc_\";\n    $3356170d7bce7f20$export$d365f7ad9d7df9c9.MAX_BUFFERED_AMOUNT = 8388608;\n    return $3356170d7bce7f20$export$d365f7ad9d7df9c9;\n}($0b3b332fd86c5202$exports.BaseConnection);\n\n\n\nvar $9e85b3e1327369e6$exports = {};\n\n$parcel$export($9e85b3e1327369e6$exports, \"API\", () => $9e85b3e1327369e6$export$2c4e825dc9120f87, (v) => $9e85b3e1327369e6$export$2c4e825dc9120f87 = v);\n\n\n\nvar $9e85b3e1327369e6$var$__awaiter = undefined && undefined.__awaiter || function(thisArg, _arguments, P, generator) {\n    function adopt(value) {\n        return value instanceof P ? value : new P(function(resolve) {\n            resolve(value);\n        });\n    }\n    return new (P || (P = Promise))(function(resolve, reject) {\n        function fulfilled(value) {\n            try {\n                step(generator.next(value));\n            } catch (e) {\n                reject(e);\n            }\n        }\n        function rejected(value) {\n            try {\n                step(generator[\"throw\"](value));\n            } catch (e) {\n                reject(e);\n            }\n        }\n        function step(result) {\n            result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n        }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar $9e85b3e1327369e6$var$__generator = undefined && undefined.__generator || function(thisArg, body) {\n    var _ = {\n        label: 0,\n        sent: function() {\n            if (t[0] & 1) throw t[1];\n            return t[1];\n        },\n        trys: [],\n        ops: []\n    }, f, y, t, g;\n    return g = {\n        next: verb(0),\n        \"throw\": verb(1),\n        \"return\": verb(2)\n    }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() {\n        return this;\n    }), g;\n    function verb(n) {\n        return function(v) {\n            return step([\n                n,\n                v\n            ]);\n        };\n    }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while(_)try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [\n                op[0] & 2,\n                t.value\n            ];\n            switch(op[0]){\n                case 0:\n                case 1:\n                    t = op;\n                    break;\n                case 4:\n                    _.label++;\n                    return {\n                        value: op[1],\n                        done: false\n                    };\n                case 5:\n                    _.label++;\n                    y = op[1];\n                    op = [\n                        0\n                    ];\n                    continue;\n                case 7:\n                    op = _.ops.pop();\n                    _.trys.pop();\n                    continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                        _ = 0;\n                        continue;\n                    }\n                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                        _.label = op[1];\n                        break;\n                    }\n                    if (op[0] === 6 && _.label < t[1]) {\n                        _.label = t[1];\n                        t = op;\n                        break;\n                    }\n                    if (t && _.label < t[2]) {\n                        _.label = t[2];\n                        _.ops.push(op);\n                        break;\n                    }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop();\n                    continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) {\n            op = [\n                6,\n                e\n            ];\n            y = 0;\n        } finally{\n            f = t = 0;\n        }\n        if (op[0] & 5) throw op[1];\n        return {\n            value: op[0] ? op[1] : void 0,\n            done: true\n        };\n    }\n};\nvar $9e85b3e1327369e6$export$2c4e825dc9120f87 = /** @class */ function() {\n    function $9e85b3e1327369e6$export$2c4e825dc9120f87(_options) {\n        this._options = _options;\n    }\n    $9e85b3e1327369e6$export$2c4e825dc9120f87.prototype._buildRequest = function(method) {\n        var protocol = this._options.secure ? \"https\" : \"http\";\n        var _a = this._options, host = _a.host, port = _a.port, path = _a.path, key = _a.key;\n        var url = new URL(\"\".concat(protocol, \"://\").concat(host, \":\").concat(port).concat(path).concat(key, \"/\").concat(method));\n        // TODO: Why timestamp, why random?\n        url.searchParams.set(\"ts\", \"\".concat(Date.now()).concat(Math.random()));\n        url.searchParams.set(\"version\", $0d1ed891c5cb27c0$exports.version);\n        return fetch(url.href, {\n            referrerPolicy: this._options.referrerPolicy\n        });\n    };\n    /** Get a unique ID from the server via XHR and initialize with it. */ $9e85b3e1327369e6$export$2c4e825dc9120f87.prototype.retrieveId = function() {\n        return $9e85b3e1327369e6$var$__awaiter(this, void 0, Promise, function() {\n            var response, error_1, pathError;\n            return $9e85b3e1327369e6$var$__generator(this, function(_a) {\n                switch(_a.label){\n                    case 0:\n                        _a.trys.push([\n                            0,\n                            2,\n                            ,\n                            3\n                        ]);\n                        return [\n                            4 /*yield*/ ,\n                            this._buildRequest(\"id\")\n                        ];\n                    case 1:\n                        response = _a.sent();\n                        if (response.status !== 200) throw new Error(\"Error. Status:\".concat(response.status));\n                        return [\n                            2 /*return*/ ,\n                            response.text()\n                        ];\n                    case 2:\n                        error_1 = _a.sent();\n                        $1615705ecc6adca3$exports.default.error(\"Error retrieving ID\", error_1);\n                        pathError = \"\";\n                        if (this._options.path === \"/\" && this._options.host !== $06cb531ed7840f78$export$7debb50ef11d5e0b.CLOUD_HOST) pathError = \" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer.\";\n                        throw new Error(\"Could not get an ID from the server.\" + pathError);\n                    case 3:\n                        return [\n                            2 /*return*/ \n                        ];\n                }\n            });\n        });\n    };\n    /** @deprecated */ $9e85b3e1327369e6$export$2c4e825dc9120f87.prototype.listAllPeers = function() {\n        return $9e85b3e1327369e6$var$__awaiter(this, void 0, Promise, function() {\n            var response, helpfulError, error_2;\n            return $9e85b3e1327369e6$var$__generator(this, function(_a) {\n                switch(_a.label){\n                    case 0:\n                        _a.trys.push([\n                            0,\n                            2,\n                            ,\n                            3\n                        ]);\n                        return [\n                            4 /*yield*/ ,\n                            this._buildRequest(\"peers\")\n                        ];\n                    case 1:\n                        response = _a.sent();\n                        if (response.status !== 200) {\n                            if (response.status === 401) {\n                                helpfulError = \"\";\n                                if (this._options.host === $06cb531ed7840f78$export$7debb50ef11d5e0b.CLOUD_HOST) helpfulError = \"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.\";\n                                else helpfulError = \"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.\";\n                                throw new Error(\"It doesn't look like you have permission to list peers IDs. \" + helpfulError);\n                            }\n                            throw new Error(\"Error. Status:\".concat(response.status));\n                        }\n                        return [\n                            2 /*return*/ ,\n                            response.json()\n                        ];\n                    case 2:\n                        error_2 = _a.sent();\n                        $1615705ecc6adca3$exports.default.error(\"Error retrieving list peers\", error_2);\n                        throw new Error(\"Could not get list peers from the server.\" + error_2);\n                    case 3:\n                        return [\n                            2 /*return*/ \n                        ];\n                }\n            });\n        });\n    };\n    return $9e85b3e1327369e6$export$2c4e825dc9120f87;\n}();\n\n\nvar $26088d7da5b03f69$var$__extends = undefined && undefined.__extends || function() {\n    var extendStatics = function(d1, b1) {\n        extendStatics = Object.setPrototypeOf || ({\n            __proto__: []\n        }) instanceof Array && function(d, b) {\n            d.__proto__ = b;\n        } || function(d, b) {\n            for(var p in b)if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n        };\n        return extendStatics(d1, b1);\n    };\n    return function(d, b) {\n        if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() {\n            this.constructor = d;\n        }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n}();\nvar $26088d7da5b03f69$var$__assign = undefined && undefined.__assign || function() {\n    $26088d7da5b03f69$var$__assign = Object.assign || function(t) {\n        for(var s, i = 1, n = arguments.length; i < n; i++){\n            s = arguments[i];\n            for(var p in s)if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n        }\n        return t;\n    };\n    return $26088d7da5b03f69$var$__assign.apply(this, arguments);\n};\nvar $26088d7da5b03f69$var$__values = undefined && undefined.__values || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function() {\n            if (o && i >= o.length) o = void 0;\n            return {\n                value: o && o[i++],\n                done: !o\n            };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar $26088d7da5b03f69$var$__read = undefined && undefined.__read || function(o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while((n === void 0 || n-- > 0) && !(r = i.next()).done)ar.push(r.value);\n    } catch (error) {\n        e = {\n            error: error\n        };\n    } finally{\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        } finally{\n            if (e) throw e.error;\n        }\n    }\n    return ar;\n};\nvar $26088d7da5b03f69$var$PeerOptions = /** @class */ function() {\n    function PeerOptions() {}\n    return PeerOptions;\n}();\n/**\n * A peer who can initiate connections with other peers.\n */ var $26088d7da5b03f69$export$ecd1fc136c422448 = /** @class */ function(_super) {\n    $26088d7da5b03f69$var$__extends($26088d7da5b03f69$export$ecd1fc136c422448, _super);\n    function $26088d7da5b03f69$export$ecd1fc136c422448(id1, options) {\n        var _this = _super.call(this) || this;\n        _this._id = null;\n        _this._lastServerId = null;\n        // States.\n        _this._destroyed = false; // Connections have been killed\n        _this._disconnected = false; // Connection to PeerServer killed but P2P connections still active\n        _this._open = false; // Sockets and such are not yet open.\n        _this._connections = new Map(); // All connections for this peer.\n        _this._lostMessages = new Map(); // src => [list of messages]\n        var userId;\n        // Deal with overloading\n        if (id1 && id1.constructor == Object) options = id1;\n        else if (id1) userId = id1.toString();\n        // Configurize options\n        options = $26088d7da5b03f69$var$__assign({\n            debug: 0,\n            host: $06cb531ed7840f78$export$7debb50ef11d5e0b.CLOUD_HOST,\n            port: $06cb531ed7840f78$export$7debb50ef11d5e0b.CLOUD_PORT,\n            path: \"/\",\n            key: $26088d7da5b03f69$export$ecd1fc136c422448.DEFAULT_KEY,\n            token: $06cb531ed7840f78$export$7debb50ef11d5e0b.randomToken(),\n            config: $06cb531ed7840f78$export$7debb50ef11d5e0b.defaultConfig,\n            referrerPolicy: \"strict-origin-when-cross-origin\"\n        }, options);\n        _this._options = options;\n        // Detect relative URL host.\n        if (_this._options.host === \"/\") _this._options.host = window.location.hostname;\n        // Set path correctly.\n        if (_this._options.path) {\n            if (_this._options.path[0] !== \"/\") _this._options.path = \"/\" + _this._options.path;\n            if (_this._options.path[_this._options.path.length - 1] !== \"/\") _this._options.path += \"/\";\n        }\n        // Set whether we use SSL to same as current host\n        if (_this._options.secure === undefined && _this._options.host !== $06cb531ed7840f78$export$7debb50ef11d5e0b.CLOUD_HOST) _this._options.secure = $06cb531ed7840f78$export$7debb50ef11d5e0b.isSecure();\n        else if (_this._options.host == $06cb531ed7840f78$export$7debb50ef11d5e0b.CLOUD_HOST) _this._options.secure = true;\n        // Set a custom log function if present\n        if (_this._options.logFunction) $1615705ecc6adca3$exports.default.setLogFunction(_this._options.logFunction);\n        $1615705ecc6adca3$exports.default.logLevel = _this._options.debug || 0;\n        _this._api = new $9e85b3e1327369e6$exports.API(options);\n        _this._socket = _this._createServerConnection();\n        // Sanity checks\n        // Ensure WebRTC supported\n        if (!$06cb531ed7840f78$export$7debb50ef11d5e0b.supports.audioVideo && !$06cb531ed7840f78$export$7debb50ef11d5e0b.supports.data) {\n            _this._delayedAbort($60fadef21a2daafc$export$9547aaa2e39030ff.BrowserIncompatible, \"The current browser does not support WebRTC\");\n            return _this;\n        }\n        // Ensure alphanumeric id\n        if (!!userId && !$06cb531ed7840f78$export$7debb50ef11d5e0b.validateId(userId)) {\n            _this._delayedAbort($60fadef21a2daafc$export$9547aaa2e39030ff.InvalidID, \"ID \\\"\".concat(userId, \"\\\" is invalid\"));\n            return _this;\n        }\n        if (userId) _this._initialize(userId);\n        else _this._api.retrieveId().then(function(id) {\n            return _this._initialize(id);\n        }).catch(function(error) {\n            return _this._abort($60fadef21a2daafc$export$9547aaa2e39030ff.ServerError, error);\n        });\n        return _this;\n    }\n    Object.defineProperty($26088d7da5b03f69$export$ecd1fc136c422448.prototype, \"id\", {\n        /**\n         * The brokering ID of this peer\n         */ get: function() {\n            return this._id;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty($26088d7da5b03f69$export$ecd1fc136c422448.prototype, \"options\", {\n        get: function() {\n            return this._options;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty($26088d7da5b03f69$export$ecd1fc136c422448.prototype, \"open\", {\n        get: function() {\n            return this._open;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty($26088d7da5b03f69$export$ecd1fc136c422448.prototype, \"socket\", {\n        get: function() {\n            return this._socket;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty($26088d7da5b03f69$export$ecd1fc136c422448.prototype, \"connections\", {\n        /**\n         * A hash of all connections associated with this peer, keyed by the remote peer's ID.\n         * @deprecated\n         * Return type will change from Object to Map<string,[]>\n         */ get: function() {\n            var e_1, _a;\n            var plainConnections = Object.create(null);\n            try {\n                for(var _b = $26088d7da5b03f69$var$__values(this._connections), _c = _b.next(); !_c.done; _c = _b.next()){\n                    var _d = $26088d7da5b03f69$var$__read(_c.value, 2), k = _d[0], v = _d[1];\n                    plainConnections[k] = v;\n                }\n            } catch (e_1_1) {\n                e_1 = {\n                    error: e_1_1\n                };\n            } finally{\n                try {\n                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n                } finally{\n                    if (e_1) throw e_1.error;\n                }\n            }\n            return plainConnections;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty($26088d7da5b03f69$export$ecd1fc136c422448.prototype, \"destroyed\", {\n        /**\n         * true if this peer and all of its connections can no longer be used.\n         */ get: function() {\n            return this._destroyed;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty($26088d7da5b03f69$export$ecd1fc136c422448.prototype, \"disconnected\", {\n        /**\n         * false if there is an active connection to the PeerServer.\n         */ get: function() {\n            return this._disconnected;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    $26088d7da5b03f69$export$ecd1fc136c422448.prototype._createServerConnection = function() {\n        var _this = this;\n        var socket = new $31d11a8d122cb4b7$exports.Socket(this._options.secure, this._options.host, this._options.port, this._options.path, this._options.key, this._options.pingInterval);\n        socket.on($60fadef21a2daafc$export$3b5c4a4b6354f023.Message, function(data) {\n            _this._handleMessage(data);\n        });\n        socket.on($60fadef21a2daafc$export$3b5c4a4b6354f023.Error, function(error) {\n            _this._abort($60fadef21a2daafc$export$9547aaa2e39030ff.SocketError, error);\n        });\n        socket.on($60fadef21a2daafc$export$3b5c4a4b6354f023.Disconnected, function() {\n            if (_this.disconnected) return;\n            _this.emitError($60fadef21a2daafc$export$9547aaa2e39030ff.Network, \"Lost connection to server.\");\n            _this.disconnect();\n        });\n        socket.on($60fadef21a2daafc$export$3b5c4a4b6354f023.Close, function() {\n            if (_this.disconnected) return;\n            _this._abort($60fadef21a2daafc$export$9547aaa2e39030ff.SocketClosed, \"Underlying socket is already closed.\");\n        });\n        return socket;\n    };\n    /** Initialize a connection with the server. */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype._initialize = function(id) {\n        this._id = id;\n        this.socket.start(id, this._options.token);\n    };\n    /** Handles messages from the server. */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype._handleMessage = function(message) {\n        var e_2, _a;\n        var type = message.type;\n        var payload = message.payload;\n        var peerId = message.src;\n        switch(type){\n            case $60fadef21a2daafc$export$adb4a1754da6f10d.Open:\n                this._lastServerId = this.id;\n                this._open = true;\n                this.emit(\"open\", this.id);\n                break;\n            case $60fadef21a2daafc$export$adb4a1754da6f10d.Error:\n                this._abort($60fadef21a2daafc$export$9547aaa2e39030ff.ServerError, payload.msg);\n                break;\n            case $60fadef21a2daafc$export$adb4a1754da6f10d.IdTaken:\n                this._abort($60fadef21a2daafc$export$9547aaa2e39030ff.UnavailableID, \"ID \\\"\".concat(this.id, \"\\\" is taken\"));\n                break;\n            case $60fadef21a2daafc$export$adb4a1754da6f10d.InvalidKey:\n                this._abort($60fadef21a2daafc$export$9547aaa2e39030ff.InvalidKey, \"API KEY \\\"\".concat(this._options.key, \"\\\" is invalid\"));\n                break;\n            case $60fadef21a2daafc$export$adb4a1754da6f10d.Leave:\n                $1615705ecc6adca3$exports.default.log(\"Received leave message from \".concat(peerId));\n                this._cleanupPeer(peerId);\n                this._connections.delete(peerId);\n                break;\n            case $60fadef21a2daafc$export$adb4a1754da6f10d.Expire:\n                this.emitError($60fadef21a2daafc$export$9547aaa2e39030ff.PeerUnavailable, \"Could not connect to peer \".concat(peerId));\n                break;\n            case $60fadef21a2daafc$export$adb4a1754da6f10d.Offer:\n                // we should consider switching this to CALL/CONNECT, but this is the least breaking option.\n                var connectionId = payload.connectionId;\n                var connection = this.getConnection(peerId, connectionId);\n                if (connection) {\n                    connection.close();\n                    $1615705ecc6adca3$exports.default.warn(\"Offer received for existing Connection ID:\".concat(connectionId));\n                }\n                // Create a new connection.\n                if (payload.type === $60fadef21a2daafc$export$3157d57b4135e3bc.Media) {\n                    var mediaConnection = new $353dee38f9ab557b$exports.MediaConnection(peerId, this, {\n                        connectionId: connectionId,\n                        _payload: payload,\n                        metadata: payload.metadata\n                    });\n                    connection = mediaConnection;\n                    this._addConnection(peerId, connection);\n                    this.emit(\"call\", mediaConnection);\n                } else if (payload.type === $60fadef21a2daafc$export$3157d57b4135e3bc.Data) {\n                    var dataConnection = new $3356170d7bce7f20$exports.DataConnection(peerId, this, {\n                        connectionId: connectionId,\n                        _payload: payload,\n                        metadata: payload.metadata,\n                        label: payload.label,\n                        serialization: payload.serialization,\n                        reliable: payload.reliable\n                    });\n                    connection = dataConnection;\n                    this._addConnection(peerId, connection);\n                    this.emit(\"connection\", dataConnection);\n                } else {\n                    $1615705ecc6adca3$exports.default.warn(\"Received malformed connection type:\".concat(payload.type));\n                    return;\n                }\n                // Find messages.\n                var messages = this._getMessages(connectionId);\n                try {\n                    for(var messages_1 = $26088d7da5b03f69$var$__values(messages), messages_1_1 = messages_1.next(); !messages_1_1.done; messages_1_1 = messages_1.next()){\n                        var message_1 = messages_1_1.value;\n                        connection.handleMessage(message_1);\n                    }\n                } catch (e_2_1) {\n                    e_2 = {\n                        error: e_2_1\n                    };\n                } finally{\n                    try {\n                        if (messages_1_1 && !messages_1_1.done && (_a = messages_1.return)) _a.call(messages_1);\n                    } finally{\n                        if (e_2) throw e_2.error;\n                    }\n                }\n                break;\n            default:\n                if (!payload) {\n                    $1615705ecc6adca3$exports.default.warn(\"You received a malformed message from \".concat(peerId, \" of type \").concat(type));\n                    return;\n                }\n                var connectionId = payload.connectionId;\n                var connection = this.getConnection(peerId, connectionId);\n                if (connection && connection.peerConnection) // Pass it on.\n                connection.handleMessage(message);\n                else if (connectionId) // Store for possible later use\n                this._storeMessage(connectionId, message);\n                else $1615705ecc6adca3$exports.default.warn(\"You received an unrecognized message:\", message);\n                break;\n        }\n    };\n    /** Stores messages without a set up connection, to be claimed later. */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype._storeMessage = function(connectionId, message) {\n        if (!this._lostMessages.has(connectionId)) this._lostMessages.set(connectionId, []);\n        this._lostMessages.get(connectionId).push(message);\n    };\n    /** Retrieve messages from lost message store */ //TODO Change it to private\n    $26088d7da5b03f69$export$ecd1fc136c422448.prototype._getMessages = function(connectionId) {\n        var messages = this._lostMessages.get(connectionId);\n        if (messages) {\n            this._lostMessages.delete(connectionId);\n            return messages;\n        }\n        return [];\n    };\n    /**\n     * Connects to the remote peer specified by id and returns a data connection.\n     * @param peer The brokering ID of the remote peer (their peer.id).\n     * @param options for specifying details about Peer Connection\n     */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype.connect = function(peer, options) {\n        if (options === void 0) options = {};\n        if (this.disconnected) {\n            $1615705ecc6adca3$exports.default.warn(\"You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available.\");\n            this.emitError($60fadef21a2daafc$export$9547aaa2e39030ff.Disconnected, \"Cannot connect to new Peer after disconnecting from server.\");\n            return;\n        }\n        var dataConnection = new $3356170d7bce7f20$exports.DataConnection(peer, this, options);\n        this._addConnection(peer, dataConnection);\n        return dataConnection;\n    };\n    /**\n     * Calls the remote peer specified by id and returns a media connection.\n     * @param peer The brokering ID of the remote peer (their peer.id).\n     * @param stream The caller's media stream\n     * @param options Metadata associated with the connection, passed in by whoever initiated the connection.\n     */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype.call = function(peer, stream, options) {\n        if (options === void 0) options = {};\n        if (this.disconnected) {\n            $1615705ecc6adca3$exports.default.warn(\"You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect.\");\n            this.emitError($60fadef21a2daafc$export$9547aaa2e39030ff.Disconnected, \"Cannot connect to new Peer after disconnecting from server.\");\n            return;\n        }\n        if (!stream) {\n            $1615705ecc6adca3$exports.default.error(\"To call a peer, you must provide a stream from your browser's `getUserMedia`.\");\n            return;\n        }\n        var mediaConnection = new $353dee38f9ab557b$exports.MediaConnection(peer, this, $26088d7da5b03f69$var$__assign($26088d7da5b03f69$var$__assign({}, options), {\n            _stream: stream\n        }));\n        this._addConnection(peer, mediaConnection);\n        return mediaConnection;\n    };\n    /** Add a data/media connection to this peer. */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype._addConnection = function(peerId, connection) {\n        $1615705ecc6adca3$exports.default.log(\"add connection \".concat(connection.type, \":\").concat(connection.connectionId, \" to peerId:\").concat(peerId));\n        if (!this._connections.has(peerId)) this._connections.set(peerId, []);\n        this._connections.get(peerId).push(connection);\n    };\n    //TODO should be private\n    $26088d7da5b03f69$export$ecd1fc136c422448.prototype._removeConnection = function(connection) {\n        var connections = this._connections.get(connection.peer);\n        if (connections) {\n            var index = connections.indexOf(connection);\n            if (index !== -1) connections.splice(index, 1);\n        }\n        //remove from lost messages\n        this._lostMessages.delete(connection.connectionId);\n    };\n    /** Retrieve a data/media connection for this peer. */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype.getConnection = function(peerId, connectionId) {\n        var e_3, _a;\n        var connections = this._connections.get(peerId);\n        if (!connections) return null;\n        try {\n            for(var connections_1 = $26088d7da5b03f69$var$__values(connections), connections_1_1 = connections_1.next(); !connections_1_1.done; connections_1_1 = connections_1.next()){\n                var connection = connections_1_1.value;\n                if (connection.connectionId === connectionId) return connection;\n            }\n        } catch (e_3_1) {\n            e_3 = {\n                error: e_3_1\n            };\n        } finally{\n            try {\n                if (connections_1_1 && !connections_1_1.done && (_a = connections_1.return)) _a.call(connections_1);\n            } finally{\n                if (e_3) throw e_3.error;\n            }\n        }\n        return null;\n    };\n    $26088d7da5b03f69$export$ecd1fc136c422448.prototype._delayedAbort = function(type, message) {\n        var _this = this;\n        setTimeout(function() {\n            _this._abort(type, message);\n        }, 0);\n    };\n    /**\n     * Emits an error message and destroys the Peer.\n     * The Peer is not destroyed if it's in a disconnected state, in which case\n     * it retains its disconnected state and its existing connections.\n     */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype._abort = function(type, message) {\n        $1615705ecc6adca3$exports.default.error(\"Aborting!\");\n        this.emitError(type, message);\n        if (!this._lastServerId) this.destroy();\n        else this.disconnect();\n    };\n    /** Emits a typed error message. */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype.emitError = function(type, err) {\n        $1615705ecc6adca3$exports.default.error(\"Error:\", err);\n        var error;\n        if (typeof err === \"string\") error = new Error(err);\n        else error = err;\n        error.type = type;\n        this.emit(\"error\", error);\n    };\n    /**\n     * Destroys the Peer: closes all active connections as well as the connection\n     *  to the server.\n     * Warning: The peer can no longer create or accept connections after being\n     *  destroyed.\n     */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype.destroy = function() {\n        if (this.destroyed) return;\n        $1615705ecc6adca3$exports.default.log(\"Destroy peer with ID:\".concat(this.id));\n        this.disconnect();\n        this._cleanup();\n        this._destroyed = true;\n        this.emit(\"close\");\n    };\n    /** Disconnects every connection on this peer. */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype._cleanup = function() {\n        var e_4, _a;\n        try {\n            for(var _b = $26088d7da5b03f69$var$__values(this._connections.keys()), _c = _b.next(); !_c.done; _c = _b.next()){\n                var peerId = _c.value;\n                this._cleanupPeer(peerId);\n                this._connections.delete(peerId);\n            }\n        } catch (e_4_1) {\n            e_4 = {\n                error: e_4_1\n            };\n        } finally{\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            } finally{\n                if (e_4) throw e_4.error;\n            }\n        }\n        this.socket.removeAllListeners();\n    };\n    /** Closes all connections to this peer. */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype._cleanupPeer = function(peerId) {\n        var e_5, _a;\n        var connections = this._connections.get(peerId);\n        if (!connections) return;\n        try {\n            for(var connections_2 = $26088d7da5b03f69$var$__values(connections), connections_2_1 = connections_2.next(); !connections_2_1.done; connections_2_1 = connections_2.next()){\n                var connection = connections_2_1.value;\n                connection.close();\n            }\n        } catch (e_5_1) {\n            e_5 = {\n                error: e_5_1\n            };\n        } finally{\n            try {\n                if (connections_2_1 && !connections_2_1.done && (_a = connections_2.return)) _a.call(connections_2);\n            } finally{\n                if (e_5) throw e_5.error;\n            }\n        }\n    };\n    /**\n     * Disconnects the Peer's connection to the PeerServer. Does not close any\n     *  active connections.\n     * Warning: The peer can no longer create or accept connections after being\n     *  disconnected. It also cannot reconnect to the server.\n     */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype.disconnect = function() {\n        if (this.disconnected) return;\n        var currentId = this.id;\n        $1615705ecc6adca3$exports.default.log(\"Disconnect peer with ID:\".concat(currentId));\n        this._disconnected = true;\n        this._open = false;\n        this.socket.close();\n        this._lastServerId = currentId;\n        this._id = null;\n        this.emit(\"disconnected\", currentId);\n    };\n    /** Attempts to reconnect with the same ID. */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype.reconnect = function() {\n        if (this.disconnected && !this.destroyed) {\n            $1615705ecc6adca3$exports.default.log(\"Attempting reconnection to server with ID \".concat(this._lastServerId));\n            this._disconnected = false;\n            this._initialize(this._lastServerId);\n        } else if (this.destroyed) throw new Error(\"This peer cannot reconnect to the server. It has already been destroyed.\");\n        else if (!this.disconnected && !this.open) // Do nothing. We're still connecting the first time.\n        $1615705ecc6adca3$exports.default.error(\"In a hurry? We're still trying to make the initial connection!\");\n        else throw new Error(\"Peer \".concat(this.id, \" cannot reconnect because it is not disconnected from the server!\"));\n    };\n    /**\n     * Get a list of available peer IDs. If you're running your own server, you'll\n     * want to set allow_discovery: true in the PeerServer options. If you're using\n     * the cloud server, email team@peerjs.com to get the functionality enabled for\n     * your key.\n     */ $26088d7da5b03f69$export$ecd1fc136c422448.prototype.listAllPeers = function(cb) {\n        var _this = this;\n        if (cb === void 0) cb = function(_) {};\n        this._api.listAllPeers().then(function(peers) {\n            return cb(peers);\n        }).catch(function(error) {\n            return _this._abort($60fadef21a2daafc$export$9547aaa2e39030ff.ServerError, error);\n        });\n    };\n    $26088d7da5b03f69$export$ecd1fc136c422448.DEFAULT_KEY = \"peerjs\";\n    return $26088d7da5b03f69$export$ecd1fc136c422448;\n}($ac9b757d51178e15$exports.EventEmitter);\n\n\nvar $70d766613f57b014$export$2e2bcd8739ae039 = $26088d7da5b03f69$exports.Peer;\n\n\nexport {$70d766613f57b014$export$2e2bcd8739ae039 as default, $26088d7da5b03f69$export$ecd1fc136c422448 as Peer, $06cb531ed7840f78$export$7debb50ef11d5e0b as util};\n//# sourceMappingURL=bundler.mjs.map\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/* global AFRAME, THREE */\r\n\r\nrequire('./src/bar-position.js')\r\nrequire('./src/bar-monitor.js')\r\nrequire('./src/in-rack-ui.js')\r\nrequire('./src/ui-updater.js')\r\nrequire('./src/squat-rack.js')\r\nrequire('./src/vertical-controls.js')\r\n//require('./src/nod-shake.js')\r\nrequire('./src/calibration-flow')\r\nrequire('./src/ui-manager')\r\nrequire('aframe-polygon-wireframe')\r\nrequire('./src/video-stream.js')\r\nrequire('./src/phone/phone.js')"],"names":["root","factory","exports","module","define","amd","a","i","self","AFRAME","registerComponent","schema","color","type","default","opacity","hiddenOpacity","dashed","dashSize","gapSize","dashScale","init","this","updateGeometry","bind","el","addEventListener","getObject3D","baseGeometry","geometry","edges","dispose","THREE","EdgesGeometry","update","oldMaterial","material","oldLine","line","oldHiddenMaterial","hiddenMaterial","oldHiddenLine","hiddenLine","data","createLineMaterial","console","warn","depthWrite","depthTest","toneMapped","LineSegments","computeLineDistances","object3D","add","visible","removeLineAndMaterial","removeFromParent","LineDashedMaterial","scale","LineBasicMaterial","transparent","remove","removeEventListener","BufferBuilder","binaryFeatures","BinaryPack","unpack","Unpacker","pack","packer","Packer","getBuffer","index","dataBuffer","dataView","Uint8Array","length","byteLength","bufferBuilder","_utf8Replace","m","code","charCodeAt","prototype","size","unpack_uint8","unpack_raw","unpack_string","unpack_array","unpack_map","unpack_float","unpack_double","unpack_uint16","unpack_uint32","unpack_uint64","unpack_int8","unpack_int16","unpack_int32","unpack_int64","byte","bytes","read","uint16","uint32","uint64","uint8","Math","pow","Error","buf","slice","c","str","String","fromCharCode","objects","Array","map","key","value","exp","h32","l32","j","subarray","pack_string","floor","pack_integer","pack_double","append","constructor","pack_array","Blob","File","pack_bin","ArrayBuffer","useArrayBufferView","buffer","Object","toString","startsWith","pack_object","Date","toBinaryPack","flush","blob","pack_uint8","pack_uint16","pack_uint32","replace","utf8Length","ary","num","pack_int8","pack_int16","pack_int32","pack_int64","pack_uint64","sign","log","LN2","frac0","frac1","b32","obj","keys","prop","hasOwnProperty","n","high","low","useBlobBuilder","e","BlobBuilder","_pieces","_parts","window","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","push","builder","ii","getBlob","SDPUtils","writeMediaSection","transceiver","caps","stream","dtlsRole","sdp","writeRtpDescription","kind","writeIceParameters","iceGatherer","getLocalParameters","writeDtlsParameters","dtlsTransport","mid","rtpSender","rtpReceiver","trackId","_initialTrackId","track","id","msid","sendEncodingParameters","ssrc","rtx","localCName","getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","codecs","headerExtensions","fecMechanisms","findCodecByPayloadType","pt","parseInt","payloadType","preferredPayloadType","rtxCapabilityMatches","lRtx","rRtx","lCodecs","rCodecs","lCodec","parameters","apt","rCodec","name","toLowerCase","forEach","clockRate","JSON","parse","stringify","numChannels","min","rtcpFeedback","filter","fb","parameter","lHeaderExtension","rHeaderExtension","uri","isActionAllowedInSignalingState","action","signalingState","offer","setLocalDescription","setRemoteDescription","answer","indexOf","maybeAddCandidate","iceTransport","candidate","alreadyAdded","getRemoteCandidates","find","remoteCandidate","foundation","ip","port","priority","protocol","addRemoteCandidate","makeError","description","NotSupportedError","InvalidStateError","InvalidAccessError","TypeError","undefined","OperationError","edgeVersion","addTrackToStreamAndFireEvent","addTrack","dispatchEvent","MediaStreamTrackEvent","fireAddTrack","pc","receiver","streams","trackEvent","Event","setTimeout","_dispatchEvent","RTCPeerConnection","config","_eventTarget","document","createDocumentFragment","method","canTrickleIceCandidates","needNegotiation","localStreams","remoteStreams","_localDescription","_remoteDescription","iceConnectionState","connectionState","iceGatheringState","usingBundle","bundlePolicy","rtcpMuxPolicy","iceTransportPolicy","iceServers","hasTurn","server","urls","url","isString","filterIceServers","_iceGatherers","iceCandidatePoolSize","RTCIceGatherer","gatherPolicy","_config","transceivers","_sdpSessionId","generateSessionId","_sdpSessionVersion","_dtlsRole","_isClosed","defineProperty","configurable","get","onicecandidate","onaddstream","ontrack","onremovestream","onsignalingstatechange","oniceconnectionstatechange","onconnectionstatechange","onicegatheringstatechange","onnegotiationneeded","ondatachannel","event","_emitGatheringStateChange","getConfiguration","getLocalStreams","getRemoteStreams","_createTransceiver","doNotAdd","hasBundleTransport","recvEncodingParameters","associatedRemoteMediaStreams","wantReceive","transports","_createIceAndDtlsTransports","s","_maybeFireNegotiationNeeded","RTCRtpSender","addStream","getTracks","clonedStream","clone","idx","clonedTrack","enabled","removeTrack","sender","t","stop","splice","removeStream","getSenders","getReceivers","_createIceGatherer","sdpMLineIndex","shift","writable","bufferedCandidateEvents","bufferCandidates","end","state","_gather","onlocalcandidate","evt","sdpMid","cand","component","ufrag","usernameFragment","serializedCandidate","writeCandidate","assign","parseCandidate","toJSON","sections","getMediaSections","getDescription","join","complete","every","RTCIceTransport","onicestatechange","_updateIceConnectionState","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","onerror","_disposeIceAndDtlsTransports","_transceive","send","recv","params","encodings","rtcp","cname","compound","rtcpParameters","p","receive","sessionpart","Promise","reject","splitSections","mediaSection","parseRtpParameters","isIceLite","matchPrefix","isRejected","rejected","remoteIceParameters","getIceParameters","remoteDtlsParameters","getDtlsParameters","role","start","_updateSignalingState","resolve","receiverList","iceOptions","substr","split","lines","splitLines","getKind","direction","getDirection","remoteMsid","parseMsid","getMid","generateIdentifier","parseRtpEncodingParameters","parseRtcpParameters","isComplete","cands","setTransport","setRemoteCandidates","MediaStream","RTCRtpReceiver","getCapabilities","codec","isNewTrack","nativeTrack","removeTrackFromStreamAndFireEvent","sid","item","close","newState","states","closed","checking","connected","completed","disconnected","failed","new","connecting","createOffer","numAudioTracks","numVideoTracks","offerOptions","arguments","mandatory","optional","offerToReceiveAudio","offerToReceiveVideo","writeSessionBoilerplate","remoteCodec","hdrExt","rHdrExt","getLocalCandidates","desc","RTCSessionDescription","createAnswer","mediaSectionsInOffer","localTrack","getAudioTracks","getVideoTracks","reducedSize","addIceCandidate","candidateString","trim","getStats","selector","MediaStreamTrack","senderOrReceiver","promises","all","then","allStats","results","Map","stats","stat","set","ortcObjectName","nativeGetstats","apply","nativeStats","mapStats","inboundrtp","outboundrtp","candidatepair","localcandidate","remotecandidate","methods","nativeMethod","args","error","random","part","prefix","parts","substring","address","relatedAddress","relatedPort","tcpType","toUpperCase","parseIceOptions","parseRtpMap","parsed","channels","writeRtpMap","parseExtmap","writeExtmap","headerExtension","preferredId","parseFmtp","kv","writeFmtp","param","parseRtcpFb","writeRtcpFb","parseSsrcMedia","sp","colon","attribute","parseSsrcGroup","semantics","ssrcs","parseFingerprint","algorithm","fingerprints","setupType","fp","parseCryptoLine","tag","cryptoSuite","keyParams","sessionParams","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","pwd","password","mline","rtpmapline","fmtps","maxptime","extension","secondarySsrc","encodingParameters","hasRed","hasUlpfec","primarySsrc","flows","encParam","codecPayloadType","fec","mechanism","bandwidth","maxBitrate","remoteSsrc","rsize","mux","spec","planB","msidParts","parseSctpDescription","maxMessageSize","parseMLine","maxSizeLine","isNaN","sctpPort","fmt","writeSctpDescription","media","sctp","output","sessId","sessVer","sessUser","version","parseOLine","username","sessionId","sessionVersion","netType","addressType","isValidSDP","charAt","dependencies","hookPosition","x","y","z","topHeight","targetDepth","safetyPinHeight","rackWidth","rackDepth","showPlanes","insideRack","lifterAtHooks","barOnShoulders","atTop","belowDepth","belowSafetyPins","deletePlanes","createPlanes","topPlaneUpwards","createPlane","depthPlaneUpwards","safetyPlaneTop","safetyPlaneBottom","deletePlane","plane","parentNode","removeChild","aboveTopPlane","height","createElement","setAttribute","querySelector","appendChild","isInsideRack","barPosition","insideLR","insideFB","abs","zOffset","checkIfInsideRack","emit","isAtHooks","atHooksLR","atHooksFB","checkIfAtHooks","isAtTop","checkIfAtTop","isBelowDepth","checkIfBelowDepth","isBelowSafetyPins","checkIfBelowSafetyPins","tick","sceneEl","components","createRing","radius","ring","rotation","PI","position","cameraPosition","Vector3","cameraQuaternion","Quaternion","tempQuaternion","rackEl","rack","rackInverseTransform","Matrix4","updateWorldMatrix","copy","matrixWorld","invert","barOffset","getCameraAndBarPosition","quaternion","camera","getWorldPosition","getWorldQuaternion","applyMatrix4","setFromRotationMatrix","multiply","addVectors","calibrationUIImages","bar","hooks","top","depth","safety","review","done","calibrationUISounds","calibrationUIFollowOnSounds","calibrationUIFollowOnSounds2","skip","reachedHooks","forwardEvent","backEvent","stage","calibrationUI","getElementById","cameraWorldPosition","cameraWorldQuaternion","forwardVector","directionVector","playSFX","playPrompt","video","play","endCalibrationProcess","updateUI","beginCalibrationProcess","getBarPosition","moveToStage","moveBackToStage","origin","src","autoplay","sound","playSound","forward","applyQuaternion","normalize","setFromUnitVectors","pos","ypos","back","saving","deleting","forwardButton","backButton","imageSelector","fowardButton","circle","deleteImage","createImage","deleteButtons","createButtons","createButton","imageSrc","eventName","button","deleteButton","parent","dimension","image","classList","animatedRing","property","from","to","dur","easing","removeAttribute","totalReps","repsToGo","width","message","reps","rep","repNumber","repReport","detail","status","restPrior","timeDown","timeUp","turnSpeed","daviationLR","deviationLR","deviationFB","reportStats","label","units","number","wrapCount","align","childStats","imgSrc","deleteReportStats","child","numberText","toFixed","location","href","includes","peer","conn","connect","on","navigator","mediaDevices","getUserMedia","audio","call","renderVideo","catch","err","registerGeometry","frontHeight","rearHeight","frameWidth","hookRadiusSmall","hookRadiusLarge","hookDepth","hookHeight","safetyHeight","safetyRadius","geometries","BoxGeometry","translate","CylinderGeometry","rotateX","BufferGeometryUtils","mergeBufferGeometries","primitive","calibrated","inRack","calibrationComplete","enteredRack","exitedRack","insideRackUI","outsideRackUI","cursor","videoFrame","updateUIs","updateVisibility","leftHooks","shoulderedBar","returnedBar","hitTop","loweredFromTop","hitTargetDepth","upwardsFromTargetDepth","bailedOut","repPhase","shutUp","minHeightThisRep","timestamps","finishedLast","beganRep","hitDepth","hitBottom","finishedRep","repData","setTargetReps","repCount","repCompleted","success","now","reportRep","setMessage","verticalVelocity","verticalAcceleration","keyDown","keyUp","dt","velDelta","yDelta","logDisabled_","deprecationWarnings_","extractVersion","uastring","expr","match","wrapPeerConnectionEvent","eventNameToWrap","wrapper","proto","nativeAddEventListener","nativeEventName","cb","wrappedCallback","modifiedEvent","handleEvent","_eventMap","nativeRemoveEventListener","has","unwrappedCb","delete","enumerable","disableLog","bool","disableWarnings","deprecated","oldMethod","newMethod","isObject","val","compactObject","reduce","accumulator","isObj","isEmptyObject","walkStats","base","resultSet","endsWith","filterStats","result","outbound","streamStatsType","filteredResult","trackStats","trackIdentifier","trackStat","logging","shimGetUserMedia","browserDetails","constraintsToChrome_","cc","r","ideal","exact","max","oldname_","oc","mix","advanced","concat","shimConstraints_","constraints","func","remap","b","face","facingMode","getSupportedFacingModeLies","getSupportedConstraints","matches","enumerateDevices","devices","dev","d","some","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","constraint","constraintName","onSuccess","onError","webkitGetUserMedia","origGetUserMedia","cs","DOMException","shimGetDisplayMedia","getSourceId","getDisplayMedia","sourceId","widthSpecified","heightSpecified","frameRateSpecified","frameRate","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","shimMediaStream","webkitMediaStream","shimOnTrack","_ontrack","f","origSetRemoteDescription","_ontrackpoly","te","shimGetSendersWithDtmf","shimSenderWithDtmf","dtmf","_dtmf","createDTMFSender","_pc","_senders","origAddTrack","origRemoveTrack","origAddStream","origRemoveStream","origGetSenders","senders","shimGetStats","origGetStats","onSucc","onErr","fixChromeStats_","response","standardReport","report","standardStats","timestamp","names","makeMapStats","successCallbackWrapper_","shimSenderReceiverGetStats","origGetReceivers","receivers","srcElement","shimAddTrackRemoveTrackWithNative","_shimmedLocalStreams","streamId","existingSenders","newSenders","newSender","shimAddTrackRemoveTrack","origGetLocalStreams","nativeStreams","_reverseStreams","_streams","newStream","replaceInternalStreamId","internalId","externalStream","internalStream","RegExp","oldStream","methodObj","origSetLocalDescription","replaceExternalStreamId","origLocalDescription","getOwnPropertyDescriptor","streamid","shimPeerConnection","webkitRTCPeerConnection","RTCIceCandidate","fixNegotiationNeeded","target","sdpSemantics","origMSTEnabled","ev","RTCDtmfSender","RTCDTMFSender","RTCPeerConnectionShim","validTurn","shimReplaceTrack","replaceTrack","setTrack","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","preferredMediaSource","mediaSource","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","nativeGetStats","shimSenderGetStats","shimReceiverGetStats","shimRemoveStream","shimRTCDataChannel","DataChannel","RTCDataChannel","shimAddTransceiver","origAddTransceiver","addTransceiver","setParametersPromises","initParameters","shouldPerformCheck","sendEncodings","encodingParam","test","rid","parseFloat","scaleResolutionDownBy","RangeError","maxFramerate","getParameters","setParameters","shimGetParameters","origGetParameters","shimCreateOffer","origCreateOffer","finally","shimCreateAnswer","origCreateAnswer","shimLocalStreamsAPI","_localStreams","_addTrack","tracks","shimRemoteStreamsAPI","_remoteStreams","_onaddstream","_onaddstreampoly","shimCallbacksAPI","successCallback","failureCallback","options","promise","withCallback","_getUserMedia","shimConstraints","errcb","shimRTCIceServerUrls","OrigPeerConnection","pcConfig","pcConstraints","newIceServers","generateCertificate","shimTrackEventTransceiver","shimCreateOfferLegacy","audioTransceiver","getTransceivers","setDirection","videoTransceiver","shimAudioContext","AudioContext","webkitAudioContext","shimRTCIceCandidate","NativeRTCIceCandidate","nativeCandidate","parsedCandidate","augmentedCandidate","shimMaxMessageSize","_sctp","browser","mLine","sctpInDescription","isFirefox","getRemoteFirefoxVersion","canSendMMS","remoteIsFirefox","canSendMaxMessageSize","getCanSendMaxMessageSize","remoteMMS","getMaxMessageSize","Number","POSITIVE_INFINITY","shimSendThrowTypeError","wrapDcSend","dc","origDataChannelSend","readyState","origCreateDataChannel","createDataChannel","dataChannel","channel","shimConnectionState","_onconnectionstatechange","origMethod","_connectionstatechangepoly","_lastConnectionState","newEvent","removeExtmapAllowMixed","nativeSRD","shimAddIceCandidateNullOrEmpty","nativeAddIceCandidate","adapter","shimChrome","shimFirefox","shimEdge","shimSafari","mozGetUserMedia","userAgent","isSecureContext","supportsUnifiedPlan","RTCRtpTransceiver","commonShim","browserShim","adapterFactory","$parcel$export","v","$af8cf1f663f490f4$var$webRTCAdapter","$af8cf1f663f490f4$export$25be9502477c137d","class_1","isIOS","platform","supportedBrowsers","minFirefoxVersion","minChromeVersion","minSafariVersion","isWebRTCSupported","isBrowserSupported","getBrowser","getVersion","isUnifiedPlanSupported","tempPc","supported","$06cb531ed7840f78$var$DEFAULT_CONFIG","credential","$06cb531ed7840f78$export$7debb50ef11d5e0b","Util","CLOUD_HOST","CLOUD_PORT","chunkedBrowsers","Chrome","chrome","chunkedMTU","defaultConfig","browserVersion","supports","webRTC","audioVideo","binaryBlob","reliable","ordered","binaryType","_dataCount","noop","validateId","chunk","chunks","total","ceil","__peerData","blobToArrayBuffer","fr","FileReader","onload","readAsArrayBuffer","binaryStringToArrayBuffer","binary","byteArray","randomToken","isSecure","$26088d7da5b03f69$export$ecd1fc136c422448","$ac9b757d51178e15$exports","$ac9b757d51178e15$var$has","$ac9b757d51178e15$var$prefix","$ac9b757d51178e15$var$Events","$ac9b757d51178e15$var$EE","fn","context","once","$ac9b757d51178e15$var$addListener","emitter","listener","_events","_eventsCount","$ac9b757d51178e15$var$clearEvent","$ac9b757d51178e15$var$EventEmitter","create","__proto__","eventNames","events","getOwnPropertySymbols","listeners","handlers","l","ee","listenerCount","a1","a2","a3","a4","a5","len","removeListener","removeAllListeners","off","addListener","prefixed","EventEmitter","$1615705ecc6adca3$exports","$1615705ecc6adca3$export$243e62d78d3b544d","$1615705ecc6adca3$export$2e2bcd8739ae039","$1615705ecc6adca3$var$__read","o","Symbol","iterator","ar","next","$1615705ecc6adca3$var$__spreadArray","$60fadef21a2daafc$export$3157d57b4135e3bc","$60fadef21a2daafc$export$9547aaa2e39030ff","$60fadef21a2daafc$export$89f507cf986a947","$60fadef21a2daafc$export$3b5c4a4b6354f023","$60fadef21a2daafc$export$adb4a1754da6f10d","$0d1ed891c5cb27c0$exports","Logger","_logLevel","Disabled","logLevel","_i","All","_print","Warnings","Errors","setLogFunction","rest","$31d11a8d122cb4b7$exports","$31d11a8d122cb4b7$export$4798917dbf149b79","extendStatics","$31d11a8d122cb4b7$var$__extends","d1","b1","setPrototypeOf","__","_super","secure","host","path","pingInterval","_this","_disconnected","_messagesQueue","wsProtocol","_baseUrl","token","_id","wsUrl","_socket","WebSocket","onmessage","Message","onclose","_cleanup","Disconnected","onopen","_sendQueuedMessages","_scheduleHeartbeat","_wsPingTimer","_sendHeartbeat","_wsOpen","Heartbeat","e_1","_a","copiedQueue","$31d11a8d122cb4b7$var$__spreadArray","$31d11a8d122cb4b7$var$__read","copiedQueue_1","$31d11a8d122cb4b7$var$__values","copiedQueue_1_1","e_1_1","return","clearTimeout","$353dee38f9ab557b$exports","$353dee38f9ab557b$export$4a84e95a2324ac29","$77f14d3e81888156$exports","$77f14d3e81888156$export$89e6bb5ad64bf4a","$77f14d3e81888156$var$__assign","$77f14d3e81888156$var$__awaiter","thisArg","_arguments","P","generator","fulfilled","step","$77f14d3e81888156$var$__generator","body","g","_","sent","trys","ops","verb","op","pop","connection","startConnection","peerConnection","_startPeerConnection","Media","_stream","_addTracksToConnection","originator","Data","dataConnection","initialize","_makeOffer","handleSDP","provider","_setupListeners","peerId","connectionId","connectionType","socket","Candidate","payload","dst","getConnection","mediaConnection","_addStreamToMediaConnection","cleanup","peerConnectionNotClosed","dataChannelNotClosed","err_2","err_1_1","sdpTransform","metadata","serialization","Offer","emitError","WebRTC","_makeAnswer","err_3","err_1_2","Answer","err_4","handleCandidate","ice","err_5","$0b3b332fd86c5202$exports","$0b3b332fd86c5202$export$23a2a68283c24d80","$0b3b332fd86c5202$var$__extends","_open","$353dee38f9ab557b$var$__extends","$353dee38f9ab557b$var$__assign","_localStream","ID_PREFIX","_negotiator","Negotiator","_remoteStream","remoteStream","handleMessage","_payload","messages","_getMessages","messages_1","$353dee38f9ab557b$var$__values","messages_1_1","_removeConnection","open","BaseConnection","$3356170d7bce7f20$exports","$3356170d7bce7f20$export$d365f7ad9d7df9c9","$3014d862dcc9946b$exports","$3014d862dcc9946b$export$c6913ae0ed687038","$3014d862dcc9946b$var$__extends","fileReader","_queue","_processing","doNextTask","destroy","queue","enque","processing","abort","$3356170d7bce7f20$var$__extends","_buffer","_bufferSize","_buffering","_chunkedData","_encodingQueue","EncodingQueue","Binary","ab","_bufferedSend","_dc","_configureDataChannel","_handleDataMessage","datatype","deserializedData","BinaryUTF8","unpackedData","ab1","_handleChunk","chunkInfo","count","data_1","chunked","_sendChunks","msg","_trySend","bufferedAmount","MAX_BUFFERED_AMOUNT","_tryBuffer","blobs","blobs_1","$3356170d7bce7f20$var$__values","blobs_1_1","blob_1","$9e85b3e1327369e6$exports","$9e85b3e1327369e6$export$2c4e825dc9120f87","$9e85b3e1327369e6$var$__awaiter","$9e85b3e1327369e6$var$__generator","_options","_buildRequest","URL","searchParams","fetch","referrerPolicy","retrieveId","error_1","pathError","text","listAllPeers","helpfulError","error_2","json","$26088d7da5b03f69$var$__extends","$26088d7da5b03f69$var$__assign","$26088d7da5b03f69$var$__values","$26088d7da5b03f69$var$__read","id1","userId","_lastServerId","_destroyed","_connections","_lostMessages","debug","DEFAULT_KEY","hostname","logFunction","_api","API","_createServerConnection","_delayedAbort","InvalidID","_initialize","_abort","ServerError","BrowserIncompatible","plainConnections","_b","_c","_d","k","Socket","_handleMessage","SocketError","Network","disconnect","Close","SocketClosed","e_2","Open","IdTaken","UnavailableID","InvalidKey","Leave","_cleanupPeer","Expire","PeerUnavailable","MediaConnection","_addConnection","DataConnection","message_1","e_2_1","_storeMessage","connections","e_3","connections_1","connections_1_1","e_3_1","destroyed","e_4","e_4_1","e_5","connections_2","connections_2_1","e_5_1","currentId","reconnect","peers","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","definition","toStringTag"],"sourceRoot":""}